---

title: Methods and apparatus to route a communication session directly to a voicemail mailbox
abstract: Methods and apparatus to route a communication session directly to a voicemail mailbox are disclosed. An example method includes receiving a communication session initiation message from a caller at a source telephone number, the communication session initiation message including a destination telephone number and a direct voicemail feature identifier, determining that the direct voicemail feature identifier indicates that the caller requests that the call be sent to a voicemail mailbox associated with the destination telephone number, and forwarding the call directly to the voicemail mailbox associated with the destination telephone number without ringing the destination telephone number.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08879545&OS=08879545&RS=08879545
owner: AT&T Intelletual Property I, L.P.
number: 08879545
owner_city: Atlanta
owner_country: US
publication_date: 20071231
---
This disclosure relates to generally telephone networks and more particularly to methods and apparatus to route a communication session directly to a voicemail mailbox.

In communication networks such as Internet Protocol Multimedia Subsystem networks communication sessions are routed through a communication network from an originating device e.g. a voice over internet protocol telephone and or public switched telephone network telephone to a terminating device e.g. a voice over internet protocol telephone and or a public switched telephone network telephone . If the terminating device is busy or a communication session between the originating device and the terminating device is not initiated the communication session is transferred to a voicemail mailbox associated with the terminating device at a voicemail server. The originating device then has an opportunity to leave a message e.g. a voice message in the voicemail mailbox.

To access IMS communication services throughout and or within a site location building geographic area and or geographic region the example IMS communication system of includes any number and or type s of access networks two of which are designated in with reference numbers and . In general the example access networks and provide and or facilitate a communicative coupling of the IMS devices to and or with an IMS network which provides and or enables IMS communication services to the IMS device . However in some examples one or more of the IMS devices may access the IMS network without use of an access network . The example access networks and can be implemented using any number and or type s of past present and or future standards specifications communication devices networks technologies and or systems such as public switched telephone network PSTN systems public land mobile network PLMN systems e.g. cellular wireless distribution systems wired or cable distribution systems coaxial cable distribution systems Ultra High Frequency UHF Very High Frequency VHF radio frequency systems satellite or other extra terrestrial systems cellular distribution systems power line broadcast systems fiber optic networks and or any combinations and or hybrids of these devices systems and or networks.

While in the illustrated example of each of the example IMS devices are depicted as having an associated access network such depictions are merely illustrative. For example the example IMS devices may utilize a common access network an IMS device may be configured for and or capable of utilizing more than one access network at the same and or different times an IMS device may be configured to access the IMS network directly or via the IP network without an intervening access network etc.

To provide IMS communication services e.g. telephone services Internet services data services messaging services instant messaging services electronic mail email services chat services video services audio services gaming services etc. the example IMS communication system of includes one or more IMS networks one of which is designated in with reference numeral . In IMS networks such as the example IMS network of a tElephone NUMber mapping ENUM server e.g. an example ENUM server is generally used to obtain a session initiation protocol SIP uniform resource identifier URI for a destination based on the telephone number associated with the destination. The SIP URI is then used by and or within the IMS network to route a communication session to the destination.

In the example IMS communication system of the example IMS devices are communicatively coupled to the example IMS network via one or more of the example access networks and or and or any number and or type s of private and or public IP based communication networks such as for example the Internet two of which are illustrated in with reference numerals and . While in the illustrated example of each of the example IMS devices are depicted as having an associated IP network such depictions are merely illustrative. For example the example IMS devices may utilize the same public IP network an IMS device may be configured for and or capable of utilizing more than one IP network at the same and or different times etc. In general the example IP networks and of provide and or facilitate a communicative coupling of the IMS devices to and or with the IMS network .

In some examples the IMS devices may be communicatively coupled to the access networks and via one or more additional IP based networks and or devices not shown such as a local area network LAN a gateway and or a router located within a place of business a school and or a residence. The example IMS devices of are communicatively coupled to the example access networks and the example IP networks and and or more generally the example IMS network via any number and or type s of past current and or future communication network s communication system s communication device s transmission path s protocol s technique s specification s and or standard s . For instance the example IMS devices may be coupled to the example access networks and the example IP networks and and or the example IMS network via any type s of voice band modem s digital subscriber line DSL modem s cable modem s Ethernet transceiver s optical transceiver s IP virtual private network VPN connection s Institute of Electrical and Electronics Engineers IEEE 802.11x a.k.a. WiFi transceiver s IEEE 802.16 a.k.a. WiMax wireless local area network WLAN access point s general packet radio services GPRS networks in 4G wireless networks etc. Moreover any or all of the example IMS network the example access networks and and or the example IP networks and of may extend geographically to include one or more locations near to and or encompassing one or more of the IMS devices . For example the access network may include a wireless access point not shown by which for example a WiFi IP phone connects to the IP network and the IMS network .

In the example IMS communication system of the example access networks and the example IP networks and and the IMS network need not be owned implemented and or operated by a single service provider. For example the IMS devices may access IMS services provided by an IMS network owned operated and or implemented by a first service provider via access networks and which are owned operated and or implemented by one or more additional service providers. However any or all of the access networks and the IMS network and or the IP networks and may be operated by a single service provider.

In the illustrated example IMS communication system of each IMS device e.g. the example IMS devices that is registered to the example IMS network is associated with and or assigned to a serving call session control function S CSCF server three of which are designated in with reference numerals and . The example S CSCF servers of are responsible for handling incoming and or outgoing IMS communication sessions e.g. telephone calls data sessions and or video sessions associated with its registered IMS devices .

While three S CSCF servers are illustrated in the IMS network may include any number and or type s of S CSCF servers and each such S CSCF server may support any number and or type s of IMS devices . The example S CSCF servers of perform session control maintain session states and or enable communications with call feature servers e.g. the example feature servers of for its associated and or registered IMS devices . For instance when the calling IMS device A initiates for example an outgoing telephone call to the example IMS device B a communication session initiation message e.g. a SIP INVITE message is routed by the IMS network from the IMS device A to the S CSCF server A associated with that particular IMS device A . When the calling IMS device A initiates an outgoing telephone call having a destination that includes a feature identifier e.g. 99 the S CSCF server A routes the communication session initiation message to a feature server e.g. the feature server A for processing.

To provide one or more additional call features the example IMS network of includes any number and or type s of feature servers three of which are designated in with reference numerals and . The example feature servers of provide and or implement additional service features to subscribers e.g. call barring calling name delivery and or blocking call blocking call forward call forking call trace voicemail announcement servers call trees etc. . Example feature servers include but are not limited to VoIP feature servers. The feature servers may be used to provide and or implement call features and or services for both calling and or called parties.

According to the illustrated example the feature server A supports a direct to voicemail feature. When a communication session initiation message having a destination that includes a direct to voicemail feature identifier is routed to the feature server A from the S CSCF server A the feature server A modifies the communication session initiation message to direct the call to a callee s voicemail. In the example implementation the example feature server A sends an ENUM query to the ENUM server requesting URIs associated with the destination identified in the communication session initiation message. Upon receipt of the URIs from the ENUM server the feature server selects a URI associated with a voicemail server. The feature server A then inserts the original destination number in a header field used to indicate a redirecting number. According to the illustrated example the feature server A inserts the destination number in a Redirecting Number field in a Diversion Header of the communication session initiation message. The feature server A also inserts an identifier in the communication session initiation message indicating that the communication session initiation message is being directed to voicemail based on a caller request. In the illustrated example the feature server A inserts a reason code identifying caller requested in the Diversion Header of the communication session initiation message. The feature server A additionally adds a parameter to the communication session initiation message indicating that a S CSCF that receives the communication session initiation message doesn t need to perform another ENUM query. For example appending the parameter term to a route header of the communication session initiation message indicates to the S CSCF A that an ENUM query has already been performed and does not need to be repeated.

After modifying the communication session initiation message the feature server A routes the communication session initiation message to the S CSCF A for processing.

In another example implementation the feature server A may alternatively not perform an ENUM query. Upon receipt of a communication session initiation message the example feature server A removes the direct to voicemail feature identifier from the destination of the communication session initiation message and copies the destination to a redirecting number field of the communication session initiation message. The example feature server A also appends a tag to the communication session initiation message indicating that the caller has requested connection directly to the callee s voicemail e.g. CTag Voicemail Direct . The example feature server A modifies a header of the communication session initiation message to include a reason code that identifies the reason for forwarding the call directly to voicemail e.g. caller requested . The feature server then routes the communication session initiation message back to the S CSCF server A . According to this example implementation the feature server A does not perform an ENUM query. Rather the S CSCF server A will perform the ENUM query upon receipt of the communication message initiation message.

The feature server B of the illustrated example is associated with a voicemail mailbox of the IMS device B . For example calls that are not answered at the IMS device B are normally routed to the feature server B so that a caller can leave a voicemail message. The example feature server B additionally handles incoming calls that identify caller requested in the Diversion Header of the communication session initiation message differently than other incoming calls e.g. calls that were directed to voicemail as a result of a call not being answered by a callee . For example the feature server B may present an incoming call with a different outgoing message that may have been customized by a callee may present the caller with an interactive voice response menu that is different from a menu offered to traditional voicemail calls etc.

If an ENUM query has been performed by the feature server A the S CSCF server A receives the communication session initiation message and does not perform an additional ENUM query. In the illustrated example the term parameter indicates to the S CSCF server A that a further ENUM query is not needed. Based on the URI identified in the communication session initiation message e.g. the URI of the voicemail server the S CSCF server A determines if the voicemail server is located on a PSTN network or a VoIP network. According to the illustrated example the URI identifies the network as tel indicating a PSTN network or sip indicating a VoIP network. If the voicemail server is on a PSTN network the S CSCF server A routes the communication session to the voicemail server on the PSTN network. If the voicemail server is on a VoIP network the S CSCF server A performs a domain name service DNS query on a domain name of the URI in the communication session initiation message to obtain an IP address of the voicemail server. An example URI identifies user voicemail.server.com. The S CSCF performs a DNS query on the domain name voicemail.server.com to obtain an IP address for the server. Once an IP address of the voicemail server has been obtained the S CSCF server A routes the communication session to the IP address of the voicemail server.

If an ENUM query has not been performed by the feature server A the example S CSCF server A sends an ENUM query request message to the example ENUM server to obtain an identifier e.g. a SIP URI for the voicemail server associated with the destination of the communication session initiation message e.g. feature server B . According to the illustrated example the ENUM server returns an identifier e.g. a SIP VOICEMAIL URI for the feature server B which manages the voicemail mailbox for the callee identified in the communication session initiation message. The S CSCF server A recognizes the tag appended to the communication session initiation message e.g. CTag Voicemail Direct by the feature server. In response to recognizing the appended tag the S CSCF server A uses the VOICEMAIL URI for processing the communication session initiation message. The S CSCF server routes the call to the feature server identified by the VOICEMAIL URI e.g. feature server B as a standard Message Deposit call. For example the call will be routed as if the call had been sent to the callee and not answered.

To locate and or identify the destination for a requested communication session e.g. a communication session directed to a voicemail server the example IMS network of includes any number of ENUM servers one of which is designated in with reference numeral . The example ENUM server of extracts the call destination from the ENUM query request message received from an S CSCF server . The example ENUM server then performs based on the destination a lookup of an ENUM database e.g. the example ENUM database of to obtain a SIP URI for the final destination. The ENUM database stores and or represents associations between device identifiers e.g. E.164 telephone numbers to SIP URIs . Thus for example by performing an ENUM lookup a SIP URI e.g. a fully qualified domain name for the destination can be identified based upon a called telephone number assigned to the destination. However the ENUM database may store any number and or type s of associations between any number and or type s of identifiers. In some examples a final destination associated with and or configured to an original destination may already be a URI e.g. a SIP URI an application URI and or a hypertext transfer protocol HTTP URI and thus the ENUM database lookup need not be performed. An example manner of implementing the example ENUM server is described below in connection with .

The ENUM server of the illustrated stores and retrieves a URI for a voicemail mailbox. An example ENUM service for a voicemail server includes an Enumersevice Name field that is populated with vm an Enumerservice Type field populated with vm an Enumservice Subtype field populated with tel or sip and a URI Scheme field populated with tel or sip. In the example implementation the tel identifier is used when the voicemail system resides in a public switched telephone network PSTN and the sip identifier is used when voicemail system resides in a VoIP network. The ENUM server may use any identification to identify the voicemail mailbox. In the illustrated example the voicemail mailbox is identified as mailbox voicemail.server.com. 

To provide an access entry point for an IMS device into the IMS network the example IMS network of includes any number and or type s of proxy call session control function P CSCF servers two of which are designated in with reference numerals and . The example P CSCF servers and of among other things route SIP messages between IMS devices and their associated S CSCF servers .

To locate and or identify the S CSCF server associated with an IMS device the example IMS network of includes any number and or type s of interrogating call session control function I CSCF servers one of which is designated in with reference number . The example I CSCF server of serves as a contact point within the example IMS network for connections destined for an IMS device of the IMS communication system and or for an IMS device currently located within the serving area of the IMS communication system e.g. a roaming subscriber . For example for a destination identified by the example ENUM server the example I CSCF identifies to which S CSCF server the destination IMS device is registered. IMS protocol messages directed to the destination IMS device are then routed to the S CSCF server identified by the I CSCF .

To manage subscriber information and or to enable subscribers and or servers to locate other servers subscribers and or destinations the example IMS network of includes any number and or type s of home subscriber server s HSSs one of which is designated in with reference numeral . The example HSS of maintains a device profile and or one or more preferences for each subscriber and or IMS device of the IMS network . The example I CSCF server of uses information contained in the HSS to for example determine and or locate the S CSCF server associated with a particular subscriber and or IMS device .

As illustrated in the example S CSCF servers the example ENUM server the example P CSCF servers and the example I CSCF server the example HSS and or the example feature servers communicate and or are communicatively coupled via any number type s and or combination of communication paths communication networks busses and or communication devices .

While an example IMS communication system example IMS devices and an example IMS network have been illustrated in the devices networks systems servers and or processors illustrated in may be combined divided re arranged eliminated and or implemented in any way. The example S CSCF servers the example ENUM server the example P CSCF servers and the example I CSCF server the example HSS and or the example feature servers illustrated in are logical entities of the example IMS network . They may therefore be implemented separately and or in any combination using for example machine accessible instructions executed by one or more computing devices and or computing platforms. Further the example IMS devices the example S CSCF servers the example ENUM server the example P CSCF servers and the example I CSCF server the example HSS the example feature servers and or more generally the example IMS network may be implemented by hardware software firmware and or any combination of hardware software and or firmware. Further still the example IMS communication system the example IMS devices and or the example IMS network may include additional devices servers systems networks gateways portals and or processors in addition to or instead of those illustrated in and or may include more than one of any or all of the illustrated devices servers networks systems gateways portals and or processors. For example an IMS network may include any number and or type s of media gateways media gateway control function MGCF servers breakout gateway control function BGCF severs and or session border controllers.

To allow feature servers e.g. the example feature servers of to configure update and or otherwise provide re direction information and or data the example ENUM server of includes a service oriented architecture protocol SOAP interface . In other examples the interface may be implemented using an open application programming interface API such as for example JAVA and or common object request broker architecture CORBA .

The example ENUM database may be implemented using any number and or type s of data structures and may be stored in and or within any number and or type s of memories and or memory devices .

To allow call servers e.g. the example S CSCF servers of to perform ENUM queries the example ENUM server of includes any type of ENUM query interface . Using any message s format s and or protocol s e.g. in accordance with Internet Engineering Task Force IETF Request for Comment RFC 4761 the example ENUM query interface of exchanges ENUM query request messages and ENUM query response messages with call servers.

To perform ENUM lookups the example ENUM server of includes any type of example ENUM querier . The example ENUM querier of performs a lookup of the ENUM database to identify a SIP URI associated with a telephone number. In some examples the ENUM database is implemented using one or more legacy ENUM servers.

While an example manner of implementing the example ENUM server of has been illustrated in one or more of the data structures elements processes and or devices illustrated in may be combined divided re arranged omitted eliminated and or implemented in any other way. Further the example interfaces and the example databases the example ENUM querier and or more generally the example ENUM server may be implemented by hardware software firmware and or any combination of hardware software and or firmware. Further still the example ENUM server may include data structures elements processes and or devices instead of or in addition to those illustrated in and or may include more than one of any or all of the illustrated data structures elements processes and or devices.

To allow the example feature server of to handle communication session initiation message having a destination including a feature identifier the example feature server includes a direct voicemail configurer and the ENUM server querier . The direct voicemail configurer receives a communication session initiation message forwarded from an S CSCF server e.g. the S CSCF server A of that is a direct to voicemail request. The direct voicemail configurer extracts the destination number e.g. called number from the communication session initiation message and directs the ENUM server querier to query an ENUM server e.g. the ENUM server of to request a URI associated with the destination number. Upon receipt of the ENUM list of URIs associated with the destination number from the ENUM server the direct voicemail configurer selects the voicemail URI. The direct voicemail configurer inserts the original dialed number into a header of the communication session initiation message. The direct voicemail configurer also inserts a new reason code e.g. caller requested as the reason for forwarding into a header of the message. In addition the direct voicemail configurer replaces the URI e.g. the Request URI that it received from the caller with the voicemail URI from the returned ENUM list. The direct voicemail configurer of the illustrated example additionally appends a parameter to a header of the communication session initiation message e.g. in the illustrated example the parameter term is appended to the Route header to instruct the S CSCF server not to perform an addition ENUM query once the communication session initiation message is directed back to the S CSCF server.

To implement call services and or features the example feature server of includes any number and or type s of application servers one of which is designated at reference numeral . The example application server of implements any call services and or features such as for example call barring call name delivery call name blocking call blocking call forwarding call forking call trace and or voicemail.

While an example manner of implementing any or all of the example feature servers of has been illustrated in one or more of the data structures elements processes and or devices illustrated in may be combined divided re arranged omitted eliminated and or implemented in any other way. Further the example interfaces and the example ENUM server querier the example direct voicemail configurer the example application server and or more generally the example feature servers may be implemented by hardware software firmware and or any combination of hardware software and or firmware. Further still the example feature servers may include data structures elements processes and or devices instead of or in addition to those illustrated in and or may include more than one of any or all of the illustrated data structures elements processes and or devices.

The flowchart of begins when a communication session initiation message is received by a S CSCF server e.g. the S CSCF server A of block . For example the IMS device A sends a communication session initiation message to the P CSCF which identifies the S CSCF server e.g. the S CSCF A associated with a destination identified in the communication session initiation message e.g. the S CSCF A . The P CSCF routes the communication session initiation message to the S CSCF A . The communication session initiation message is routed to a feature server e.g. the feature server A of block . The feature server then processes the communication session initiation message block . A flowchart illustrating an example implementation of the processing performed by the feature server in block is illustrated in .

After the communication session initiation message is processed by the feature server the S CSCF receives a modified communication session initiation message from the feature server block . In the illustrated example the modified communication session initiation message identifies a URI for a voicemail server associated with the destination identified in the communication session initiation message. Then the S CSCF determines if the URI identified in the modified communication session initiation message indicates that the voicemail server is on a PSTN or a VoIP network block . In the illustrated example the uniform resource locator includes the identifier tel if the voicemail server is on a PSTN or includes the identifier sip if the voicemail server is on a VoIP network. Alternatively if additional communication networks exist an identifier for the additional networks may be used.

If the URI indicates that the voicemail server is on a PSTN network block the S CSCF routes the communication session to the voicemail server on the PSTN network block . In the illustrated example the communication session is routed directly to the voicemail mailbox associated with the destination of the communication session initiation message so that the caller can leave a message in the voicemail mailbox without ringing the telephone of the destination. The instructions represented is then complete.

Returning to block if the URI indicates that the voicemail server is on a VoIP network block the S CSCF performs a DNS query using the domain name identified in the URI to obtain an IP address associated with the voicemail server block . The S CSCF replaces the domain name identified in the URI with the IP address retrieved by the DNS query block . The S CSCF then routes the communication session to the IP address identified by the DNS query block . The instructions represented by the flowchart of then terminate.

While the instructions of are completed once the communication session initiation message has resulted in a communication session being routed to a voicemail server it should be understood that the instructions may be implemented as a loop that waits for a next communication session initiation message e.g. control returns to block .

The flowchart of illustrates example machine readable instructions that are executed to process a communication session initiation message at a feature server block of . The flowchart of begins when a communication session initiation message is received from a S CSCF e.g. the S CSCF A of at a feature server e.g. the feature server A of block . The example communication session initiation message identifies a destination that includes a feature identifier indicating that the source of the communication session has requested to be connected directly to a voicemail mailbox at the destination. In response the feature server sends a query to an ENUM server e.g. the ENUM server of for a destination number identified in the communication session initiation message block . In response the feature server receives an ENUM list identifying URIs associated with the destination number block . Because the destination of the communication session initiation indicates that the communication session is to be connected directly to a voicemail mailbox the feature server selects a URI for the voicemail server from the ENUM list block . The feature server then inserts the destination number from the communication session initiation message in a header of the communication session initiation message used to indicate a redirecting number block . In the illustrated example the destination number field is inserted in a field in a Diversion Header of the communication session initiation message. The feature server then inserts a caller requested reason code into the header e.g. the Diversion Header of the communication session initiation message block . Next the feature server replaces the URI identified in the communication session initiation message with the URI associated with the voicemail server from the ENUM list block . Then the feature server modifies the communication session initiation message to indicate that an ENUM query has been performed block . In the illustrated example the feature server adds the parameter term to a route header of the communication session initiation message to indicate to a S CSCF server that a further ENUM query need not be performed.

After the feature server has modified the communication session initiation message the feature server sends the modified communication session initiation message back to the S CSCF block . Control then returns to block of .

The processor platform of the example of includes at least one general purpose programmable processor . The processor executes coded instructions and or present in main memory of the processor e.g. within a RAM and or a ROM . The processor may be any type of processing unit such as a processor core a processor and or a microcontroller. The processor may execute among other things the example exchanges and or the example machine accessible instructions of to implement the example methods and apparatus described herein.

The processor is in communication with the main memory including a ROM and or the RAM via a bus . The RAM may be implemented by DRAM SDRAM and or any other type of RAM device and ROM may be implemented by flash memory and or any other desired type of memory device. Access to the memory and may be controlled by a memory controller not shown .

The processor platform also includes an interface circuit . The interface circuit may be implemented by any type of interface standard such as an external memory interface serial port general purpose input output etc. One or more input devices and one or more output devices are connected to the interface circuit . The input devices and or output devices may be used to for example implement the example interface and or of and or the example interfaces and or of .

Of course the order size and proportions of the memory illustrated in the example systems may vary. Additionally although this patent discloses example systems including among other components software or firmware executed on hardware it will be noted that such systems are merely illustrative and should not be considered as limiting. For example it is contemplated that any or all of these hardware and software components could be embodied exclusively in hardware exclusively in software exclusively in firmware or in some combination of hardware firmware and or software. Accordingly the above described examples are not the only way to implement such systems.

At least some of the above described example methods and or apparatus are implemented by one or more software and or firmware programs running on a computer processor. However dedicated hardware implementations including but not limited to an ASIC programmable logic arrays and other hardware devices can likewise be constructed to implement some or all of the example methods and or apparatus described herein either in whole or in part. Furthermore alternative software implementations including but not limited to distributed processing or component object distributed processing parallel processing or virtual machine processing can also be constructed to implement the example methods and or apparatus described herein.

It should also be noted that the example software and or firmware implementations described herein are optionally stored on a tangible storage medium such as a magnetic medium e.g. a disk or tape a magneto optical or optical medium such as a disk or a solid state medium such as a memory card or other package that houses one or more read only non volatile memories random access memories or other re writable volatile memories or a signal containing computer instructions. A digital file attachment to e mail or other self contained information archive or set of archives is considered a distribution medium equivalent to a tangible storage medium. Accordingly the example software and or firmware described herein can be stored on a tangible storage medium or distribution medium such as those described above or equivalents and successor media.

To the extent the above specification describes example components and functions with reference to particular devices standards and or protocols it is understood that the teachings of the invention are not limited to such devices standards and or protocols. Such systems are periodically superseded by faster or more efficient systems having the same general purpose. Accordingly replacement devices standards and or protocols having the same general functions are equivalents which are intended to be included within the scope of the accompanying claims.

Although certain example methods apparatus and articles of manufacture have been described herein the scope of coverage of this patent is not limited thereto. On the contrary this patent covers all methods apparatus and articles of manufacture fairly falling within the scope of the appended claims either literally or under the doctrine of equivalents.

