---

title: Apparatus and methods for providing secured communication
abstract: Authentication information is generated for a group where members within a group are able to communicate with each other, but a non-members is not able to participate in that communication. The authentication information provides the determination of whether the member belongs to the group.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07392387&OS=07392387&RS=07392387
owner: Xerox Corporation
number: 07392387
owner_city: Stamford
owner_country: US
publication_date: 20070226
---
This application is a continuation application of U.S. patent application Ser. No. 10 231 194 filed Aug. 30 2002 now U.S. Pat. No. 7 185 199 by the same inventors claims priority therefrom and incorporates its entire disclosure herein by reference.

Arbitrary connections can be used to connect various devices such as Personal Digital Assistants PDAs handheld computers laptop computers desktop computers cellular phones wireless phones sensors with measuring devices securing devices and home entertainment automation and security devices for example. However authorizing communication between certain devices while disallowing others may require an infrastructure that provides globally trusted certification authorities up to date certificate revocation lists and sound certificate issuing policies.

These elaborate systems for securing wireless and hard wired communication are not well suited to environments where ease of use and accessibility are important. For example in an environment where users are likely to be unsophisticated or are unwilling to deal with the challenges of security configurations security may be breached because the users may not know how to use the security measures. Users may even deliberately turn off the security measures if they find the security measures to be confusing or to be interfering with the tasks that they are attempting to complete.

This invention provides devices systems and methods for securing a communication over a communication medium.

This invention separately provides devices systems and methods that allow communication to be secured among a plurality of members of a group.

In various exemplary embodiments of the devices systems and methods according to this invention a securing device includes a logic unit that generates authentication information for a group. In various exemplary embodiments the securing device includes a location limited channel transmitter that is usable to send pre authentication information to a potential member. In various exemplary embodiments the receipt of the authenticating information by the potential member designates that potential member as a member of the group. In various exemplary embodiments the member of the group uses the authentication information to secure communication with other members of the group.

In various exemplary embodiments the securing device generates a trusted group and designates a controller device as a member of the trusted group.

In various exemplary embodiments the securing device includes a controller device interface to interface with the controller device. In various exemplary embodiments the controller device interface is adapted to communicate with another device through the communication medium.

In various exemplary embodiments the securing device includes a biometric input. In various exemplary embodiments the biometric input is used to generate authentication information. In various exemplary embodiments the biometric input is used to secure data in a memory of the securing device. In various exemplary embodiments the biometric input authenticates the user that is allowed to use the securing device.

In various exemplary embodiments the securing device includes a reset application stored in a memory where the logic unit uses the reset application to generate a reset signal that resets members of a group to their original state. In various exemplary embodiments a member device is provided with a reset button which when activated reverts the member device to its original state. In various exemplary embodiments a member device is provided with a reset application which when executed reverts the member device to its original state.

In various exemplary embodiments the securing device includes a logic unit that generates audit information.

These and other features and advantages of the invention are described in or are apparent from the following description of various exemplary embodiments of the systems and methods according to this invention.

In various exemplary embodiments of devices systems and methods according to this invention users can create one or more groups having members where the members within a group are able to communicate with each other but a non member is not able to participate in that communication. According to various exemplary embodiments communication between group members is authenticated and or encrypted. The authentication provides the determination of whether the member belongs to the group. The group can have numerous members or the group can even have only one member. For example the group can have only one device to which other devices may later be added or the group may have only one device to which a particular key certificate credential to a set of applications or services are attached.

In various exemplary embodiments the logic unit may be a microprocessor a microcontroller a digital signal processor DSP an arthmetric logic unit ALU an application specific integrated circuit ASIC and the like. The memory may be a known or future developed semiconductor volatile and or non volatile memory such as random access memory RAM read only memory ROM flash memory and the like but may also include known or future developed magnetic or optical disk drive units.

In various exemplary embodiments the securing device is configured to receive and download applications and or commands for example from an external controller device or the like via the controller device interface and or the location limited channel transmitter receiver . The commands can cause the securing device to perform certain tasks while the various applications allow the securing device to execute more sophisticated application logic and or state control logic. In various exemplary embodiments the securing device may also independently initiate connections and actions using the location limited channel transmitter receiver the controller device interface and or the capabilities of a controller device in communication with the securing device . In various exemplary embodiments the securing device performs messaging protocols to communicate with other devices . . . to determine what capabilities the other devices . . . have and or issue credentials and or keys that are suitable for the intended purposes of the other devices.

In various exemplary embodiments the securing device utilizes a number of applications to form a group and to create an infrastructure that allows devices . . . of the group to communicate with each other. Some of the applications may require input from a user beyond that supported by the securing device . Other applications may require additional features supported by the controller device . In various exemplary embodiments reducing features on the securing device that may be duplicated by the controller device may also reduce the size of the securing device . This reduction may enhance the portability of the securing device .

In various exemplary embodiments the controller device interface and or the location limited channel transmitter receiver may provide the securing device with a communication link that is physically limited in the distance and or the direction over which the securing device is able to communicate. In various exemplary embodiments the communication link may be microwave infrared physical contact wires USB plugs serial port connection parallel port connection and other known or future developed communication links. In various exemplary embodiments the communication link may be short range multi directional communication such as short range radio sound whether in the audible and or in the ultrasonic range Bluetooth and other known or future developed multi directional communication links.

In various exemplary embodiments a suitable communication link may depend on the application and or the environment to be used. As an example when the communication link between a securing device and a controller device is a short range radio sound contact and so forth the two devices may need to be in close proximity for the securing device to be in communication with the controller device . Thus if a stolen controller device is being used to control the securing device then that controller device will be easily detected because of the close proximity to the securing device in which that controller device must operate. In other examples the controller device communicates with the securing device over arbitrary distances and or over arbitrary networks. In these examples communication links such as infrared microwave RFID tags and the like may be used.

In various exemplary embodiments the arbitrary network may be a wired network a wireless network or a combination of the two. In various exemplary embodiments the arbitrary network may be a local area network a wide area network an intranet an extranet the Internet or any other distributed processing and or storage network.

In various exemplary embodiments the controller device may be authorized to perform various operations on the securing device at close proximity but may be authorized to perform certain operations at a remote distance. For example the controller device may control the operation of the securing device at close proximity however it may access the status of the securing device over an arbitrary network. In various exemplary embodiments the short range local communication may allow the possibility of expressing intention with location. For example if the securing device contains subway credits and is close to a turnstile the turnstile charges the securing device for entry and provides access. However if the turnstile is a few feet away the turnstile does not charge the securing device .

In various exemplary embodiments identifying controller devices . . . by their membership in a special trusted group allows a single securing device to be controlled from multiple controller devices . . . . The controller devices . . . may be selected by the user of the securing device and can take a variety of forms such as cell phones PDAs handheld computers laptop computers and any other appropriate known and future developed devices that have an appropriate logic unit. In particular the set of chosen controller devices . . . can vary from user to user. Because the user is usually familiar with the selected controller devices . . . the user need not learn the operation of those controller devices . . . to control the securing device . Controlling the securing device may appear to the user as yet another application on the user s controller devices . . . . For example control of the securing device may be performed through a user interface of the controller device .

In various exemplary embodiments the securing device is usually imprinted with the identity of at least one trusted controller device . . . during an initialization process. As part of the initialization process for the securing device the securing device creates a special trusted group in the memory for its trusted controller devices . . . and requests that the user add at least one controller device . . . to this group. The selected controller device . . . is distinguished cryptographically by its membership in a special trusted group and or is further distinguished by its ability to run an application that provides for an interface with the securing device .

In various exemplary embodiments having multiple controller . . . help establish trust. For example a controller device allows a status of the securing device to be displayed on a display screen of the controller device . Further the controller device delivers commands from the user to the securing device . If the controller device is tampered with such tampering is likely to be detected as a second controller device may be used to verify the status of the securing device . Certain controller devices . . . such as a cellular phone makes it difficult if not impossible for an adversary to tamper with the cellular phone s software. In certain embodiments for high security sensitive applications a dedicated tamper resistant controller device whose software cannot be changed may be used to interface with the securing device .

In various exemplary embodiments for added security the securing device can include a biometric input such as a fingerprint sensor or any one or more other known or future developed biometric devices. In various embodiments the biometric input generates biometric identification that can be used to protect sensitive data stored in the securing device and or as an input analogous to a secure button. The biometric information can be used to generate keys that are used in group communication and or to encrypt and or secure data in the memory . The biometric identification can also be used to make the securing device functional for the legitimate user and is rendered useless for anyone else. In various other exemplary embodiments as an option the securing device can further include a display such as a liquid crystal display LCD a light emitting diodes LED display and or an audio display that generates monotones or multitones to indicate the state and or status information of the security device .

In those exemplary embodiments where an independent securing device is not desired the securing device and for example the host controller device may be packaged together as a single integrated device. For example the securing device may be integrated into a cellular phone. In various exemplary embodiments the cellular phone may be modified to include an interface such that another controller device may be used to control the securing device integrated into the cellular phone.

In various exemplary embodiments the communication between the securing device and the controller device . . . is authenticated and carried out at the desired distance for the application and or the environment at hand and the range limitation is enforced by the nature of the communication medium chosen. Communication between the securing device and the controller device . . . may be authenticated and encrypted using known cryptographic credential protocols that can support groups such as shared secret keys digital certificates identity based encryption identity based signatures group signatures credential systems with revocable anonymity which may be modified to support authentication and or any known or future developed protocols. The credentials should usually be able to both support authentication and key exchange. Ephemeral keys may be used for key exchange as long as authentication is supported.

In various exemplary embodiments a user uses the securing device to add a device . . . to a group. As an example the user uses the location limited channel of the securing device to point out the target device . This can be performed by for example using an infrared beam to transmit information to the target device or by using a contact interface to touch the securing device to the desired target device . In any case this indicates to the target device that the target device is to be added to the group and allows the securing device and the target device to exchange authentication information via the location limited channel . The exchange of authentication information will allow both devices to set up a secure communication over which subsequent interactions can take place which may be an arbitrary network or communication link.

In various exemplary embodiments during subsequent interactions the securing device sends to the target device a new member credential along with supporting information about the group such as the group root certificate and current revocation information. The securing device may optionally send additional information such as additional keys to be used for group communication information about the addresses of current members of the group and so forth. The target device receives this information and updates its internal data storage to indicate that it is a member of this new group. The target device stores the group credentials revocation information and other supporting data.

In various exemplary embodiments the securing device further maintains membership information for which a device a member. The securing device may also maintain owner information for that group such as for example by storing private group keys. In various exemplary embodiments the securing device may store as membership information a list of groups of which the securing device is a member including those which it is not an owner for each of those groups the securing device may store member credentials and owner credentials. The securing device may also cache a list of current members of that group and their last known addresses and may even include information about their credentials for example. In various exemplary embodiments the securing device may store as owner information a root key for each group.

In various exemplary embodiments the securing device may store as membership information credentials belonging to the user not associated with any group. For example the securing device may perform various protocols that allows it to act as a standard smart card or a credential wallet. In various exemplary embodiments the credentials may take the form of member credentials for a particular group. As an example if the user has a standard X.509 certificate for a managed PKI which may be required to access a computer database the certificate and private key may be stored in the securing device . The securing device knowing how to present credentials will present the required credentials to the computer. In the case of a digital wallet application the securing device may have at least two roles one where it is acting for itself that is storing and managing credentials for the groups that it has been used to create and in another it is acting for its human owner. In the second role the securing device stores and carries cryptographic credentials which are used for the benefit of the human owner. For example the securing device acts as a smart card for the human owner. In various exemplary embodiments the controller device may have a role in the presentation of credentials. For example the securing device may not have the correct data interface to present an airline ticket credential to a reservation kiosk but the controller device such as for example a PDA may have such an interface.

In various exemplary embodiments the securing device retains audit information that relates to audits changes in status of the communication operating environment and or membership list in a group. Such audit information may be stored in the memory and or at a location separate from the securing device such as in a memory of the host controller device or some other offboard storage location for redundancy reasons and or to minimize storage space required on the securing device . The audit information may be signed to preserve its integrity and encrypted if the audit information contains sensitive information.

In various exemplary embodiments the securing device may back up the contents stored in the memory to the memory of another device such as the memory of the host controller device . This feature allows the state of the securing device and stored information in the security device to be at least partially recovered if the securing device is lost or damaged.

In various exemplary embodiments the securing devices may be a member of each group it creates. However having a device being a member of more than one group may have security implications such as that device may become a conduit by which information can move across group boundaries. Therefore in these circumstances it may be desirable to restrict that device to one membership in a group at a time.

In step S when a potential member is to be added to a group the securing device determines whether there are more than one group created. If several groups have been created then in step S a selection is made as to which group the potential member is to be added. The operation then continues to step S. Otherwise if it is determined that only one group is created than the operation continues directly to step S. In step S a location limited channel is used to establish a secure communication between the securing device and the potential member. With the secure communication established in step S the securing device and the potential member exchange commitments to their public keys and contact information such as for example IP addresses sufficient to allow them to find each other over an arbitrary network or communication link. Next in step S communication between the securing device and the potential member using the location limited channel terminates. The operation then resumes in step S.

In step S the securing device uses the contact information to further communicate with the potential member using an arbitrary network or communication link. Next in step S the securing device and the potential member undertake a key exchange protocol of their choice to authenticate each other by ensuring that the public keys they use match the commitments made over the location limited channel. Then in step S after the securing device and the potential member have authenticated each other the securing device signals the potential member whether it is willing to be added to the group and whether it desires its own public key to be used in the group. If the potential member does not accept then the operation continues to step S where the operation terminates. Otherwise if the potential member accepts the operation continues to step S where the securing device uses the potential member s public key to create a new member certificate for that potential member by signing its public key along with any necessary supporting information with the group root key. In the event that the potential member decides not to use its public key then the securing device uses a public key from its own created key pair to create the new member certificate. Then in step S the securing device sends to the new member the new member certificate the group root certificate and any necessary supporting information about the group such as information about currently revoked devices auxiliary keys used for securing multicast communication and so forth. In the event the securing device has created the key pair the securing device also sends the private key. The new member stores the received certificates and supporting information in its local memory. The new member can now establish communication with other members in the group. The operation then continues to step S where the communication between the securing device and the new member device terminates.

As alternative exemplary embodiments different cryptographic mechanisms can be used as group member credentials. For example secret keys shared between all group members are simple to implement however they do not support distinctions between owners such as the securing device and group members such as the member devices. A device becomes a member of the group when the device has access to the shared secret key. Other alternative embodiments may allow the use of anonymous credentials or identity based encryption or signature systems as the cryptographic credentials underlying group membership.

In various exemplary embodiments the certificates may take many forms including standard X.509 certificates SPKI certificates WTLS certificates extended metadata language XML certificates attribute certificates or any current or future certificate types. In various exemplary embodiments choosing certificates that comply with external constraints may be desirable. As the primary function of such a group certificate is to allow its use by a member of a group to prove membership in the group it should contain at minimum the member s public key an identifier for the group that makes it unique such as for example a digest of the group root public key and an optional way to uniquely identify the certificate such as for example a serial number signed by the group root key. The member s key may be sufficient to uniquely identify the certificate that is the member is likely to have only one certificate for this group and the member is likely to be the only one with that public key. In the absence of uniquely identifying information contained in the credential the cryptographic digest of the credential may be used as its unique identifier. Optionally certificates may contain friendly names serial numbers or other information designed to make it easier to manage this credential information. In various exemplary embodiments choosing certificates that comply with external constraints may be desirable. For example X.509 certificates can be readily used with standard SSL TLS client and server software or with standard IKE demons enabling group members to secure their communications with IPSEC.

In various exemplary embodiments members of a group may communicate using a common language such as a remote procedure call RPC framework such as for example SOAP Java RMI or SUN RPC or a specified wire protocol. The RPC framework or wire protocol is run over a channel authenticated and encrypted using credentials that identify both communicants as members of a particular group. In various exemplary embodiments the members firewalls can be configured manually or automatically to refuse communication from any device not in one of the groups to which this device belongs and or refuse communication at the level of particular protocols or ports as a function of which groups are specified as being allowed to talk. As an example a member may be in a game group that allows all group members to recognize each other but that member may only allow other members of that group to talk to the member using the gaming protocol and or to the port on that member s machine on which the gaming program is listening.

In step S the controller device sends to the securing device any additional user inputs which the securing device may store in its memory. The user may use a user interface provided in the controller device. For example the user may input personalization application a friendly name and the like. In step S the securing device makes a credential for the controller device as a member of its group of trusted devices for example by certifying a public key given to it by the controller device. Then in step S the securing device sends to the controller device the new credential along with any necessary supporting group information which the controller device then stores in its memory. The new credential and any necessary supporting information will be used by the controller device for all future communication with the securing device. The operation then continues to step S where the process terminates.

In various exemplary embodiments future communications between the controller device and the securing device are primary user commands to the securing device and may require additional application code that runs on the controller device as a user interface in a form of an application Java code a web page and the like. In various exemplary embodiments such application code may already have been installed by the controller can be downloaded at this point or gotten from the securing device. In various exemplary embodiments additional controller devices may be added to the trusted group. Such additions may be done for example using the operation described in .

In the exemplary operation described above once the original group owner has made a secure connection with the second securing device the owner securing device will create for the second securing device a new group certificate signed with the key it has that is certified as a CA for the group. This can be the group root certificate or the certificate belonging to another secondary owner of the group that indicates the second securing device is authorized to act as a CA for the group. The second device s key can be the same as the one it uses in its member credential for the group or the second securing device can create a new key pair. When the second securing device adds a new member to the group it provides that new member not only with the root certificate of the group but with its own CA certificate and a chain of CA certificates connecting its certificate with the root that is the CA certificate of the device that signed its CA certificate and so on until it reaches a CA certificate signed by the root.

In various exemplary embodiments if the first securing device adds the second device as an owner of the group by passing it a copy of the group root private key the credentials issued by the two owners to new devices will be indistinguishable as they will be signed by the same key. Accordingly a mechanism should be used to ensure that member credentials are uniquely identifiable to be able to continue to work even though these owners may issue credentials to new members in parallel without communicating to one another. For example when the second securing device is being created as another owner of the group the creating securing device could reserve an serial number space for the new owner. However in various exemplary embodiments credentials identified uniquely by their cryptographic digests are immune to this assuming the credentialing system used includes information in those credentials designed to make two certificates signed by the same key for the same key distinct that is by including a date of issue in the certificate.

One advantage of having all issuers carry the same root key is that revocation information can be sent around without sending the signing certificate of the particular owner that signed it all members of the group are guaranteed to have the root key and to be able to use it to verify revocation information. Another advantage is that this approach works for all types of cryptographic credential systems not just certificate based ones.

In various exemplary embodiments the second securing device may already be a member of the group. In this case the user is given a list of devices in the group and is asked to select one of the device in the group.

As described above the apparatus and methods according to this invention allow at least two devices to securely communicate over a network medium. The apparatus and methods according to this invention allow the medium used for the location limited channel the public key algorithm used for the key commitments and or the final authenticated key exchange protocol used over the network medium to be dynamically chosen.

In various exemplary embodiments a software framework that supports inclusion of different location limited channel types public key algorithms used for the key exchange protocols and the final key exchange protocols chosen and allows these to be dynamically chosen can be used. The framework can be extended to provide a new location limited channel type or a new key exchange protocol for example by implementing a Java interface to provide a small amount of syntactic glue .

In various exemplary embodiments a system comprises a securing device which is the initiator of the authenticated channel and a responding server. The server listens for a connection on both the location limited channel and the network medium but only admits network connections from clients who have performed authentication on the location limited channel.

In various exemplary embodiments the commercially available Infra red Data Association IrDA system can be used as a medium for the location limited channel. The securing device opens an IrDA connection to the device and generates an error if it discovers more than one potential IrDA endpoint. Across this connection the securing device and the device exchange authentication data such as for example XML encoded authentication data containing authentication information such as for example a commitment to an ephemeral Digital Signature Algorithm DSA public key a friendly name and an IP address and a port on which the device is listening.

With the authentication complete the IR channel is closed and the securing device extracts the device s IP address and port number from the data it received. The securing device opens a normal SSL TLS connection to the device using the network. Each side uses the information gained in the authentication step i.e. the commitments to the public keys to authenticate the newly opened channel. The securing device and device are now free to securely exchange any information they choose over the network medium.

While the invention has been described in conjunction with the specific embodiments outlined above it is evident that many alternatives modifications and variations will be apparent to those skilled in the art. Accordingly the preferred embodiments of the invention as set forth above are intended to be illustrative not limiting. Various changes may be made without departing from the spirit and scope of the invention.

