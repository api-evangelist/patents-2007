---

title: Partitioning data on a smartcard dependent on entered password
abstract: In one embodiment, an apparatus and method for partitioning data on a smartcard dependent on an entered password are disclosed. In one embodiment, the method includes maintaining multiple containers in a smartcard, associating a different personal identification number (PIN) with each of the multiple containers, and accessing contents of a container when an associated PIN for the container is provided by a user of the smartcard. Other embodiments are also described.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08161546&OS=08161546&RS=08161546
owner: Red Hat, Inc.
number: 08161546
owner_city: Raleigh
owner_country: US
publication_date: 20070228
---
Embodiments of the present invention relate to smartcards and more specifically relate to partitioning data on a smartcard dependent on an entered password.

Most people now have a collection of small plastic cards representing various credit cards store cards identity cards membership cards etc. Information about the card and its owner e.g. account details is normally printed or embossed on the card and may also be stored in some form of magnetic strip. In recent years smartcards have also proliferated. Smartcards are standardized portable articles defined in ISO standard 7816. Smartcards are typically used to provide secure management of confidential data and to provide authentication.

A smartcard incorporates within its plastic case a microelectronic memory and also an embedded processor. The memory is used to store various data including for example private keys identity certificates email certificates etc. A single personal identification number PIN is used to access the data stored on the smartcard.

A smartcard may also host software that manipulates the stored data. The software may be in the form of a Java applet and a Java virtual machine VM may be provided within the smartcard to allow the execution of Java applets. A Java applet typically creates a container to hold required data and ensures that the container is only accessed by an authorized user. In particular an applet may store a PIN associated with the container and allow a user to access the contents of the container only if the user provides a correct PIN.

Described herein is a method and apparatus for partitioning data on a smartcard dependent on an entered password. In one embodiment the method includes maintaining multiple containers in a smartcard associating a different personal identification number PIN with each of the multiple containers and accessing contents of a specific container when a PIN associated with this container is provided by a user of the smartcard.

In the following description numerous details are set forth. It will be apparent however to one skilled in the art that the present invention may be practiced without these specific details. In some instances well known structures and devices are shown in block diagram form rather than in detail in order to avoid obscuring the present invention.

Some portions of the detailed descriptions which follow are presented in terms of algorithms and symbolic representations of operations on data bits within a computer memory. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. An algorithm is here and generally conceived to be a self consistent sequence of steps leading to a desired result. The steps are those requiring physical manipulations of physical quantities. Usually though not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated. It has proven convenient at times principally for reasons of common usage to refer to these signals as bits values elements symbols characters terms numbers or the like.

It should be borne in mind however that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the following discussion it is appreciated that throughout the description discussions utilizing terms such as processing or computing or calculating or determining or displaying or the like refer to the action and processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission or display devices.

The present invention also relates to apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes or it may comprise a general purpose computer selectively activated or reconfigured by a computer program stored in the computer. Such a computer program may be stored in a computer readable storage medium such as but is not limited to any type of disk including floppy disks optical disks CD ROMs and magnetic optical disks read only memories ROMs random access memories RAMs EPROMs EEPROMs magnetic or optical cards or any type of media suitable for storing electronic instructions and each coupled to a computer system bus.

The algorithms and displays presented herein are not inherently related to any particular computer or other apparatus. Various general purpose systems may be used with programs in accordance with the teachings herein or it may prove convenient to construct more specialized apparatus to perform the required method steps. The required structure for a variety of these systems will appear from the description below. In addition the present invention is not described with reference to any particular programming language. It will be appreciated that a variety of programming languages may be used to implement the teachings of the invention as described herein.

A machine accessible storage medium includes any mechanism for storing or transmitting information in a form readable by a machine e.g. a computer . For example a machine accessible storage medium includes read only memory ROM random access memory RAM magnetic disk storage media optical storage media flash memory devices electrical optical acoustical or other form of propagated signals e.g. carrier waves infrared signals digital signals etc. etc.

The smartcard is a portable article that is defined in ISO standard 7816. The smartcard interacts with the host computer via a smartcard reader that detects when the smartcard is in place e.g. using a sensor . The smartcard reader may be part of the host computer or an independent device. When the smartcard is inserted into the smartcard reader two communication protocols are involved in supporting interactions between the smartcard and the host computer . In particular a protocol unit complies with the ISO 7816 protocol that provides detailed requirements for the interface between the smartcard and the smartcard reader and defines the format for application protocol data unit APDU commands exchanged between the smart card and the host computer . A protocol unit complies with the USB protocol or the serial RS 232 protocol that provides an interface for communications between the smartcard reader and the host computer . The smartcard reader contains electronic circuits and embedded software that enable communication with the smartcard using the ISO 7816 protocol and the host computer using the USB or RS 232 protocol.

A PC SC unit is compliant with the personal computer smartcard PC SC standard that provides device independent application programming interfaces APIs as well as resource management to allow applications to communicate with the smartcard . The applications utilize a smartcard library provided by a smartcard vendor to supply data necessary for interactions with the smartcard .

Generally when the smartcard is inserted into the smartcard reader the smartcard reader activates the smartcard e.g. by providing power to the smartcard and notifies an application running on the host computer . The application then prompts the user of the smartcard for a password or personal identification number PIN . In addition the application sends an ADPU message to the smartcard with a request to verify the PIN provided by the user.

The smartcard may include a microcontroller with associated memories and software. The software may include one or more Java applets executing on a Java virtual machine VM provided within the smartcard . It should be noted that the term Java applets or applets is used herein for illustrative purposes only the software running on the smartcard can include any program other than a Java applet. For example a C or C program can run on the smartcard to provide the functionality discussed herein.

An applet creates multiple containers within the smartcard memory to hold various data e.g. user private keys identity certificates email certificates attribute certificates etc. . Each container is associated with a different PIN. For example if a user uses the smartcard with his or her work identity as well as home identity container may be associated with a first PIN representing the user s work identity and container may be associated with a second PIN representing the user s home identity. Container may store a certificate and private key issued by the user s employer and container may store a certificate and private key issued by an external certificate authority e.g. VeriSign . Hence the data stored on the smartcard is partitioned dependent on the user identity or a password or PIN associated with the user identity.

When an applet receives a PIN provided by the user the applet checks this PIN against each container . If the PIN provided by the user unlocks a particular container the applet notifies the application that the user has provided a correct PIN. The applet hides the existence of multiple containers associated with different PINs from the user by continuing to check the PIN against the containers until finding a container having the PIN provided by the user. If no such container is found the applet notifies the application that the PIN provided by the user is incorrect. The application then conveys this message to the user. In one embodiment the application is unware of the existence of multiple containers and or different PINs on the smartcard . Rather it is the applet that fully controls the access to the containers and how the data is stored in the containers .

The container further includes a password or PIN that is unique for the container . When the user enters a PIN it is checked against the stored PIN . If the two PINs match the user is allowed to access the contents of the container . If the two PINs do not match the PIN provided by the user is compared against other containers on the smartcard.

Returning to in one embodiment the smartcard includes multiple applets. For example the smartcard may include one applet to control digital data e.g. digital certificate private keys etc. and another applet to control biometric data e.g. user fingerprints . The application may use the vendor s smartcard library to determine an identifier ID of an applet that should execute a requested task and include this applet ID in the ADPU message sent to the smartcard .

In another embodiment applets A and B may maintain containers to store identity and attribute certificate respectively. For example a host application running on the host computer may need the user s identity certificate to allow his or her access to certain data and a host application may need the user s attribute certificate to allow his or her access to data associated with a specific project. Then application may interact with applet A to obtain the user identity certificate and application may interact with applet B to obtain the user attribute certificate. Depending on the user s current identity applets A and B may provide certificates from corresponding containers to applications and .

The attribute certificate includes a certificate issuer name a certificate serial number a certification date a subject name an attribute and a signature . The signature binds the subject name e.g. user name with the attribute which may concern a certain capability or permission. For example the signature may confirm that the user identified by the subject name has a clearance or security level specified by the attribute .

In one embodiment the identity certificate is placed in container A protected by PIN A and the attribute certificate is placed in container B protected by PIN B thus separating private data from public data. When the user provides a PIN the applet first compares this PIN against container A. If the PIN provided by the user matches PIN A the application on the host computer can request the identity certificate to prove the user s identity. Once the user is authenticated the user may want to access data associated with a specific project. To be able to do that the user will have to enter a different PIN e.g. a user may be prompted to enter a new PIN which will be compared against container B holding the attribute certificate . If the PIN provided by the user matches PIN B the application on the host computer can request the attribute certificate to determine whether the user s level of security allows the user to access this data. One embodiment of this mechanism will be discussed in more detail below in conjunction with .

Referring to method begins with processing logic creating multiple containers on the smartcard block . At block processing logic associates each container with a distinct PIN. Processing logic may store each PIN in a corresponding container or in a separate table or other store on the smartcard.

At block processing logic receives a PIN provided by a user of the smartcard. At block processing logic compares the received PIN with a PIN associated with a current container. If the two PINs match block processing logic allows user access to the container with the matching PIN block .

If the two PINs do not match processing logic determines whether all containers in the smartcard have been already checked block . If so processing logic notifies the host computer that the PIN provided by the user is invalid block . If not processing logic moves to the next container and returns to block .

Accordingly method hides the existence of multiple containers associated with different PINs from the host computer and the user.

Referring to method begins with processing logic creating containers A and B on the smartcard placing the user identity certificate with a corresponding private key in container A and placing the user attribute certificate in container B block . At block processing logic associates container A with PIN A and container B with PIN B. Processing logic may store each PIN in a corresponding container or in a separate table or other store on the smartcard.

At block processing logic receives a PIN provided by a user of the smartcard. At block processing logic compares the received PIN with PIN A associated with container A. If the two PINs match processing logic provides the user identity certificate and or corresponding private key to the host application block . If not processing logic notifies the host application that the PIN provided by the user is incorrect block .

At block processing logic receives a request for the user attribute certificate from the host application. At block processing logic requests that the user be asked for another PIN. In one embodiment processing logic uses a time out mechanism to make the above request.

At block processing logic compares the new PIN entered by the user with PIN B associated with container B. If the two PINs match processing logic provides the attribute certificate to the host application block . If not processing logic notifies the host application that the PIN provided by the user is incorrect block .

Processing device represents one or more general purpose processing devices such as a microprocessor central processing unit or the like. More particularly the processing device may be complex instruction set computing CISC microprocessor reduced instruction set computing RISC microprocessor very long instruction word VLIW microprocessor or processor implementing other instruction sets or processors implementing a combination of instruction sets. The processing device is configured to execute processing logic for performing the operations and steps discussed herein. The software may also reside completely or at least partially within the main memory and or within the processing device during execution thereof by the system the main memory and the processing device also constituting machine accessible storage media.

While the machine accessible storage medium is shown in an exemplary embodiment to be a single medium the term machine accessible storage medium should be taken to include a single medium or multiple media e.g. a centralized or distributed database and or associated caches and servers that store the one or more sets of instructions. The term machine accessible storage medium shall also be taken to include any medium that is capable of storing encoding or carrying a set of instructions for execution by the machine and that cause the machine to perform any one or more of the methodologies of the present invention. The term machine accessible storage medium shall accordingly be taken to include but not be limited to solid state memories optical and magnetic media and carrier wave signals.

It is to be understood that the above description is intended to be illustrative and not restrictive. Many other embodiments will be apparent to those of skill in the art upon reading and understanding the above description. The scope of the invention should therefore be determined with reference to the appended claims along with the full scope of equivalents to which such claims are entitled.

