---

title: Intrusion detection apparatus and method using patterns
abstract: An intrusion detection apparatus includes: a rule generator classifying intrusion detection rules into rules having content examination parts and rules without content examination parts, granting an index to each of the rules so as to output the indices to a unit for performing the matching and to simultaneously store the indices; an extractor extracting payload parts and address parts from the packets and outputting the extracted payload parts and address parts to the unit; and an examination unit examining corresponding rules based on the indices.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08015610&OS=08015610&RS=08015610
owner: Electronics and Telecommunications Research Institute
number: 08015610
owner_city: Daejeon
owner_country: KR
publication_date: 20070729
---
This application claims the benefit of Korean Patent Application No. 10 2006 0072649 filed on Aug. 1 2006 in the Korean Intellectual Property Office the disclosure of which is incorporated herein in its entirety by reference.

The present invention relates to a method and apparatus for improving an intrusion detection performance by using a hardware based content board in a low cost and low performance intrusion detection system and more particularly to a method and apparatus for performing intrusion detection capable of performing pattern matching including payload matching and Internet protocol IP address matching at a low cost by using a commercial hardware based content board having a low cost standard interface for example a peripheral component interface PCI .

A high cost high performance intrusion detection system can maximize performance by implementing an intrusion detection algorithm and other functions in hardware through an application specific integrated circuit ASIC or microcoding. However since the system incurs an extremely high cost medium and small companies and small office home office SOHO companies cannot afford it.

Recently there is a tendency that the intrusion detection system requires a line speed performance and products having the performance have been introduced. However the costs are too high for the medium and small companies and the SOHO companies to buy and use these products. This system implements packet decoding and a matching algorithm into an ASIC and uses a memory such as a Ternary content addressable memory TCAM having a high cost for more rapid matching. Meanwhile software based intrusion detection systems have been introduced to a medium and low cost market. However performance of the system is not satisfactory.

The present invention provides a method and apparatus for performing intrusion detection capable of using a commercial hardware based content board having a low cost standard interface using regular expressions provided from the content board and expanding a content matching range to an Internet protocol IP address of a packet in addition to a payload of the packet to obtain matching results thereby rapidly and accurately performing the intrusion detection.

According to an aspect of the present invention there is provided an intrusion detection apparatus using patterns for performing intrusion detection by receiving indices of matched intrusion detection rules which are results of matching of payload parts and IP Internet protocol address parts of packets comprising a rule generator classifying intrusion detection rules into rules having content examination parts and rules without content examination parts granting an index to each of the rules in order to output the indices to a unit for performing the matching and simultaneously store the indices an extractor extracting payload parts and address parts from the packets and outputting the extracted payload parts and address parts to the unit and an examination unit examining corresponding rules based on the indices.

According to another aspect of the present invention there is provided an intrusion detection apparatus using patterns comprising a content unit having one or more standard interfaces and performing pattern examination on packets input to a system and an intrusion detection unit generating and providing one or more patterns and indices for rules corresponding to the patterns from intrusion detection rules so as to enable the content unit to perform the pattern examination and receiving the result of the pattern examination so as to perform a predetermined rule examination and determining intrusion to the system.

According to another aspect of the present invention there is provided an intrusion detection method using patterns used in an intrusion detection apparatus using the patterns comprising generating one or more patterns and indices for rules corresponding to the patterns from intrusion detection rules receiving input packets and extracting payload parts and IP address parts from the input packets performing pattern examination on the payload parts and the IP address parts of the input packets based on the patterns and receiving the result of the pattern examination so as to perform predetermined rule examination and determining intrusion to a system.

Hereinafter exemplary embodiments of the present invention will be described in detail with reference to the attached drawings. is a block diagram of an intrusion detection apparatus using patterns according to an embodiment of the present invention. is a flowchart of an intrusion detection method using patterns according to an embodiment of the present invention. is a view for conceptually explaining operations of applying intrusion detection rules by using a content board according to an embodiment of the present invention. is a view for conceptually explaining a method of arraying intrusion detection rules and constructing patterns by using the arrayed intrusion detection rules according to an embodiment of the present invention. is a view showing operations of obtaining examination results from pattern information according to an embodiment of the present invention. is a view showing an example of constructing Internet protocol IP address patterns used for IP address matching according to an embodiment of the present invention.

Referring to the intrusion detection apparatus includes a content unit for examining a payload pattern and an IP address pattern and an intrusion detection unit for examining other detailed fields. Hereinafter content board and the content unit have the same meaning.

The content unit has an interface specification for connecting a standard interface including a peripheral component interface PCI or an application programming interface API to the intrusion detection unit and performs pattern examination on packets input to a system. The content unit performs matching of a payload of the input packet and an IP address of the input packet. Data used to detect the matching is provided from the intrusion detection unit and a detailed description thereon will be provided later. According to a result of the detecting of the matching when the payload is matched or the IP address is matched respectively an index of a matched rule is output to the intrusion detection unit and the intrusion detection unit finally determines intrusion.

The intrusion detection unit generates and provides one or more patterns and indices for rules corresponding to the patterns from intrusion detection rules to the content board so as to enable the content board to perform pattern examination receives a result of the pattern examination so as to enable a predetermined rule examination to be performed and determines intrusion to the system. More specifically a rule generator classifies the intrusion detection rules into rules having patterns and rules without patterns grants an index to each rule to be output to the content unit and simultaneously stores them. Here the rule generator patternizes an IP address of the rules without the patterns from among the intrusion detection rules. An extractor extracts a payload part and an address part from the packet and outputs the extracted payload and address parts to the content unit . An examination unit receives the result of the pattern examination of the content unit performs an examination on corresponding rules and finally determines the intrusion. In this case the examination unit examines a protocol and detailed fields including options only on intrusion detection rules which have designated indices provided from the content unit in advance so that loads are reduced.

The intrusion detection method according to an embodiment of the present invention will now be described with reference to . One or more patterns and indices for rules corresponding to the patterns are generated from the intrusion detection rules. In order to generate the rules and patterns the intrusion detection rules are classified into rules having patterns that is rules having content examination items and rules without patterns that is rules without content examination items. Thereafter an index is granted to each of the classified rules. Here IP addresses of the rules without patterns from among the intrusion detection rules are patternized. In this case when the IP address follows an Internet protocol version 4 IPv4 system the IP address is patternized so as to have 64 bits including a source address and a destination address and to be applied with a netmask. When the IP address follows an IPv6 system the IP address is patternized so as to have 256 bits including a source address and a destination address and to be applied with a prefix operation S . This will be described with reference to .

Then input packets are received and payload parts and IP address parts are extracted operation S . The content unit performs pattern examination on the payload parts and the IP address parts of the input packets based on the pattern and generates a result of the pattern examination as indices operation S . This is because both the payload pattern examination and the address pattern examination are performed on all of the packets in the pattern examination process. Last the intrusion detection unit receives the pattern examination result and performs a predetermined rule examination to determine intrusion to the system. In this case the intrusion detection unit examines a protocol and detailed fields including options only in regard to intrusion detection rules corresponding to the pattern examination result operation S .

Characteristics described above according to the current embodiment of the present invention are provided as compared with a related art. In a general intrusion detection system all functions are performed in an intrusion detection module. However according to the embodiment of the present invention from among functions of the intrusion detection system pattern matching of a payload of a packet and an examination on an IP address are performed by the content board. Most of the load caused from the intrusion detection functions is generated by pattern matching. Therefore when the matching function is processed by the additional hardware based content board load caused by the intrusion detection functions may be significantly reduced and performance can be improved. Namely when packets are input to the intrusion detection apparatus a payload part and an address part of the packet are transmitted to the content unit in order to obtain a matching result and the intrusion detection unit examines detailed fields including a protocol and options only in regard to rules corresponding to the matching result and performs a final examination.

Referring to intrusion detection operations according to an embodiment of the present invention are shown in a simplified manner. A first examination operation using the content unit and a second examination operation of examining protocols and detailed option fields corresponding to each protocol only in regard to rules corresponding to a result of the first examination operation are provided. Most intrusion detection systems have thousands or tens of thousands of intrusion detection rules. Applying the rules to all packets in software every time causes a heavy load on the system. Performance can be improved to a certain degree by using an optimal retrieving algorithm however applying it in software has a limitation. A low cost method of overcoming this limitation is to use the content board dedicatedly providing pattern matching. A pattern matching time for using a content board is in real time and is deterministic so that faster examination results can be obtained by using a content board and a relatively stable performance can be achieved.

The first examination operation has a function of markedly reducing the number of intrusion detection rules to be examined and through the function the performance can be improved. Rules filtered through the payload pattern matching from among the rules having patterns and rules of which addresses are patternized so as to be examined by using the content unit from among the rules without patterns are selected first. In the operation results are obtained in real time and the number of rules to be specifically examined is significantly reduced. Thereafter the detailed operation fields of the rules of which the number reduces through the first examination operation are examined to obtain the final examination result operation .

When the pattern input to the content unit is matched index information on rules is input along with the pattern in order to know which rule corresponds to the matched pattern. For example when a sequence in which the intrusion detection rules are arrayed is assumed to be the index positions corresponding to the sequence and all patterns of the rule are input to the content board. In this way the content board can refer the complete intrusion detection rule corresponding to the matched pattern when the content board determines matching. When rules do not have the patterns IP address parts are patternized operation and input to the content board similarly to the aforementioned operation. By performing this operation the content board sets information to be matched by the content board to the intrusion detection rules. An operation of patternizing an address is described with reference to .

When the payload matching is finished the intrusion detection unit transmits IP address parts of the packets to the content board. The content unit performs matching examination based on the input IP addresses and set IP address pattern information operation and outputs matched information operation . Here similarly to the aforementioned operation several matching results can occur. Address information in an intrusion detection rule is set as a range by using a netmask in the IPv4 system by using a prefix in the IPv6 system. Address information can be set with different options in corresponding address regions so that several matching results occur. Accordingly the second examination operation is needed. Examination results generated from the two examinations are reference information about the complete intrusion detection rule. Therefore after the examinations the final examination is performed in the second examination operation as illustrated in only on the rules corresponding to the examination results. Matching information generated in the operations illustrated in reduces as compared with the number of rules to be examined when being processed in software so that the examination load on the intrusion detection unit is significantly reduced and this directly causes a performance improvement.

As described above the intrusion detection apparatus and method using patterns according to an embodiment of the present invention reduces an overload due to examinations which are performed on all rules for malicious packets whenever packets are input so that a processing speed can be increased. Therefore an implementation of a system having an effective performance and a relatively low cost that can replace a high cost and high performance hardware dedicated system is possible.

In addition an intrusion detection system having a stable performance can be implemented at a very low cost as compared with the high performance hardware dedicated system. An additional cost is incurred only to provide a hardware based content board having a standard interface such as a PCI and easy development is possible by using a high level and low level API provided from a development environment and a content board.

In addition the development of an effective system against costs is possible due to the rapid rule retrieving method and an improved rule retrieving time provided by an embodiment of the present invention.

The invention can also be embodied as computer readable codes on a computer readable recording medium. The computer readable recording medium is any data storage device that can store data which can be thereafter read by a computer system. Examples of the computer readable recording medium include read only memory ROM random access memory RAM CD ROMs magnetic tapes floppy disks optical data storage devices and carrier waves such as data transmission through the Internet . The computer readable recording medium can also be distributed over network coupled computer systems so that the computer readable code is stored and executed in a distributed fashion. Also functional programs codes and code segments for accomplishing the present invention can be easily construed by programmers skilled in the art to which the present invention pertains.

While the present invention has been particularly shown and described with reference to exemplary embodiments thereof it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the present invention as defined by the appended claims.

