---

title: Image segmentation by clustering web images
abstract: An image segmentation system selects candidate images from an image collection. Image analysis on individual images proceeds by first detecting salient features on each image. Patches are centered on points of interest located on the salient features of the image. Each patch is gridded into blocks. The block feature vectors are merged to generate a patch feature vector. A fingerprint for each image is obtained by merging patch feature vectors across the image. Images with similar fingerprints are identified and geometric matching is performed to further select images with similar objects. Common regions are tabulated and merged into single regions to segment out coherent objects.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08200010&OS=08200010&RS=08200010
owner: Google Inc.
number: 08200010
owner_city: Mountain View
owner_country: US
publication_date: 20070920
---
The present invention pertains in general to image segmentation systems and in particular to techniques for segmenting individual images by combining information from individual images and groups of images.

Image segmentation refers to the process of partitioning an image into multiple regions. This is done to make the image easier to analyze. Typically image segmentation is used to locate objects and boundaries within images. Objects or regions in the image are identified based some characteristic or property such as color intensity or texture. Adjacent regions are typically significantly different with respect to the same characteristic.

Traditionally image segmentation examines individual images to find regions of a particular color a smooth color variation or based on a priori knowledge of what is being segmented. The drawbacks of such a process clearly stem from the fact that such a priori knowledge of a model color or texture is not always readily available. For objects or regions that are novel or yet to be characterized this process clearly falls short.

Further by segmenting a single image at a time common objects in different images may be classified differently due to color lighting and texture variations between images. Further color variations within an object in an image may cause the segmentation to only identify a sub region and not the complete region.

A method and a system segments individual images by combining information from multiples images and groups of images. To segment images in an image collection a set of images are analyzed to derive a fingerprint of each image. Each fingerprint comprises an aggregation of sub fingerprints derived from distinctive features in the image. The fingerprints for the images are compared so as to select similar images having regions that are common among some portion of the set of images. The images are then segmented based upon the common regions. Image segmentation is thus done in a semantically coherent way the semantics coming from evaluating a large set of image similarities.

A system for segmenting images from an image collection includes a feature detection module that detects features at various locations in a set of images. The features are detected based on attributes in the images. A patch generation module generates patches within each detected feature with each patch comprising an area of a fixed geometrical shape. An image fingerprint generation module derives a fingerprint for each the images by merging patch feature vectors from various patches. A similar image identification module compares fingerprints from the images to select similar images with common regions. A geometric matching module matches geometric characteristics between matching pairs of patches using pairwise selections of images to identify common regions. Finally a common object generation module merges the identified common regions into a single region.

The present invention has further embodiments in computer system and software architectures computer program products and computer implemented methods and computer generated user interfaces and search result contents.

The foregoing are just some of the features of an image segmentation system and methodology based on images. Those of skill in the art of information retrieval will appreciate the flexibility of generality of the image segmentation allows for a large variety of uses and applications in linking objects in images within personal image collections or larger collections searching for and retrieving similar objects in images or video virtual linking of images and identifying product placements in images.

The figures depict a preferred embodiment of the present invention for purposes of illustration only. One skilled in the art will readily recognize from the following discussion that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles of the invention described herein.

The image search server receives a query from a client over the network and in response to the client query searches and retrieves a corresponding set of images from the image database . The image selection server can also retrieve a set of images from the image database e.g. based on a list of metadata without a search request from the client and a corresponding response from the image search server . The retrieved collection of images is presented to the image segmentation server . The image segmentation server receives as input a collection of images and provides as output a set of segmented images. The presentation server then presents the segmented images to the client .

Features are identified at various locations on the image. A feature is any programmatically distinguishable characteristic associated with a point on the image that is considered significant based on determining any number of characteristics associated with that point such as edge color intensity texture wavelet transforms corner or orientation histogram. From among these features at various points or locations of the image points of interest are determined by identifying those points with a high variation of current features from the surrounding features i.e. discontinuities in feature characteristics. Points of interest may be detected computationally as discontinuities or differences from surrounding points using any known method such as the Harris or Difference of Gaussian DoG method. However other methods may be used for detecting points of interest. shows several such points of interest and one such point of interest is highlighted. A collection of matching local features defines an object on an image. An image may contain many such objects.

A patch is a defined region around a point of interest and that contains a salient feature on the image. Patch is a patch defined around the point of interest . Image shows several patches defined at varying scales at each point of interest on the image. Patches may have any shape associated with them i.e. circular rectangular etc. illustrates the use of circular patches as will be used throughout the various embodiments described herein. Circular patches are defined by a radius and a pixel offset of the center of the circle from a corner of the image represented in a suitable coordinate system for the image. In addition patches may also have an orientation associated with them the orientation being an angle relative to an initial axis e.g. horizontal or vertical axis . Patch orientation is defined by identification of an intensity gradient with the patch. Each patch from among the set of patches defined around the salient features of the image is defined in this manner. Patches may be generated using any known method such as scale invariant feature transform. Collectively the patches define the salient features of an image. Hence an object on the image may be represented by the locus of patches corresponding to salient features of the object.

Each patch is gridded into a number of blocks. As an example shows patch having grid of 16 blocks such as block . A block is a sub section of a patch that helps to quantize patch characteristics such as orientation. Patches may be gridded into blocks using any known method such as those that generate log polar grids or logarithmic spiral grids.

An object on an image may be represented by a multi dimensional vector of numerical features. Such numerical representations of objects facilitate processing and statistical analyses. The numerical values corresponding to features vary with the feature e.g. for images the feature values may be pixels of the image for color distributions on an image the feature values may correspond to the Red Green Blue RGB colorspace or the YIQ colorspace etc. Such vectors are referred to as feature vectors. The dimensionality of the feature vector may be adjusted through various techniques such as by choosing a bin size for the feature values thereby determining the number of bins that define the feature vector. shows 8 bin block feature vectors through corresponding to each of the n blocks in patch . For example if patch is gridded into sixteen blocks and each block has an 8 bin block feature vector etc. then the entire patch has feature values in 128 bins 16 blocks 8 bins per block . In one embodiment the 8 bin block feature vectors for each of the 16 blocks are stacked or merged to arrive at a 128 bin patch feature vector. illustrates the generation of patch feature vector from the constituent block feature vectors etc. from each block within patch . The bin size and number of bins may be varied to alter the dimensionality of the feature vectors to adequately represent the feature being detected. Similarly other patch feature vectors through are derived from other features represented by other patches .

An image fingerprint is obtained by stacking or merging e.g. concatenating patch feature vectors representing all the salient features of an image. illustrates the generation of image fingerprint by stacking or merging patch feature vectors through . In one embodiment each patch contains a sub fingerprint or a portion of the image fingerprint.

Assume images A and B in the collection of images are to be evaluated by the similar image identification module to determine if they have similar fingerprints. The similar image identification module retrieves 800 all patch feature vectors from the fingerprint for each of images A and B. Each patch feature vector constitutes a portion of the image fingerprint .

v. . . v feature values v v through to vcorresponding to n dimensional patch feature vector for patch A in image A and

u. . . u feature values u u through to ucorresponding to n dimensional patch feature vector for patch B in image B.

The dimensionality of a patch feature vector is determined by the number of blocks the patch is gridded into and further by the number of bins corresponding to each block feature vector with each number determined empirically.

Based on all the patch feature vectors for images A and B all pairwise distances between every patch in image A and every patch in image B are computed . If there are N patches in image A and M patches in image B then a total of N M pairwise comparisons of distances are performed between patches in images A and B. In one embodiment the images A and B are determined to be similar when a minimum number of these N M patch to patch distances between images A and B are within a threshold distance of each other as will be further explained below.

A simple threshold test is applied to identify matching patches in images A and B as follows. For a particular patch in image A the corresponding best two matches in image B are identified. If the distance between the patch in image A and the best matched patch in image B is significantly lower than the distance between patch in image A and the second best matched patch in image B then there is a distinguishable match between the patch in image A and the best matched patch in image B. Further for the distinguishable match between the patch in image A and the best matched patch in image B if the distance between the patches is within a threshold distance then the two patches are identified as matching patches.

The above process yields pairs of matching patches between any two images. Since each patch comes with a scale orientation or rotation and location or translation a transformation between a pair of matching patches may be computed as changes in scale orientation and location between the pair of matching patches. For pairs of matching patches between any two images if the transformation is not consistent across all pairs of matching patches then the subset of pairs of matching patches with inconsistent transformations are filtered out and eliminated. The bounds for consistency are derived in practice. For example for orientation a maximum of 30 variance may be acceptable and for scale a maximum of 1.5 fold variance may be acceptable. Upon filtering pairs of matching patches based on the transformation criteria the best matching patches between images are retained.

For scale and orientation the transformation between pairs of matching patches is computed in terms of differences in corresponding values for scale and orientation. However for location the transformation between pairs of matching patches may be computed as a function of scale and or orientation as in the following example.

For a pair of matching patches if a and c are scaling parameters respectively b and d are location parameters respectively and x is a transformation parameter and further if the following relationship holds then Thus the location parameter b may be expressed as a function of scaling parameters a and c besides the other location parameter d.

Once the best matching patches are identified between images the corresponding images with the matching patches are identified . Upon examining all patches in the collection of images in this fashion the similar image identification module identifies a set of images with similar fingerprints as images that contain matching patches.

To measure this transformation a global transformation parameter GTP is calculated as a metric between these two matching collections of patches as follows where 

The GTP metric is calculated using a least squares fit and the images are screened based on a GTP threshold. The locations A and B may be represented in screen coordinates. In one embodiment if the error of the least squares fit is too large i.e. exceeds a threshold then the match between the sets of patches in images A and B is rejected. In one embodiment if the error of the least squares fit is too large i.e. exceeds a threshold then outliers in terms of patch locations are rejected and the GTP is estimated a second time without the outliers. Hence the GTP metric is a final filter used to identify the set of images with similar objects.

The matching patches extracted by the geometric matching module in different images help define matching boundaries and further help group the matching boundaries into similar and distinguishable objects. The matching patches between any two images indicate a very high correlation between several points on the images. Given a collection of correctly matched points together with initial boundaries using traditional image segmentation techniques a collection of common regions are identified in the image. Further a color model is used to define color boundaries. Segmentation in color is used to group the color boundaries into similar objects. In one embodiment these objects are sub regions or sub clusters of a larger more coherent object. Information from the original matching patches and hence matching boundaries in the neighborhood of the sub clusters is used to determine which of the sub clusters or sub regions need to be further clustered into one big cluster to form one coherent object.

The pseudo code listed below depicts an embodiment of an algorithm that i selects regions with greater than a threshold number of matched points of interest from among the images in an image collection and ii merges sub regions that are geometrically adjacent to each other nearest neighbor in each image. The following steps are presented in sequence 

Step 2 Tabulate the score of region R I in image I as the number of matched points of interest P I J that are present in region R I and

Alternate Step 3 Merge into one region all sub regions R I in image I whose score together with those of nearest neighbors exceed a threshold score.

A Markov model such as Markov Random Fields MRF may be used to determine that an unmatched region should be clustered together with the adjacent sub clusters to form one coherent object. Alternately a sufficient color similarity between the matched sub regions and the unknown region may be used to infer that the regions are likely continuous and merge them together.

In a like fashion other coherent objects are identified in the images comprising the image collection yielding segmented images .

The process of clustering sub regions into coherent objects may be examined further with the images of the Sydney Opera House depicted in as an example. and depict a collection on images on the Sydney Opera House. Using color to do the pre segmentation initially identifies coherent objects such as sections of the sky the water clouds and various parts of the opera house as illustrated in and for different images. The opera house may be identified as in for example by merging five sub regions of the opera house namely the two pillars and the three sections of the opera house after determining that the sub regions have one continuous boundary. Alternately a continuous boundary determination might not be made leading to a gap or a discontinuity in between. If the center section of the opera house did not match between the images with similar objects then this yields two sub clusters with a gap in the middle representing the unmatched center section of the opera house. A Markov model or color similarity may be used to determine that the unmatched center region should be clustered together with the adjacent sub clusters to form one coherent object that is the Sydney Opera House. depicts the final segmented image showing the Sydney Opera House as a coherent object.

The present invention may be implemented in several ways. Pre segmentation may be done with color texture geometric modeling curvature and even human labeling. For example humans can also provide labels to objects of interest. An online image labeling game may be used where a region of an image is labeled by a player e.g. an image of a cow labeled as cow . Such user contributed labels may be propagated to other matching images and or objects. Alternate embodiments include integration of geometric verification and feature generation such that the global positions of the features are incorporated into the feature values. For example instead of representing each point of interest as a feature two points of interest together with their intervening distance say in pixels may be represented as a feature. In the matching stage the best match between two pairs of features together with their intervening distance may then be determined. The sub regions may be merged in alternate ways including finding the largest bounding box over the matched points of interest or construction a graph using the sub regions as nodes and their geometric distance as edges. Using a semi supervised or transducive machine learning algorithm the labels may be propagated by examining the number of matched points along the graph.

The present invention may be used in several different ways. A few exemplary usage models are discussed below. Segmentation of images to identify common regions or objects may be used to generate hyperlinks to other images with similar regions or objects. For example an image could store references to links to other similar images. Such virtual links to other images may be presented dynamically since images are constantly added to or removed from an image database which necessitates that the virtual links be refreshed periodically. Virtual linking could be achieved by indexing an object in an image assigning a unique identifier to the object indexing all images containing a similar object to the unique identifier and using the unique identifier as a query value. For example an existing image could have the Sydney Opera House object segmented out. Upon receiving a new image if the segmenting and matching identifies the same object i.e. the Sydney Opera House in the new image then a virtual link could be established that couples the existing image and the new image.

Other applications include identification of product placements in images Zeitgeist and hyperlinks within personal image collections. Hyperlinks within personal image collections may help locate other images with similar objects either from within the personal collection or from an online image repository such as Google Images. For example a user may click on an image containing the Eiffel Tower and retrieve other images containing the Eiffel Tower either from within the personal collection or from the online image repository. One possible application is to identify common objects in videos. Persistent objects in videos may be identified and similar objects in other videos may be found on demand.

The present invention has been described in particular detail with respect to one possible embodiment. Those of skill in the art will appreciate that the invention may be practiced in other embodiments. First the particular naming of the components capitalization of terms the attributes data structures or any other programming or structural aspect is not mandatory or significant and the mechanisms that implement the invention or its features may have different names formats or protocols. Further the system may be implemented via a combination of hardware and software as described or entirely in hardware elements. Also the particular division of functionality between the various system components described herein is merely exemplary and not mandatory functions performed by a single system component may instead be performed by multiple components and functions performed by multiple components may instead performed by a single component.

Some portions of above description present the features of the present invention in terms of algorithms and symbolic representations of operations on information. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. These operations while described functionally or logically are understood to be implemented by computer programs. Furthermore it has also proven convenient at times to refer to these arrangements of operations as modules or by functional names without loss of generality.

Unless specifically stated otherwise as apparent from the above discussion it is appreciated that throughout the description discussions utilizing terms such as processing or computing or calculating or determining or displaying or the like refer to the action and processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system memories or registers or other such information storage transmission or display devices.

Certain aspects of the present invention include process steps and instructions described herein in the form of an algorithm. It should be noted that the process steps and instructions of the present invention could be embodied in software firmware or hardware and when embodied in software could be downloaded to reside on and be operated from different platforms used by real time network operating systems.

The present invention also relates to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes or it may comprise a general purpose computer selectively activated or reconfigured by a computer program stored on a computer readable medium that can be accessed by the computer. Such a computer program may be stored in a computer readable storage medium such as but is not limited to any type of disk including floppy disks optical disks CD ROMs magnetic optical disks read only memories ROMs random access memories RAMs EPROMs EEPROMs magnetic or optical cards application specific integrated circuits ASICs or any type of media suitable for storing electronic instructions and each coupled to a computer system bus. Furthermore the computers referred to in the specification may include a single processor or may be architectures employing multiple processor designs for increased computing capability.

The algorithms and operations presented herein are not inherently related to any particular computer or other apparatus. Various general purpose systems may also be used with programs in accordance with the teachings herein or it may prove convenient to construct more specialized apparatus to perform the required method steps. The required structure for a variety of these systems will be apparent to those of skill in the along with equivalent variations. In addition the present invention is not described with reference to any particular programming language. It is appreciated that a variety of programming languages may be used to implement the teachings of the present invention as described herein and any references to specific languages are provided for disclosure of enablement and best mode of the present invention.

The present invention is well suited to a wide variety of computer network systems over numerous topologies. Within this field the configuration and management of large networks comprise storage devices and computers that are communicatively coupled to dissimilar computers and storage devices over a network such as the Internet.

Finally it should be noted that the language used in the specification has been principally selected for readability and instructional purposes and may not have been selected to delineate or circumscribe the inventive subject matter. Accordingly the disclosure of the present invention is intended to be illustrative but not limiting of the scope of the invention which is set forth in the following claims.

