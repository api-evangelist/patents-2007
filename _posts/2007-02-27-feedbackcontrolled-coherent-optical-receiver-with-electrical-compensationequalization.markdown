---

title: Feedback-controlled coherent optical receiver with electrical compensation/equalization
abstract: An optical coherent receiver in one embodiment has a heterodyne configuration, and in another embodiment has a homodyne configuration, in each configuration employs multiple feedback signaling and analog/digital processing to optimize response to a modulated optical input signal, the provision of both individual RF I and RF Q channel outputs.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07406269&OS=07406269&RS=07406269
owner: Discovery Semiconductors, Inc.
number: 07406269
owner_city: Ewing
owner_country: US
publication_date: 20070227
---
The present Application is related to co pending Provisional Application Ser. No. 60 781 233 filed Mar. 10 2006 for Optical Coherent Receiver System takes priority therefrom and incorporates by reference the teachings thereof to the extent they do not conflict herewith. The related Application has the same inventorship and assignee as the present Application.

The US Government has a paid up license in this invention and the right in limited circumstances to require the patent owner to license others on reasonable terms as provided for by the terms of Grant No. MDA904 03C 0462 awarded by the NSA National Security Agency .

The present invention is generally related to optical communication systems and more particularly to optical coherent receivers for detecting optical signals.

Coherent optical detection was considered intensively for fiber optics in the 80 s and 90 s. However with the advent of the optical amplifier the work on this versatile and highly sensitive receiver technique was put aside. In the meantime great improvements on the optical components side have been achieved. These include laser output power linewidth stability and noise as well as the bandwidth power handling capability and common mode rejection of balanced photo detectors. The advances in electronic microwave components improved in a way that the advantages of optical coherent detection over direct detection can be used. The present inventors recognize that this makes coherent optical detection very attractive for future communication links.

For free space optical communication links coherent detection was always of interest since it has to rely on high power laser and sensitive receiver techniques. One application is the optical satellite link which can equal or exceed the data throughput of an entire suite of microwave transponders. Moreover the optical system has a much tighter beam size than all RF systems making it intrinsically more secure. With the possibility of entire suites of RF transponders being replaced by a single optical communication system the level of complexity of spacecraft SC and their associated weight and power consumption all decrease.

Optical coherent detection offers a number of advantages over conventional intensity modulation direct detection. For example the use of an optical coherent receiver allows detecting signals of very low strength lower than that of conventional optical receivers. This is especially important in order to detect signals at optical wavelengths where low noise optical amplification is not available. Moreover coherent detection allows preserving the phase information of the optical signal. This is useful to detect optical signals where the information is comprised in the phase of the electromagnetic wave. This requires a stable phase and or frequency lock between the received optical signal and the optical local oscillator used in the coherent receiver.

In the coherent receiver structure the received optical signal is mixed with the light of an optical local oscillator LO . In this way the signal is down converted from the optical carrier frequency 200 THz at 1.55 m to a microwave carrier frequency typically a few gigahertz . The resulting beat signal after photo detection exhibits a center frequency that corresponds to the intermediate frequency f IF which is the difference between the signal frequency and the LO frequency.

If the signal frequency and the LO frequency are the same the detection technique is called homodyne. For different center frequencies of signal and LO the system is referred to as heterodyne with f f f where fand fare the center frequencies of the received signal and LO respectively. For heterodyne systems the IF has to be at least two times the data rate of the optical signal to receive the double sided data spectrum. Homodyne reception requires that the LO typically produced by a laser be phase locked to the incoming optical signal whereas heterodyne detection calls for frequency locking to the received signal.

In many transmission scenarios homodyne systems can provides higher sensitivity than heterodyne systems. Homodyne detection requires an RF bandwidth approximately equal to the transmitted data rate whereas heterodyne detection requires an RF bandwidth approximately equal to two to three times of the transmitted data rate. From purely a bandwidth perspective homodyne is less demanding than heterodyne detection. However homodyne detection is more demanding in its implementation compared to heterodyne mainly because of homodyne s strict requirement for phase locking.

The main building blocks of a coherent receiver include an optical local oscillator optical coupler balanced photodetector phase frequency locking polarization control loop and electrical signal processing. Within these blocks there are several requirements necessary to achieve high receiver sensitivity 

In a conventional coherent optical receiver as shown in the above listed requirements will exist with modifications existent between designs. However the following operational drawbacks generally exist for these systems 

An object of the invention is to provide a highly reliable multifunctional optical coherent receiver of reduced cost.

Another object of the invention is to provide a lightweight optical coherent receiver comprising in one module all of the required optical generation management devices as well as the O E and RF circuitry.

Another object of the invention is to provide a fiber based optical generation management subsystem and integrated optical control circuit based designs for minimizing weight and volume while enhancing reliability of the associated optical coherent receiver.

Another object of the invention is to provide integrated circuit based designs for minimizing the weight and volume of the opto electronic and RF subsystems while enhancing reliability of the associated optical coherent receiver.

These and other objects of the invention are met via several embodiments of the invention by including an optical generation management subsystem and providing integrated circuit optical opto electronic and RF control boards of specified functionality. Coherent receivers with different functionalities can thus be generated by the appropriate optical subsystem and control board combination.

The above stated drawbacks of conventional coherent receivers are uniquely addressed through this invention by way of embodiments of the invention including means for 

Also in its various embodiments the present invention provides an optical coherent receiver that includes means for achieving high sensitivity without reliance on erbium doped fiber amplification EDFA . As a result the present optical coherent receiver can be implemented both for free space and fiber optical links. The present receiver further includes means for detecting various modulation formats such as ASK D PSK and FSK. The receiver further includes means for operating at many different wavelengths such as 980 nm 1064 nm 1310 nm and optical S band. The receiver further includes means for operating at 2.5 Gb s and 10 Gb s.

A brief description of operational drawbacks of a coherent receiver system as shown in was previously provided. With further reference to a known coherent receiver system is shown in the block schematic diagram of . As shown the prior coherent receiver includes an optical local oscillator LO for outputting an optical signal to an optical local oscillator processor system which in turn drives an optical coupler . The optical coupler serves to receive a modulated optical input signal and feed or couple the same to a post coupler optical processing circuit or network which in turn couples the processed signal to a balanced photodiode and RF radio frequency amplifier . The RF output signal from the balance photodiode amplifier is fed to an RF processing circuit which in turn feeds an output signal to a baseband RF processing circuit the output of which is connected both to an RF Output terminal or connector and also to a frequency lock circuit the output of which is inputted to the Optical LO .

The optical LO provides a high power optical continuous wave which is related in a fixed fashion to the frequency of the received signal. The optical LO processor serves to isolate and amplify filter and polarization stabilize the output signal from the optical LO . The optical coupler combines the output of the optical LO processor and the modulated optical input signal . The post coupler optical processor serves to optimize the coupling ratio of the optical coupler and the balanced photodiode converter .The balanced photodiode converter converts the mixed optical signal into the RF domain. The RF processor in tandem with the baseband RF processor serve to provide a demodulated RF output signal and potentially supply a feedback signal to drive the frequency lock the latter functioning to control the frequency of the optical LO in relation to the frequency of the modulated input signal .

A block schematic diagram for a coherent receiver for a first embodiment of the invention is shown in . Note that for this first embodiment of the invention relative to the prior coherent receiver of the former uses a baseband RF EDC radio frequency electronic dispersion compensation equalization processor in substitution of the baseband RF processor a frequency phase lock circuit in place of the frequency lock circuit and the addition of an autoscan . Also RF feedback control signals are connected from the output of the RF processor to each of the peak detector frequency and phase lock autoscan and balanced O E converter .

In receiver the optical LO processor serves to isolate amplify filter and polarization stabilize the optical LO signal as in the receiver . The post coupler optical processor serves to optimize the coupling ratio of the optical coupler and also serves to equalize the path length between the optical coupler and the balanced O E converter . The balanced O E converter consists of either a balanced avalanche photodiode APD pair or balanced conventional photodiode pair PD either of which serves to convert the optical output of into an RF signal. The baseband RF EDC processor module functions to allow for electronic compensation of transmission impairments baseband filtering differential modulation processing and amplification of the baseband signal. The frequency and phase lock module functions to control frequency and phase of the optical LO with respect to the modulated optical input signal . The autoscan module functions to locate the wavelength of the modulated optical input signal by changing the wavelength of the optical LO . The peak detector serves to provide a control signal to optimize the operation of post coupler optical processor .

The optical coupler can be provided by either a feedback driven variable ratio optical 2 2 coupler or a 2 4 hybrid optical coupler. An optical feedback signal is connected from optical processor to optical coupler and provides a control signal to insure optimal operation of optical coupler .

The output current of the balanced coherent receiver is given by 2 square root over sin 1 wherein R is the responsivity in Amperes Watt of the balanced O E device and other of parameters and variables as identified below.

With further reference to and equation 1 for optimal receiver performance the following conditions must be maintained 

The coherent receiver can approach the optimum performance under these conditions. A way of demonstrating the performance of the coherent receiver is the evaluation of the so called eye diagram after detection of a high bit rate digital data stream. If the eye diagram has a wide vertical opening detection it can be anticipated that the signal incorporates very low or no bit errors. An eye diagram detected with the coherent receiver at 10 Gb s with a signal input power of 31 dBm is shown in . The corresponding measurement of the bit error ratio is 1 10 one of a billion bits is in error .

There are several differences between the prior art coherent receiver of and the inventive coherent receiver of with the latter providing 

The invention in all of its embodiments is envisioned to provide a lightweight low power consumption coherent receiver that can maintain these system submodules at optimized settings for best receiver performance. The invention is envisioned to provide broad optical wavelength coverage. The optical LO submodule is widely tunable and the autoscan submodule can seamlessly modify the LO wavelength to coherently detect multiple optical signal wavelengths without the use of external optical or RF equipment. The receiver is thus suitable for field deployment.

As previously mentioned the block schematic diagram of shows the major modules and submodules for a first embodiment of the invention for the coherent receiver . In a detailed block schematic diagram of the coherent receiver shows greater details of the design of the various modules that are more generally shown in . In components or modules of receiver are configured in a preferred embodiment of the invention for providing a heterodyne surveillance coherent receiver but is not meant to be limiting. In receiver the RF processor provides an intermediate frequency IF stage. Those of skill in the art may recognize alternative design implementations for the modules of .

In the modulated optical input provides the input optical signal to a signal optical isolator which provides signal isolation to the modulated optical input . A low noise figure high gain signal optical amplifier optionally amplifies the output of the signal optical isolator . A bandwidth appropriate signal optical bandpass filter filters out out of band optical noise from the output of the signal optical amplifier . An optical signal polarization stabilizer stabilizes the polarization state of the output of the signal optical bandpass filter . The tunable local oscillator LO laser provides the optical input to the LO optical isolator which provides optical isolation to the LO input . A low noise figure high gain signal optical amplifier optionally amplifies the output of the LO optical isolator . A narrowband LO optical bandpass amplified spontaneous emission ASE filter filters out optical noise from the output of the LO optical amplifier . An optional LO polarization stabilizer stabilizes the polarization state of the output of the LO optical bandpass filter . A variable ratio optical coupler receives the outputs of the signal polarization stabilizer and the optional LO polarization stabilizer . The two outputs of coupler are E j E square root over 2 and j E E square root over 2 . Optical taps and individually receive signal outputs from the variable ratio optical coupler . Each tap outputs splitting of the input whereby 99 is fed forward and 1 is a feedback signal. An optical differential comparator receives the feedback signals from optical taps and and outputs an electrical DC signal. The variable ratio optical coupler receives the output signal from the optical differential comparator which allows for a perfect 50 50 coupling ratio for the two outputs of coupler . A fiber stretcher receives the feed forward output of optical tap and allows for optical path equalization between the fiber outputs of optical taps and . A balanced avalanche photodiode APD pair and housed in an RF package respectively receive the optical outputs of fiber stretcher and optical tap and outputs a number of RF signals. A broadband bias tee receives an RF output signal from the balanced APD and passes the RF output signal to an amplifier and a DC feedback DC signal to APD to allow for AC responsivity balancing between APD s and . A temperature control loop TCL maintains high precision temperature stability of APD the positive biased APD and APD the negative biased APD devices in the RF package . A photocurrent monitor loop PML drives the voltage of the negative biased APD for optimal operation. An impedance matched broadband RF amplifier receives the feed forward output of the broadband bias tee and amplifies the received RF signal for subsequent RF processing. A peak detect circuit receives a portion of the RF output of the RF amplifier . The output of the peak detect circuit drives the fiber stretcher in order to maintain equal path lengths between the fiber outputs of optical taps and . A bandpass filter receives a portion of the output from the RF amplifier and outputs an IF beat note. An IF detect module receives the output from the bandpass filter and the former functions to output an RF signal at a specified reference frequency.

An autoscan module receives the RF output from the IF detect module and provides for wavelength adjustment of the LO laser .

Note that wherever optionally is used in describing the various embodiments of the invention the use of the referred to optical component is meant to be a preferred embodiment whereas the component s use may not be necessary in certain applications.

The output of bandpass filter is split and feeds An I data synchronous processing loop consisting of a double balanced mixer which receives a portion of the RF output of the RF amplifier and receives a portion of the output of bandpass filter . A low pass filter filters the out of signal band noise of the output of mixer . A double balanced mixer receives a portion of the RF output of the RF amplifier . A 90 delay module receives an output of the bandpass filter and feeds the delayed output into the double balanced mixer . A low pass filter filters the out of signal band noise of the output of mixer . Two decision blocks F and F respectively convert portions of the RF output of low pass filters and respectively into digital signals. Two sample and hold RF modules G and G introduce a time delay of one clock duration. The sample and hold RF module G receives a second portion of the RF output of low pass filter . The sample and hold RF module G receives a second portion of the RF output of low pass filter . A multiplier receives the outputs of G and F . A multiplier receives the outputs of G and F . A subtraction module receives the RF outputs of multipliers and . A loop filter receives an error signal output from subtraction module . The output of the loop filter drives the tunable LO laser in order to maintain a constant frequency and or phase difference between the modulated optical input and the tunable LO laser . An electrical compensation module combined with an optional differential decoding circuit receives a portion of the RF output of the low pass filter . An electrical compensation module combined with an optional differential decoding circuit receives a portion of the RF output of the low pass filter . An I channel RF output port receives the output of the differential decoding circuit . A Q channel RF output port receives the output of the decoding circuit .

With further reference to as previously described the modulated input optical signal to the generic heterodyne surveillance coherent receiver is first input to an optical isolator then optionally fed through a low noise optical amplifier the output of which is connected to the input of an optical bandpass filter with data appropriate bandwidth. The filtered optical signal is then fed into a polarization stabilizer . This stabilizer operates with a single mode fiber input and can be adapted to accept low level optical signals. It is preferred that the output from the polarization stabilizer is polarization maintaining PM fiber for insuring that the polarization state is maintained in the appropriate state of polarization SOP .

The LO laser which is a PM fiber pigtailed device with a fixed state of polarization is connected into a PM two stage optical isolator in this example. The laser is chosen for lowest RIN relative intensity noise and linewidth while still being amenable to feedback drive circuitry. The output from this isolator is carried on a PM fiber and is optionally fed into a low noise optical amplifier and to an optical amplified spontaneous emission ASE filter . The output of the ASE filter is then fed into a polarization stabilizer with a chosen output SOP. For heterodyne applications both the optical signal and LO laser will have aligned SOPs.

Fiber outputs or optical signals from optional LO polarization stabilizers are inputted to a variable ratio optical coupler VROC . The coupling ratio of the coupler is feedback controlled via an RF output from the optical differential comparator to maintain highest system performance. As previously mentioned two optical outputs of the VROC are both fed into 99 1 optical tap couplers OT and respectively. Ninety nine percent of the input power to each tap is fed through to the balanced APD avalanche photodiode which consists of a positive biased APD and a negative biased APD in this example. One percent of the input to the tap couplers is fed into the optical differential comparator which internally consists of a balanced photodiode followed by an analog comparator that operates at a predetermined commutation frequency. The RF output signal of the optical differential comparator drives the voltage controlled VROC as shown. When the VROC is set at a 50 50 setting it is driven by a null voltage. This loop provides real time voltage controlled coupling stability to the VROC with a negligible insertion loss of 

There are two output fibers or optical output signals from the optical taps and . The optical output signal from optical tap is connected into a low loss 

The avalanche photodiode pair and are actually each avalanche photodiode pairs independent of one another and are individually biased wherein each have sufficient bandwidth to process RF frequencies from IF 0.7 bit rate to IF 0.7 bit rate . APD is designed to operate over a wide range of optical input powers and can operate under linear conditions for large average optical inputs. Typically APD devices such as B APD are grown to achieve a low excess noise figure of 

The APD has its reverse voltage preset for optimal operation via a photocurrent monitor loop PML . This is the active B APD gain set control loop. The output signal of the B APD is connected through the DC port of a wideband bias tee BT . Feedback circuitry driven by BT is designed to control the bias of the APD in order to achieve matched AC responsivity throughout the frequency range of the RF signal. This voltage is integrated over MANY bit pattern cycles and applied to the Slave APD to constantly adjust for near perfect balance. With this B APD respective pairs of avalanche photodiodes and and the associated feedback circuitry precise balancing between the balanced channels is achieved. This is the B APD balance control loop. When the feedback voltage drive through the bias tee is nulled then the DC responsivities of the avalanche photodiodes and within B APD are matched and laser RIN relative intensity noise is minimized for optimal receiver performance.

B APD converts the optical input signals into an RF output signal. The RF output signal of the balanced B APD which consists of avalanche photodiodes is fed via BT bias tee into a well isolated 50 ohm impedance low noise amplifier chain . This amplifier chain supplies uniform gain with low group delay over the RF received passband and provides sufficient non compressed RF power to appropriately drive the subsequent RF mixers and .

The amplified RF signal is split into four paths. As described above one path provides an input to peak detector . A second path drives a bandpass filter which feeds an IF detector circuit which feeds an autoscan circuit which drives a tuneable local oscillator . The third and fourth paths are feeding the inputs to the double balanced mixers and respectively which are used for processing the information on the in phase I and quadrature Q component of the modulated input. For arbitrary optical modulation the in phase and quadrature component of the optical signal can be modulated with independent data streams. This is generally referred to as quadrature amplitude modulation QAM . The I and Q processing structure allows to retrieve any data modulation on the I and Q component of the optical signal. The I channel processing components include mixer LPF decision block mixer subtractor and F decision block . The Q channel processing components include mixer LPF F decision block G decision block mixer and subtractor . The output of bandpass filter is split into two parts one which feeds the IF detect module and a second that is subsequently split and feeds the I channel double balanced mixer and a 90 degree delay module . Mixer performs a synchronous downconversion of the I data stream. The output from mixer is fed into a low pass filter LPF . The output of LPF is split into three parts. The first output of LPF is fed into an electrical compensation module with optional differential decoder ECM DD . The output of ECM DD is the RF I channel output which detects the modulated data on the in phase part of any optical modulation format which is generally addressed as quadrature amplitude modulation QAM . The differential decoder section of ECM DD can be operated to demodulate differentially encoded modulation formats. The other two portions of the filtered I data are available for error signal processing. These signals are sent through digitally based RF decision blocks F and decision block G . The output of block F is input to a multiplier . The output of block G is fed into multiplier .

The output of the 90 delay module is fed into DBM . DBM performs a synchronous downconversion of the Q data stream. The output of is fed into a low pass filter LPF . The output of LPF is the Q data and is split into three branches. One branch is fed into an electrical compensation module with optional differential decoder ECM DD . The output of ECM DD is the RF Q channel output which detects the modulated data on the quadrature phase part of any optical modulation format which is generally addressed as quadrature amplitude modulation QAM . The differential decoder section of ECM DD can be operated to demodulate differentially encoded modulation formats.

The other two portions of the filtered Q data are available for error signal processing. These signals are sent through digitally based RF decision blocks F and G . The output of block F is input to multiplier . The output of block G is fed into multiplier .

The outputs of multipliers and are fed into an RF subtraction module . The output of module is an error signal that drives the loop filter . The output of filter drives the tunable laser LO and insures strict frequency and phase locking of LO is maintained.

The autoscan circuit automatically scans the laser LO via temperature control so that a frequency lock between the LO and the input signal is maintained at the IF beat frequency. The laser LO is coarsely tuned in wavelength by changing the temperature. A change from a lower temperature to a higher temperature increases the wavelength of the laser LO . Utilizing a Digital to Analog Converter DAC this temperature can be scanned from a low temperature to a higher temperature by the use of digital counters not shown with a clock set at an appropriate rate for a controlled scan or tuning of the laser LO . Referring to the beat of the unknown signal can be searched for by starting a scan at the low temperature range and proceeding to the high temperature range. The bandpass filter set at the Intermediate Frequency IF of interest will eventually pass a carrier associated with the heterodyne or beat between the LO and the unknown signal. This carrier is detected with the autoscan circuitry in order to lock the LO laser to the incoming optical signal.

The experimental way of finding the beat between two lasers to produce an IF with a coherent heterodyne system normally involves a few pieces of expensive equipment. The two lasers being used in such an experimental setup typically on an optics bench require connection to an OSA Optical Spectrum Analyzer. This instrument will show the two different laser wavelengths simultaneously. One laser is then tuned to move the wavelength close to the other. The resolution of the OSA is such that usually one can get the pair of lasers to be observed as a single output blip . However a finer degree of wavelength frequency determination is required by an RF Spectrum Analyzer. The laser outputs must be optically mixed in a fiber coupler followed by O E optical to electrical conversion usually by a wide bandwidth photodiode. If the laser wavelengths are tuned close enough within the frequency range of the Spectrum Analyzer for example less than 40 GHz then an RF signal the IF will be observed. A way of finely tuning and also maintaining the wavelength stability of the lasers is helpful and required. The application used in this embodiment of this invention uses lasers employing temperature and current to finely adjust and stabilize the IF beat but does not exclude other methods.

The autoscan of as shown in detail in consists of a differential amplifier oscillator D A clock amplifier Schottky diode BP filter AND gate SPST switch opto FET switch PLL loop filter cycle slip detector and multiplier . The IF DETECT module of consists of a voltage controlled oscillator multiplier and BP filter as shown in . The autoscan section or module scans the wavelength of the LO laser in a course adjustment by temperature control and in a fine adjustment for phase locking by current control. One type of available laser is supplied in a small sealed device. As packaged the laser of the optical LO is internally mounted on a TE thermoelectric cooler not shown along with a thermistor T to easily monitor the temperature as shown in . The TE input of the Laser Package for the optical LO is driven by a differential amplifier . A TE loop filter is included in the feedback loop for amplifier . Temperature sensing from LO is provided by thermistor T which is connected to amplifier to provide feedback for precise temperature regulation. The reference set point temperature for amplifier is determined by D A converter DAC connected and digitally selected by up down counters using designs known by those skilled in the art. The temperature resolution which is responsible for the frequency resolution of the LO laser tuning is set by the DAC number of bits the DAC reference voltage and resistors REF TEMP and OFFSET BIAS . The offset bias circuitry is used to center the DAC tuning range within the temperature specifications of the LO laser being used. For example but not limited to a 5 volt reference the 12 bit DAC is used for a typical resolution per DAC bit of nominally 60 MHz.

The autoscan circuitry operates by digital clocking the DAC up down counters. This will increase or decrease of the laser temperature of LO . This tunes the wavelength frequency of laser oscillator LO so that the beat is detected and stops the digital counting.

The autoscan is initiated as follows DAC and up down counters can be SET TO ZERO . This sets the temperature reference to the lowest temperature for laser oscillator LO . The MANUAL START will enable tuning clock to count up at a FAST or SLOW selected rate. A beat between the laser LO and the modulated optical input is recognized by a signal output from bandpass filter . Schottky diode and a filter network including resistor and capacitor detects the amplitude of the beat . The output of Schottky diode and filter network is connected to carrier detector comparator amplifier . The output of carrier detector comparator is connected to AND gate and tuning clock input. Stop clock signal stops the temperature tuning by halting the UP DN counter clock of DAC . Note that the amplifier has its non inverting terminal terminated to ground via resistor and a feedback resistor is connected between its non inverting terminal and output terminal providing hysteresis.

The temperature tuning can be very slow because of the thermal time constants inherent to the laser package of LO . For faster tuning a FAST clock set for example at but not limited to 20 Hz can be selected to scan tune to quickly access the desired signal. However when the beat detection occurs and stops the DAC counters the temperature will overshoot out of the bandpass filter detection circuit range. Then the DOWN slow clock can be set for example at but not limited to 1 Hz to precisely bring the beat into the detection circuit range without overshoot. In conclusion temperature control of the laser LO is feedback controlled by the amp loop filter and the temperature to be set for tuning of laser LO wavelength frequency by DAC .

Current input for the Laser Package of LO requires a current which can be set to provide near the maximum optical output and fine current adjustment control for phase locking. The Laser Package laser LO current input is fed by a laser bias voltage connected to resistor R. Typically but not limited thereto the bias voltage is 3.5 volts and resistor Ris 10 ohms. The PLL Phase Lock Loop drive to the laser is via Amplifier PLL Loop Filter and resistor Rselected for optimum loop gain. Amplifier PLL Loop Filter is reset to zero volts by OPTO FET Switch .

The following description will trace the operation of the autoscan topology for the embodiment focusing on the phase lock loop . In the heterodyne configuration of the output of the RF amplifier chain is split into four parts. The part feeding into BPF is called the carrier channel. This discussion deals with the carrier channel.

DUAL CONVERSION CARRIER CHANNEL The carrier channel may have but is not limited to an IF intermediate frequency of 27 GHz. This IF frequency may be ideal for the signal point of view but may not be ideal for the carrier section used for phase locking. With reference to by using mixer and Voltage Controlled Oscillator VCO set at for example but not limited thereto 17 GHz a down conversion to 10 GHz will be achieved. This will be fed to a 10 GHz bandpass filter then on to the PLL circuitry. This dual conversion carrier channel enables the system to choose an IF appropriate for the signal channel but can use a carrier channel PLL design of 10 GHz for example. It is convenient to have a versatile system for various signal IF frequencies without having to redesign a different PLL channel for each different ideal signal IF frequency. In a simpler embodiment for an application requiring for example but not limited to a 10 GHz signal IF this Dual Conversion section can be eliminated. The carrier channel would be inserted directly into bandpass filter thereby eliminating use of VCO and mixer .

The Carrier Channel as described above however it is produced connects to bandpass filter set for this embodiment to but not limited to 10 GHz. The output of bandpass filter is fed to both Schottky diode and filter circuitry and digital divider divides by 200.

In the following we will first follow the digital divider section circuit path. The digital divider is of a known design. For this example digital divider is set for but not limited to a divide by 200 as previously mentioned. As a result the 10 GHz carrier channel of this example will be divided down to a frequency of 50 MHz as compared with the 50 MHz REF OSC via the Exclusive OR mixer phase comparator for example.

The output of mixer phase comparator drives via coupling resistor Amplifier and PLL Loop Filter which then drives via resistor Rthe Current Input of the Laser Package for laser LO . When this phase lock loop is locked LO will produce a Local Oscillator Laser Output wavelength frequency value to beat with the modulated optical input wavelength frequency and produce for example but not limited to a 27 GHz IF. This IF will be frequency and phase locked to 50 MHz REF OSC reference oscillator . Note that in this example resistor Rcouples a laser bias voltage to the current input of optical laser oscillator LO . Also a resistor couples the output of loop filter to the latter.

The following discussion is for identification of the desired beat and decision to lock circuitry embodiment. For decades there have been available many highly successful conventional PLL single chip devices. They operate by driving with proper polarity from the output of a loop filtered phase comparator a voltage controlled oscillator VCO to phase lock to a reference frequency. There are two characteristic types or versions of mixer phase comparators. One version is an edge sensitive type that can contain digital Flip Flop circuitry for frequency discrimination called a frequency phase comparator or detector. This has the advantage of not locking onto harmonics of the reference frequency but has the disadvantage of being very susceptible to noise because it is using the edges of the signals for comparison detection. The second version is a quadrature type of mixer comparator and can be in an analog configuration such as typically called a Gilbert cell or in an up side down Christmas tree mixer detector configuration. It also can be designed as a digital configuration using an exclusive OR gate. These alternative configurations can lock onto harmonics but can have the advantage to be configured to obtain very high noise immunity. Either type of these mixer comparator configurations when set up in a standard PLL configuration WHEN OUT OF LOCK will cause the output of the loop filter to NOT be at zero volts but be clipped against one power supply rail not shown .

For PLL topologies there can be three specific items to be monitored during a successful lock. In usual applications there are three items to monitor first a phase locking of the signal of interest to a reference frequency secondly after the loop is phase locked there can be included a lock indictor and thirdly an amplitude detector can also be included. The embodiment of the Phase Lock Loop of this invention combines the ability to discriminate against harmonic locking and obtain high noise immunity. When out of lock PLL will place the loop filter amplifier at zero volts rather than clipped against one power supply rail. This is accomplished by reversing the order of the three specific items in the monitoring sequence stated above. First Schottky diode and filter network detect the amplitude of the beat . The output of Schottky diode and filter network is connected to Carrier Detector Comparator amplifier . The output of Carrier Detector Comparator amplifier is connected to AND gate and Tuning Clock STOP CLOCK input stopping the tuning as described above. When the carrier amplitude which is converted to a DC voltage representative of the Carrier amplitude is above a threshold set by Carrier Detector Comparator amplifier and associated circuitry the output thereof will go HI indicating a carrier of proper amplitude within the bandpass filter has been detected. This carrier has gone through bandpass filter so its frequency is known and means the beat is very close to the desired IF. Second now the beat is very close to the desired IF 50 MHz REF OSC and digital divide by 200 is connected to Cycle Slip Detector .

The basic cycle slip detector operation is such that if one input receives one clock signal and the other input receives another clock signal regardless of the phase between them or which one came first the output will be enabled in this example by going HI high . In other words the two signals are of the same frequency but their phase relationship doesn t matter with this circuit. If either input gets more than one clock pulse or signal before the other receives a clock signal then the output is disabled or in this example goes LO low . This is a same frequency detector but not a phase detector. This is the same type of circuitry used in normal PLL applications to indicate that the loop is locked. A cycle slip detector can be designed with Flip Flops and logic Gates as known by one skilled in the art. When AND gate receives individual inputs from cycle slip detector and from the output of amplifier its output goes HI with switch set to AUTO PLL ENABLE causing OPTO FET SWITCH to be open circuited thereby enabling Amplifier and PLL Loop Filter connected to the Current input of optical LO through resistor R. This will enable the PLL to lock. Switch PLL OFF PLL ENABLE can be used to manually disable the PLL. Note that a resistor connects to 5 VDC to the opto FET switch .

The prior art would have to use an Optical Spectrum Analyzer OSA to find the LO laser wavelength and the unknown signal wavelength. Next the temperature of the LO laser would need to be changed until the two wavelengths are very similar. Because the OSA does not have sufficient wavelength resolution an RF spectrum analyzer must now be used after O E conversion to further fine tune the temperature to get very close to the desired IF. Both of these instruments are large heavy and costly. Various wavelength division multiplex WDM transmission channels can be studied and analyzed using this feature.

Note that the RF component characteristics in the coherent receiver embodiment of are appropriately chosen to process the optical heterodyne signal in the optimal fashion.

With reference to an enhancement of the invention for configuring the modules of receiver to provide a heterodyne surveillance receiver with balanced photodiodes B PD is shown. Balanced PIN photodiodes and residing in RF package for B PD have sufficient RF bandwidth to process RF frequencies from IF 0.7 bit rate to IF 0.7 bit rate . The photodiode pair may be required for higher IF value or higher bit rate digital transmissions if the B APD shown in does not have sufficient RF bandwidth. The DSC740 of Discovery Semiconductors Inc. using balanced photodiodes has a 35 GHz bandwidth and can be used for the present 10 Gb s heterodyne receiver. The DC responsivity of the balanced photodiodes is approximately 0.7 A W while that of the B APD can be approximately 1.5 A W. The lower DC responsivity of the balanced PIN diodes will lead to degraded sensitivity performance of the secondary embodiment of the invention shown in . Also no feedback loops are applied to the B PD package so the receiver performance may be slightly degraded versus the preferred receiver embodiment of the invention shown in . This is explained by the fact that the feedback loop applied to the balanced APD pair serves the purpose of equalizing the DC responsivities of the two APD s to more completely cancel the RIN of the LO laser which improves sensitivity performance of the preferred embodiment of the receiver of over the performance of the B PD package based secondary embodiment of . Otherwise the receiver of operates in the same manner as receiver of .

With reference to the modules of receiver are configured to provide a homodyne surveillance coherent receiver for another embodiment of the invention are shown. In contrast to the heterodyne surveillance coherent receivers respectively a variable ratio 90 degree optical hybrid is used instead of a variable ratio coupler . A detailed view of the generic variable ratio 90 degree optical hybrid used in the homodyne version of the invention is shown in . The hybrid generates in phase I and quadrature phase Q optical data. The Q data is needed as the input for phase locking the LO laser in this homodyne receiver . Since the I and Q data streams are generated via the optical hybrid there is no need to generate these states in the RF domain as is done in the heterodyne receivers and of respectively. The polarization states of the modulated optical input signal and LO lasers may need to be set at fixed polarization states e.g. circular linear. Also in the homodyne platform the RF output from the B APD is in the baseband and no synchronous demodulation is needed. A portion of the RF output is split and fed into the autoscan module . The output from the autoscan module controls the LO laser temperature. Homodyne operation is maintained in this way.

With further reference to the input optical signal to the generic homodyne surveillance coherent receiver is first input to an optical isolator and then optionally fed through a low noise optical amplifier and then through an optical bandpass filter with data appropriate bandwidth. The filtered signal is then fed into a polarization stabilizer . This stabilizer operates with a single mode fiber input and can be adapted to accept low level optical signals. The output signal from the polarization stabilizer is a polarization maintaining PM fiber and the polarization state can be maintained in the appropriate state of polarization SOP . The output signal is inputted to the optical hybrid .

The LO laser which is a PM fiber pigtailed device with a fixed state of polarization is connected into a PM two stage optical isolator . The laser is chosen for lowest RIN and linewidth while still being amenable to feedback drive circuitry. The output signal from this isolator is on PM fiber and is optionally fed into a low noise optical amplifier driving an optical amplified spontaneous emission ASE filter . This filtered output signal is then fed into a polarization stabilizer with a chosen output SOP. For homodyne applications the polarization states of the signal and LO laser may need to be set at fixed polarization states e.g. circular linear.

Fiber outputs from the signal and optional LO polarization stabilizers respectively are connected to a variable ratio 90 optical hybrid VROH . With reference to the optical hybrid of the coupling ratios of internal Coupler and Coupler of the hybrid are feedback controlled to maintain the highest system performance. The coupling ratios of internal Coupler and Coupler are also voltage controlled. However Couplers and are normally maintained at a 50 50 coupling ratio. There are four optical outputs from the VROH variable ratio optical hybrid . Two optical outputs from Coupler of the VROH are both fed into 99 1 optical tap couplers OT and see . About 99 of the input power to each optical tap OT is fed through to the I channel balanced APD which consists of a positive biased APD and a negative biased APD . About 1 of the input to the optical tap couplers is fed into optical differential comparator which drives the coupler of the voltage controlled VROH . The output from the optical comparator alternately transmits optical information from both taps at a predetermined commutation frequency to drive Coupler of the VROH . When Coupler of the VROH is set at an effective 50 50 setting a null voltage drives the Coupler of the VROH . This loop provides real time voltage controlled coupling stability to Coupler of the VROH with negligible insertion loss of 

There are two output fibers from Coupler of the VROH . One of the fibers is connected into a low loss 

The balanced O E elements and are avalanche photodiode pairs APD s which as previously indicated have sufficient RF bandwidth nominally 70 percent of the data transmission rate to efficiently process the homodyne optical signal . These APD s are designed to operate over a wide range of optical input powers and can operate under linear conditions for large average optical inputs. The APD devices are grown to achieve a low excess noise figure of 

Note that either APD or APD has a bias voltage preset for optimal operation via a photocurrent monitor loop PML which is the active APD gain set control loop.

The output voltage of the I channel APD pair is connected to the DC port of a wideband bias tee BT . Feedback circuitry driven by the output of BT is designed to control the bias of the second APD in order to achieve matched AC responsivity throughout the frequency range of the RF signal. This voltage is integrated over MANY bit pattern cycles and applied to the Slave APD to constantly adjust for near perfect balance. With this APD package of APD s and the associated feedback circuitry precise balancing between the balanced channels is achieved. This is the APD balance control loop. When the feedback voltage drive through the bias tee is nulled the DC responsivities of the APD s and are matched and laser LO RIN is minimized for optimal receiver performance.

The RF output of the balanced APD pair is fed into a well isolated 50 ohm impedance low noise amplifier chain . This chain supplies uniform gain with low group delay over the RF received passband. This chain provides sufficient non compressed RF power to appropriately drive the subsequent RF components. Also the chain has sufficient RF bandwidth for the baseband homodyne signal 0.7 bit rate .

The amplified RF I signal is split into four paths. One path from amplifier chain is input to peak detector . A second output of amplifier chain is fed into an electronic compensation module with optional differential decoder ECM DD . The other two portions of RF amplifier are available for error signal processing. These signals are sent through digitally based RF decision blocks F and G . The output of F is input to multiplier . The output of G is fed into multiplier .

Two optical outputs from Coupler of the VROH are both fed into 99 1 optical tap couplers OT and respectively. About 99 of the input power to each OT is fed through to the Q channel of balanced APD which consists of a positive biased APD and a negative biased APD . About 1 of the input to the tap couplers is fed into optical differential comparator which drives the coupler of the voltage controlled VROH . The output from the optical comparator alternately transmits optical information from both taps and at a predetermined commutation frequency to drive Coupler of the VROH . When Coupler of the VROH is set at an effective 50 50 setting a null voltage drives the Coupler of the VROH . This loop provides real time voltage controlled coupling stability to Coupler of the VROH with negligible insertion loss of 

There are two output fibers from Coupler of the VROH . One of the fibers is connected into a low loss 

The balanced O E elements and are avalanche photodiodes APD s having sufficient RF bandwidth nominally 70 percent of the data transmission rate to efficiently process the homodyne optical signal . These APD s are designed to operate over a wide range of optical input powers and can operate under linear conditions for large average optical inputs. The APD devices are grown to achieve a low excess noise figure of 

Note that APD voltage has a bias voltage preset for optimal operation via a photocurrent monitor loop PML . This is the active APD gain set control loop.

The output voltage of the Q channel APD RF package is connected through the DC port of a wideband bias tee BT . Feedback circuitry driven by the output of BT is designed to control the bias of the second APD in order to achieve matched AC responsivity throughout the frequency range of the RF signal. This voltage is integrated over MANY bit pattern cycles and applied to the Slave APD to constantly adjust for near perfect balance. With this APD RF Package and the associated feedback circuitry precise balancing between the balanced channels is achieved. This is the APD balance control loop. When the feedback voltage drive through the bias tee or BT is nulled then the DC responsivities of the APD s and are matched and laser RIN is minimized for optimal receiver performance.

The RF output of the balanced APD pairs is fed into a well isolated 50 ohm impedance low noise amplifier chain . This amplifier chain supplies uniform gain with low group delay over the RF received passband. This amplifier chain provides sufficient non compressed RF power to appropriately drive the subsequent RF components. Also the chain has sufficient RF bandwidth for the baseband homodyne signal 0.7 bit rate .

The amplified RF Q signal is split into five paths from amplifier chain . One path of amplifier chain is input to a Q channel peak detect block . A second output of amplifier chain is fed into an electronic compensation module with optional differential decoder ECM DD which is fed to a low pass filter which is followed by the RF Q channel output . Two other portions of amplifier chain are available for error signal processing. These signals are sent through digitally based RF decision blocks F and G . The output of F is input to multiplier . The output of G is fed into multiplier . The fifth output from amplifier chain is fed to the autoscan module which drives the tunable LO laser .

The RF outputs of multipliers and are fed into an RF subtraction module . The output of module is an error signal that drives the loop filter . The output of filter drives the tunable LO laser and insures strict frequency and phase locking of LO is maintained.

The autoscan circuit automatically scans the LO laser via temperature control so that a frequency lock between the LO laser and signal transmission is maintained at homodyne. The LO laser is coarsely tuned in wavelength by changing the temperature. A change from a lower temperature to a higher temperature increases the wavelength of the LO laser .

The autoscan utilizes a Digital to Analog Converter DAC not shown for scanning the temperature from a low temperature to a higher temperature by the use of digital counters with a clock set at an appropriate rate for a controlled scan or tuning of the laser . Referring to the beat of the unknown signal can be searched for by starting a scan at the low temperature range and proceeding to the high temperature range. The scan will eventually pass a signal associated with the homodyne condition between the LO laser and the unknown signal. When this signal is detected additional circuitry will stop the digital counters enable the PLL phase comparator and lock onto this unknown signal. Additional comparator circuitry is available to monitor the output of the PLL loop filter . When the positive or negative extremes are approached indicating a potential loss of lock going out of the lock range this circuitry will adjust the temperature appropriately to place the loop filter back near the center of its locking range. With this monitoring system once the loop is locked the unknown signal can be tracked if it is drifting over most of the temperature control range thereby expanding drastically the locking range of the system.

The prior art would have to use an Optical Spectrum Analyzer OSA to find the LO laser wavelength and the unknown signal wavelength. Then the temperature of the LO laser would need to be changed until the two wavelengths were very similar. Because the OSA does not have sufficient wavelength resolution an RF spectrum analyzer must now be used after O E conversion to further fine tune the temperature to get very close to homodyne operation. Both of these instruments are large heavy and costly. Various wavelength division multiplex WDM transmission channels can be studied and analyzed using this feature.

Note that the RF component characteristics in the coherent receiver of the invention are appropriately chosen to process the optical homodyne signal in the optimal fashion.

With reference to the modules of receiver of are configured to provide a homodyne surveillance receiver with balanced photodiodes and in RF package and balanced photodiodes and in RF package . This receiver can provide high bit rate digital homodyne transmissions. For example the PIN based DSC740 has 35 GHz bandwidth and would be the balanced photodiode of choice for packages and providing for 40 Gb s homodyne processing which requires 28 GHz of RF bandwidth. The DC responsivity of a balanced photodiode pair is approximately 0.7 A W while that of an APD pair can be approximately 1.5 A W. The lower DC responsivity through use of balanced PIN diodes for packages and will lead to degraded sensitivity performance of the secondary embodiment of the invention shown in . Also no feedback loops are applied to the B PD packages and so the receiver performance may be slightly degraded versus the preferred embodiment of the invention shown in . This is explained by the fact that the feedback loop applied to the balanced APD serves the purpose of equalizing the DC responsivities of the two APD s and of package and and of package . Therefore the result will be to more completely cancel the RIN of the LO laser which improves sensitivity performance of the preferred embodiment of the receiver over the performance of the B PD based secondary embodiment for receiver .

In reference to a number of the components have been implemented in a prototype coherent 10 Gb s ASK modulation heterodyne receiver operating at an IF of 27 GHz as listed below in Table 1 

Although various embodiments of the present invention are shown and described they are not meant to be limiting. Those of skill in the art may recognize certain modifications to these embodiments which modifications are meant to be covered by the spirit and scope of the appended claims.

