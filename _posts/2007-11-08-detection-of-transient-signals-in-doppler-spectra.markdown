---

title: Detection of transient signals in doppler spectra
abstract: Signal processing is used to detect transient signals in the presence of noise. Two embodiments are disclosed. In both embodiments, the time series from a remote sensor is broken into a number of short time series. The power spectrum of each short time series are then calculated along with the mean noise level. The moments of each peak in every power spectrum are calculated and the peak with the largest power selected from each power spectrum. A histogram of the moments from these selected peaks is generated and normalized to become a measured PDF. In addition, a pre-determined PDF is derived, in the same method as above, from theoretically calculated noise, numerically simulated noise, or measured noise. Comparison between the measured and pre-determined PDF's establish the detection of a transient signal. The first embodiment compares the area between the measured and pre-determined PDF's against a threshold to determine detection. In a second embodiment, the differences between the measured and pre-determined PDF's are weighted and summed to form a score. This score is compared to a threshold to determine detection.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08022864&OS=08022864&RS=08022864
owner: The United States of America as represented by the Secretary of Commerce
number: 08022864
owner_city: Washington
owner_country: US
publication_date: 20071108
---
The research that led to the development of the present invention was sponsored by the National Oceanic and Atmospheric Administration s NOAA s Earth Systems Research Laboratory ESRL . NOAA is a part of the U.S. Department of Commerce a component of the U.S. Federal government. The United States Government has certain rights in this invention.

The present invention relates to the art of signal processing. In particular the present invention is directed toward a statistical technique for detection of transient signals in power spectra particularly for Doppler spectra used in radar and related applications.

Many remote sensing instruments i.e. radars lidars sodars calculate Doppler spectra power spectra scaled to represent the Doppler shift as part of their signal processing. Transforming signals from a time series representation to a power spectrum is very useful since it concentrates the signal energy into a small region of the power spectrum while spreading out the noise energy. Typically the desired signal appears as a peak in the power spectrum in the presence of noise. If the signal to noise ratio SNR is large enough it is easy to detect the signal peak amongst the noise peaks. Usually the largest peak in the spectrum is chosen as the signal. However when the SNR is low it is difficult to select the desired signal since the noise peaks can be larger than the signal. Optimum detectability occurs when the signal exists at least as long as the duration of the sampling time. However many real world signals are of shorter duration. These transient signals are difficult to detect in the presence of noise. Under these conditions the signal energy is contained in many spectral points and difficult to detect.

Most instrument designers will choose the sampling time of an instrument equal to the time the scattering target is in the beam to optimize its detectability. Since the Fourier transform of a continuous signal has narrow bandwidth its corresponding signal will have a narrow peak in the power spectrum. This narrow peak has the best chance of detection. In addition the sampled time series is often divided into short blocks whose power spectra are averaged together. This averaging reduces the variance of the noise making signal peaks more detectable. However often the detection of a transient signal is required. The Fourier transform of a transient signal will have a broad peak in the power spectrum. Therefore the signal energy will appear in many frequency bins and be difficult to detect. Also it is not possible to average short power spectra together when trying to detect transient signals since averaging would reduce the amplitude of a transient peak.

Detecting signals in the presence of noise is a problem when signal amplitude is small compared with the amplitude of the noise signal. Transforming from a time series representation to a power spectrum is very useful since it concentrates the signal energy into a small region of the power spectrum while spreading out the noise energy. Typically the amplitude of a signal peak must be larger than one to two standard deviations of the noise peaks to be detected. The Heisenberg Gabor Uncertainty Principal states that long duration time signals have narrow spectral peaks and short transient signals have broad spectral peaks. This makes detection of long duration signals much easier since the signal energy will be contained in very few spectral bins. Transient signals with short time duration will spread the signal energy over a larger part of the spectrum making detection based on the peak exceeding the noise deviations difficult.

This effect is demonstrated in . is a simulated power spectrum calculated from a 500 msec long time series. This spectrum contains exponentially distributed noise and a 400 msec long burst of a sine wave. The signal peak is contained in one spectral bin and is obviously detectable compared with the surrounding noise peaks. is a similar spectrum that contains a 40 msec burst of signal with the same signal energy as in . Again the signal peak is easily detectable standing well above the noise. However the signal peak has been spread over several frequency bins and is not as tall in relation to the noise peaks. The shorter duration signal has a larger spectral width and is not as detectable as the longer duration signal. shows another spectrum that contains a 4 msec signal burst with the same signal energy as above. The peak is so broad that it is not possible to detect the signal in the noise. The solid line is added to to highlight the signal peak. The spectral width of a 4 msec burst of signal is so large that it is not possible to choose the signal peak from the noise peaks. A different detection method is necessary to detect such short transient signals.

The present invention comprises a statistical method for detecting small amplitude short duration signals in the presence of noise. If the noise in the sampled time series has Gaussian voltage statistics for example usually the case in remote sensing instruments the resulting power spectrum will have exponential noise statistics. Exponential statistics imply that there is a high probability of large narrow noise peaks with large amplitudes. Broad spectral width signals that are not taller than the noise peaks are difficult to detect. The present invention selects the peak with the largest area signal power then uses a statistical test to determine if the peak is due to a transient signal or noise.

The first step of the processing method breaks the sampled time series of voltages into many short blocks and calculates the power spectrum of each block. It then finds the peak in each spectrum with the largest signal power. A peak is defined as a region where the spectral values are completely above the mean noise level. To find the peak with the largest signal power the first three moments signal power frequency and spectral width are calculated for every peak in each spectrum. From all these moments the peak with the largest signal power is chosen. This effect is demonstrated in . contains an expanded portion of a Doppler spectrum that contains a transient signal peak between about 340 to 360 msec. There are many other peaks with larger amplitude however the transient signal peak has the widest spectral width. The largest power peak from each short spectrum is then tested to determine if a transient signal existed in the original time series.

The second step of the processing method uses the low probability of occurrence of wide noise peaks to detect transient signals. This second step is accomplished by comparing the probability density function PDF of the measured signal spectral widths to a pre determined PDF to detect the transient signals. The measured signal PDF is developed by generating a histogram of all the spectral widths calculated from all the largest power peaks from measured power spectra. Enough short spectra have to be processed to generate a histogram of spectral widths. The measured spectral width histogram is then normalized by its area to derive the measured spectral width probability density function PDF . A similar technique is used to develop a pre determined PDF. This pre determined PDF of spectral widths can be calculated from existing theoretical functions derived from numerical simulations of the system or measured instrument noise that does not contain any signal.

While there are many ways to look at the difference between measured and pre determined PDFs the simplest scheme looks at the difference between the two PDFs. If the measured probability is larger than the pre determined probability at some width a signal was detected. In another embodiment a scheme may be used that assigns a weight to each of the probabilities in the PDF. The measured PDF is then compared with the pre determined PDF by calculating the difference between them. This difference is multiplied by its weight and these products summed into a score. Finally each score is compared against an empirically determined output threshold. Scores greater than this threshold are considered detections.

No theoretical PDFs for the moments of noise peaks or measured instrument noise exist for the simulated radar data therefore a model has been created that generates simulated radar Doppler spectra containing pure noise. This model was run about 6000 times and moments from each run were used to generate a pre determined PDF.

Referring to in step noise data generated from the model is input into the system. This noise signal was actual numerically simulated noise but this signal may comprise measured noise data background noise with no signal present or may comprise theoretically calculated noise data. In step the noise input time series is broken into a series of short blocks of data. In step the power spectrum of the noise data is then determined. From the power spectrum of step a mean noise level is calculated in step . From this mean noise level peaks can be determined. Moments including power velocity and spectral width are calculated in step for each peak in the power spectrum. Higher order moments such as skewness or kurtosis can also be calculated. The largest signal power peak from each individual power spectrum is selected.

In Step a histogram of the largest signal power peaks is generated. In step this histogram is normalized to produce a pre determined PDF. Histograms of all three moments signal power velocity and spectral width were then plotted are shown in signal power velocity and spectral width. The histogram of signal power has a wide peak and long tail for larger signal powers. This shape histogram will not provide a good discrimination between large power noise peaks and large power signal peaks. The velocity histogram in is flat. There is a uniform probability that the velocity of noise can have any value. Drop offs at the ends are caused by chopping off the peaks at the end of the spectrum. Therefore a velocity histogram is also not useful to discriminate between signal and noise. However the spectral width histogram in has a sharp peak where most of the noise peaks are narrow and the tail drops off quickly with width. This makes the spectral width a good choice for detecting short transient signals. Histograms of higher order moments such as skewness or kurtosis can also be used.

Once the pre determined PDF value has been calculated the process of maybe utilized to detect whether a transient signal existed in the input signal.

Referring to the measured signal and noise is input into the system in step . In step this measured signal and noise is broken up into a series of short blocks in a similar manner to step in . Enough short blocks have to be processed to generate a statistically robust histogram of spectral widths. Again a power spectrum is determined in step and a mean noise level is determined in step . From this mean noise level peaks can be determined. Moments including power velocity and spectral width are calculated in step for each peak in the power spectrum. The largest signal power peak from each individual power spectrum is selected. In Step a histogram of these moments is generated. In step this histogram is normalized by its area to produce a measured PDF.

In step the difference between the measured PDF from step is compared with the pre determined PDF from step . There are many ways to look at the difference between measured and pre determined PDFs. One technique is a weighting scheme that allows assigning a weight to each of the bins in the PDF. The measured PDF is then compared with the pre determined PDF by calculating the difference between them and multiplying the differences by the appropriate weight. The pre determined PDF values may be stored in memory. As previously noted the pre determined PDF value may be measured once for a given data stream and stored and used repeatedly thus eliminating the need to continually recalculate the pre determined PDF value.

In step the weighted differences between the measured and pre determined PDF are summed and compared with a pre determined threshold value. In this example the comparison starts at a spectral width of four bins since is it expected that the transient signal to be wider than four bins. If the measured PDF value is larger than the pre determined PDF value the difference is weighted by multiplying the difference by its associated weight. The sum of these weighted differences is recorded as the score for each group of data. Finally each score is compared against an empirically determined output threshold. Scores greater than this threshold are considered detections.

This threshold value may be determined empirically and adjusted accordingly to provide the proper level of signal detection. If the sum of the weighted differences exceeds the threshold value a signal is detected as indicated in step . If the sum of the weighted differences is less than the threshold value no signal is detected as indicated in sep .

In adder the difference between the measured PDF from block is compared with a pre determined PDF stored in memory . Predetermined PDF may be calculated using the techniques of previously discussed. There are many ways to look at the difference between measured and pre determined PDFs. In the embodiment of a weighting scheme is used that allows assigning a weight to each of the bins in the PDF though multiplier . The measured PDF is thus compared with the pre determined PDF by calculating the difference between them and multiplying the differences by the appropriate weight . The pre determined PDF values may be stored in memory . As previously noted the pre determined PDF value may be measured once for a given data stream and stored and used repeatedly thus eliminating the need to continually recalculate the pre determined PDF value.

In block the weighted differences between the measured and pre determined PDF are summed and compared with a pre determined threshold value in block . In this example the comparison starts at a spectral width of four bins since is it expected that the transient signal to be wider than four bins. If the measured PDF value is larger than the pre determined PDF value the difference is weighted by multiplying the difference by its associated weight. The sum of these weighted differences is recorded as the score for each group of data. Finally each score is compared against an empirically determined output threshold. Scores greater than this threshold are considered detections. This threshold value may be determined empirically and adjusted accordingly to provide the proper level of signal detection. Detection reports may be output indicating whether a signal is present based upon this threshold comparison.

While the preferred embodiment and various alternative embodiments of the invention have been disclosed and described in detail herein it may be apparent to those skilled in the art that various changes in form and detail may be made therein without departing from the spirit and scope thereof.

