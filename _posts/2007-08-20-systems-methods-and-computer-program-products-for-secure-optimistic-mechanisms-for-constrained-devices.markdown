---

title: Systems, methods, and computer program products for secure optimistic mechanisms for constrained devices
abstract: Embodiments of the invention may provide for systems and methods for secure authentication. The systems and methods may include receiving, by a constrained device, a random string transmitted from a server; determining, by the constrained device, a responsive output by evaluating a first deterministic function based upon the received random string, a locally generated string and a first private key stored on the constrained device; and transmitting at least one portion of the responsive output and the locally generated string from the constrained device to a server. The systems and methods may also include determining, by the server, a validation output by evaluating a second deterministic function based upon the random string, the locally generated string, and a second private key of a plurality of private keys stored on the server; and authenticating the constrained device based upon the server matching the transmitted at least one portion of the responsive output to at least a portion of the validation output.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08793496&OS=08793496&RS=08793496
owner: Florida State University
number: 08793496
owner_city: Tallahassee
owner_country: US
publication_date: 20070820
---
The present application claims the benefit of U.S. Provisional Application No. 60 822 765 filed Aug. 18 2006 and entitled Systems Methods and Computer Program Products for Secure Optimistic Mechanisms for Constrained Devices which is hereby incorporated by reference in its entirety as if fully set forth herein.

The work that led to this invention has been supported in part by a grant from the National Science Foundation Contract Nos. CNS 0087641 and CNS 0209092. Thus the United States Government may have certain rights to this invention.

Aspects of an embodiment of the invention relate generally to authentication mechanisms and more particularly to authentication mechanisms for constrained devices including but not limited to radio frequency identification RFID devices tags near field communication NFC devices tags wireless sensor nodes smart cards and the like.

Radio frequency identification RFID devices tags are small electronic devices that include a chip and an antenna. The chip is typically capable of carrying a small amount of data. RFID devices tags can be powered or passive devices. If the RFID device tag is powered then it may include a power source such as a battery. On the other hand if the RFID device tag is passive then it may be powered by a reader s radio waves with the antenna doubling as a source of inductive power. RFID devices tags may also combine both inductive and battery power sources in which case they may be termed semi passive. Generally RFID devices tags can operate with a range of up to 20 feet or more.

Similar to RFID devices tags near field communication NFC devices tags may also include a small chip and antenna. Generally NFC devices tags are short range wireless technology that enable the communication between devices over a short distance perhaps in the range of zero to twenty centimeters. NFC devices tags are generally powered by magnetic field induction.

Current RFID and NFC devices tags used in tracking identification and anti counterfeiting applications do not support strong secure security mechanisms and accordingly are vulnerable in the systems that deploy them. In addition RFID and NFC devices tags typically have extremely limited computational capabilities. Accordingly traditional distributed multi party computation techniques for securing communication protocols are not feasible for use with these RFID and NFC devices tags.

According to an embodiment of the invention there is a method for secure authentication. The method may include receiving by a constrained device a random string transmitted from a server determining by the constrained device a responsive output by evaluating a first deterministic function based upon the received random string a locally generated string and a first private key stored on the constrained device and transmitting at least one portion of the responsive output and the locally generated string from the constrained device to a server. The method may also include determining by the server a validation output by evaluating a second deterministic function based upon the random string the locally generated string and a second private key of a plurality of private keys stored on the server and authenticating the constrained device based upon the server matching the transmitted at least one portion of the responsive output to at least a portion of the validation output.

According to another embodiment of the invention there is a system for a secure authentication. The system may include a wireless constrained device that includes an antenna a first memory for storing first computer executable instructions and a first processor in communication with the antenna and memory. The first processor may be operable to execute the first computer executable instructions to receive a random string determine a responsive output by evaluating a first deterministic function based upon the received random string a locally generated string and a first private key stored on the constrained device and transmit at least one portion of the responsive output and the locally generated string. The system may also include a server having a second memory for storing second computer executable instructions and a second processor in communication with a reader interrogator and the second memory. The second processor may be operable to execute the second computer executable instructions to transmit the random string to the constrained device receive the at least one portion of the responsive output and the locally generated string transmitted from the constrained device determine a validation output by evaluating a second deterministic function based upon the random string the locally generated string and a second private key of a plurality of private keys stored in the second memory and authenticate the constrained device based upon the received at least one portion of the responsive output matching at least a portion of the validation output.

According to yet another embodiment of the invention there is an authentication method. The authentication method may include receiving at a wireless constrained device a random string broadcast from a server via a reader retrieving a locally generated string at the wireless constrained device and determining an output for a message authentication code MAC function or a pseudo random function PRF based upon at least the received random string a locally generated string and a private key stored on the wireless constrained device. The authentication method may also include transmitting at least one portion of the MAC function or PRF output and the locally generated string from the constrained device to the server wherein validation of the constrained device occurs by the server determining the private key stored on the wireless constrained device and verifying the received at least one portion of the MAC function or PRF output based upon the random string the locally generated string and the determined private key.

Embodiments of the present invention will now be described more fully hereinafter with reference to the accompanying drawings in which some but not all embodiments of the invention are shown. Indeed these inventions may be embodied in many different forms and should not be construed as limited to the embodiments set forth herein rather these embodiments are provided so that this disclosure will satisfy applicable legal requirements. Like numbers refer to like elements throughout.

As will be appreciated by one of ordinary skill in the art upon reading the following disclosure the present invention may be embodied as a method a data processing system or a computer program product. Accordingly the present invention may take the form of a hardware embodiment a software embodiment or an embodiment combining software and hardware aspects. Furthermore the present invention may take the form of a computer program product on a computer readable storage medium having computer readable program code means embodied in the storage medium. Any suitable computer readable storage medium may be utilized including hard disks CD ROMs optical storage devices or magnetic storage devices.

The present invention is described below with reference to flow diagram illustrations of methods apparatus i.e. systems and computer program products according to an embodiment of the invention. It will be understood that one or more block of the flow diagram illustrations and combinations of blocks in the flow diagram illustrations can be implemented by computer program instructions. These computer program instructions may be loaded onto a general purpose computer special purpose computer or other programmable data processing apparatus to produce a machine such that the instructions which execute on the computer or other programmable data processing apparatus create means for implementing the functions specified in the flow diagram block or blocks.

These computer program instructions may also be stored in a computer readable memory that can direct a computer or other programmable data processing apparatus to function in a particular manner such that the instructions stored in the computer readable memory produce an article of manufacture including instruction means which implement the function specified in the flow diagram block or blocks. The computer program instructions may also be loaded onto a computer or other programmable data processing apparatus to cause a series of operational steps to be performed on the computer or other programmable apparatus to produce a computer implemented process such that the instructions which execute on the computer or other programmable apparatus provide steps for implementing the functions specified in the flowchart block or blocks.

Accordingly blocks of the flow diagram illustrations support combinations of means for performing the specified functions combinations of steps for performing the specified functions and program instruction means for performing the specified functions. It will also be understood that each block of the flow diagram illustrations and combinations of blocks in the flow diagram illustrations can be implemented by special purpose hardware based computer systems which perform the specified functions or steps or combinations of special purpose hardware and computer instructions.

Example embodiments of the invention may provide for lightweight and secure mechanisms and protocols for authentication of constrained devices. According to an example embodiment of the invention these constrained devices can include one or both of Radio frequency identification RFID devices tags or Near Field Communication NFC devices tags. It will be appreciated however that other constrained devices with limited processing memory storage and or power supply may be utilized without departing from embodiments of the invention. For example other constrained devices may include wireless sensor nodes and smart cards. It will be appreciated that while the following embodiments of the invention may be discussed with respect to RFID and NFC devices tags the invention is equally applicable to other constrained devices as well.

In accordance with example embodiments of the invention the lightweight and secure mechanisms and protocols described herein may allow wireless constrained devices to be applied to a variety of tracking and identification applications. For instance RFID devices tags and NFC devices tags can be used to determine the contents of shipping containers shopping carts and the like. Likewise RFID devices tags and NFC devices tags are small enough to be printed in materials such as passports for providing identifying information.

In addition to automatic tracking and identification applications the RFID devices tags and NFC devices tags may be used to guarantee authenticity of products and to prevent counterfeiting e.g. by embedding RFID devices tags in drug labels and car license plates. They can also employed to automate payments in wave to pay credit cards and in automated road toll booths to provide access control to physical areas such as restricted airport areas to control access to resources including keyless car entry systems and to tag items against shoplifting.

Furthermore the RFID devices tags and NFC devices tags may be utilized in concurrent presence applications also called yoking or group scanning that determine whether a particular RFID device tag or NFC device tag is located within a particular area at the present time. Concurrent presence applications may be useful in identification and military applications including for example to prevent a gun from being used unless it is within a particular distance from the soldier s torso. It will be appreciated that while automatic tracking identification counterfeiting and concurrent presence applications have been described for illustrative purposes other applications of the lightweight and secure mechanisms and protocols described herein for constrained devices are available without departing from example embodiments of the invention.

Each of the RFID devices tags or NFC devices tags may include individual private keys Kstored in a memory which are generally shared or synchronized with the trusted server . According to an embodiment of the invention the trusted server may know which private keys Kare stored on which RFID devices tags or NFC devices tags . According to an embodiment of the invention a private key can be a value or password comprising one or more characters such as an alphanumeric or a binary string. In alternative embodiments of the invention instead of having the trusted server generate all the communication data some of the data may be generated by the readers interrogators and then communicated to both the trusted server and the RFID devices tags and NFC devices tags . By allowing the readers interrogators to generate some of the communicated data some of the contention and or congestion associated with the trusted server may be alleviated.

Still referring to the trusted server may include a memory that stores programmed logic in accordance with an embodiment of the present invention. The programmed logic may include one or more modules for initiating receiving validating and or responding to communications with RFID devices tags and NFC devices tags as well as other methodologies or combinations thereof described herein. For example the programmed logic may include but is not limited to one or more pseudo random functions described herein. The memory may include data that may be utilized in the operation of the invention and an operating system . According to an example embodiment of the invention the data may include one or more random strings and or calculated pseudo random outputs including portions thereof that are generated by the trusted server the RFID devices tags and or NFC devices tags . Additionally the data may optionally include identification information for RFID devices tags or NFC devices tags . It will be appreciated that while the examples of data described above are provided for illustrative purposes other examples and types of data may be available without departing from example embodiments of the invention. A processor may utilize the operating system to execute the programmed logic and in doing so may also utilize e.g. store modify update and or retrieve the data .

A data bus may provide communication between the memory and the processor . Users such as authorized users of the trusted server may interface with the trusted server via a user interface device s such as a keyboard mouse control panel display microphone speaker or any other devices capable of communicating information to or from the trusted server . The trusted server may be in communication with other external devices including readers interrogators via one or more Input Output I O Interface s . According to an embodiment of the invention the I O interface s may include a universal serial bus USB port a firewire port a wireless network card a wire based network card a parallel port a bluetooth network adapter a short messaging service SMS network card a modem and the like. Thus it will be appreciated that the readers interrogators may be in communication with the I O Interface s of the trusted server via one or more wired connections or wireless connections. Furthermore while not illustrated in there may be one or more networks either public or private that connect the trusted server with the readers interrogators .

The trusted server may be a personal computer mainframe computer minicomputer a dedicated server any other computer device or any combination thereof without departing from example embodiments of the present invention. It will be appreciated that while a single trusted server is illustrated in there may be multiple trusted servers in accordance with example embodiments of the invention. According to an example embodiment of the invention each trusted server may be operable with only a portion of the RFID devices tags and NFC devices tags . For example a first trusted server may communicate only with RFID devices tags via one or more readers interrogators . A second trusted server may then communicate only with NFC devices tags via one or more readers interrogators . Alternatively according to another embodiment of the invention one or more of the trusted servers may be redundant or otherwise provide extra processing capacity to allow for more throughput and data handling capabilities. It will also be appreciated that while RFID devices tags and NFC devices tags have been provided as examples of constrained devices yet other examples of constrained devices are available in other embodiments of the invention.

As illustrated in block the RFID device tag or NFC device tag may retrieve a locally generated string r which as described below is also updated periodically and combine it with the received random string rin calculating a message authentication code MAC as a responsive output h. More precisely the responsive output hmay be determined according to h F r r where Kis the private key stored with the respective RFID device tag or NFC device tag and F may be a deterministic function including a member function of a MAC function family. According to an embodiment of the invention a MAC function may be formed of cryptographic primitives such as cryptographic hash functions e.g. HMAC or from block cipher algorithms e.g. OMAC CBC MAC and PMAC . It will be appreciated that the value of the responsive output hmay be calculated by the RFID device tag or NFC device tag using simple arithmetic operations or computationally inexpensive operations according to an example embodiment of the invention.

In block the RFID device tag or NFC device tag may transmit at least the locally generated string r the calculated responsive output h and its respective identification code e.g. an identification tag for the RFID device tag or NFC device tag to the reader interrogators in its vicinity. The reader interrogators may then provide the received data e.g. locally generated string r the calculated responsive output h and respective identification code to the server block . After the transmission by the RFID device tag or NFC device tag to the reader interrogators the value of the locally generated string rstored in the RFID device tag or NFC device tag may then be updated according to r F r . According to an embodiment of the invention F may be a member function of a MAC function family as described above. Accordingly as provided by r F r the value of the new locally generated string may be a function of the value of the previous locally generated string. According to another embodiment of the invention the locally generated string may be updated based upon information e.g. an algorithm shared between the RFID device tag or NFC device tag and the server .

As shown in block the server may attempt to validate the RFID device tag or NFC device tag that transmitted the locally generated string r the responsive output h and its respective identification code. In particular using the received tag identification the server can determine which private key K was used by the RFID device tag or NFC device tag to compute the received responsive output h. According to an example embodiment of the invention the server may maintain a lookup table which provides a cross reference between identification codes and private keys Kfor the respective RFID devices tags or NFC devices tags . Once the server determines the appropriate private key K the server may verify the received responsive output hby calculating its own validation output haccording to h F r r where function F may correspond to the same function for the respective RFID device tag or NFC device tag the random string rwas the string transmitted or broadcasted by the server and the locally generated string rwas received from the respective RFID device tag or NFC device tag . Accordingly if the value of the received responsive output hmatches the value of the validation output hcalculated by the server then the RFID device tag or NFC device tag may be considered validated as illustrated in block . In addition the server may also store an indication that the RFID device tag or NFC device tag has been validated for purposes of tracking identification anti counterfeiting concurrent presence applications and yet other applications.

In block the RFID device tag or NFC device tag may then retrieve a locally generated string r which may be updated periodically and combines it with the received random string r where the combined string is used in calculating a responsive output h F r r where Kis the private key stored with the respective RFID device tag or NFC device tag and function F may be a deterministic function including a member function of the MAC function family described above or a member function of a pseudo random function PRF family. Generally with a PRF family no efficient algorithm may be able to distinguish between a function chosen randomly from the PRF family and a function whose outputs are completely random. According to an embodiment of the invention a PRF family may be constructed from a cascade construction of a pseudo random function generator such that described in Oded Goldreich Shari Goldwasser and Silvio Micali. How to Construct Random Functions In 33 no. 4 pp. 792 807. ACM Press October 1986 which is hereby incorporated by reference. The pseudo random function generators used in constructing the PRF family may comprise linear feedback shift registers or a cipher e.g. stream cipher etc. that generates a keystream which comprises a stream of random or pseudo random characters. According to another embodiment of the invention the PRF may include one or more block cipher cryptographic e.g. encryption or decryption functions. According to yet another embodiment of the invention the PRF may comprise one way functions OWFs which are functions that are easy to compute but hard to invert. If an OWF is utilized as the function F for determining the responsive output h then the input into the OWF may be a single concatenated input that includes the combined string locally generated string rand received random string r and the private key Kstored with the respective RFID device tag or NFC device tag . It will be appreciated that the value of the responsive output h which is based upon the value of the function F may be calculated by the RFID device tag or NFC device tag using simple arithmetic operations or computationally inexpensive operations according to an example embodiment of the invention.

Having determined the responsive output h the RFID device tag or NFC device tag may then transmit the locally generated string rand the responsive output hto the reader interrogator block which provides the received information to the server block . As illustrated in block the server may then attempts to validate the RFID device tag or NFC device tag based upon the received locally generated string rand the responsive output h. In particular the server may include a lookup table or other database that includes an expected value of the locally generated string r that cross references to private key K. Assuming that the received value of the locally generated string rmatches the expected value of locally generated string rin the look up table or database then the server may know which private key Kto use when calculating its validation output haccording to h F r r where function F may correspond to the same function for the respective RFID device tag or NFC device tag the random string rwas the string transmitted or broadcasted by the server and the locally generated string rwas received from the respective RFID device tag or NFC device tag . If the value of the received responsive output hmatches the value of the validation output hcalculated by the server then the RFID device tag or NFC device tag may be considered validated as illustrated in block . The server may also update the next expected value of locally generated string rfor the key Kin the lookup table by r F r . According to an embodiment of the invention F may be a member function of a MAC function family as described above. According to another embodiment of the invention the locally generated string may be updated based upon information e.g. an algorithm shared between the RFID device tag or NFC device tag and the server . In addition the server may also store an indication that the RFID device tag or NFC device tag has been validated for purposes of tracking identification anti counterfeiting concurrent presence applications and yet other applications.

However if the received value of the locally generated string rdoes not match any of the expected values of the locally generated string rin the look up table or database then the server may have to exhaustively search through all private keys K at least one of which match the private key Kof any authentic RFID device tag or NFC device tag and compute the value of the validation output h F r r to locate the private key Kthat yields a correct validation output hcorresponding to the received responsive output h. The lookup table or database on the server may then be synchronized to update its next expected value of the locally generated string rfor the located private key Kaccording to r F r . According to another embodiment of the invention the locally generated string may be updated based upon information e.g. an algorithm shared or synchronized between the RFID device tag or NFC device tag and the server .

On the other hand if the server exhaustively searches through all private keys Kand none of the computed values of the validation output h H r r correspond to the received responsive output h then the server will not be able to validate the transmitting RFID device tag or NFC device tag 

For example consider the scenario where the private keys or information about the keys of one or more of the RFID devices tags or NFC devices tags are compromised to an unauthorized party A. However in accordance with the protocol of since the private keys of the devices tags or NFC devices tags have been modified in the intervening time and the compromised older private keys are no longer registered with or recognized by the server the unauthorized Party A cannot utilize the obtained the knowledge or partial knowledge of the compromised keys to impersonate or mimic the devices tags or NFC devices tags or otherwise violate the claimed security properties of the system. This property may sometimes be referred to as forward secrecy. 

Turning now to in block the server starts by generating a random string r which is delivered to at least one of the readers interrogators . The readers interrogators may transmit or broadcast the random string rto one or more RFID devices tags or NFC devices tags within their vicinity block . At least one of the RFID devices tags or NFC devices tags may receive the transmitted or broadcasted random string r block . As described above the server may update the value of the random string rperiodically. For example if the server is expected to poll for one or more RFID devices tags or NFC devices tags at a rate of once every ten seconds then the value of the random string rmay be updated at least once per ten seconds. According to an example embodiment of the invention the random string rmay be an alphanumeric or binary string generated by one or more random or pseudo random generators including a hash function.

In block the RFID device tag or NFC device tag may then retrieve a locally generated string r which may be updated periodically and combine it with the received random string r where the combined string is used in calculating a responsive output h F r r where Kis the private key stored with the respective RFID device tag or NFC device tag and function F may be a deterministic function including a member function of a MAC function family or a pseudo random function PRF family as described earlier. It will be appreciated that the value of the responsive output h which is based upon the value of the function F may be calculated by the RFID device tag or NFC device tag using simple arithmetic operations or computationally inexpensive operations according to an example embodiment of the invention.

Having determined the responsive output h the RFID device tag or NFC device tag may then split divide or otherwise logically apportion the responsive output hinto a plurality of components block . According to an example embodiment of the invention the responsive output hmay be split divided or logically apportioned into at least i the device answer component ii the server answer component and iii a new private key. According to an example embodiment of the invention the device answer component may be transmitted to the server and serve as a response to the random string rfrom the server . The server answer component may serve as a validator value for the server . Likewise the new private key may be used to update or otherwise substitute the current value of the private key for the RFID device tag or NFC device tag 

The RFID device tag or NFC device tag then may transmit its locally generated string rand the device answer component of the responsive output hto the reader interrogator block which provides or retransmits the received information to the server block .

Turning now to as illustrated in block the server then attempts to validate the RFID device tag or NFC device tag based upon the received locally generated string rand the device answer component of the responsive output h. In particular the server may include a lookup table or database that includes an expected value of the locally generated string rthat cross references to one or more private key s K. Assuming that the received value of the locally generated string rmatches the expected value of the locally generated string rin the look up table or database then the server may know which private key s Kto use when calculating its validation output haccording to h F r r where function F may correspond to the same function for the respective RFID device tag or NFC device tag the random string rwas the string transmitted or broadcasted by the server and the locally generated string rwas received from the respective RFID device tag or NFC device tag . According to an example embodiment of the invention the look up table or database may cross reference the expected value of the locally generated string rto both a prior value of the private key Kand a current value of the private key K. As will be described in further detail below the server may need to calculate the validation output husing the prior value of the private key Kin the event the respective RFID device tag or NFC device tag did not update its private key from a prior communication session with the server perhaps due to a temporary or transient hardware or communications error.

Once the server has calculated the validation output h the server may likewise split divide or logically apportion the validation output hinto at least i a device answer component ii a server answer component and iii a new private key. According to an embodiment of the invention the server may split divide or logically apportion the validation output haccording to the same or substantially similar manner or algorithm in which the RFID device tag or NFC device tag split divided or logically apportioned the responsive output h. If the value of the received device answer component of the responsive output hmatches the server determined value of the device answer component of the validation output h then the RFID device tag or NFC device tag may be considered validated as illustrated in block . The server may also update the next expected value of the locally generated string rfor the key Kin the lookup table by r F r . According to another embodiment of the invention the locally generated string may be updated based upon information e.g. an algorithm shared or synchronized between the RFID device tag or NFC device tag and the server . However if the received value of the locally generated string rdoes not match any of the expected values of the locally generated string rin the look up table or database then the server may have to exhaustively search through all private keys K perhaps including prior values of private keys K at least one of which may match the private key Kof any authentic RFID device tag or NFC device tag and compute the value of the validation output h F r r to locate the private key Kthat yields a device answer component matching the received device answer component. If a match is found then the RFID device tag or NFC device tag may be validated and the lookup table or database on the server may then be synchronized to update its next expected value of the locally generated string rfor the located private key K. On the other hand if the server exhaustively searches through all private keys Kand none of the computed values of the validation output h F r r provide a device answer component matching the received device answer component then the server will not be able to validate the transmitting RFID device tag or NFC device tag 

According to an example embodiment of the invention if the server succeeded in validating the RFID device tag or NFC device tag then the server may also update its lookup table or database to include the updated private key determined from the component of the validation output h. Additionally the server may also retain at least one prior private key Kthat was updated in addition to the new private key.

According to an alternative embodiment of the invention the server may update the private key Kfor the RFID device tag or NFC device tag with the new private key obtained as a component of the previously calculated validation output hduring the next interaction with the same RFID device tag or NFC device tag and then only if the new key value is being used as current by the device tag block . This precludes that the server and the RFID device tag or NFC device tag reaching a state where the key stored for the device tag at the server and the key stored in the RFID device tag or NFC device tag differ.

In block once the server succeeds in validating the RFID device tag or NFC device tag it may then transmit the server answer component of the determined validation output hto the reader interrogator . The reader interrogator may then simply broadcast or transmit the server answer component to the RFID devices tags in its vicinity block . If the device tag or NFC device tag that participated previously in blocks is still within range of the reader interrogator it will receive the transmitted or broadcasted server answer component of the validation output hcalculated by the server block . Assuming that the received server answer component matches its own server answer component the RFID device tag or NFC device tag may then update its current private key with the new private key obtained as a component from the previously responsive output h block . It will also be appreciated that in other embodiments of the invention the server and or device tag may determine a new value for the private keys based upon a pseudo random function of the information that the server and the device tag share.

Many modifications and other embodiments of the inventions set forth herein will come to mind to one skilled in the art to which these inventions pertain having the benefit of the teachings presented in the foregoing descriptions and the associated drawings. Therefore it is to be understood that the inventions are not to be limited to the specific embodiments disclosed and that modifications and other embodiments are intended to be included within the scope of the appended claims. Although specific terms are employed herein they are used in a generic and descriptive sense only and not for purposes of limitation.

