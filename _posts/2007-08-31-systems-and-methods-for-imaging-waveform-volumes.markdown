---

title: Systems and methods for imaging waveform volumes
abstract: Systems and methods for imaging waveform volumes. An image of the waveform volume may be drawn on a display device as a two-dimensional image or a three-dimensional image of a sampling probe and redrawn in real-time at interactive rates using a graphics accelerator or a graphics card. The image of the waveform volume may also include seismic-data traces that are color-filled according to texture coordinates for pixels on the display device that intersect the waveform volume.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08022947&OS=08022947&RS=08022947
owner: Landmark Graphics Corporation
number: 08022947
owner_city: Houston
owner_country: US
publication_date: 20070831
---
The priority of U.S. Provisional Patent Application No. 60 824 334 filed on Sep. 1 2006 is hereby claimed and the specification thereof incorporated herein by reference

The present invention generally relates to systems and methods for imaging a three dimensional volume of seismic traces hereinafter seismic data traces representing a waveform volume. The waveform volume may be imaged displayed as a two dimensional or a three dimensional image of seismic data traces sometimes referred to as wiggles or wavelets at interactive rates.

In the applied sciences various fields of study require the analysis of two dimensional or three dimensional volume data sets wherein each data set may have multiple attributes representing different physical properties. An attribute sometimes referred to as a data value represents a particular physical property of an object within a defined two dimensional or three dimensional space. A data value may for instance be an 8 byte data word which includes 256 possible values. The location of an attribute is represented by x y data value or x y z data value . If the attribute represents pressure at a particular location then the attribute location may be expressed as x y z pressure .

In the medical field a computerized axial topography CAT scanner or magnetic resonance imaging MRI device is used to produce a picture or diagnostic image of some specific area of a person s body typically representing the coordinate and a determined attribute. Normally each attribute within a predetermined location must be imaged separate and apart from another attribute. For example one attribute representing temperature at a predetermined location is typically imaged separate from another attribute representing pressure at the same location. Thus the diagnosis of a particular condition based upon these attributes is limited by the ability to display a single attribute at a predetermined location.

In the field of earth sciences seismic sounding is used for exploring the subterranean geology of an earth formation. An underground explosion excites seismic waves similar to low frequency sound waves that travel below the surface of the earth and are detected by seismographs. The seismographs record the amplitude of seismic waves both direct and reflected at a given location for a given time period. Knowing the time and place of the explosion the time of travel of the waves through the interior can be calculated and used to measure the velocity of the waves in the interior. A similar technique can be used for offshore oil and gas exploration. In offshore exploration a ship tows a sound source and underwater hydrophones. Low frequency e.g. 50 Hz sound waves are generated by for example a pneumatic device that works like a balloon burst. The sounds bounce off rock layers below the sea floor and are picked up by the hydrophones. In either application subsurface sedimentary structures that trap oil such as faults and domes are mapped by the reflective waves.

The use of seismic data to analyze subsurface geological structures such as faults or other stratigraphic features is relevant to interpreters searching for subsurface mineral and hydrocarbon deposits. Seismic data traces are the record of the reflection of sonic waves from underground. These traces can be denoted as A x y t the reflection amplitude of time t at surface location x y . A wiggle display is a basic graphic representation for seismic applications which may be displayed as a two dimensional or a three dimensional image. On a two dimensional image the wiggle display of seismic data traces is commonly imaged by computing the graphics coordinate u v of each amplitude and drawing polylines connecting these coordinates for each trace. The area of the amplitude above and or below a given reference amplitude value for a given wiggle can be filled with colors to enhance the wiggle display for interpretation purposes and therefore make faults and other stratigraphic features revealed by the wiggle display easier to recognize as generally described in U.S. Pat. No. 7 013 218 which is incorporated herein by reference. The colors for amplitude above and below the reference value are normally called positive fill and negative fill respectively. The color fill is most commonly done by 1 drawing horizontal lines in a given color from the position determined by the reference value to the position determined by the amplitude at a given time depth or 2 by filling polygons formed by the reference line and amplitudes. illustrate different images produced by a commercial software package which uses the first approach to generate two dimensional images of seismic data.

The color fill according to the first approach drawing horizontal lines is faster than the second approach filling polygons but the first approach is not applicable in three dimensional displays. Both approaches are normally carried out using a computer s CPU which may be limited by the number of registers. This limitation is an important bottleneck through which a large number of seismic amplitudes waveforms must pass through to be visualized. At present the current state of the art seismic waveform visualization techniques using two dimensional graphics primitives polylines lines filled polygons are insufficient to produce images of a three dimensional volume of seismic data traces in real time at interactive rates meaning at least ten 10 frames per second.

Graphical displays however have been generally improved by using a graphics accelerator or a graphics card to process and display other types of graphical data. For example U.S. Patent Application Publication No. 2005 0237334 A1 assigned to Landmark Graphics Corporation which is incorporated herein by reference uses a graphics card to render voxel data in real time. And U.S. Pat. No. 7 076 735 also assigned to Landmark Graphics Corporation uses a graphics card to render graphical data representing a three dimensional model. Nevertheless conventional visualization techniques as thus described are not capable of rendering a three dimensional volume of seismic data traces in real time for contemporaneous use and analysis.

The present invention meets the above needs and overcomes one or more deficiencies in the prior art by providing systems and methods for imaging a three dimensional volume of seismic data traces representing a waveform volume.

In another embodiment the present invention includes a method for imaging a three dimensional volume of seismic data traces representing a waveform volume that comprises i retrieving texture coordinates s t for a pixel in a display device that intersects the waveform volume ii computing an amplitude for a first trace at pixel texture coordinate t representing a first trace amplitude iii computing a texture coordinate S for the first trace amplitude iv coloring the pixel with a preset trace color if the first trace amplitude texture coordinate S is equal to the pixel texture coordinate s v computing an amplitude for a second trace at pixel texture coordinate t representing a second trace amplitude vi computing a texture coordinate S for the second trace amplitude vii coloring the pixel with the preset trace color if the second trace amplitude texture coordinate S is equal to the pixel texture coordinate s viii coloring the pixel with a preset background color if the second trace amplitude texture coordinate S is greater than the pixel texture coordinate s and ix modifying the pixel texture coordinates s t and repeating the computing and coloring steps if an iteration count is less than a desired seismic data trace overlap.

In yet another embodiment the present invention includes a non transitory computer readable medium tangibly carrying computer executable instructions for imaging a three dimensional volume of seismic data traces representing a waveform volume. The instructions are executable to implement i retrieving texture coordinates s t for a pixel in a display device that intersects the waveform volume ii computing an amplitude for a first trace at pixel texture coordinate t representing a first trace amplitude iii computing a texture coordinate S for the first trace amplitude iv coloring the pixel with a preset trace color if the first trace amplitude texture coordinate S is equal to the pixel texture coordinate s v computing an amplitude for a second trace at pixel texture coordinate t representing a second trace amplitude vi computing a texture coordinate S for the second trace amplitude vii coloring the pixel with the preset trace color if the second trace amplitude texture coordinate S is equal to the pixel texture coordinate s viii coloring the pixel with a preset background color if the second trace amplitude texture coordinate S is greater than the pixel texture coordinate s and ix modifying the pixel texture coordinates s t and repeating the computing and coloring steps if an iteration count is less than a desired seismic data trace overlap.

Additional aspects advantages and embodiments of the invention will become apparent to those skilled in the art from the following description of the various embodiments and related drawings.

The subject matter of the present invention is described with reference to certain preferred embodiments however is not intended to limit the scope of the invention. The claimed subject matter thus might also be embodied in other ways to include different steps or combinations of steps similar to the ones described herein and other technologies. Although the term step may be used herein to describe different elements of methods employed the term should not be interpreted as implying any particular order among or between various steps herein disclosed unless otherwise expressly limited by the description to a particular order.

The present invention provides improved systems and methods for imaging a three dimensional volume of seismic data traces representing a waveform volume in the form of a two dimensional or a three dimensional wiggle display image.

In one embodiment the present invention may be described in the general context of a computer executable program of instructions such as program modules generally referred to as software. The software may include for example routines programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. The software forms an interface to allow a computer to react according to a source of input. The software may also cooperate with other code segments to initiate a variety of tasks in response to data received in conjunction with the source of the received data. The software may be stored onto any variety of memory media such as CD ROM magnetic disk bubble memory and semiconductor memory e.g. various types of RAM or ROM . Furthermore the software and its results may be transmitted over a variety of carrier media such as optical fiber metallic wire free space and or through any of a variety of networks such as the internet.

Those skilled in the art will appreciate that the present invention may be implemented in a variety of computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and the like. Any number of computer systems and computer networks are therefore acceptable for use with the present invention. The present invention may be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment the software may be located in both local and remote computer storage media including memory storage devices.

The present invention may therefore be implemented using hardware software or a combination thereof in a computer system or other processing system.

Menu interface software overlays the operating system . The menu interface software are used to provide various menus and windows to facilitate interaction with the user and to obtain user input and instructions. As would be readily apparent to one of skill in the relevant art any number of menu interface software programs could be used in conjunction with the present invention.

A basic graphics library overlays menu interface software . Basic graphics library is an application programming interface API for three dimensional computer graphics. The functions performed by basic graphics library may include for example geometric and raster primitives RGBA or color index mode display list or immediate mode viewing and modeling transformations lighting and shading hidden surface removal alpha blending translucency anti aliasing texture mapping atmospheric effects fog smoke haze feedback and selection stencil planes and accumulation buffer.

A visual simulation graphics library overlays the basic graphics library . The visual simulation graphics library is an API for creating real time multi processed three dimensional visual simulation graphics applications. As will be understood by those skilled in the art the visual simulation graphics library may include a suite of tools for two dimensional and or three dimensional seismic data interpretations including for example interactive horizon and fault management three dimensional visualization and attribute analysis. The visual simulation graphics library therefore provides functions that bundle together graphics library state control functions such as lighting materials texture and transparency. These functions track state and the creation of display lists that can be rendered later.

Overlaying the elements of program previously described is a 3D sampling probe program that interfaces with and utilizes the functions carried out by the visual simulation graphics library the basic graphics library the menu interface software and the operating system in the manner described in U.S. Pat. No. 6 765 570 assigned to Landmark Graphics Corporation which is incorporated herein by reference. The sampling probe program visual simulation graphics library basic graphics library menu interface software and operating system are executed on one or more general purpose CPU s as described in the 570 patent. An acceptable CPU may include for example processors marketed by Intel and AMD .

Overlaying the sampling probe program is a waveform module . The waveform module may be written in a procedural language such as for example Open GL Shader Language GLSL which makes it possible to program a Graphics Processing Unit sometimes referred to as a graphics processor graphics accelerator or graphics card hereinafter GPU to achieve visualization effects that are not available using Open GL marketed by Silicon Graphics Inc. and the video hardware i.e. the graphics card. GLSL is well known in the art and is published ISBN 0 321 19789 5 in The Open GL Shading Language. The advantages of programming a conventional GPU instead of a CPU to execute the waveform module are its large number of registers and its architecture which enables massive parallelization of the processors. This architecture can process data in the registers in a few GPU cycles while it may take a few thousand CPU cycles for the same task. GLSL works with individual pixels at u v of the projection plane on a display device. Through GLSL shaders one can determine how a pixel at u v is illuminated. An acceptable CPU for example may include the NVIDIA G 70 graphics card and a Qudro 5500 graphics port marketed by NVIDIA . Other GPU s well known in the art may be acceptable if they are capable of executing fragment pixel shader programs written with GLSL and support at a minimum looping and branching functions.

The waveform module is configured to interface with the sampling probe program . The sampling probe program creates a three dimensional sampling probe in the manner described by the 570 patent which may comprise a subvolume of a wave form volume. In other words the sampling probe program extracts a subvolume data set from the waveform volume which corresponds to a surface of the sampling probe. The waveform module receives the subvolume data set from the sampling probe program and processes the subvolume data set using the GPU to draw at least a portion of an image of the sampling probe on a display device. The image of the sampling probe therefore may comprise an intersection of the sampling probe and the waveform volume or the image may be limited to only an intersection of the sampling probe and the waveform volume. The waveform module may be configured to draw at least a portion of an image of the sampling probe on a display device by coloring the subvolume data set and texture mapping the subvolume data set onto the surface of the sampling probe. The subvolume data set may be colored by coloring each seismic data trace in the subvolume data set with a preset trace color color filling each seismic data trace in the subvolume data set with a preset positive fill color or a preset negative fill color and coloring a remainder of the subvolume data set with the preset background color. In addition the waveform module may be configured to color each seismic data trace by coloring each pixel on the display device with the preset trace color if the pixel intersects a seismic data trace in the subvolume data set. Likewise the waveform module may be configured to color fill each seismic data trace by coloring each pixel on the display device with the preset positive fill color if the pixel intersects the subvolume data set between a seismic data trace maximum positive amplitude and a seismic data trace zero amplitude and coloring each pixel on the display device with the preset negative fill color if the pixel intersects the subvolume data set between a seismic data trace maximum negative amplitude and the seismic data trace zero amplitude. The waveform module may also be configured to color the remainder of the subvolume data set by coloring each pixel on the display device with the preset background color if the pixel does not intersect a seismic data trace and does not intersect the subvolume data set between a seismic data trace maximum positive amplitude or a seismic data trace maximum negative amplitude and a seismic data trace zero amplitude. The image of the sampling probe may be repeatedly drawn in response to movement of the sampling probe within the waveform volume so that as the sampling probe moves through the waveform volume the image of the sampling probe is redrawn at a rate that is sufficiently fast to be perceived as moving in real time. Exemplary methods that are enabled by the waveform module are further described in reference to .

While the present invention is described with reference to processing a three dimensional volume of seismic data traces representing a waveform volume other seismic data sets may be processed in the same manner such as voxel data sets to produce a two dimensional or three dimensional image in real time. Geoprobe and PowerView which are a commercial software packages marketed by Landmark Graphics Corporation for use in the oil and gas industry are examples of appropriate interface applications. Geoprobe is the commercial embodiment of the sampling probe program which may be used to interface with the waveform module to render a three dimensional image of a seismic data set including seismic data traces and voxels in real time. Alternatively PowerView may be used to interface with the waveform module to render a two dimensional image of a seismic data set including seismic data traces and voxels in real time.

The program illustrated in may be executed or implemented through the use of a computer system incorporating the program and various hardware components. The system hardware components may include for example a processor memory e.g. random access memory and or non volatile memory devices one or more input devices one or more display devices and one or more interface devices. These hardware components may be interconnected according to a variety of configurations and may include one or more CPU s and CPU s configured in the manner described in the 570 patent. Non volatile memory devices may include for example devices such as tape drives semiconductor ROM or EEPROM. Input devices may include for example devices such as a keyboard a mouse a digitizing pad a track ball a touch sensitive pad and or a light pen. Display devices may include for example devices such as monitors projectors and or head mounted displays. Interface devices may be configured to require digital image data from one or more acquisition devices and or from one or more remote computers or storage devices through a network. Any variety of acquisition devices may be used depending on the type of object being imaged. The acquisition device s may sense various forms of mechanical energy e.g. acoustic seismic energy displacement and or stress strain .

Each processor GPU and CPU may be configured to reprogram instructions and or data from RAM and or non volatile memory devices and to store computational results into RAM and or non volatile memory devices. The program directs each processor to operate on a three dimensional volume of seismic data traces and other two dimensional or three dimensional seismic data sets based on the methods described herein.

Referring now to a flow diagram generally illustrates one embodiment of a method for implementing the present invention through a procedural texture generation routine that displays generalized geophysical data. The fragment pixel location which intersects one or more geophysical data sources and or on a display device and the specified data source s and or are input into the procedural texture generation routine . A geophysical data source may include a waveform volume for example but may also include any other geophysical seismic data sets such as for example voxel data sets with amplitude frequency or phase data values. The input data may be provided to the computer system through a variety of mechanisms. For example the input data may be acquired into non volatile memory and or RAM using one or more interface devices. As another example the input data may be supplied to the computer system through a memory medium such as a disk or a tape which is loaded into onto one of the non volatile memory devices. In this case the input data will have been previously recorded onto the memory medium. It is noted that the input data may not necessarily be raw sensor data obtained by an acquisition device. For example the input data may be the result of one or more processing operations using a set of raw sensor data. The processing operation s may be performed by the computer system and or one or more other computers. The input data may be stored in a format generally well known in the art and or described in the 570 patent. With the data source s and or in place the routine can be executed on the GPU to transform the inputs into an output fragment pixel color on the display device. One example of an output for the routine is a wiggle texture which may be displayed as a two dimensional or a three dimensional image of a waveform volume and manipulated at interactive rates meaning in real time.

In order to draw a wiggle texture with GLSL the associated amplitude A x y t for a given pixel u v must first be obtained in order to determine the illumination of the pixel based on A x y t . The routine therefore proposes a completely opposite approach to the conventional technique of wiggle texture drawing where the position u v of an amplitude is computed from a given A x y t as explained further in reference to .

In a flow diagram illustrates a particular implementation of the routine illustrated in for imaging a three dimensional volume of seismic data traces as a wiggle texture representing a two dimensional or a three dimensional image of a waveform volume. The geophysical data source s and or that are used as input for the routine pass amplitude as a texture map A s t to video memory or the CPU registers. For m traces and n samples per trace the size of the texture map is roughly m by n bytes or floats. The s dimension of the texture map corresponds to m traces. Therefore the s texture coordinate of i th trace is i m. Similarly the t texture coordinate of j th sample is j n. To draw the seismic data traces as a wiggle texture representing a two dimensional or a three dimensional image of the waveform volume a quadrilateral with four vertices is defined. Each vertex is defined by 2 or 3 coordinates for two dimensional or three dimensional cases respectively and a pair of texture coordinates s t . The illumination of each pixel or voxel is determined on the basis of the texture coordinates.

In step the texture coordinates s t for a pixel in a display device that intersects the waveform volume may be retrieved from memory. The texture coordinates determine the texture value or the amplitude in this case at the chosen pixel. The texture coordinates also determine the position of the pixel in the texture map or the position of the pixel in the trace sample grid in this case.

In step an index value for each trace adjacent the pixel texture coordinates may be computed. From the s texture coordinate of the pixel the two neighboring traces i and i 1 with i floor s m can be found.

In step an index value for each sample adjacent the pixel texture coordinates may be computed. From the t texture coordinate of the pixel the two neighboring samples j and j 1 with j floor t n can be found.

In step the results of step and step are used to compute an amplitude for a first trace i at pixel texture coordinate t representing a first trace amplitude a t . For the first trace i the amplitude at t texture coordinate is interpolated by a Sp A i j where Sp A i j is a suitable interpolating spline e.g. linear quadratic cubic .

In step supposing that the width of each trace in texture space is d and the maximum amplitude for the trace width is A a texture coordinate for the first trace amplitude may be computed by S a t i m a t d Aand simply represented as the first trace amplitude texture coordinate S .

In step the first trace amplitude texture coordinate S is compared to the pixel texture coordinate s . If the first trace amplitude texture coordinate S is greater than the pixel texture coordinate s then the pixel is colored with a preset positive fill color Cat step and the routine proceeds to step . The preset positive fill color Cmay be a constant color or a variable color which is adjusted according to the first trace amplitude.

In step the first trace amplitude texture coordinate S is again compared to the pixel texture coordinate s . If the first trace amplitude texture coordinate S is equal to the pixel texture coordinate s then the pixel is colored with a preset trace color Cat step and the routine proceeds to step . The preset trace color Cis preferably a different color than the preset positive fill color and is normally constant.

In step the results of step and step are used again to compute an amplitude for a second trace i 1 at pixel texture coordinate t representing a second trace amplitude a t .

In step assuming again that the width of each trace in texture spaces is d and the maximum amplitude for the trace width is A a texture coordinate for the second trace amplitude may be computed by S a t i m a t d Aand simply represented as the second trace amplitude texture coordinate S .

In step the second trace amplitude texture coordinate S is compared to the pixel texture coordinate s . If the second trace amplitude texture coordinate S is less than the pixel texture coordinate s then the pixel is colored with a preset negative fill color Cat step and the routine proceeds to step . The preset negative fill color Cmay be a constant color or a variable color which is adjusted according to the second trace amplitude. The preset negative fill color is preferably a different color than the preset positive fill color and the preset trace color.

In step the second trace amplitude texture coordinate S is again compared to the pixel texture coordinate s . If the second trace amplitude texture coordinate S is equal to the pixel texture coordinate s then the pixel is colored with the preset trace color Cat step and the routine proceeds to step .

In step the pixel is colored with a preset constant background color which may be transparent white or any other desired color corresponding to A s t if the second trace amplitude texture coordinate S is greater than the pixel texture coordinate s . The preset background color is preferably a different color than the preset positive fill color the preset negative fill color and the preset trace color.

In step the pixel color resulting from the routine i.e. the trace color the background color the positive fill color or the negative fill color is applied over a current pixel color on the display device using a Porter Duff over operator and the current pixel color is then set to the resulting color. The Porter Duff over operator is well known in the art and published ISBN 0 201 84840 6 in Computer Graphics Principles and Practice Second Edition at p. 838.

In step an iteration count for the routine is compared to a desired seismic data trace overlap. If the iteration count for the routine is less than the desired seismic data trace overlap then a next trace may be selected at step and the routine is repeated beginning at step . Otherwise the routine proceeds to step which may result in the final pixel color on the display device. The next trace selected in step may be represented as i 1 or i 2 if the iteration count is 1 less than the desired seismic data trace overlap. If the iteration count is 2 less than the desired seismic data trace overlap then the next trace may be represented as i 2 or i 3 and the routine is repeated beginning at step until the iteration count is equal to or greater than the desired seismic data trace overlap.

In step the routine may be repeated for each pixel in the display device that intersects the waveform volume. The resulting image may be displayed as a two dimensional or a three dimensional image of at least a portion of the waveform volume.

As illustrated by the results of the routine in the system and methods of the present invention therefore improve the ability to recognize and process amplitude variation patterns and other attribute anomalies indicative of hydrocarbon resources. Beyond the generation of wiggle displays one can envision a multitude of useful multidata synthetic images that can be generated using the present invention. Multi attribute displays which must currently be computed on the CPU saved to disk and then rendered can instead be rendered directly on the GPU thereby radically reducing the cycle time necessary to gain insight into volumetric data using multiple attributes.

Because the systems and methods described herein may be used to selectively and interactively analyze various types of seismic data traces they may be particularly useful for analyzing medical data or geophysical data however may also find utility for analyzing and interpreting any other type of waveform data.

While the present invention has been described in connection with presently preferred embodiments it will be understood by those skilled in the art that it is not intended to limit the invention to those embodiments. It is therefore contemplated that various alternative embodiments and modifications may be made to the disclosed embodiments without departing from the spirit and scope of the invention defined by the appended claims and equivalents thereof.

