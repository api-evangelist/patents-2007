---

title: Presence status notification from digital endpoint devices through a multi-services gateway device at the user premises
abstract: A gateway device for operation at a user premises to provide and manage application services provided for endpoint devices associated with the gateway device. The gateway device includes a communications client program to enable client-server communications between the gateway device and a remote communications server via the wide area network using a presence and networking message protocol. The gateway device utilizes at least one driver program with a driver communications protocol to communicate with, control, and manage associated endpoint devices. The communications client program interacts with the driver program, and the gateway device is configured to specify which associated endpoint devices, attributes and operations are exposed to the network via the communications client. The gateway device is configured to specify rules for presentation and/or notification of incoming presence and networking messages to the gateway device and the routing of those messages to the managed endpoint device through their respective drivers.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09209995&OS=09209995&RS=09209995
owner: Prodea Systems, Inc.
number: 09209995
owner_city: Richardson
owner_country: US
publication_date: 20070907
---
This application is a United States national phase application of co pending international application Number PCT US2007 019534 filed Sep. 7 2007 which claims the benefit of United States provisional application No. 60 882 865 filed Dec. 29 2006 and U.S. provisional application No. 60 882 862 filed Dec. 29 2006 the disclosures of which is incorporated herein by reference.

The present subject matter relates to a gateway device and or programming for such devices wherein the gateway device is enabled with client programming for client server communications using a presence and networking messaging protocol. The gateway device may be configured by a services subscriber and or service provider to expose the presence and functionalities of one or more associated endpoint devices to local and or remote presence and networking message servers or other devices via a wide area network. The subscriber and or service provider may also configure the gateway to provide notices status or other messages in response to events and may also configure the muting of such messages to particular parties and or devices for display.

The digital home is now becoming more complex with the myriad of new and emerging digital devices and services intended to address many user and consumer needs such as communication entertainment privacy and security etc. These digital devices can be connected with a gateway device in the user premises to form a home network. The digital devices can have a variety of functionalities as well as proprietary interfaces and communication protocols to access such functionalities. Although an increasing number of emerging digital devices are enabled with programming for client server communications using presence and networking message protocols many digital devices rely on proprietary communications protocols and driver programs to allow them to interoperate with devices in a home network.

A home network user may desire to have the associated devices of the home network provide alerts notifications status or other messages to the user in response to particular events and have such messages directed to specific individuals and or digital endpoint devices for display. Upon receipt of such messages the user may desire to provide instructions to one or more of the digital devices of the home network. The user may also desire to determine the status of one or more of the devices of the home network in the absence of an event. The home network user may also desire to remotely handle and or control various endpoint devices associated with a gateway device of the home network. However the user may wish to limit the visibility of specific endpoint devices and their functions to local or remote servers providing applications services or server side presence and networking communications for the home network.

Additionally the user may wish to establish peer to peer communications between the gateway device in the user premises and another local or remote gateway device with associated endpoint devices. The peer to peer connection is desirable as it may enable a user to access the functionalities and status of endpoint devices associated with another gateway. The peer to peer communication is also desirable as it minimizes management of communications between two or more gateway devices.

In that regard it would be desirable to provide a gateway device for a user premises that provides a presence and networking messaging client for client server communications wherein endpoint devices associated with the gateway device may not be enabled themselves with such clients. It may be further desirable to enable a gateway device to be configured by a services subscriber or a service provider to facilitate the handling of events by the gateway and provide notices status or other messages in response to events and route such messages to particular parties and or devices for display. Moreover it may be desirable for associated endpoint devices to communicate with one another via the gateway device without using presence and networking communications. It may be further desirable to enable peer to peer communications between two or more gateway devices.

The technology discussed herein may be embodied in gateway devices typically for deployment at user premises and or to programming for devices that may function as such gateways. The gateway device is implemented in such a manner as to provide client programming to enable client server communications using a presence and networking message protocol. The gateway device may be further configured to have application service logic that functions as an intermediary between associated digital endpoint devices and one or more driver programs. The driver program may communicate with the endpoint device using its own communication protocol. The driver may abstract the functionalities of the endpoint as a set of attributes for the endpoint device. The service subscriber i.e. user or a service provider may configure the gateway so as to control the exposure of the presence and functionalities of the one or more endpoint devices to presence and networking messaging communication servers or other external devices.

Hence in one example a gateway device for operation at a user premises is disclosed to provide and manage application services provided for endpoint devices associated with the gateway device. The gateway device has a first interface for enabling communications within the premises with one or more associated endpoint devices within the premises. The gateway device also has a second interface for enabling bi directional communications for the gateway device via a wide area network. The gateway device further includes a processor coupled to the interfaces and storage coupled to the processor. The gateway device further comprises programming in the storage including a communications client program for configuring the gateway to enable communications via the interfaces and to further enable client server communications between the gateway device and a remote communications server via the wide area network using a presence and networking message protocol. The programming in the storage also includes a driver program for at least one associated endpoint device the driver program enabling communications between the gateway device and the least one associated endpoint device using at least one driver communications protocol wherein the driver program enables the gateway device to control and manage the at least one associated endpoint device using the at least one driver communications protocol. The programming of the gateway device includes application service programming for the application services wherein execution of the programming by the processor causes the gateway device to provide functions via one or both of the interfaces for each respective application service for one or more of the associated endpoint devices using the driver program and the at least one driver communications protocol.

Execution of the programming by the processor causes the gateway device to provide enforcement regarding authorization authentication configuration or use of the respective application service via the associated endpoint devices. The execution of the programming by the processor also causes the gateway device to provide management of the application services based upon the communications with a service management center via the wide area network through the second interface.

The associated endpoint device is typically without communications programming for presence and networking communications. The communications client program of the gateway device may provide presence and networking communications for the driver program wherein the driver program communicates with the associated endpoint device without programming for presence and networking communications via the at least one driver communications protocol. The presence and networking messaging communications may also be provided between the gateway device and the associated endpoint device the endpoint device having communications programming for presence and networking communications via the respective driver program for the associated endpoint device. The presence and networking messaging communications of the gateway device may also be provided between the gateway device and the associated endpoint device where the endpoint device has presence and networking communications programming.

The presence and networking message protocol used by the communications client of the gateway device may comprise an instant messaging type protocol. Endpoint device having presence and networking communications programming may utilize an instant messaging type protocol for communications.

The programming of the gateway device may also enable the first or second interface of the gateway device to establish peer communications using presence and networking message communications of the client server communications between the gateway device and the remote server via the wide area network.

Execution of the programming by the processor further causes the gateway device to support one or more application service interfaces via different endpoint devices using the associated driver program with respect to one or more application services provided through the gateway device. One of the different application service interfaces is a user interface for implementation via a personal computer type endpoint device a cell phone type endpoint device a personal digital assistant endpoint device a remote control type endpoint device or a television or any combination thereof. An alert message or status message may be transmitted from the gateway device using the driver communications protocol to the personal computer cell phone personal digital assistant remote control or the television for display in the user interface or overlaid onto or inserted into a display of the television cell phone personal digital assistant remote control or personal computer. An alert message or status message also may be transmitted from the associated endpoint device via the gateway device using the driver communications protocol to the personal computer cell phone personal digital assistant remote control or the television for display in the user interface or overlaid onto or inserted into a display of the television cell phone personal digital assistant remote control or personal computer. The user interface enabled by the driver program and driver communications protocol enables a user to determine status change a configuration view an event log or any combination thereof for the associated endpoint device.

The exemplary gateway device may further include programming in the storage that has configuration data for management responses and interactions with an associated endpoint device in response to a client server communication between the gateway and the remote communications server via the wide area network using the presence and networking message protocol. The configuration data may be received by the gateway device from a service management center via the wide area network through the second interface of the gateway device. The configuration data also may be received by the gateway device from a user via the first interface second interface or the first and second interfaces. The configuration data and the driver program may also provide a list of functionalities and status of the respective endpoint devices to the communications client program for use with client server communications with the remote communications server via the wide area network.

The programming on the storage of the exemplary gateway device may include configuration data for parameters of access control presentation notification and service for each associated endpoint device.

The exemplary gateway device may be comprised of service logic wherein the service logic processes communications received by the communications client for an associated endpoint device via the driver program.

In addition the communications client of the exemplary gateway device may enable client server communications with a public communications server or a private communications server via the first or second interfaces. The remote communications server may be a presence and networking message server or a service management center.

The driver program of the gateway device may enable communication between a first associated endpoint device and a second associated endpoint device via the at least one driver communications protocol. The first associated endpoint device may transmit an alert message or status message to the second associated endpoint device via the at least one driver communications protocol. The configuration data of the gateway device may provide a list of functionalities and status of the first associated endpoint device to the second associated endpoint device via the at least one driver communications protocol.

The communications client programming of the gateway device that enables client server communications with a remote communications server via the wide area network may further enable communication with a second gateway device via the remote communications server. The communications client programming of the gateway device may receive wide area network address information via the remote communications server from the second gateway device such that the received network address information enables the gateway device to establish peer to peer communication between the gateway device and the second gateway device. The gateway device may transmit a list of functionalities to the second gateway device via the peer to peer communications between the gateway device and the second gateway device. The list of functionalities transmitted may be based upon the associated endpoint devices of the gateway device. The list of functionalities of the associated endpoint device transmitted may also be based on configuration data for each associated endpoint device located in the programming in the storage of the gateway device.

In addition a first endpoint device associated with the gateway device may be a remote control. The gateway device may be enabled to receive a signal from the remote control via the driver communications protocol of the driver program wherein the gateway device may control and manage the second associated endpoint device via the driver program based on the received signal from the remote control.

The disclosure also encompasses program products for implementing gateways of the type outlined above. In such a product the programming is embodied in or carried on a machine readable medium. For example the detailed description discloses an exemplary product comprising a machine readable medium and programming embodied in the medium for gateway device for operation at a user premises to provide and manage application services provided for endpoint devices associated with the gateway device. The gateway device has a first interface for enabling communications within the premises with one or more associated endpoint devices within the premises. The gateway device also has a second interface for enabling bi directional communications for the gateway device via a wide area network. The gateway has a processor coupled to the interfaces wherein the programming is executable by the processor. The programming includes a communications client program for configuring the gateway to enable communications via the interfaces and to further enable client server communications between the gateway device and a remote communications server via the wide area network using a presence and networking message protocol. The programming also includes a driver program for at least one associated endpoint device the driver program enabling communications between the gateway device and the least one associated endpoint device using at least one driver communications protocol wherein the driver program enables the gateway device to control and manage the at least one associated endpoint device using the at least one driver communications protocol. The programming also includes application service programming for the application services wherein execution of the programming by the processor causes the gateway device to provide functions via one or both of the interfaces for each respective application service for one or more of the associated endpoint devices using the driver program and the at least one driver communications protocol.

The detailed description discloses an exemplary system to provide and manage application services for endpoint devices. The system includes a gateway device for operation at a user premises to provide and manage application services provided for endpoint devices associated with the gateway device. The gateway device has a first interface for enabling communications within the premises with one or more associated endpoint devices within the premises. The gateway device also has a second interface for enabling bi directional communications for the gateway device via a wide area network. In addition the gateway device includes a processor coupled to the interfaces storage coupled to the processor and programming in the storage. The programming includes a communications client program for configuring the gateway to enable communications via the interfaces and to further enable client server communications between the gateway device and a remote communications server via the wide area network using a presence and networking message protocol. The programming also includes a driver program for at least one associated endpoint device the driver program enabling communications between the gateway device and the least one associated endpoint device using at least one driver communications protocol wherein the driver program enables the gateway device to control and manage the at least one associated endpoint device using the at least one driver communications protocol. The programming further includes application service programming for the application services wherein execution of the programming by the processor causes the gateway device to provide functions via one or both of the interfaces for each respective application service for one or more of the associated endpoint devices using the driver program and the at least one driver communications protocol. The system also includes a service management system coupled to the wide area network for communication with the gateway device for remotely managing the delivery of the application services via the gateway device.

The service management center of the system may include the remote communications server. Alternatively the remote communications server may be separate from the service management center. In either aforementioned arrangement the remote communications server may be a public communications server or a private communications server.

Additional advantages and novel features will be set forth in part in the description which follows and in part will become apparent to those skilled in the art upon examination of the following and the accompanying drawings or may be learned by production or operation of the examples. The advantages of the present teachings may be realized and attained by practice or use of various aspects of the methodologies instrumentalities and combinations set forth in the detailed examples discussed below.

In the following detailed description numerous specific details are set forth by way of examples in order to provide a thorough understanding of the relevant teachings. However it should be apparent to those skilled in the art that the present teachings may be practiced without such details. In other instances well known methods procedures components and circuitry have been described at a relatively high level without detail in order to avoid unnecessarily obscuring aspects of the present teachings.

The various technologies disclosed herein provide application service logic in a gateway device in the customer premises. The gateway may be enabled with client programming to facilitate client server communications using a presence and networking message protocol. The application service logic of the gateway device may have programming for providing application services and to facilitate communications with the client programming as well as configuration data. The application service logic also serves as an intermediary between the client programming and associated endpoint devices coupled to the gateway device. One or more driver programs enable communications between the endpoint devices and the service logic. The driver program communicates with each device using a proprietary communication protocol. The driver program may also enable associated endpoint devices to communicate with one another.

As directed by the configuration data of the service logic which is established by a service subscriber i.e. user or service provider the presence and or various functions of an endpoint device may be provided to local or remote servers or other devices. The configuration data of the service logic may also provide guidelines for an endpoint device providing status updates notices or other messages to particular users and or particular display devices.

The gateway device is also implemented in such a manner as to offer its user many of the applications services from the user premises. As further described below these application services comprise by way of example programming to simplify support services in the digital home including one or more of media delivery content management access control and use tracking file sharing and protection and back up services of both Internet Web generated digital media content and user generated digital media content. The gateway device is programmed to simplify various aspects of managing the emerging home business digital networks including the myriad of interconnected digital endpoint devices associated with the gateway device. It is important to note that the endpoint devices need not reside within or be located at the premises to maintain their association with the gateway device. The application services offered via the gateway device may be managed by the service management center.

The gateway device and the system architecture effectively place a set of application services on a tightly coupled e.g. always on or always available basis secure hardware platform that is externally managed by the service management center. The gateway device comprises application services programming and associated hardware that is positioned on the user premises side of the Network Service Provider Demarcation which is configured to be managed by an external service management center.

Reference now is made in detail to the examples illustrated in the accompanying drawings and discussed below. is a high level diagram of the architecture of the gateway service management center network as disclosed herein as well as the logical flow of how a specific Application Client residing at a User Premises could interact with an Application Service in a gateway device that is being managed in the gateway service management center network configuration. shows application services that logically reside at the Application Services Layer AS Layer in the User Premises Network i.e. on the hardware components located in the user premises such as by example a gateway device. In particular the programming that implements application services is logically positioned on the user premises side of the Network Service Provider Demarcation. The application service on the user premises side that enforces authorization authentication configuration or use of the respective service via an endpoint device is logically depicted in as the Application Services Enforcement ASE module in the AS Layer of the User Premises Network. The ASE module may also communicate via the wide area network with the Application Services Management ASM logic residing in the service management center.

With reference to the core of the logical capacities of the service management center resides on the Service Provider Network and is depicted as the Application Service Management ASM portion of the Application Service Delivery Platform ASD in the AS Layer. The ASM function is implemented in the service management center which is external to the user premises and on the network side of the demarcation line in . The ASL and ASE functions maintain logical connectivity or interaction with the Application Service Management ASM function in the service management center typically via communication through a wide area network. This logical connectivity is established through an always on or on an as needed periodic basis secure communication channel between the User Premises AS Layer ASL and ASE and the Service Provider AS Layer ASM at the service management center. The service management center and the communications of the center with one or more of the gateway devices provides an infrastructure support and or management of the application services offered to endpoint devices and their users by the logic implemented in the gateway device s . Effectively the ASD considered in its entirety extends all the way to the User Premises and traverses the Network and Network Service Provider Demarcation. The secure communications channel is established through the NF Layer and the NI layer.

The examples discussed herein also introduce a logical platform management layer to the user premises side which allows for inter layer allocation of local resources. This function guarantees access between the Application Service Logic function on the user premises network and the applications service management function in the service management center by assuring that the local user premises hardware and software modules are functioning at a required state CPU and memory usage bandwidth usage QoS settings etc. in order for the ASL to have the necessary resources to establish its required communications path to the ASM.

The platform manager is also responsible for implementing that part of the managed application services to be performed by the gateway device. In that regard the platform manager secures and manages the overall hardware platform given that in this scenario the NF layer and the AS layer reside on one hardware platform. This secure hardware platform provides a robust and secure operating environment for the AS Layer. So to establish a secure and robust hardware operating environment the platform manager must interface with all the layers above it and allow for bi directional management information flow among all of the functions. For example if the Application Client is a telephony application and the desired application is call processing the application must first connect to the LAN termination interface 1 . Then a connection must be established to the AS Layer through the NF layer 2 . At this point the platform manager determines if there are sufficient resources available for this to take place on the routing and switching modules and if there is not sufficient resources on either the LAN Termination interface or the NF layer functions it would take the necessary corrective measure to free up the required resources so that the application can execute properly e.g. prioritize packets throttle bandwidth attempt to reduce noise on an RF interface or free up time slices on a TDMA interface such as MoCA . Once that is done the connection is established to the AS Layer 3 where the ASE and ASL having been updated by the ASM in the network respond instantaneously to the Application Client completing the service request.

Application services represent functionalities implemented in the higher layer s of the protocol or logical stack above the network layer s that may extend up to the top application layer layer 7 of the OSI model . An application service for example provides application server communication with a client functionality of one or more endpoint devices for the respective service communicated on top of network layer communications through the interfaces. In the examples the services are provided on a subscription service basis to users at the premises. Hence the application service logic provides enforcement regarding authorization authentication configuration and or use of the respective service via the endpoint devices. The application service includes service and feature functions implemented and controlled by the application service logic. Management of the application service is based on communications with the service management center via the wide area network.

The illustrated architecture of the gateway device service management center network enables other features and capabilities that have not previously been available to the user. For instance peer to peer application communication between or among gateways is possible without the need to go through or utilize resources at an external service management center or presence and networking message server. Communications through the service management center are also possible. In addition given the considerable functionality present in the gateway device and its ability to manage the various endpoint devices associated with it as explained below the user interface with the gateway can be presented and utilized on the home TV. Additionally information from other endpoint devices such as the PC network sources such as an RSS Really Simple Syndication service may now be overlaid on the TV screen so that for example PC messages or weather information can be viewed on the TV screen and the functionality of the PC or other home networked endpoint devices can be accessed from the TV screen. As described below in connection with gateway device may direct alerts notifications and messages from associated endpoint devices to users and display them on one or more devices as specified by subscribers or service providers in configuration data stored by the gateway device.

As illustrated in gateway device may be configured with a presence and networking message protocol client e.g. IM client that may communicate with a local or remote server e.g. IM server which may be part of IM networks and or as described below or service management center . With IM client gateway device may be configured as an IM endpoint so as to expose one or more resources of associated endpoint devices e.g. devices etc. and or the presence of the associated endpoint devices themselves under the management of gateway device . The management by gateway device of the one or more associated endpoint devices e.g. devices etc. may include for example the routing of notification messages from the associated endpoint devices to users or service providers and file sharing among the endpoint devices. Preferably gateway device does not extend the presence and networking message protocol functionality of IM client to the associated endpoint devices e.g. devices etc. .

As shown in gateway device may be configured with service logic which acts as an intermediary between the IM client and the drivers for the endpoint devices. Application service logic may include programming that interacts with drivers for devices and configuration data . Drivers e.g. driver driver driver may be configured to control and manage the various endpoint devices associated with gateway device . For example driver and may manage devices and respectively. Although not shown in one driver may manage more that one device. Endpoint devices such as endpoint devices and may include any digitally enabled device. Additionally drivers may enable communications between endpoint devices associated with the gateway as discussed in further detail below.

IM client of gateway device may interact with the driver associated with the endpoint device through the implemented application service logic . Service logic is configured to specify which devices attributes and operations are exposed to the IM server via messages with IM client . Through the service management center the service provider may also specify parameters of operation and presentation of application services provisioned by the service provider e.g. using provisioning server . The service logic may include configuration data which may be configured by user or the service provider to specify rules for handling incoming IM messages e.g. IM messages which may be any suitable messages using a presence and networking message protocol such as Instant Messaging to gateway device and the routing of those messages to the appropriate managed endpoint device e.g. endpoint devices etc. using one or more drivers e.g. drivers etc. associated with the endpoint device.

The intermediary service logic in gateway device may be configured by user of gateway device to establish the management parameters of associated digital endpoint devices etc. Configuration data of service logic may store the management parameters for the one or more associated endpoint devices. Thus local or remote IM users via IM server may interact with or manage endpoint devices associated with gateway device that may not be not be enabled with a presence and networking message protocol client e.g. IM client protocol. Thus service provider and user may configure the configuration data of gateway device so as to manage the response of gateway device to an IM event e.g. IM message by providing customized notification from associated endpoint devices as well as management and responses of and interaction with associated endpoint devices.

IM client enables gateway to communicate with other external entities through a local or remote IM server using a presence and networking message protocol e.g. IM protocol . Preferably IM client is the IM client presented to an external entity via IM server . Alternatively one or more endpoint devices may be enabled with an IM client and may be visible to IM server. IM client of gateway device presents endpoint devices e.g. devices etc. and or device functionalities to external endpoint clients communicatively coupled to IM server based upon configuration data in service logic . For example gateway device with IM client may be visible to an external user and the associated endpoint devices of gateway device may not be visible. In a preferred embodiment IM client of gateway device reveals associated endpoint devices it manages based upon configuration data and such that the endpoint devices and their respective functionalities are revealed as attributes and operations of IM client .

Associated with gateway device are one or more endpoint devices e.g. device device device etc. . These devices do not need to be enabled with presence and networking protocol clients e.g. IM clients or function as IM intelligent devices. Although such devices may have IM clients or function as IM intelligent devices the individual devices and their associated functionalities are preferably not presented directly to external clients. Rather the presence and functionalities of these devices are represented by IM client of gateway device as specified by configuration data . Alternatively configuration data may be configured by user or service provider so as to directly present the presence and or functionality of an associated IM intelligent device.

As described herein endpoint devices may become associated with and configured to gateway device . Each endpoint device has an associated driver e.g. driver driver driver etc. which accomplishes the association with and configuration to gateway device . The driver communicates with the device e.g. device device device etc. directly using its own proprietary communication protocol. The driver abstracts the capabilities of the endpoint device with which it is associated to form a set of attributes and operations for that type of endpoint device. For example digital photo frames may have the same kind of driver capabilities but each digital photo frame may have its own particular driver implementation.

Intermediary service logic of gateway device uses the one or more drivers e.g. driver driver driver etc. to communicate with the endpoint devices. The intermediary service logic interacts with one or more drivers through for example a an applications program interface API . Thus specific communication protocols either supported by or utilized by each endpoint device need not reside in intermediary service logic and may reside in the drivers. As discussed above and as illustrated in intermediary service logic may be positioned between the IM client device drivers e.g. drivers etc. . Once an endpoint device is detected by and configured to gateway device intermediary service logic may enable user or the service provider to establish or revise configuration data to what extent if any the presence and or functionalities of the endpoint devices are available via IM client to external entities. Thus user may for example set parameters for access control presentation notification and level of service for one or more endpoint devices. These parameter selections may be stored in configuration data . For example the user can decide who can view the endpoint devices and the attributes and operations exposed to an IM external entity. This arrangement allows the IM client to utilize the endpoint devices and functionalities as well as and present these functionalities as part of the capabilities of gateway device that may be exposed to an external entity. From the perspective of the external entity or external IM server e.g. IM server IM client of gateway device appears as the sole endpoint even though gateway device to utilize the capabilities provided by the associated endpoints.

Intermediary service logic may enable user of gateway device to define the notices and or alerts provided by gateway device in response to an IM event. User may specify various notification protocols which may be stored as configuration data that may be used to determine how gateway device responds to an IM event. For example user may have the ability to establish with configuration data whether notices may be displayed on certain associated endpoint devices e.g. a television PC personal digital assistant cell phone remote control etc. advising of an IM event or inviting a response to an IM event. User may also specify in configuration data whether IM notices may be sent to an external entity with an IM client in response to an IM event whether the notice is informational in nature and that actions in respect to an endpoint device are automatically taken by gateway device or whether a response to the notice is required before any action will be taken. For example notices may be displayed on the TV a particular room when a phone call is received providing the caller s identification and other related information. The notification protocol as defined in configuration data may be programmed to display the notice for a predefined period of time e.g. ten seconds one minute etc. on a television or other display device e.g. cell phone personal digital assistant remote control PC etc. . The notification protocol may require a response by which the call may be answered and the TV programming paused or the call is routed to a voice mail or other messaging storage. Thus configuration data as set by user or service provider may enable gateway device to have an plurality of different options for response to an IM event depending on the nature of the event and the endpoint device indirectly involved. This differs from previous approaches in which notification and messaging protocols are provided through a central IM service.

In an illustrative example a TV digital picture frame and garage door may be devices associated with and configured to gateway device . Application service logic of gateway device may be utilized by user to present to an external IM entity the following as the identified resource 

In the above example user has made configuration selections which may be represented by configuration data such that intermediary service logic may present the garage door but not the TV or digital picture frame to external IM clients i.e. IM clients other than IM client . Instead IM client of gateway device offered to the home user environment by the TV or digital picture frame has been presented. Even though the Garage Door is listed as an endpoint and may be IM enabled the external entity does not communicate with the Garage Door directly. Rather IM client may control and communicate with the Garage Door through the intermediary service logic .

The resources presented to an external IM entity may be dependent on the identity of the IM entity. For example a father and mother may be presented with the Garage Door resource but not their children or those on the roster or buddy list for the registered IM community. Other restrictions that user may implement through the intermediary service logic may allow IM external entities to view identity and state of the endpoint device but in a read only attribute on the IM Client . Therefore the configuration of configuration data may determine the external entities that may directly interact with any endpoint device and the extent of that interaction. The interaction with endpoint devices is governed and managed by the intermediary service logic and associated configuration data .

Along with the resources presented IM client may present corresponding or associated capabilities and states. For example 

Intermediary service logic may further enable user to determine the manner in which an event is handled by gateway device and the associated endpoints. In the preceding example if an external entity sends a digital picture gateway device may be programmed to notify the subscriber e.g. user through messages displayed for example on the TV the picture frame or a cell phone that a digital picture has been offered. The subscriber may elect which associated end point device to display the digital picture e.g. the TV the digital picture frame. Alternatively gateway device may be programmed to display the offered digital picture on a pre selected endpoint device such as the TV upon receipt. The response to each event may be programmed e.g. as part of configuration data to be dependent on the source of the event and or request or the nature of it.

In another example user may decide not to present resources e.g. to IM server via IM Client but may configure the service logic to consider the type of incoming IM message e.g. message for routing to a particular device. For example incoming file shares could be routed to the digital picture frame without an IM external entity being aware that the IM Client has an associated picture frame.

Gateway device may have further programming e.g. the API and drivers as described above that communicates with the endpoint devices e.g. device device device etc. . If the endpoint device is IM enabled the communication may be based on an IM protocol from gateway device . Or it may be based on an alternative communication protocol based on the capabilities of the endpoint device or the programming in service logic . Preferably for IM enabled end point devices the endpoint device does not communicate directly with the external entity but does so through service logic of gateway device .

If the endpoint device is not IM enabled the communication may be facilitated by any appropriate communication protocol. In particular the endpoint device may communicate its state through the associated driver e.g. driver driver driver etc. to the intermediary service logic . Intermediary service logic may exposes the state condition to e.g. as an attribute of IM Client if so configured to do so by user . The endpoint device is thus able to communicate events to gateway device .

As described above the notification protocol as selected or predefined in configuration data may enable IM client of gateway device to determine the recipient e.g. an IM external entity or another associated endpoint device of messages or notification. The messages and or notifications may be endpoint device state notices and messages generated by IM Client in response to IM events. This determination can be made by reference to a roster created by user in accordance with programming selections available by the intermediary service logic wherein the selections may be stored as configuration data . The roster may particularized based on event or endpoint device and may vary depending on the type of event associated with designated end point devices. IM client may automatically inform particular end point devices and or IM external entities of state changes of other end point devices or of IM events or messages received from IM external entities. Because IM external entities may include other gateway devices which in turn have their own associated end point devices it is possible that the programming choices may in response to state changes in one endpoint device associated with gateway device automatically trigger or effect state changes in other gateway device and or endpoint devices associated with other gateway devices.

The gateway device IM server and service management center illustrated in may be used in the context of a home management system. A more specific example of a home management system is described below in connection with which illustrates a home automation control network. Turning to the received event e.g. message may be a state notice from the garage door e.g. device or etc. to the gateway device via a driver program that it is open. Gateway device may determine the user and device associated with the user that should receive the state notice e.g. as directed by configuration data . For example while several cell phones family friends etc. on an IM Roster associated with the gateway device the programming of intermediary service logic gateway device may direct IM client to communicate only to e.g. a mother and father s cell phones regarding the garage door state. The mother may respond by directing the garage door be closed. IM client of gateway device may receive the event e.g. message with the instruction to close the door and intermediary application service logic determines if the event is to be processed and implemented. Having verified the event the instruction is implemented through driver and or API resident on gateway device . The door is closed and the drivers receive state information. The state information may be shared with the intermediary application service logic which determines if the state information is to be communicated based on configuration data . If it is to be communicated service logic determines which associated external entities are to receive that state notice e.g. cell phones for the mother and father of a family .

An event e.g. message as an incoming file instruction state notice etc. arriving at the IM client of the gateway device whether received from an associated endpoint device or from an external entity e.g. IM server is handled and processed by intermediary application service logic of gateway device according to the configuration and programming choices made by user stored in configuration data . User may determine which of the entities are notified of the event how they are notified of the event and the range of responses available to the entity and the endpoint device.

Thus in the arrangement illustrated in the external entity or external IM server e.g. IM server registers IM client of gateway device and associated endpoint devices are not visible from the standpoint of IM server or other external entity. Although the functionalities of one or more endpoint devices may be selected to be available to IM server or other external entity. From the standpoint of user gateway device may be enabled to manage and control one or more associated endpoint devices and utilize them in response to events according to programming or programming selections made by the user and stored e.g. as configuration data .

Gateway device may also be managed by service management center . Thus IM client of gateway device and associated application service logic may be provisioned and governed by the service provider through service management center . This arrangement may enable service provider to set the parameters for access control presentation and level of service which may be stored in configuration data with user able to make programming and service choices within the parameters set by the service provider . The various services available through the gateway device e.g. home automation file sharing video download and the features or capabilities within each of those services may be provisioned configured managed initiated or terminated through service management center . Thus IM Client may be managed externally to provide different levels and types of services and capabilities.

Note that the external IM Server illustrated in can be public e.g. an IM server operated by Yahoo Google MSN etc. or private. In one particular embodiment service management center may be configured to serve as an external but private CM server. This capability is in addition to the management servicing and provisioning capabilities e.g. as with provisioning server of service management center described above. Thus the architecture of the system illustrated in may be configured to enable an established public IM service to provide presence and networking functions to gateway device or it can be configured to have the service management center configured to be a private external IM server. Thus the communication between gateway device and service management center may provide a private proprietary and closed presence and networking message communication system. In addition the IM client server communication link whether public or private may be operated in a secure manner. When service management center is enabled as a private external IM Server the IM client server communications between service management center and gateway device may be private and secure.

Gateway device may facilitate communication between various digital endpoint devices e.g. devices etc. associated with gateway device using drivers e.g. drivers etc. and service logic .

For example device may be a remote control device may be a television and device may be a garage door. A user may use the remote control to make selections of video content for display on the television. A remote control receiver may be communicatively connected to gateway device wherein the receiver has an associated driver program e.g. driver . The driver may process the received signal from the remote as the communication between the device and the driver may utilize a driver communications protocol. The driver may transmit the processed remote signal to programming of service logic to enable the remote to communicate with the television. Programming may determine which endpoint device may receive the processed remote signal as well as determine the application or service that the signal is requesting from the determined endpoint device. For example the signal from the remote may be to direct the television to change the channel. Service logic provides the request from the remote to the driver for the associated television. The driver for the television communicates the request from service logic which was originally from the remote to the television using a driver communication protocol that may be specific for communications between the driver and the television. Upon receipt of the request as facilitated by the driver the television may change the channel as the user had indicated.

Similarly the garage door e.g. device as in the example above may send a notification that the door is open. The notification may be transmitted to the driver e.g. driver of gateway device using a driver communication protocol. The driver may transmit the notification to programming of service logic . Using configuration data programming may determine which endpoint device to direct notification messages from the garage. For example the configuration data may provide instructions that notification messages should be directed to the television e.g. device . Programming directs the notification message to the driver program e.g. driver associated with the television e.g. device . The driver program uses a driver communication protocol to transmit the notification message to the television for display. The television receives the communication from the driver program and presents the notification message for display.

Using the remote control a user may respond to the notification message by selecting a option to change the status of the garage door e.g. either from a selection offered by the notification message displayed or by selecting a menu option with the remote . Thus the remote may provide a signal to the remote control receiver that is communicatively connected to gateway device wherein the receiver has an associated driver program e.g. driver . The driver may process the received signal from the remote as the communication between the device and the driver may utilize a driver communications protocol. The driver may transmit the processed remote signal to programming of service logic to enable the remote to communicate with the garage door via e.g. driver . Driver may utilize a driver communications protocol to communicate to the garage door the command to close the door. Upon receipt of the command via the driver communications protocol the garage door e.g. device may close.

A notification message may be sent from the garage door to driver via the driver communications protocol that the door has been closed. Driver may provide the message to programming which in turn may provide the message to driver . This routing of the message may be for example based at least in part on configuration data . Driver may transmit the message to the television e.g. device via the driver communication protocol for display. Thus the user may be updated as to the change in status of the garage door i.e. status has been changed from open to closed .

In addition the remote control e.g. device may be enabled to facilitate two way communication between the remote control and gateway device via a driver communication protocol and a driver e.g. driver . To enable this communication the remote control may be configured with a display that presents alarm status and or notification messages or any other information to a user. The remote and its associated display may be configured to present a menu to the user for selecting options to display the status of endpoint devices associated with gateway device and enable the user to change the status of the associated devices by providing selections.

A user may determine which messages are to be routed to the remote control by gateway device as well as determine which endpoint devices associated with gateway device may be controlled by the remote by setting various device and messaging parameters in configuration data of gateway device .

Turning to the example above the remote control may provide a signal to gateway device to close the associated garage door endpoint device and may also receive a notification message from the garage door via gateway device that the door has been closed. This notification message may be for example presented on the display of the remote. In another example a user may be notified of the phone number of an incoming phone call which may be displayed on the remote control s display.

Gateway device in conjunction with service management center may deliver application services to associated endpoint devices as described further in connection with .

If configured as a standalone device the NSP TA device is required to have its own CPU Memory physical interfaces and logic control. In order for Network Service Providers to deliver managed services they typically require a management element controlled by the CPU on the NSP TA. To depict these logical elements residing on the hardware components includes an Application Services Layer above the hardware layer. This layer corresponds to the AS Layer of but without reference to any logical elements residing at the network services provider. The management element represented by the Network Service Provider Managed Application allows the network service provider to determine the status of the network hardware device and interfaces as well as maintain a certain degree of security enforcement at the customer premises. As noted the network service functionality is at the NI and NF Layers and generally does not extend to the AS Layer s beyond basic authentication authorization and state management. As with the hardware components the logical elements also have a Network Service Provider Demarcation as shown in . On the WAN side depicted as the Network Service Provider Managed Applications side of the Network Service Provider Demarcation resides the applications that are managed and under the exclusive control of the network service provider the Network Service Provider Logic . The User Interface to Managed Applications is present on the LAN side of the Network Service Provider Demarcation within the Application Services Layer. Within this interface resides programming and logic available to users other than the network service provider referred to as the Network User Controlled Logic. The Network User Controlled Logic which is depicted at the Application Services Layer in provides a user interface to the Network Service Provider Logic and to the extent permitted by the Network Service Provider Logic interaction with or communication between the user and network service provider through the Network User Controlled Logic and the Network Service Provider Logic and to the NSP TA hardware components. The Network User Controlled Logic allows for the User of the hardware to make certain minimal programming changes relevant to their preferences e.g. user name and password changes local IP addresses changes local interface selection . All user devices typically can only communicate with the NSP TA through one or more of the User Premises Network Interfaces. The user can modify the Network User Controlled Logic through the User Premises Network Interface. The Network Service Provider Demarcation is typically within the NSP TA logically dividing the Network Service Provider Interface and the User Premises Network Interface modules. The network service provider does not have any in depth visibility or significant responsibility beyond the Network Service Provider Demarcation.

The User Network and Application Delivery Apparatus UNA DA shown on the right hand side of is a separate managed gateway device that a managed service provider which may be different than the network service provider would control in delivering a set of application services to the user premises. This device is required to have its own dedicated CPU memory logic control as well as its own dedicated set of interfaces. The UNA DA includes one or more Network Interfaces providing connectivity to the NSP TA as well as to user premises endpoint devices. The interfaces provide the LAN Termination functionality at the NI Layer . One skilled in the art will readily recognize however that the physical connection that connects the UNA DA to the NSP TA also provides connectivity for the UNA DA to the public WAN side network and is the means by which the UNA DA accesses the public network. The end point devices connected to the LAN Interface are on the private LAN side of that interface. The UNA DA also includes a switch router or bridge for the NF Layer.

Programming elements of the UNA DA are depicted at the Application Services Layer of the UNA DA. Certain logical elements depicted as the Application Service Provider Managed Applications and Platform in on which resides inter alia the programming corresponding to the ASL and ASE of are managed by the managed application service provider s network control center e.g. by the ASM through a wide area network WAN by means of a control channel to the Application Service Provider Managed Applications and Platform. The Application Service Provider Managed Applications and Platform includes a platform management logic module that with other programming in the Platform and the ASM allows the managed application service provider to control the hardware elements of the UNA DA in addition to any other relevant application services logic or hardware that may reside on the user premises. For example this programming enables managed application service provider to control and manage the hardware elements on the UNA DA to ensure proper use and allocation of the UNA DA s processing memory storage and bandwidth to monitor local hardware security and generate needed alarms or protection sequences and to prioritize applications based on a set of established policies. The user would have control over specific parameters of the UNA DA through the User Interface and Platform to Managed Applications User Controlled Logic shown in . These parameters allow the user to control the local behavior of the interfaces and to configure the specific applications to accommodate the user network as configured by the user and to implement the user preferences for those applications.

To identify the separation of and distinguish between the programming and hardware components subject to control by the managed service provider and those subject to control by the user premises identifies a dividing line across the logical elements of the UNA DA and a corresponding dividing line across hardware components referred to as the Applications Service Provider Demarcation. The Applications Service Provider Demarcation is flexible in that it may extend logically through the Application Services Interface and in a hardware context through the Network Interface to other devices that are under the logical control of the Application Services Provider Managed Applications and Platform given that services are not restricted to a specific hardware boundary.

There is no hard requirement for cross management between the UNDA DA and the NSP TA. Under this first scenario the user is responsible for making the configuration changes in the specific user controlled logic modules in order to get the two devices to communicate with each other. Optionally the two sub systems can be combined together either physically in one hardware device or logically as two separate hardware devices but having one user managed interface.

The two hardware regimes described above NSP TA and the UNA DA may be combined into one managed hardware platform and thereby replace the need for the user to have access to the User Premises Network Interface with the logic residing in the Platform Management logic module of the Application Service Provider Managed Applications and Platform. This would in effect replace the user access with a managed machine access for aspects of the NSP TA as well as aspects of the application services offered through the UNA DA. Thus the combination creates an integral gateway device providing both network service and application services under centralized management. Although integrated network interconnect functions of the NSP TA may still be managed by the network service provider as in the example of . Those skilled in the art will readily see additional combinations and configurations for the hardware comprising the NSP TA and the UNA DA. For example in a further embodiment all the hardware dedicated to the Network Service Provider Interface may reside and be integral with the hardware comprising the UNA DA. Thus the hardware for the WAN interface may reside on the UNA DA.

It may be helpful now to consider more detailed examples of the gateway device service management center network.

Those skilled in the art will recognize that functions of the service management center which reside in the Application Service Management node on the Service Provider Network as depicted in may be implemented in a variety of different ways on one or more computer hardware platforms connected to the gateway devices via a wide area network. depicts an example wherein the implementation is on Internet or other wide area IP network . The example uses a distributed processing approach in which the elements platforms implementing the service management center are interconnected for communication and for wide area communication and in this way those elements form a network for implementing the service management center.

As shown in the service management center network through the logical capabilities earlier depicted in as the ASM module of the ASD Platform at the AS Layer manages application services for a number of gateway devices . . . located at various users premises. These application services shown as ASL and ASE in implement their functionality within the Application Services Layer through programming that resides at least in part within the Application Service Provider Managed Applications and Platform of the UNA DA . As shown in secure connectivity to the service management center network is provided in one embodiment via a WAN Termination interface such as Ethernet WAN over a broadband connection via the public Internet or for example via a wireless EvDO Evolution Data Optimized Internet data interface embodied as a PCMCIA personal computer memory wireless card . When the WAN Termination interface is used for example it may provide connectivity to a broadband modem serving as the NSP TA of either as a separate unit or on a board included within the gateway device . If the wireless WAN interface is used there may be no physical NSP TA device and the logic of the gateway device would implement functions of the NSP TA as well.

As will be described in greater detail herein below the service management center generally provides a communications and processing infrastructure for supporting the variety of application services and related communications residing at the gateway devices . . . . In an exemplary embodiment this infrastructure may be configured to provide a secure environment and may be IP based. Preferably this support architecture is designed for high availability redundancy and cost effective scaling.

The secure platform for building and providing multiple application services for digital endpoints associated with a gateway device requires connectivity between the gateway device and each of a user s devices referred interchangeably herein as endpoint devices or digital endpoint devices . This connectivity may be provided by implementation of one or more USB ports interfaces a wired Local Area Network connection such as provided by an Ethernet local area network LAN interface or a wireless network interface via a WiFi LAN access point provided for example in accordance with the I.E.E.E. 802.11 b g n wireless or wireless network communications standard. These physical interfaces provide the required network interconnectivity for the endpoint devices to connect to the multiple application services. Although not shown in this connectivity between digital endpoint devices and the gateway device may be accomplished by other means including by way of example through of a virtual private area network connection accessed through a WAN interface.

That is the gateway device interfaces with digital endpoint devices including but not limited to a home automation networking device e.g. X10 Z Wave or ZigBee for wired or wireless home network automation and control of networked home devices such as a switch controller sensor devices automatically controlled window blinds a controlled lighting or lamp unit etc individual or wired or wireless network of personal computing PC and laptop mobile devices . . . that serve as file sources control points and hosts for various other client endpoints one or more television display devices including associated set top boxes STB or digital media adapters DMA one or more VoIP phone devices e.g. SIP phones or other devices not shown that convert IP interfaces to PSTN FXO and FXS interfaces.

As noted earlier the gateway device may provide an interface to the Digital Media Adapter DMA for television TV which enables bidirectional wireline or wireless communication. This interface supports several functions for multiple services including but not limited to media e.g. video and music by enabling the transfer of media e.g. video and music to the TV voice services by providing for Called Line ID and for voice mail control and provide Home Automation Services including status and control of networked home automation devices. The DMA element converts audio and video optionally to a format suitable for a TV. In addition the Digital Media Adapter may be capable of receiving context sensitive commands from a remote control device not shown and forwarding those commands to the gateway device . This enables the use of menus on the TV for controlling application services and various features functions thereof as offered by the gateway device . For example the Media Adapter TV combination is able to provide the following features including but not limited to display of media media control functions when enabled FF REW STOP PAUSE etc display of Calling Line Identification CLID control of voicemail picture viewing control of home automation and user functions for the gateway device .

A Set Top Box as shown in also may handle media format conversion for example NTSC to ATSC television RF signals digital decryption and other DRM digital rights management functions and Video On Demand Purchases etc. The Set Top Box TV combination may thus enable by way of example Media format conversion for example NTSC to ATSC decryption other DRM functions such as expiry of leases prohibition of copying to digital outputs function restriction etc. Video On Demand Purchases and media control functions e.g. FF REW STOP PAUSE etc. .

Whether provided by the DMA interface and the TV or by the set top box and the TV the communications to and from the TV provide a user interface for interaction with the gateway device . The programming of the gateway device supports among other things a graphical user interface GUI via the TV sometimes referred to as the ten foot interface.

With respect to PCs interfacing with the gateway device PCs may serve as among other things file sources control points and hosts for various software clients. Thus the PC programming may work in conjunction with the ASL and ASE programming of the gateway device. Together the PC programming and the ASL and ASE programming provide a more comprehensive and robust user experience. The gateway device may further provide a bidirectional wireline or wireless interface to a PC device for supporting the transfer of media e.g. video and music to the computer for storage and viewing for supporting voice services e.g. by providing for calls from SIP soft clients for file sharing file back up and home storage and home automation control functions. The access point offers wireless data communications with a PC . The gateway device interface through any PC may provide for the bidirectional moving of files and status and control for the endpoint devices including for example status and control of networked home automation devices. In addition using the PC interface users may for example share files on the gateway devices back up or transfer files to the gateway devices or other storage access personal page for notifications RSS shared photos voicemail etc. In addition to the IM and SIP capabilities of the gateway device as described more below PCs may also serve as a host for IM and SIP soft phone clients and other client devices. The client server interaction of the PC with the application service logic of the gateway device offers an alternative GUI for at least some of the services. The PC based GUI is sometimes referred to as the two foot interface.

Although not shown in other digital endpoint devices for which connectivity may be established with the gateway device include but are not limited to personal music or media players hi fi audio equipment with media streaming capability game stations Internet radio devices WiFi phones WiFi or other wirelessly enabled digital cameras facsimile machines electronic picture frames health monitors sensor and monitoring devices etc.

As described in greater detail herein the gateway device includes both a hardware and software infrastructure that enables a bridging of the WAN and LAN networks e.g. a proxy function such that control of any digital endpoint device at the premises from the same or remote location is possible via the gateway device using optionally a secure peer and presence type messaging infrastructure or other communications protocols e.g. HTTPS. For example via any IM capable device or client respectively connected with an Instant Messaging IM or XMPP Extensible Messaging and Presence Protocol network messaging infrastructure e.g. IM networks such as provided by Yahoo Microsoft MSN Skype America Online ICQ and the like shown for purposes of illustration in a user may access any type of functionality at a subordinate digital endpoint device at the premises via the gateway device and service management center by simple use of peer and presence messaging protocols. In one exemplary embodiment a peer and presence communications protocol may be used such as Jabber and or XMPP. Particularly Jabber is a set of streaming XML protocols and technologies that enable any two entities on the Internet to exchange messages presence and other structured information in close to real time. The Internet Engineering Task Force IETF has formalized the core XML streaming protocols as an approved instant messaging and presence technology under the name of XMPP Extensible Messaging and Presence Protocol the XMPP specifications of which are incorporated by reference herein as IETF RFC 3920 and RFC 3921. Thus the gateway device is provided with functionality for enabling a user to remotely tap into and initiate functionality of a digital endpoint device or application at the premises via the IM based messaging framework. In addition the gateway device and network connectivity to the novel service management center provides in a preferred embodiment a secure peer and presence messaging framework enabling real time communications among peers via other gateway devices . . . . For instance the device provides the ability to construct communication paths between peers with formal communications exchanges available between for example one gateway device at a first premises and a second gateway device located at the remote premises. Thus such an infrastructure provides for content addressing enabling peers through remote gateway devices . . . . to supply and request content such as files media content or other resources of interest to a community of interest.

As noted above the novel system architecture allocates the logical functionality of the ASD Platform between the gateway device and the service management center within an environment that enables communication and feedback at the AS Layer between the gateway device and service management center . Thus the gateway device when operable with the service management center makes possible the management of services for the digital home and facilitates the easy addition of new services or modification of existing services. Such services may include for example facility management home automation media content downloading and Digital Rights Management DRM device updates data backups file sharing media downloading and transmission etc. without the intermediary of a plurality of external service providers who may typically provide these individual services for every digital endpoint device in the home or premises. The programming for these services resides in the Application Service Provider Managed Applications and Platform of the UNA DA . That is as earlier shown the gateway device is integrated with hardware and software modules and respective interfaces that handle all aspects of home automation and digital endpoint service and management for the home in a manner without having to rely on external service providers and in a manner that is essentially seamless to the user. This advantageously is provided by the service management center which is able to access regions of the gateway device that are not accessible to the user e.g. for controlling the transport and storing of digital content and downloading and enabling service applications and upgrades and providing largely invisible support for many tasks performed by users.

For example with the robust capabilities of the Application Service Provider Managed Applications and Platform the gateway device is capable of handling all aspects of the digital home communications e.g. IP voice VoIP phone connectivity. In this example the service logic located and stored at the gateway device may provide soft switch functionality for implementing call processing features at the premises rather than the network for voice communications and enabling management of other service features to be described. With the provision of central office type call services and other service features provided at the gateway devices . . . a distributed soft switch architecture is built. The ASM logical functionality of the service management center in cooperation with the ASE logical functionality of the gateway device may among other things provide manage and regulate for example service subscription registration authentication verification key management and billing aspects of service provision etc. With all of the service logic and intelligence residing at the gateway device a service provider can offer customers a broad spectrum of services including but not limited to media services voice services e.g. VoIP automated file backup services file sharing digital photo management and sharing gaming parental controls home networking and other features and functions within the home or premises e.g. home monitoring and control . Users can access their content and many of the solution s features remotely. Moreover software updates for the in home devices that require updating are handled in an automated fashion by the system infrastructure. The service management center infrastructure additionally provides a web interface for third party service providers to round out the service solutions provided at the gateway device for the premises. For example a third party service provider other than the managed service provider associated with the service management center may be allowed access through the infrastructure to particular endpoint devices to provide additional services such trouble shooting repair and update services.

The composition of the premises gateway device earlier described with reference to is now described in greater detail with reference to . As shown in the gateway device utilizes a layered architecture which enables the encapsulation of similar functionality and the minimization of dependencies between functions in different layers. depict exemplary functionality hardware and logical resident in or corresponding to each of the layers shown in . The layers include a hardware layer and device driver software for allowing the processor to operate other hardware elements of the gateway device . is a functional block diagram illustrating interconnection of exemplary elements of the hardware layer . The logical elements of the NI Layer residing on the gateway device are found in the Hardware Drivers which govern the operation of the Hardware Components . The processor runs an operating system shown at layer which plays a role in each of the NI NF AS and Platform Management Layers . The layered architecture also includes software for systems services and for the platform management layer shown at in this drawing. Logical elements represented by the NF Layer depicted in are comprised of elements from the system services of . In a similar fashion the Platform Management Layer depicted in is implemented in the exemplary architecture of by the platform modules and the platform management layer .

Particular logical elements comprising the ASL and ASE functionalities of the AS Layer represented in and that reside on the gateway device predominately in the Application Service Provider Managed Applications and Platform of the UNA DA shown in are depicted in and comprise logical elements from each of services framework and application services . The layered architecture in facilitates reuse or sharing of logic across the layers to provide a managed service framework . The service management functionality provided by the framework enables deployment of new services as pluggable modules comprising computer readable instructions data structures program modules objects and other configuration data in a plug and play fashion. The layered service architecture additionally provides the gateway device with intra process communication and inter process communication amongst the many services and modules in the service framework layer that enables the provisioning management and execution of many applications and services depicted e.g. services A B . . . N at the gateway device . Additionally provided are the application service interfaces that enable communications from user endpoint devices with service environments. In that regard the interfaces enable the application service logic to act as an appropriate server with respect to client device application or service functionality of the endpoint devices. The application service interfaces also enable corresponding interfaces for the application services with aspects of service environments implemented outside the user premises. In that regard the interfaces enable the application service logic to act as an appropriate client for extending the application or service related communications to a server accessed via the wide area network such as a server of the service management center . For example the gateway device may appear as a SIP server to a SIP client in an end point device e.g. for a VoIP telephone service but the gateway device will appear as a SIP client with respect to some related functions provided by a server such as a SIP directory server provided by the service management center .

As shown in more detail in the base support layer comprises hardware components including a processor device e.g. a system on chip central processing unit CPU that includes processing elements digital signal processor resources and memory. The CPU is also coupled to a random access memory RAM and additionally non volatile hard drive disk magnetic and or optical disk memory storage . Generally the above identified computer readable media provide non volatile storage of computer readable instructions data structures program modules objects service configuration data and other data for use by the gateway device. The non volatile hard drive disk magnetic and or optical disk memory storage may be partitioned into a network side which is the repository for storing all of the service logic and data associated with executing services subscribed to by the user and is invisible to the user and a user side for storing user generated content and applications in which the user has visibility. Although not shown the CPU may be coupled to a microcontroller for controlling a display device.

Additional hardware components include one or more Ethernet LAN and WAN interface cards e.g. 802.11 T T kb X. DSL or xDSL which may include broadband connections e.g. ISDN Frame Relay ATM Gigabit Ethernet Ethernet over SONET etc. wireless connections or some combination of any or all of the above. The card referred to as the LAN interface card provides data communication connectivity within the user premises essentially for communication via a user premises network with any endpoint devices operating within the premises. The card referred to as the WAN interface card provides data communication connectivity for the gateway device and endpoint devices communicating through the device with the wide area IP network . For additional or alternative customer premises communications the hardware components may also include one or more USB interfaces and for additional or alternative communications with the wide area network the hardware components may also include the PCMCIA EvDO interface card .

A data encryption decryption unit is additionally provided as part of the architecture for providing data security features. A watchdog timer element or like timer reset element is provided as is one or more LED devices for indicating status and other usable information to users of the gateway device .

As mentioned above the gateway device provides an in premises footprint enabling the service connectivity and local management to client s . The implementation of functions and the related control such as a router with quality of service QoS firewall VoIP gateway voice services and voice mail may be embodied and performed within the CPU .

The discussion of the gateway hardware layer above and the illustration thereof in the drawings provides a high level functional disclosure of an example of the hardware that may be used in the gateway device. Those skilled in the art will recognize that the gateway device may utilize other hardware platforms or configurations.

Continuing as shown in the device driver layer comprises a multitude of driver interfaces including but not limited to a PCMCIA driver for enabling low level communication between the gateway CPU and the PCMCIA network interface card wireless interface an IDE driver for enabling low level communication between the gateway CPU and the local mass memory storage element and LAN WAN drivers for enabling low level communication between the gateway CPU and the respective network interface cards and . The exemplary driver layer also includes an LED driver controller for driving LED s a USB driver allowing CPU to communicate via USB interface and an 802.11 b g or n wireless network driver for allowing the CPU to communicate via the access point . The drivers provide the logical connectivity between the low level hardware devices and the operating system which controls the execution of computer programs and provides scheduling input output control file and data management memory management and communication control and related services for the gateway device. With respect to the operating system the gateway computing may support any embedded operating system any real time operating system any open source operating system any proprietary operating system or even any operating systems for mobile computing devices as long as the operational needs of the client discussed herein below can be met. Exemplary operating systems that may be employed include Windows Macintosh Linux or UNIX or even an embedded Linux operating system. For instance the gateway device may be advantageously provided with an embedded operating system that provides operating system functions such as multiple threads first in first out or round robin scheduling semaphores mutexes condition variables message queues etc.

Built upon the system operating system is a system services support layer providing both client like and server like functions that enable a wide range of functionality for the types of services capable of being managed by the gateway device . For instance there is provided a Dynamic Host Configuration Protocol DHCP client and server software modules. The DHCP client particularly requests via a UDP IP User Datagram Protocol Internet Protocol e.g. Ipv4 Ipv6 etc. configured connection information such as the IP address that the gateway device has been dynamically assigned by a DHCP service not shown and or any the subnet mask information the gateway device should be using. The DHCP server dynamically assigns or allocates network IP addresses to subordinate client endpoints on a leased e.g. timed basis. A Virtual Private Network VPN client may communicate via a proxy server in the service control network according to a VPN protocol or some other tunneling or encapsulation protocol. An SMPT client handles incoming outgoing email over TCP in accordance with the Simple Mail Transfer protocol. A Network Time Protocol NTP RFC 1305 generates and correlates timestamps for network events and generally provides time synchronization and distribution for the Internet. A Domain Name Server DNS client and server combination are used by the IP stack to resolve fully qualified host or symbolic names i.e. mapping host names to IP addresses.

An HTTP S server handles secure Hypertext Transfer Protocol HTTP Secure Sockets Layer communications and provides a set of rules for exchanges between a browser client and a server over TCP. It provides for the transfer of information such as hypertext and hypermedia and for the recognition of file types. HTTP provides stateless transactions between the client and server.

A Secure File Transfer Protocol SFTP client and server combination govern the ability for file transfer over TCP. A SAMBA server is an open source program providing Common Internet Files Services CIFS including but not limited to file and print services authentication and authorization name resolution and service announcement browsing . An EvDO PPP driver includes a Point to Point Protocol PPP daemon configuration for wireless broadband services. A PPPoE Point to Point Protocol over Ethernet client combines the Point to Point Protocol PPP commonly used in dialup connections with the Ethernet protocol and it supports and provides authentication and management of multiple broadband subscribers in a local area network without any special support required from either the telephone company or an Internet service provider ISP . The gateway device is thus adapted for connecting multiple computer users on an Ethernet local area network to a remote site through the gateway and can be used to enable all users of an office or home to share a common Digital Subscriber Line DSL cable modem or wireless connection to the Internet. A Secure Shell or SSH server implemented with HTTP protocol provides network protocol functionality adapted for establishing a secure channel between a local and a remote computer and encrypts traffic between secure devices by using public key cryptography to authenticate the remote computer and optionally to allow the remote computer to authenticate the user.

Additionally provided as part of the system services layer is intelligent routing capability provided by an intelligent router device that provides Quality of Service QoS guaranteed bandwidth intelligent routing services for example by enforcing routing protocol rules and supporting unlimited multiple input sources and unlimited multiple destinations and particularly for routing communications to networked digital endpoint devices subordinate to the gateway. A central database server handles all of the database aspects of the system. For example the database server maintains and updates registries and status of connected digital endpoint devices maintains and updates service configuration data services specific data e.g. indexes of backed up files other service specific indexes metadata related to media services etc. and firmware configurations for the devices. The database server may also store billing and transaction detail records and performance diagnostics. The database server logic also satisfies all other database storage needs as will be described in greater detail herein.

Referring back to built on top of the system services layer is the platform module layer . The platform module layer provides a software framework for operating system and communications level platform functionality such as CPU management Timer management memory management functions a firewall a web wall for providing seamless WWW access over visual displays via access technologies enumerated herein e.g. HTTP SMS Short Messaging Service and WAP Wireless Access Protocol QoS management features bandwidth management features and hard disk drive management features. The layered architecture further provides a platform management layer as shown in which together with the platform modules implement the platform management layer logic discussed earlier with regard to .

The features functions in the layer include a platform manager module which will implement unique rules based notification services. On operational failure for example when one of the components or services fails the platform manager would detect this failure and take appropriate action such as implement a sequence of rules to provide notification to a user. A scheduler module manages scheduled device maintenance managing scheduled services e.g. back up services etc. The layer also includes a diagnostics module and a firmware upgrades management module for managing firmware upgrades. A resource management module manages system resources and digital contention amongst the various resources e.g. CPU Bandwidth utilization etc. A display management module and a logger management module store and track gateway log in activity of users and applications e.g. voice call logs at the user premises. The platform management layer in concert with resource and service management components enforces the separation of network side managed service control and user side delegations depending upon service subscriptions and configurations. For example the platform and resource management encompass rules and guidelines provided according to subscribed services that act to enforce manage and control input output operations and use of hard drives space etc. A demarcation point logically depicted as the Application Service Provider Demarcation in is thus defined that provides a hard line between what is owned by the customer and what is owned by the service provider.

The logical platform management layer allows for inter layer allocation of local resources. This function guarantees access between the application service management logic implemented at the higher layers in the gateway device and the applications service management function in the service management center by assuring that the local user premises hardware and software modules are functioning at a required state CPU and memory usage bandwidth usage QoS settings etc. . The platform manager is also responsible for implementing that part of the managed application services to be performed by the gateway device. In that regard the platform manager secures and manages the overall hardware platform given that in this scenario the network function layer and the application service layer reside on one hardware platform. This secure hardware platform provides a robust and secure operating environment for the application services layer. So to establish a secure and robust hardware operating environment the platform management layer must interface with all the layers above it and allow for bi directional management information flow among all of the functions.

Referring back to built on top of the platform management layer is the Services Framework which provides a library of application support service processes that facilitate data collection and data distribution to and from the multimedia endpoint devices. The application support service processes include but are not limited to an authentication manager for use in authenticating devices connected to the gateway device a billing manager for collecting and formatting service records and service usage by endpoint devices e.g. calls back up services etc. a fault manager for detecting and managing determined system and or service faults that are monitored and used for performance monitoring and diagnostics a database manager a control channel interface via which the gateway initiates secure communications with the operations support infrastructure a configuration manager for tracking and maintaining device configuration a user manager a service manager for managing service configuration and firmware versions for subscribed services provided at the gateway device and a statistics manager for collecting and formatting features associated with the gateway device. Statistics may relate to use of one or more services and associated time stamped events that are tracked.

Built on top of the Services Framework layer is the Application Services layer providing library of user application services and application support threads including but not limited to file sharing functionality backup services functionality home storage functionality network device management functionality photo editing functionality home automation functionality media services functionality call processing functionality voice mail and interactive voice response functionality presence and networking functionality parental control functionality and intelligent ads management functionality. The multi services applications gateway further provides application service interfaces that are used to enable a variety of user applications and communications modalities.

For instance the SIP Interface is an interface to the generic transactional model defined by the Session Initiation Protocol SIP that provides a standard for initiating modifying or terminating interactive user sessions that involve one or more multimedia elements that can include voice video instant messaging online games etc. by providing access to dialog functionality from the transaction interface. For instance a SIP signaling interface enables connection to a SIP network that is served by a SIP directory server via a Session Border Controller element in the service management center .

The Web Interface enables HTTP interactions requests and responses between two applications. The Web services interface provides the access interface and manages authentication as multi services gateway devices access the service management center via web services. The IM Interface is a client that enables the multi services gateway device to connect to one or more specific IM network s . As further shown in the UpNp Universal Plug and Play interface enables connectivity to other stand alone devices and PCs from many different vendors.

The XMPP interface is provided to implement the protocol for streaming XML elements via the gateway device in order to exchange messages and presence information in close to real time e.g. between two gateway devices. The core features of XMPP provide the building blocks for many types of near real time applications which may be layered as application services on top of the base TCP IP transport protocol layers by sending application specific data qualified by particular XML namespaces. In the example the XMPP interface provides the basic functionality expected of an instant messaging IM and presence application that enable users to perform the following functions including but not limited to 1 Exchange messages with other users 2 Exchange presence information with other devices 3 Manage subscriptions to and from other users 4 Manage items in a contact list in XMPP this is called a roster and 5 Block communications to or from specific other users by assigning and enforcing privileges to communicate and send or share content amongst users buddies and other devices.

As noted provides a functional block diagram of exemplary elements of the hardware layer . For example a system on a chip provides the CPU and associated system components. The CPU is also coupled to a random access memory RAM and flash memory. The system on a chip also includes a hard drive controller for controlling a hard disk drive and together the controller and drive form the hard disk example of the storage . An Ethernet switch and associated LAN port s provide the Ethernet LAN interface and the Ethernet switch and associated WAN port provide a landline implementation of the WAN interface L for connection to a broadband modem or the like implementing the NSP TA. The WAN interface may also be wireless as implemented at for example by a wireless WAN module and associated antenna. An example of such an interface would be the EvDO interface discussed earlier. If the gateway device uses the wireless WAN interface there would be no separate NSP TA.

In the example of a USB controller in the system on a chip and one or more associated USB ports provide the USB interface . The USB interface may provide an alternate in premises data communication link instead of or in addition to the wired or wireless Ethernet LAN communications. The system on a chip includes a security engine which performs the functions of the data encryption decryption unit .

The hardware layer may also include an option module. The UNA DA hardware components at layer have multiple interfaces for connection to such an option module. These interfaces by way of example could be a data bus e.g. PCI etc network interface e.g. Ethernet RJ45 MoCA HPNA Coax and Power feeds. The option module allows additional functionality to be added to the base UNA DA functionality of the gateway device. For example this additional functionality could be everything from support for a variety of extra Wide Area Network Interfaces e.g. xDSL DOCSIS Fiber PON Cellular Packet WIMAX etc. Media Processing e.g. Cable TV termination Digital Video Recording Satellite TV Termination etc to Voice Processing FXS FXO Speech Detection Voice to Text etc . The option module may have its own standalone CPU Memory I O Storage or provide additional functionality by its use of the CPU Memory I O and storage facilities off of the main hardware board. The option module may or may not be managed directly by the Platform Management of the UNA DA.

For the in home services the multi services gateway device connects the various service delivery elements together for enabling the user to experience a connected digital home where information from one source for example voicemail can be viewed and acted on at another endpoint for example the TV . The multi services gateway device thus hosts the various in home device interfaces and facilitates the moving of information from one point to another. Some of the in home endpoint device processing duties performed by the gateway device include but are not limited to 1 detecting new devices and provide IP addresses dynamically or statically 2 functioning as a Network Address Translator NAT Router and Firewall 3 providing a centralized disk storage in the home 4 obtaining configuration files from the service management center and configuring all in home devices 5 acting as a Registrar for SIP based devices 6 receiving calls from and delivering calls to voice devices providing voicemail services 7 decrypting and securely streaming media having digital rights management DRM encoding 8 distributing media to an appropriate in home device 9 compressing and encrypting files for network back up 10 backing up files to the network directly from gateway device 11 handling home automation schedules and changes in status 12 providing in home personal web based portals for each user 13 providing Parental Control Services e.g. URL filtering etc. 14 creating and transmitting billing records of in home devices including recording and uploading multi service billing event records 15 distributing a PC client to PCs in the home used in support of the various services such as monitoring events or diagnostic agents 16 storing and presenting games that users and buddies can play 17 delivering context sensitive advertising to the endpoint device and 18 delivering notifications to the endpoint device and 19 enabling remote access through the web IM client etc. Other duties the gateway device may perform include service maintenance features such as setting and reporting of alarms and statistics for aggregation perform accessibility testing notify a registration server and Location server of the ports it is listening on utilize IM or like peer and presence communications protocol information for call processing and file sharing services receive provisioning information via the registration server utilize a SIP directory server to make receive calls via the SBC network element to from the PSTN and other gateway device devices and download DRM and non DRM based content and facilitating the DRM key exchanges with media endpoints.

While the gateway devices as described above are each equipped with various logic and intelligence for service features that enable the gateway devices to provide various integrated digital services to the premises as described herein with respect to the network based elements of the service management center supports and manages multi services gateway devices for instance so as to control the accessibility to functionalities and service features provisioned in the gateway devices and the ability to communicate with other gateway devices and various digital endpoint devices connected thereto. These elements that support and manage the gateway devices comprise the ASM module described above with reference to . These ASM elements may for example provide the necessary data to the ASE and ASL modules so that they may carry out their respective functions oversee the overall integration and communication among all the modules and the services that are managed by the ASM manages the overall security and integrity of the ASD and maintains alarm statistical subscription and provisioning data and data necessary for the integration of services from third party service providers e.g. media content aggregators.

Examples of various ASM functionalities performed at the service management center from the Service Provider Network regime include but are not limited to service initialization of the gateway devices providing security for the gateway devices and the network support infrastructure enabling real time secure access and control to and from the gateway devices distributing updates and new service options to the gateway devices providing service access to and from the gateway devices and remote access to the gateway devices but not limited to such. In support of these services the service management center provides the following additional services and features authentication multi service registration subscription control service authorization alarm management remote diagnostic support billing collection and management web services access remote access to gateway devices e.g. via SIP or Internet web based communications reachability to access challenged gateway devices software updates service data distribution location service for all services SIP VoIP service media services backup services sharing services provisioning gateway interfaces to other service providers Northbound and peering load balancing privacy security and network protection.

The logical network architecture for the service management center network delivering these capabilities is illustrated in . It should be understood that the functional components described in view of may be combined and need not be running on discrete platforms or servers. Rather one server or component may provide all the service management center functionalities for providing managed network of gateway devices . In addition any one of the components shown in may perform any one of the functionalities described herein. Thus the description in the present disclosure associating certain functions with certain components are provided for ease of explanation only and the description is not meant to limit the functionalities as being performed by those components only. Thus the network elements or components shown in illustrate logical architecture only and the present teachings do not require the specific components shown to perform specific functionalities described. Moreover the functional components may use distributed processing to achieve a high availability and redundancy capacity.

The one or more network elements of center illustrated in support the gateway devices that are services points of presence in the user premises such as users homes and the various endpoint devices connected thereto. Examples of functionalities provided in the service management center network are discussed below. Upgrades to gateway device firmware and various endpoint devices may be managed in the service management center network for example by a firmware updater server . VOD video on demand functionalities for example serviced by VOD servers VODs ingest wholesale multi media content and provide DRM based premium content to the multi services gateway device and endpoint devices. The service management center network also may enforce DRM Digital Rights Management policies for example by a conditional access CA server which provides key based access and initiating billing processes. The service management center network may also provide functionalities such as collecting billing information and processing billing events which for instance may be handled by billing aggregator sub system . The service management center network for example using one or more connection manager servers may establish and maintain a signaling control channel with each active multi service gateway device . For message routing functionality of the service management center network for example one or more message router devices may provide intelligent message routing service for the network and maintain gateway device presence and registration status in an internal session manager sub system of the service management center . Publish and subscribe functionality of the service management center network for example a Publish Subscribe Pub Sub server sub system may provide publish and subscribe messaging services for the multi services gateway devices and the elements of the service management center network .

The service management center network may provide SIP based directory services for voice and other multimedia services for example via its SIP Directory Server . In addition location service functionality for example provided by the Location Server may include IP and Port level services for all inbound services. As discussed more later the location server maintains information as to accessibility of authenticated gateway devices for enabling peer to peer communications among gateway devices via the wide area IP network . DNS services functionality may be provided by a DNS server for all inbound services.

The service management center network may also provide virtual private network VPN functionalities for example handled by its VPN server subsystem and provide VPN connection services for certain inbound services on multi services gateway devices . VPN connection services may be provided on those multi services gateway devices that have accessibility challenges for example those that are behind external firewalls and NATs. The service management center network may also include functionality for determining the nature of the accessibility configuration for the multi services gateway devices . In one embodiment accessibility service may be performed by an accessibility test server that functions in cooperation with the multi services gateway device to determine the nature of the accessibility. For example the accessibility test determines whether the gateway devices are behind a firewall whether NATs is required etc.

The service management center network also functions to provide provisioning services to all elements of service management center network and to multi services gateway devices . Such functionality of the network for example may be implemented by the provisioning server in one embodiment.

Authentication functionality of the service management center network for example provided by an authentication manager provides authentication services to all service management center network elements and to multi services gateway devices . As discussed more later upon successful authentication of a gateway device the authentication manager controls the connection manager to establish a signaling communication link through the wide area IP network with the authenticated gateway device . The authentication manager confirms authentication of the respective gateway device from time to time and the authentication manager controls the connection manager to maintain a session for the signaling communication link through the wide area IP network with the respective gateway device as long as the authentication manager continues to confirm the authentication of the respective gateway device. The signaling connection may be torn down when the device no longer passes authentication either because it becomes inaccessible to the authentication manager or its service status changes.

The gateway devices and service manager center implement several methodologies that allow the service provider to manage various subscription application services provided for endpoint devices associated with the gateway devices . In general one subscription management methodology involves sending information indicating configuration data or software currently needed for the one gateway device to implement server functionality for an application service or a feature of an application service based on a service subscription of a customer associated with that gateway device. Several different ways of sending this information are discussed by way of example below. A request from a particular gateway device is received in the service management center indicating that the device needs the configuration data or software to implement the application service or feature thereof. In response the service management center sends the necessary configuration data or software through the wide area network to the gateway device . The gateway device can install the configuration data or software to enable that device to deliver the server functionality for the application service or the feature to its associated one or more endpoint device s that implement the client functions regarding the particular application service.

Subscription functionality of the service management center network for example provided by a subscription manager is one mechanism used to provide management of subscription services to all multi services gateway devices . The subscription manager manages applications services and or features of the server functionality of the gateway device to be enabled on each respective authenticated gateway device based on a service subscription associated with the respective device .

The service management center network may include functionality for providing management services for each of the services provided in the gateway device . For example respective service managers store and serve to distribute service specific configuration data to the multi services gateway devices typically via the signaling communication links established through the wide area IP network upon successful device authentication. The configuration data downloads by the service managers are based on the service subscription of the user or premises associated with the particular gateway device that is to say as indicated by the subscription manager .

The service management center network also includes elements to provide necessary software to the gateway devices through the wide area network as needed to implement customers subscription services. In the example the service management center network includes an updater for transmitting software to the gateway devices. The software resident in the gateway device is sometimes referred to as firmware. Software can be distributed upon request from an individual gateway device or as part of a publication procedure to distribute upgrades to any number of the gateway devices. For this approach the publication subscription Pub Sub server or like functionality provides notifications of available software updates. For example upon detecting an update regarding an application service gateway devices subscribing to an update notification service with regard to the relevant application service are identified. The Pub Sub server sends notification messages through the wide area network to the identified gateway devices . Assuming that a notified gateway device does not yet have the software update installed as part of its resident firmware it sends a request indicating that the gateway device needs the available update. In response to the received request the updater sends the update of the software through the wide area network to the one gateway device . The update enables the gateway device to deliver the subscription application service or feature thereof based on the updated software to one or more endpoint devices implementing client functions related to the subscription application service.

Service access test functionality of the service management center network performs tests to multi services gateway devices to verify the accessibility for each subscribed service. Such functionality may be provided by service access test managers . The service management center network for example in an alarm aggregator subsystem may aggregate alarms received from the multi services gateway devices. The service management center network also may include functionalities to support for instance by alarms diagnostics and network management NWM server network management and network management services. The service management center network enables web interface communication mechanism for example via a web services interface server to for example provide access interface and manage authentication as multi services gateway devices access the service management center for various services including access to configuration data in the service managers .

Additional service management center network functionalities shown in may include providing HTTP redirection services for public web access to the multi services gateway devices which function for example may be provided via a public web redirect server . Public SIP Redirect Proxy functionality provides for instance via a Public SIP Redirect Proxy server SIP redirection and proxy services to public remote SIP phones and devices. The service management center network also may include functionalities to provide a SIP based network border interface and billing services for off net voice calls. Such functionality in one embodiment may be provided in a Session Border Controller device . Another functionality of the service management center network may be providing Session Border Control services to SIP roaming SIP callers in certain situations which functionality for example may be provided by a Roaming Session Border Controller device . The service management center network also functions to provide dynamic NAT services during certain SIP roaming scenarios. Such functionality may be implemented in the Roamer Dynamic NAT Server .

The service management center network further may provide off site backup services for the service management center network to a Wholesale Back up Provider . The service management center network further interoperates with Wholesale VoIP Provider which may provide VoIP call origination termination services for off net voice calls. For instance the service management center network may provide VoIP PSTN gateway that enables a translation between protocols inherent to the Internet e.g. voice over Internet protocol and protocols inherent to the PSTN. Other entities that may be partnered with the service management center network as shown in include the content providers that provide media based content including but not limited to music video and gaming to the service management center network gateway interfaces for billing alarms diagnostic network management NWM and provisioning interfaces for partnered wholesale providers e.g. peering interfaces and service provider customers e.g. North bound interfaces .

In the illustrated example a server or servers of the service management center network are intended to represent a general class of data processing device commonly used to run server programming. Such a device typically utilizes general purpose computer hardware to perform its respective server processing functions and to control the attendant communications via the network s . Each such server for example includes a data communication interface for packet data communication. The server hardware also includes a central processing unit CPU in the form of one or more processors for executing program instructions. The server platform typically includes program storage and data storage for various data files to be processed and or communicated by the server although the server often receives programming and data via network communications. The hardware elements operating systems and programming languages of such servers are conventional in nature and it is presumed that those skilled in the art are adequately familiar therewith.

In one embodiment the connection manager may aggregate a plurality of connection channels and multiplex these signaling channels to the message router device . The connection manager works with the message router and the authentication manager to authenticate the multi services gateway device and allow its access to the network by enabling the establishment of a control channel providing an always on control channel between the multi services gateway device and the services service management center once the gateway device is authenticated. The connection managers also provide network security and protection services e.g. for preventing flooding denial of service DOS attacks etc. In one embodiment there may be interfaces such as APIs for interfacing the connection managers or the like to the message routers and the multi services gateway devices . As the network of multi services gateway devices grow the number of connection managers may grow to meet the demand for concurrent signaling control channel connections.

In one embodiment a message router device s provides control signal message routing services and session management services to the multi services gateway device and the other network elements of the service management center . In one embodiment the message router device has control channel signaling access via the control channel to the firmware upgrade manager server or gateway firmware updater VOD server s a billing system content managers pub subs service accessibility test manager authentication manager service manager subscription manager alarms aggregator network management NWM server and public web proxy redirect and the multi services gateway devices . The message router may also include a session manager subsystem that maintains control channel state information about every multi services gateway device client in the gateway service center network. The message router and session manager enable sessions to be established to each multi services gateway device and each element of the service management center and provide robust routing services between all the components. The message routers may additionally connect to other message routers for geographic based scaling creating a single domain based control channel routing infrastructure. The message routers may additionally connect to IM gateways and other message routers that provide user based IM services which may enable users to interact directly with their multi services gateway device via IM user clients. Thus besides providing routing and session management for all the multi services gateway devices and the network elements the message router element enables control signaling between all the network elements and the multi services gateway devices and connects to IM gateways to provide connectivity to other IM federations.

In an example the service management center network may also provide web services interface functionality for example shown at in that forms an application programming interface API between the gateway devices and the service management center network as a mechanism to communicate between the gateway devices and the service management center network. That is in addition to the established signaling control channel the gateway devices and the service management center network may utilize web services interface to communicate. For instance the gateway devices and the service management center network may exchange information via secure HTTP or HTTPS using SOAP XML WSDL etc. or the like.

In one example an authentication key is used or embedded in the message in order to validate the communication between one or more gateway devices and the web services interface functionality in the service management center network . In one embodiment the gateway device may request from the service management center network for instance from its authentication manager functionality a temporary key which is to be used when the gateway device requests services via the web services interface . Preferably this key is not a service specific key but rather identifies a particular gateway device to enter the service management center through the web services interface . Every time the gateway device requests a key the authentication manager functionality may store the key and the expiry time of the key. A response message provided from the authentication manager has the key and expiry time. In one example gateway devices are responsible to determine a status of the key compared to the expiry and to request a new key before the expiry time. In another embodiment the web services interface authentication key may be assigned during initial registration and may be renewable as described above with reference to dynamic renewable authentication and service keys.

The web services interface subsequently directs message requests to the appropriate functionality in the service management center network . The incoming requests may be load balanced in one embodiment by the DNS server and loading and performance information may be fed back to the DNS in support of this function. The web services interface may have interfaces e.g. APIs to the gateway device the authentication manager functionality of the service management center network DNS the service managers of the service management center network etc.

In an exemplary embodiment a gateway device may utilize the web services interface to pull data software or information from the service management center network while the service management center network may utilize the signaling control channel to push data such as various notification data to the gateway devices. In an example discussed more below the subscription manager notifies the gateway device of configuration data applicable to a service subscribed to by the customer associated with the particular gateway device. If the gateway device determines that it needs the configuration data not yet resident or not up to date then the gateway device sends a request to the web services interface which is forwarded to the appropriate service manager . The service manager in turn sends the configuration data to the gateway device for loading and future use. A similar procedure can be used to download software e.g. from a gateway updater or other firmware server based on a descriptor from the subscription manager or a published notification from a Pub Sub server.

In one embodiment a customer or user self provisions endpoint devices on a particular multi services gateway device . The provisioning system or like functionality may provision how many endpoints and the types of devices that can be self provisioned by the user. In one embodiment the gateway devices are capable of automatically discovering and configuring the gateway device compatible devices belonging to enabled services in the premises such as the home or business for instance with minimal human intervention e.g. for security purposes some devices may need administrator level prompting to proceed with configuration actions . For instance the gateway device compatible endpoint devices are devices that the gateway device can communicate with and thus become the center of management for the services offered through these endpoint devices. One or more of these endpoint devices may have automatic configuration capabilities such as universal plug and play e.g. uPNP devices . These endpoint devices may include but are not limited to media adaptors SIP phones home automation controllers adaptors that convert IP interfaces to PSTN FXO and FXS interfaces etc. In one example the method of configuration e.g. automatic discovery and configuration may be based on the specific device s current firmware or software or like version. The gateway device in one embodiment also may keep a record or table of configuration information for example for those devices configured automatically. Such information may include for example for media adaptor supported formats and bit rates for home automation controller information pertaining to the type of controller such as Insteon Awave etc.

As another example if the phone service is enabled and if the gateway device detects a new SIP device the gateway device may prompt a user to determine if the detected endpoint device needs to be configured for association with the gateway device. If it does then the gateway device may configure the detected device on its network home network or other premises network . Yet as another example when new drives are added to the gateway device for storage expansion the gateway device may automate initialization of the expanded device storage.

As mentioned earlier the gateway devices and service management center support a communication capability between the appliances. This feature for example may be utilized for enabling secure peer to peer sharing of data between or among the gateway appliances.

Additional aspects of the peering capabilities enabled by the gateway device service management architecture include the ability to store a roster or contact list of distant gateways on either the gateway or within the service management center and utilizing these addresses to maintain the presence and routing information of selected other gateways. This roster information is used to establish and manage access and message routing via XMPP messaging to gateways to locate and address other gateways and set up peering relationships between the gateways.

A gateway may also expose other details about resources or endpoints within the home to other gateways by communicating resource information along with presence information. As an example a gateway may send presence information to selected buddies via the signaling channel and also include information about the resources available to the distant buddy. Examples of resources include digital picture frames that the distant gateway user may direct photos to web cams or other resources enabling direct interaction between an end user connected to one gateway or in automated scenarios the gateway itself and a distant device connected to the local area network of another gateway.

When a user interacts with the resource sharing functions of their gateway the user may select a specific gateway from their roster represented as a buddy list. When the user selects a buddy additional resource details are displayed to the user providing information about any resources that the end user may utilize via that selected peer gateway device .

The XMPP messaging protocol combined with the roster and XMPP addressing mechanisms may be utilized for either end user interactions or automated interactions between gateways. Automated use of the peering capabilities include directing utility data for usage and network management information to designated collectors within peering groups and then having the designated collector forward the combined information to the service management center. This distributes the collection processing to the gateways and decreases the overall processing and bandwidth utilization in the service management center. Of course the XMPP protocol is discussed here merely by way of example and those skilled in the art will recognize that the gateway to gateway device communications may use other protocols.

Upon gateway device establishing initial communication with selected remote gateways e.g. gateway device etc as shown in and devices via service management center gateway device may negotiate a direct signaling communication path with one or more remote gateway devices. The signaling path may be independent of service management center IM networks or or IM server . Establishing a direct signaling channel between gateway devices may reduce the messaging load on service management center IM networks or or on IM server

An Application and Network Gateway ANG e.g. gateway device etc. may be located for example in a user premises. The ANG may have associated endpoint devices and be managed by an Application Services Provider e.g. the application service may be delivered via the application services layer by application service management center or may be IM networks or or IM server . An application network gateway management connection server MCS may be used to establish a connection with one or more ANGs wherein the established connection may be secure or unsecure. The MCS may be a component of application service management center IM networks or or IM server . This connection between the MCS and the ANGs allows each ANG to register its local information e.g. Internet Protocol IP address Application Ports Availability and other attributes with the MCS. Additionally when ANGs desire to locate each other e.g. to establish peer to peer connections for communication they may retrieve the distant end ANG information from the MCS.

Location updates may be performed at ANG Startup or when IP or Port changes occur at the AGN. There may be no predefined time of the validity of the addresses. For example the last update may be considered valid for an indefinite period of time. Thus in this example the AGN does not need to update location information on a periodic basis.

A Location Server may maintain the location information for all the ANGs in the network. A Session Redirect Server SRS and SRS database may store service specific authentication and routing information. The SRS and SRS database may be part of the Applications Services Provider.

At step shown in the ANG may initialize or establish a messaging connection with the MCS of the Applications Service Provider. This connection may be either a secure or unsecure connection. At step the secure messaging and presence connection is established between the ANG and the MCS and the session communication endpoint may be established. At step the location update of the ANG with the location server of the Application Services Provider is established as being valid until for example further updates are provided by the ANG or until the session is disconnected. The SRS of the Application Services Provider may be updated with a new IP and port address for ANG of Home at step . Also a unique identifier tag for the ANG may be established in the SRS database.

At step shown in the ANG may initiate an IP address change. At step the SRS may be updated with the new WAN IP and Port Address for the ANG of Home . The ANG may have a unique identifier tag in the SRS database for which this updated information is associated with. If the WAN connection between the ANG and the Application Services Provider is severed disrupted or otherwise unavailable i.e. the connection is down at step the MCS may detect that the presence and networking messaging channel is unavailable at step . At step the SRS may be updated to indicate that it is not available because the WAN connection with the ANG with a particular identifier tag is unavailable. The SRS database fields may be updated to indicate that the availability status of the identified ANG has changed.

As shown at step of the ANG of Home may establish a presence and networking message communication connection with a presence and networking message server e.g IM server or a presence and networking server that is part of service management center etc. . At step buddies in the buddy list of the ANG in Home may be notified of the ANG s presence as well as display the services offered by the ANG via the presence and networking message server. At step the ANG at Home may set up and establish a presence and networking message connection with the presence and networking message server. The ANG of Home at step may notify buddies of its presence as well as present its services that are available. At step the ANG of Home may update the routing table with the remote ANG i.e. the ANG of Home address changes as provided by the presence and networking message server. At step the ANG of Home may provide service details such as IP address and port information to the ANG of Home via the presence and networking server. The ANG of Home at step may update the routing table with the address changes of the ANG of Home .

As shown in the ANG of Home and the ANG of Home may establish a peer to peer presence and networking message connection between each other. The peer to peer connection may be established upon each ANG locating the other via the presence and networking message server or the service management center. Upon obtaining the routing information each ANG may use the routing information to establish subsequent peer to peer sessions until there is an endpoint status change.

At step illustrated in the ANG of Home may setup a presence and networking communication connection which may be secure or unsecure with the presence and networking messaging server. At step the ANG of Home may notify presence and networking message server of the presence of the ANG as well as provide peer to peer connection information e.g. IP address port etc. . Next at step ANG of Home may setup and establish a presence and networking message connection with presence and networking message server. ANG of Home may then notify buddies on the buddy list of the ANG s presence as well as present peer to peer connection information to the presence and networking message server at step . The presence and networking message server at step may provide the peer to peer connection information e.g. of the ANG of Home to ANG of Home and the ANG of Home may update the route table with address changes. The ANG of Home may present the peer to peer connection information for a buddy e.g. ANG of Home via the presence and networking server at step . ANG of Home may update the route table with the address change information from ANG of Home at step . Next at step a peer to peer control channel may be established between ANG of Home and ANG of Home . ANGs of Home and Home may then present services and service details e.g. resource identifier information IP address port information etc. to one another at step .

In providing peer to peer communications between gateway devices a user of a first gateway device may control associated endpoint devices of a second gateway device provided such endpoint devices and or their functionalities are provided to the first gateway device. This may be based for example on the second gateway device being present in the buddy list of the first gateway device. For example a user of the first gateway may control an endpoint device that is a garage door associated with a second gateway device. The user may determine the status of the garage door e.g. open closed etc. and may provide instructions to the garage door to open or close e.g. based upon the received status information .

The gateway device and its interactions with various endpoint devices and with the service management center have been described with reference to diagrams of methods apparatus systems and computer program products. It will be understood that elements and functions illustrated in the diagrams can be implemented by computer program instructions running on one or more appropriately configured hardware platforms e.g. to operate as a gateway device or as one or more of the enumerated elements of the service management center . Hence operations described above may be carried out by execution of software firmware or microcode operating on a computer other programmable device of any type. Additionally code for implementing such operations may comprise computer instruction in any form e.g. source code object code interpreted code etc. stored in or carried by any computer or machine readable medium.

As described above in connection with the gateway device may be the central communication platform that interoperates with multiple devices in the home to form a home networking environment. provides an exemplary home network that includes a home automated control.

In central to the communication platform functionality is the provisioning of IM client functionality at the gateway device . IM client functionality may be enabled for client server communications with an IM server e.g. which may be part of IM networks and or of . IM server may be a publicly accessible IM server e.g. Yahoo IM network MSN IM network etc. or may be a privately accessible IM server either of which may be remotely located. IM server whether in a publicly or privately accessibly form may enable communications between a remote IM client e.g. IM client etc. and IM client of gateway for example via a wide area network. IM client may communicate with endpoint devices e.g. device etc. that may be part of home automation network via IM server . Communication messages from IM client may be directed by IM server to IM client of gateway device . Home automation controller and device driver may process the communication messages for endpoint devices e.g. device of home automation network . As endpoint devices of home automation network may not be enabled with IM client programming and thus may not communicate with other IM devices using a presence and networking messaging protocol e.g. an Instant Messaging protocol device driver may provide the communications to a respective endpoint device in the home automation network using a device driver communication protocol. Messages from one or more endpoint devices e.g. endpoint device such as alert messages status messages or other communications may be received by home automation control node and then transmitted to device driver of gateway device . Home automation controller may be configured to direct the received message to a remote IM client. Accordingly IM client may package the message received from the endpoint device into a message that may be transmitted using a presence and networking message protocol.

In the context of home automation in the gateway appliance is additionally provisioned with a home automation controller device that communicates with the IM client function to facilitate home network management including a home automation controller that interfaces with a TV Web interface that interfaces with the digital media adaptor component and a device driver that interfaces with the home automation network e.g. Zigbee network via a home automation control node that is responsible for communicating with the smart devices designed for home automation. The digital media adaptor component further communicates with the TV device at the premises and the TV Web interface further interfaces with the computing device e.g. PC at the premises. Further the IM client functionality interfaces with an IM client that is either local at the premises or remote and may include a SIP phone or a PC.

In the context of home automation services the appliance supports multiple types of home automation controllers and multiple protocol standards including a variety of non IP protocol standards and vendor specific proprietary protocols such as Insteon Zwave etc. This enables the user to integrate multiple vendor devices in the home. It is further understood that the controller device itself may support more than one automation protocol such as Insteon or legacy x10 devices and these protocols will be transported via RF or other suitable communication path. The gateway appliance may communicate with controllers via vendor specific protocols.

Via the IM client functionality and IM server the local or remote IM client may be provided with IM based state notification messages e.g. messages of any alarm generated. Although such messages may not be initially transmitted using a presence and networking message protocol e.g. IM protocol gateway may be configured such that IM client may transmit the messages e.g. alert messages etc. received from messages to for example IM client device using a presence and networking message protocol. The IM client device may receive device state notification messages via the appliance s e mail application a phone call or at a PC directly. Thus when events are detected for example a change in the device s status or parameter s the gateway appliance generates alert notifications via the notification manager which is part of the presence and networking module shown in for receipt at the IM client device via IM server.

Moreover as shown in via the IM client functionality a user may control home networking devices or home automation devices locally or remotely. For example this functionality specifically enables a user to configure and control networking devices and home automation devices e.g. networked light switch controlling light fixture to show up as controllable entities via a list not shown on another device e.g. the PC or television via digital media adaptor such as shown in . Thus users receive immediate notifications of changes or check on connectivity or status of the home devices via communications from the gateway . Thus gateway device may be programmed through a service offering or as a default to enable the notification directly on the TV via overlay onto a video signal at the home.

Additionally gateway device through its device registry which is part of the presence and networking module e.g. IM client etc. provides a list of the device state parameters status of many devices that are connected to the gateway for additional control services e.g. via a local PC client notification message . One example of such a notification is shown in which depicts an exemplary user interface showing a generated list of devices connected to the gateway and their current status. Although devices connected to home automation control network may not have presence and network message capabilities device driver may communicate with each endpoint device of home automation control network to determine the status and functionalities of the endpoint device and provide the status and functionality information to a local or remote IM client device e.g. IM client device .

As described herein gateway device may have a configuration data file e.g. similar to configuration data shown in that may be accessible by a user of gateway or by a service provider where the configuration file data is configurable so as to indicate the level of transparency of whether an endpoint device is connected to the home automation network what features are available what the status of the endpoint device is etc. User interface as illustrated in may be used to configure various endpoint devices.

For example as shown in the presented columns include the device device identifier the device status e.g. ON OFF a type of device it is and its scheduled operation activity. Using the interface a user may be able to control or change the status of a device e.g. lights by selecting on off functionality embodied as user selectable buttons . The home automation controller functionality of the gateway appliance responds by generating appropriate signals that are forwarded to the home automation control node to effect the status change of a particular device. In one embodiment an additional control interface is provided to effect a change in analog type devices e.g. dimmer switch.

Thus in using the exemplary interface a user may check on the status of each of these devices and send commands to change the status information. Any change in status of these devices will come as notifications or alerts. For example an assisted living device e.g. a sensor monitors user behavior or biological function and checks behavioral patterns against stored patterns. If there is determined a break in the pattern when detected by the system an automatic notification may be generated and provided to a user endpoint device e.g. the PC or TV etc.

As described herein with respect to file and content sharing the gateway appliances are able to communicate with each other to share information through using IM clients at each gateway device wherein presence and networking messages are sent via an IM server to one more gateway devices IM server functionality provided at the appliance. The messages and commands may be communicated through a secure network connection.

As described above in connection with the home automation service network is supported at least in part by gateway appliance wherein the home automation service may be accessible by a user through a presence and networking protocol client e.g. IM client from a PC or any other suitable interface. Particularly the gateway appliance may be configured to appear as a buddy in the user s buddy list. However as the one or more of the endpoint device connected to gateway device do not themselves have presence and networking message capabilities they may not appear in the buddy list. The gateway appliance may provide a listing of endpoint devices and their functions to a local or remote IM client. Which endpoint devices are visible by a remote client as well as their respective available functions may be as described above configurable by a user or by a service provider. The name for the gateway appliance itself as it appears in an IM buddy client list is also configurable.

Once a user selects the gateway appliance buddy from the buddy list a number of events may occur. The user may enter into an IM chat mode. A menu option such as home automation may be presented to the user. Upon selection of the home automation option the user may be prompted for a password. Once password authenticated the user is capable of requesting status of one or more of the endpoint devices of the home automation network that are configured to be visible during an IM session and report status information. The user may also change the status of a selected device and may elect to receive notifications from a device e.g. a user may update a configuration of the gateway device such that associated endpoint devices may provide notifications . An exemplary IM interface dialog may be presented to the user that displays one or more of the following whether any events have occurred in which may require user input such that the user is prompted to enter an instruction request a Status Check Change a device status and Review an event log. In one example upon selection of change device status request the user is prompted to select from options such as device type e.g. light switch garage door outlet sprinkler system etc. a Main Menu option or any other suitable option. Furthermore in one example upon selection of a device e.g. a garage door etc. the user is prompted with additional selection options related to the first selection e.g. select a first garage door a second garage door etc. . Thus the user interaction with gateway appliance and associated endpoint devices may text based and or menu driven.

Program aspects of the technology may be thought of a products typically in the form of executable code and or associated data for implementing desired functionality which is carried on or embodied in a type of machine readable medium. In this way computer program instructions may be provided to a processor of a general purpose computer special purpose computer embedded processor or other programmable data processing apparatus to produce a machine such that the instructions which execute via the processor of the computer or other programmable data processing apparatus so as to implement functions described above.

Terms regarding computer or machine readable medium or media as used herein therefore relate to any storage medium and any physical or carrier wave transmission medium which participates in providing instructions or code or data to a processor for execution or processing. Storage media include any or all of the memory of the gateway device or associated modules thereof or any of the hardware platforms as may be used in the service management center such as various semiconductor memories tape drives disk drives and the like which may provide storage at any time for the software programming. All or portions of the software may at times be communicated through the Internet or various other telecommunication networks. Such communications for example may enable loading of the software from one computer into another computer for example from the updater a hardware platform for a gateway device or from another source into an element of the service management center . Thus another type of media that may bear the software elements includes optical electrical and electromagnetic waves such as used across physical interfaces between local devices through wired and optical landline networks and over various air links. The physical elements that carry such waves such as wired or wireless links optical links or the like also may be considered as media bearing the software. Hence the broad class of media that may bear the instructions or data encompass many forms including but not limited to non volatile storage media volatile storage media as well as carrier wave and physical forms of transmission media.

Those skilled in the art will recognize that the teachings of this disclosure may be modified extended and or applied in a variety of ways. An extension of the system architecture for example provides the ability of various and disparate third party application service providers to provide multiple application services independently. Application services are managed by the managed service provider through the service management center meaning generally authorizing provisioning and monitoring the usage of a particular application service. This can be accomplished in a variety of ways with varying degrees of involvement of or coordination with the service management center. The service management center could manage these items soup to nuts or have minimal involvement. For example the service management center could deal directly with the third party service provider to acquire application services at the request of a user and manage the delivery authorization usage monitoring and upgrading of the application service. At the other end of the spectrum the managed service provider may have arrangements with the third party application service provider by which orders or requests from the users may come directly to the third party application service provider and services are delivered to the user by the third party service provider who in turn coordinates with the managed service provider to register and monitor the particular application service placed in the gateway device . It should be noted that this ability to manage application services extends through the gateway device into the endpoint devices registered or associated with the gateway or network.

While the foregoing has described what are considered to be the best mode and or other examples it is understood that various modifications may be made therein and that the subject matter disclosed herein may be implemented in various forms and examples and that the teachings may be applied in numerous applications only some of which have been described herein. It is intended by the following claims to claim any and all applications modifications and variations that fall within the true scope of the present teachings.

