---

title: Method and system of providing landline equivalent location information over an integrated communication system
abstract: Some embodiments provide a method and apparatus for seamlessly providing the location of user equipment of a first communication network while accessing a second different communication network. The first and second communication networks may include licensed wireless networks, unlicensed wireless networks, or internet protocol (IP) networks, to name a few. Furthermore, some embodiments provide a civic address as the location information for identifying the location of the caller.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07885644&OS=07885644&RS=07885644
owner: Kineto Wireless, Inc.
number: 07885644
owner_city: Milpitas
owner_country: US
publication_date: 20070407
---
This application claims benefit to U.S. Provisional Patent Application 60 744 440 filed Apr. 7 2006. This United States Provisional Patent Application is incorporated herein by reference. Moreover this application is a Continuation in Part of U.S. patent application Ser. No. 11 096 800 entitled Method and System for Determining the Location of an Unlicensed Mobile Access Subscriber filed Mar. 31 2005 now issued as U.S. Pat. No. 7 369 859 which is a Continuation in Part of U.S. patent application Ser. No. 11 013 883 entitled Apparatus and Method for Extending the Coverage Area of A Licensed Wireless Communication System Using an Unlicensed Wireless Communication System filed Dec. 15 2004 now issued as U.S. Pat. No. 7 640 008 which is a Continuation in Part of U.S. patent application Ser. No. 10 688 470 entitled Apparatus and Method for Extending the Coverage Area of a Licensed Wireless Communication System Using an Unlicensed Wireless Communication System filed Oct. 17 2003 now issued as U.S. Pat. No. 7 127 250 which claims the benefit of U.S. Provisional Application Ser. No. 60 419 785 entitled Method for Extending the Coverage Area of a Licensed Wireless Communication System Using an Unlicensed Wireless Communications System filed Oct. 18 2002.

The present invention relates to telecommunications. More particularly it relates to providing landline equivalent location based services over an integrated communication system.

The effectiveness of emergency services resides in the ability of the service to deliver the telephone number and location information of the caller seeking assistance to the appropriate emergency services personnel such as police fire and medical assistance. Emergency services have evolved to accommodate and adapt to the gradual emergence of mobile communication services over traditional wired landline telephone services. For example the 911 service in the United States has been modified to what is now referred to as enhanced 911 E911 in order to allow licensed wireless network operators the capability to provide location information of a licensed wireless caller to the appropriate emergency services personnel.

Traditional wired telephone landlines have associated physical address locations making the identification of emergency calls from such locations a relatively trivial matter. When the emergency call is placed from a landline the call is routed to an assigned local Public Safety Access Point PSAP that is closest to the caller. Prior to dispatching the call to the PSAP the telephone number of the caller is used to query an Automatic Location Identification ALI database. The telephone number or an associated index is passed to the PSAP which then uses the information to retrieve the location or address associated with the telephone number from the ALI database. This information then permits emergency dispatchers to coordinate and send the appropriate emergency personnel to assist the caller.

Such emergency services had to be refined to become compatible with the emergence of mobile communication technology. Mobile communication devices such as cellular telephones wireless enabled personal digital assistants and the like no longer confined callers to a physical address when placing calls. In fact the mobile devices allowed the callers to cross PSAP regions cities states and even countries. Therefore in creating the new integrated emergency systems various regulations were set forth. For instance the E911 emergency system of the United States came forth as a result of the Federal Communication Commission s FCC issued E911 regulations.

E911 sought to alleviate the problem of locating mobile telephone users during an emergency call in two phases. In the first phase E911 sought to establish selective routing of an emergency call from any device whether landline wireless or voice over IP VoIP to a PSAP nearest to the caller. Additionally the first phase sought to provide location information associated with the caller irrespective of the device used in placing the emergency services call. The first phase required that the location of the nearest licensed wireless base transceiver station BTS be provided for a licensed wireless emergency caller. The second phase required service providers to identify the location of licensed wireless callers to within a specified distance of the actual location from where the emergency call originated.

In response licensed wireless networks now support various standardized methods for determining the location of the caller. These methods typically include location estimates based on latitude and longitude coordinates of the caller determined through Assisted GPS AGPS Angle of Arrival AOA Enhanced Observed Time Difference E OTD Cell Identity plus Timing Advance Cell ID TA and Time Difference of Arrival TDOA techniques. These techniques involve interaction between the subscriber s wireless device and systems in the network and generally are dependent on measurements of the licensed radio access network RAN signals from the wireless device. A particular service provider may implement one or more of these techniques in its network in order to determine the latitude and longitude coordinates of the caller.

However new wireless communication technologies continue to emerge that require integration with the aforementioned emergency response systems and location based services. One such technology is an integrated communication network for allowing user equipment of a first communication network to seamlessly communicate through a second different communication network. An example of an integrated communication system is the universal mobile access UMA also known as unlicensed mobile access and generic access architecture which in one implementation permits a licensed wireless communication device to communicate over an unlicensed wireless network. In this manner the location based techniques discussed above for the licensed wireless networks cannot be used when the communication device is communicating over the UMA network as opposed to the licensed RAN. This leads to the problem of how to determine the location of the user equipment when it is operating in UMA mode.

Furthermore while the E911 solution for a licensed wireless communication device provides location information accurate to within a specified distance e.g. latitude and longitude coordinates a need nevertheless exists for more specific location information. Specifically providing emergency responders with a civic address similar to those provided through wired landline services as opposed to the latitude and longitude coordinates of licensed wireless networks would allow quicker response times in emergency situations.

Some embodiments provide a method and apparatus for seamlessly providing the location of user equipment of a first communication network while accessing a second different communication network. The first and second communication networks may include licensed wireless networks unlicensed wireless networks or internet protocol IP networks to name a few. Furthermore some embodiments provide a civic address as the location information for identifying the location of the caller.

In the following description numerous details are set forth for the purpose of explanation. However one of ordinary skill in the art will realize that the invention may be practiced without the use of these specific details. In other instances well known structures and devices are shown in block diagram form in order not to obscure the description of the invention with unnecessary detail. Moreover throughout the following description acronyms commonly used in the telecommunications industry for wireless services are utilized along with acronyms specific to the present invention. A table of acronyms specific to this application is included in Appendix I. A listing of cited references is included in Appendix II.

Some embodiments provide a method and apparatus for seamlessly providing the location of user equipment of a first communication network while accessing a second different communication network. The first and second communication networks may include licensed wireless networks unlicensed wireless networks or internet protocol IP networks to name a few. Furthermore some embodiments provide a civic address as the location information for identifying the location of the caller.

In some embodiments the user equipment UE includes various communication devices that operate in either an unlicensed wireless network or licensed wireless network. However when the user equipment is within range of an integrated communication system ICS the user equipment may establish a communication session over a different communication network. For example the ICS of some embodiments seamlessly integrates and establishes communication sessions of a licensed wireless device through an unlicensed communication network. In some embodiments the user equipment includes a cellular telephone smart phone personal digital assistant dual mode handset WiFi handset or computer equipped with a subscriber identity mobile SIM card for communicating over the licensed or unlicensed wireless networks. Moreover in some embodiments the computer equipped with the SIM card communicates through a wired communication network.

Alternatively in some embodiments the user equipment includes a fixed wireless device providing a set of terminal adapter functions for connecting Integrated Services Digital Network ISDN Session Initiation Protocol SIP or Plain Old Telephone Service POTS terminals to the ICS. Application of the present invention to this type of device enables the wireless service provider to offer the so called landline replacement service to users even for user locations not sufficiently covered by the licensed wireless network. Moreover some embodiments of the terminal adapters are fixed wired devices for connecting ISDN SIP or POTS terminals to a different communication network e.g. IP network though alternate embodiments of the terminal adapters provide wireless equivalent functionality for connecting through unlicensed or licensed wireless networks.

In some embodiments the unlicensed wireless network is a short range unlicensed wireless network facilitated by a radio link employing a wavelength or wavelength range in a free spectrum e.g. spectrum around 2.4 GHz 5 GHz 11 66 GHz . An unlicensed wireless service hosting an unlicensed wireless channel may have an associated communication protocol. As an example the unlicensed wireless service may be a wireless local area network LAN WiFi service e.g. the IEEE 802.11a b n or g wireless standard .

In some embodiments the licensed wireless network is a GSM or GPRS type wireless network serviced by wireless providers. However one of ordinary skill in the art will recognize that the invention can be embodied through any user equipment or other communication network compatible with the ICS without departing from the spirit of the invention.

In some embodiments the seamless interface for establishing a communication session of a first communication network across a second different network is through an access point AP . In some embodiments the AP creates an unlicensed wireless network through which communication sessions established over the unlicensed wireless network are routed through an IP broadband network.

Alternatively in some embodiments the AP is referred to as a femtocell access point FAP . The FAP creates a short range licensed wireless network that operates independent from any licensed wireless network of a service provider. The FAP then routes communication sessions established over the short range licensed wireless network through an IP broadband network. For example a licensed wireless device e.g. GSM or UMTS cellular telephone when in range of the FAP may bypass the wide area licensed wireless network of the licensed service provider and instead establish the communication session transparently through the short range licensed wireless network of the FAP. The FAP then transparently routes the communication session over the IP network instead of the licensed wireless network of the service provider. In this manner the licensed wireless device can communicate over two different communication networks without requiring any changes to the user equipment.

Such added functionality provides the user with potentially improved quality of service in the service regions of the unlicensed or short range licensed wireless network i.e. within the service range of a corresponding AP FAP . Thus when a subscriber is within range of the AP FAP the subscriber enjoys low cost high speed and high quality voice and data services. In addition the subscriber enjoys extended service range since the handset can receive services deep within a building at locations that otherwise may not be reliably serviced by a wide area licensed wireless network service provider. At the same time the subscriber can roam outside the range of the AP FAP without dropping communications. Instead roaming outside the range of the AP FAP results in a seamless handoff also referred to as a handover where communication services are automatically provided by the wide area licensed wireless network of the service provider as described in the U.S. Pat. No. 6 922 559.

The licensed wireless communication session is facilitated by infrastructure provided by a licensed wireless network that includes telecommunications network . In the illustrated embodiment licensed wireless network depicts components common to a GSM Global System for Mobile Communication based cellular network that includes multiple base transceiver stations BTS of which only one is shown for simplicity that facilitate wireless communication services for various user equipment via respective licensed radio links e.g. radio links employing radio frequencies within a licensed bandwidth . Typically the multiple BTSs are configured in a cellular configuration one per each cell that covers a wide service area. The various BTSs for a given area or region are managed by a base station controller BSC with each BTS communicatively coupled to its BSC via a private trunk . In general a large licensed wireless network such as that provided by a regional or nationwide mobile services provider will include multiple BSCs .

Each BSC communicates with telecommunications network through a standard base station controller interface A. For example a BSC may communicate with MSC via the GSM A interface for circuit switched voice services and with SGSN via the GSM Gb interface for packet data services GPRS . Conventional licensed voice and data networks include protocols to permit seamless handoffs from one recognized BSC to another BSC not shown .

In some embodiments of the ICS architecture an unlicensed communication session is facilitated via an access point comprising a service area . As indicated by the arrow representing unlicensed communication session the user equipment may be connected to the telecommunications network via a second data path that includes an unlicensed wireless channel access point an access network and a universal network controller UNC also referred to as a unlicensed network controller in some embodiments . The UNC communicates with telecommunications network using a base station controller interface B that is similar to base station controller interface A and includes a GSM A interface for circuit switched voice services and a GSM Gb interface for packet data services GPRS . In this manner the UNC appears to the GSM GPRS core network as a GSM BSS network element and is managed and operated as such. In some embodiments the BSS network element includes the BTS and BSC .

In accordance with some embodiments the AP will be located in a fixed structure such as a home or an office building . In some embodiments the service area of the AP includes an indoor portion of a building although it will be understood that the service area of the AP may include an outdoor portion of a building or campus. The AP creates an accessible unlicensed wireless network to which the user equipment connects. The unlicensed wireless channel is facilitated by a radio link employing a wavelength or wavelength range in an unlicensed free spectrum e.g. spectrum around 2.4 GHz 5 GHz 11 66 GHz . An unlicensed wireless service hosting unlicensed wireless channel may have an associated communication protocol. As an example the unlicensed wireless service may be a wireless local area network LAN WiFi service e.g. the IEEE 802.11a b n or g wireless standard . The licensed wireless channel may comprise any licensed wireless service having a defined BSS interface protocol for a voice data network . Some embodiments of the licensed wireless include a GSM GPRS radio access network UMTS Terrestrial Radio Access Network UTRAN and GSM EDGE Radio Access Network GERAN to name a few although it will be understood that embodiments of the present invention include other licensed wireless services.

In this architecture the principle elements of transaction control e.g. call processing are provided by the core network elements namely the MSC visitor location register VLR and the SGSN . Authorized licensed wireless devices are allowed access to the GSM GPRS core network either directly through the GSM radio access network if they are outside of the service area of an AP or via the ICS network if they are within the service area of an AP.

Alternatively some embodiments of the ICS architecture integrate the wide area licensed wireless network with a short range licensed wireless communication session that is facilitated via a femtocell access point FAP as shown in . However it should be recognized by one of ordinary skill in the art that the licensed wireless network depicted in is presented as an example of a network that may be part of the ICS or ICS of some embodiments. Alternatively in some embodiments the ICS or ICS are integrated with various other wireless communication systems such as the UTRAN and GERAN to name a few.

Similar to the AP the FAP will be located in a fixed structure such as a home or an office building . In some embodiments the service area of the FAP includes an indoor portion of a building although it will be understood that the service area of the FAP may include an outdoor portion of a building or campus. As illustrated in some embodiments use the femtocell access point FAP to facilitate short range licensed wireless communication sessions that operate independent of the licensed communication session . In this figure the user equipment connects to the ICS network through the short range licensed wireless network created by FAP instead of the unlicensed wireless connection of . The communication session is routed through the generic IP access network to the UNC . The UNC as described with regards to interfaces with voice and data services of the core network using the UTRAN interfaces Iu cs for circuit switched services and Iu ps for packet switched services in establishing the communication session. However it should be apparent to one of ordinary skill in the art that in some embodiments of the UNCs and are implemented with various communication interfaces to access the core network such as the GSM A Gb and UTRAN Iu cs Iu ps interfaces described above.

Once authenticated the AAA notifies the INC through a separate communication exchange. The INC then proceeds to manage the subscriber s access to all voice and data mobile services using one of the various interfaces described above with regards to the UTRAN GSM and GERAN networks. However one of ordinary skill in art will realize that the UNC can be implemented using various other communication interfaces. In some embodiments the UNC includes only some of the components described with regards to or may additionally include various other components. For example the SeGW can be separated from the rest of the UNC while the AAA server can be made part of the UNC.

Some embodiments of the above mentioned devices such as the user equipment AP FAP or UNCs and include microprocessors and memory not shown that store computer program instructions for executing wireless protocols for managing communication sessions in a machine readable or computer readable medium as further described below in the section labeled Computer System . Examples of machine readable media or computer readable media include but are not limited to magnetic media such as hard disks memory modules magnetic tape optical media such as CD ROMS and holographic devices magneto optical media such as optical disks and hardware devices that are specially configured to store and execute program code such as application specific integrated circuits ASICs programmable logic devices PLDs ROM and RAM devices. Examples of computer programs or computer code include machine code such as produced buy a compiler and files containing higher level code that are executed by a computer or a microprocessor using an interpreter.

Moreover some embodiments of the user equipment AP or UNCs provide an interface conversion function to convert the signaling of the unlicensed service into a conventional base station subnetwork BSS interface e.g. an A interface or a Gb interface . Alternatively some embodiments of the user equipment AP FAP and UNCs and provide an interface conversion function to convert the signaling of the unlicensed service or licensed service into other network interfaces compatible with the UNC and and the ICS architecture such as an IP Ethernet interface.

As a result of the protocol conversion a communication session is established that is transparent to the voice network data network i.e. the voice data network uses its standard interface and protocols for the communication session as it would with a conventional communication session handled by a conventional licensed base transceiver station . Accordingly protocols for a seamless handoff of services that are transparent to the voice data network are facilitated. This permits for example a single phone number to be used for both the licensed wireless service and the unlicensed wireless service. Additionally the present invention permits a variety of services that were traditionally offered only through licensed wireless services to be offered through an unlicensed wireless service broadband connection or other integrated system of the ICS. The user thus gets the benefit of potentially higher quality service when their user equipment is located within the area serviced by a high bandwidth unlicensed wireless service or broadband connection while also having access to conventional phone services.

This typically includes the following basic services Telephony Emergency call e.g. 911 calling in North America Short message mobile terminated point to point MT PP Short message mobile originated point to point MO PP GPRS bearer services Handover licensed to unlicensed unlicensed to licensed voice data SMS SS . However it should be apparent to one of ordinary skill in the art that various implementations of the ICS architecture include other known services or alternatives to the described services such as the 112 European Union equivalent for 911 emergency services used within the United States and Canada.

In some embodiments customer premise equipment CPE includes the user equipment and AP through which the user equipment accesses the UNC for ICS service. In some embodiments the ICS CPE addressing includes the international mobile subscriber identity IMSI associated with the SIM in the user equipment as a parameter. In some embodiments the IMSI is provided by the ICS user equipment to the UNC when it requests ICS service. Unlike the GSM BSC the UNC manages in some embodiments a context for each user equipment that is operating in ICS mode. Therefore the UNC maintains a record for each served user equipment. For example IMSI may be used by the UNC to find the appropriate user equipment record when the UNC receives a BSSMAP paging message.

In some embodiments the ICS CPE addressing includes an access point identifier AP ID as the parameter. The AP ID includes the media access control MAC address of the AP or the IMSI associated with the FAP through which the user equipment accesses the ICS service. This identifier may be provided to the UNC when the user equipment requests ICS service. Moreover the AP ID may also be used by the service provider to restrict ICS service access only to authorized APs. Alternatively in some embodiments the ICS CPE addressing includes a public IP address that is indirectly associated with the AP FAP that passes communications from the UE to the UNC of the ICS network. Specifically the IP address is associated with the network access connection or device used to pass information to the UNC. In some embodiments the network access connection includes a digital subscriber line DSL or cable modem connection which could be assigned to the access device e.g. DSL modem .

In some embodiments user equipment is required to register with the network each time the serving location area or routing area changes. One or more location areas identifiers LAIs are associated with each visited location register VLR in a carrier s network. Likewise one or more routing area identifiers RAIs are controlled by a single SGSN.

In some embodiments a GSM cell is identified within the location or routing area by adding a cell identity CI to the location or routing area identification. The cell global identification CGI is the concatenation of the location area identification and the cell identity. In some embodiments the cell identity is unique within a location area. In some embodiments a partitioning method includes implementing a one to one or a many to one correspondence between GSM cell identity and ICS cell identity. Given the identification of a preferred GSM cell in a particular area it is possible to determine the corresponding ICS cell identity based for example on UNC provisioning. An example of a one to one relationship is mapping a GSM cell to an ICS cell. An example of a many to one relationship is mapping a GSM location area and associated GSM cells to an ICS cell.

In some embodiments when the user equipment connects to the UNC for ICS service it sends the CGI value of the current GSM camping cell to the UNC. The UNC maps the GSM camping cell s CGI value to a corresponding ICS cell s CGI value based on mapping logic provisioned in the UNC. This may be a one to one mapping e.g. if there is one ICS cell per GSM cell or a many to one mapping e.g. if there is one ICS cell per GSM location area . If no GSM coverage is available in the ICS service area the UNC assigns the user equipment to a default no GSM coverage ICS cell. A single UNC may serve one MSC. This does not preclude UNC embodiments that combine multiple UNC instances as defined above in a single device. Each UNC may also be assigned a unique ICS Handover CGI value used for GSM to ICS handover purposes. For example this is the value provisioned in the GSM RAN BSCs ARFCN to CGI tables and in the MSCs e.g. to point to the UNC .

Moreover one of ordinary skill in the art will recognize that the above mention mapping technique also applies to other various networks. For instance the technique can be adapted for the case of UMTS coverage whereby the UNC maps from a UTRAN cell identity to a corresponding ICS cell identity.

In some embodiments an ICS registration process does not employ signaling to the public land mobile network PLMN or licensed wireless network infrastructure but is instead contained within the ICS network i.e. between the user equipment and UNC . The ICS registration process serves at least two purposes. It informs the UNC that the user equipment is connected through a particular AP and is available at a particular IP address. The UNC keeps track of this information for example for providing location information during an emergency services request. The registration process also provides the user equipment with the operating parameters associated with the ICS service on the AP. This may be analogous to the use of the GSM broadcast control channel BCCH to transmit system parameters to user equipment in GSM cells. GSM system information message content that is applicable in ICS mode may be delivered to the user equipment during the ICS registration process.

While the identification information described above provides adequate identification information for certain services provided by landline wired and wireless communication service providers e.g. caller id the ICS based services provided in some embodiments such as an emergency service request require that location information additionally be sent in conjunction with the identification information of the caller. As described in detail below solutions for providing location information during emergency services as implemented by wired landline and licensed wireless communications service providers may be adopted to provide ICS based equivalent emergency services. In this manner ICS based emergency services conform to established national regulations or provide functionality similar to that of wired landline emergency based services. Moreover one of ordinary skill in the art will recognize that the ICS based location information services of some embodiments discussed below are further implemented for other non emergency related services.

Some embodiments of the ICS system implement location services by providing either the caller s estimated location e.g. latitude and longitude or a civic address e.g. physical street address associated with a base station serving the user equipment. A detailed description of such embodiments is provided for in U.S. Pat. No. 7 369 859. In order to provide a more robust set of location services some embodiments implement location services equivalent to those provided by traditional wired landline communication service providers. In some such embodiments instead of providing approximate latitude and longitude coordinates for identifying the location of the caller traditional landline wired communications are able to provide more detailed civic address information associated with the endpoint or telephone number from which the services request originated.

The more detailed location information allows for greater effectiveness of emergency responders in accurately and timely locating the caller. For example in an apartment complex scenario with multiple living units the latitude and longitude location estimation information locates the caller within a 100 meter range anywhere within the apartment complex. In this manner emergency responders lose valuable time searching every unit within the 100 meter radius to determine and identify the exact location of the caller.

However exact location information can be provided for through an ICS implementation equivalent to that of the wired landline emergency services. Since wired landline user equipment are associated with an exact civic address traditional wired telephone service providers are able to maintain databases for associating telephone numbers to civic addresses. In this manner when a caller places a wired landline emergency services request call the emergency responders receive the phone number and the exact civic address of the caller as opposed to a location estimate. Referring back to the previous apartment complex scenario the landline equivalent solution would provide the emergency responders with the exact apartment unit from which the emergency services request originated. In this manner emergency responders need not search within the 100 meter location estimate radius but are instead directly guided to the location of the caller.

Some embodiments provide the landline equivalent implementation by providing a civic address associated with an AP or FAP of the ICS network to the emergency responders. A typical AP resides in a residence or office and therefore has an associated civic address similar to that of wired landline user equipment. Alternatively some embodiments provide the landline equivalent implementation by providing a public IP address indirectly associated with the AP from which communications from the UE are passed into the ICS network e.g. IP address associated with a DSL modem connected to the AP .

In some embodiments the ICS service provider maintains a subscriber database that stores the civic address information or other location information associated with the location of the AP and a reference to the location information. In some embodiments the reference to the stored database location information includes the MAC address of the AP the IP address indirectly associated with the AP e.g. DSL modem connected to the AP the IMSI or some or all such keys.

In some embodiments the location information is entered into the subscriber database through pre provisioning by the ICS service provider. For instance when a new subscriber purchases access to the ICS service the ICS service provider obtains and stores the location information and MAC address associated with the AP of the subscriber or the location information and IMSI associated with the FAP of the subscriber.

Alternatively in some embodiments the civic address information is entered by the subscriber through the UE. For example when the ICS user equipment performs the ICS registration procedure one of the parameters that the UNC provides to the user equipment in the response is the a location available indicator. However if there is no entry for the subscriber within the subscriber database then the indicator is set to no location is available. The user equipment provides a convenient way for the user to enter street address information associated with the current location of the AP. Invocation of this function enables the user to enter street address information associated with the current location. Once entered the user equipment sends this information to the UNC to be stored in the subscriber database.

Moreover the UE of some embodiments communicates through a broadband IP network. In some such embodiments the user s broadband access device e.g. DSL modem with integrated residential gateway is assigned an IP address that is associated with a particular civic address. This IP address is passed to the UNC. For example a digital subscriber line DSL provider identifies an IP address assigned to a user by identifying the civic address at which the DSL line terminates. Moreover in some embodiments the user equipment contains GPS technology for identifying a latitude and longitude associated with the location of the UE. That information is then converted by components of the network into a street address which the UNC then uses to identify the location of the user equipment or alternatively leverages locator infrastructure common to GSM networks.

In some embodiments the UNC receives the civic address and stores the information in a corresponding record of an ICS subscriber database which also includes a key identifier. The key of some embodiments includes the MAC address of the AP the IMSI of the FAP the IMSI of the user equipment UE or the public IP address of the broadband access device. When location information is added to a record the UNC sends a message to the user equipment with the location available indicator set to the value location is available. 

Once the secure IP tunnel is established at step B the UNC of some embodiments includes at step C the IP address assigned to the subscriber s broadband access line in a message to an authorization authentication and accounting AAA server . The security gateway SeGW of the UNC identifies this IP address in the IP packets from the UE . After the IP address information is sent to the AAA server at step C the AAA server stores at step D this information in conjunction with the UE IMSI and the AP MAC address that is subsequently sent in the steps described below.

The UE sends at step E a Register Request message that includes the IMSI of the UE and identification information AP ID associated with the AP to the UNC . In response the UNC forwards at step F the IMSI of the UE and the AP ID via an Access Request message to the AAA server . In some embodiments the AP ID includes the MAC address of the AP or the IP address identified at step B.

Using the UE and AP ID the AAA server queries at step G and retrieves at step H subscriber and location information from an ICS subscriber database . The information is used to authorize the subscriber s UE and the associated AP from which the subscriber accesses the ICS network. If access is allowed the AAA server in some embodiments updates at step I the ICS subscriber database with the subscriber ID e.g. IMSI and current location e.g. civic address or geographic location . In this manner the current location of the UE is determined. For instance a UE is authorized to access the ICS network via several APs therefore when the subscriber registers with the ICS network the database is queried to determine whether the subscriber is accessing the network through one of the allowed APs. Once the subscriber is authorized the database is updated to indicate the current location of the subscriber as the specific AP and the civic address associated with the AP with which the subscriber is accessing the ICS network.

Subsequent to the steps A F and optionally step I of a response message containing a key for indexing the location information is returned at step J from the AAA to the UNC . The UNC stores the key in a local data store. The UNC then returns at step K a Register Accept message to the UE . This completes the registration process and the location sequence.

In some embodiments the key includes the UE IMSI and or AP MAC address. Alternatively the key of some embodiments includes the IP address indirectly associated with the AP . Specifically the IP address of some embodiments references the IP address assigned to the subscriber s broadband access line through which the AP communicates to the UNC as described above.

The FAP establishes at step A the IPSec tunnel for communications with the UNC . The UNC then sends at step B an IP address associated with the subscriber s broadband access line which is then routed at step C from the UNC to the AAA server for storage. When established the FAP proceeds with a Register Request message to the UNC providing the AP ID of the FAP which in some embodiments includes an IMSI associated with the FAP e.g. the IMSI stored in a smartcard inserted into the FAP . The messaging at steps D H of then parallel steps E J of in registering and searching the subscriber database for location information associated with the FAP . After the location information is identified the UNC is notified at step I through a Register Accept message from the AAA server containing a key for accessing the database entry associated with the location information of the FAP . The UNC then returns at step J a Register Accept message to the FAP . This completes the registration process for the FAP though as described above additional registration messaging occurs for a UE connecting through the FAP to access the ICS network.

Alternatively in some embodiments a AAA server initiates a location service request to applicable location service infrastructure. In some embodiments the AAA server submits a Location Inter operability Forum Mobile Location Protocol LIF MLP query including the IMSI for the UE . The LIF TS 101 Specification defines a secure access method via an Application Program Interface API that enables Internet applications to query location information from wireless networks irrespective of its underlying air interface and positioning methods. The API is based on existing and well known Internet technologies such as HTTP SSL TLS and XML. A gateway mobile locating center GMLC functions as a gateway server for location services and hosts an instance of the LIF API. Accordingly the AAA server and the GMLC perform an authentication message exchange to verify the UNC is authorized to use location services accessed via the GMLC.

Once the authorization is verified the GMLC obtains location information corresponding to the request using standard licensed network techniques. These include but are not limited to Assisted GPS AGPS Angle of Arrival AOA Enhanced Observed Time Difference E OD Cell Identity plus Timing Advance Cell ID TA and Time Difference of Arrival TDOA . Such location information techniques can then be converted to a civic address before storage within the ICS subscriber database.

The GMLC uses the key e.g. IMSI and AP ID to query at the ICS subscriber database to retrieve location information including a civic address associated with a location of the AP through which the emergency call was placed into the ICS network. The GMLC then stores a copy of the location information e.g. civic address within an ALI database and sends at a second key for accessing the ALI database entry to the PSAP. Using the second key the PSAP retrieves at the location information and in this manner is able to obtain a civic address associated with a service requester of the ICS network.

Steps will now be explained in further detail with reference to . In addition to the aforementioned components of the network architecture of further includes a mobile switching center MSC a GMLC and a PSAP . The GMLC represents conventional infrastructure employed by GSM networks for performing location services.

A message and operation sequence of some embodiments for passing the civic address location information associated with an AP through the ICS network to the nearest PSAP is shown in . First an emergency call is placed via the UE through the ICS network to the UNC . The call is routed at step B through the UNC to the MSC . The MSC receives a CM Service Request message from the UNC . The CM Service Request message contains a CM Service Type parameter which is set to Emergency Call to indicate that an emergency call is being placed. When the MSC determines that the user equipment is requesting an emergency call the MSC issues at step C a BSSMAP Perform Location Request back to UNC .

The UNC responds at step D to the MSC with a BSSMAP Perform Location Response. However rather than populate the response message with the typical location estimate coordinates of the caller the UNC instead encodes a key in the location estimate field and further places an ICS identifier in the positioning data field of the message to indicate that the call is being routed through the ICS network and not a GSM or other communication network. In some embodiments the key includes the AP ID such as a MAC address associated with the AP though the key of some embodiments also includes other types of identification information as described above. The key is used to access the ICS subscriber database .

Referring back to the MSC then sends at step E a Subscriber Location Report message to the GMLC containing the encoded ICS information in addition to other identification information such as the IMSI MSISDN and ICS CGI. Steps F H specify additional signaling required to locate and route the emergency services call to the appropriate PSAP .

The GMLC processes at step I the received packet. Logic within the GMLC identifies that the emergency call is being placed through the ICS network. At this point the GMLC queries at step I the ICS subscriber database using the key it was provided within the Subscriber Location Report to retrieve the geographic coordinates and or civic address of the caller. At step J the GMLC uses standard database access messaging e.g. SQL or LDAP to receive from the ICS subscriber database the location information required to send to the PSAP . However in some embodiments when a public IP address is passed to the GMLC the GMLC queries at step I an alternate database that maintains the mapping of assigned public IP addresses to broadband subscriber civic addresses instead of the ICS subscriber database .

Various additional signaling occurs through steps K L in order to establish the emergency services call with the PSAP . Once the call is established the PSAP requests at step M the location of the user equipment. In response the GMLC provides at step N the geographic coordinates and or civic address information that it received from ICS subscriber database along with the MSISDN i.e. the phone number of the UE at step J.

An alternative embodiment to the messaging and operation sequence of is presented in . Steps A C and F N of are identical to those of . However in step D rather than encode both the key and an indication that the call is being made in ICS mode only encodes the key within the Perform Location Response message. Therefore the GMLC contains logic to detect that the call is being made in ICS mode based on the cell identity associated with the cell as opposed to having that information encoded within the response message. This places the additional overhead upon the GMLC to store information about ICS cell identities.

Some embodiments of the user equipment access points and universal network controllers contain an option to specify through which communication network the user equipment should place the emergency services call. For instance user equipment of a first network when operating within range of an ICS network could place the emergency services call through the ICS network as opposed to the first communication network or vice versa depending on the specified setting. Such an option would be inactive when the user equipment is only within the first communication network e.g. GSM . Under these circumstances the user equipment will always place the call through the only available network.

Moreover some embodiments provide failsafe and alternative measures when the emergency services call cannot be properly routed over the ICS network. For instance when the ICS network does not contain location information for the AP. illustrates the operations and logic of some embodiments for switching over to the primary communication network to place the emergency services call when the service is unavailable over the ICS network.

When an emergency services caller is within range of the ICS network the ICS network or user equipment of the caller is configured to initially attempt at to place the emergency services call through the ICS network. The AP hosting the ICS service for the subscriber s UE will be identified at . Then a determination is made at as to whether the UNC or UNC operator has any valid location information for the AP. If such a record exists at the location information will be forwarded at to the emergency service as the location for the subscriber. If no record is found at then a hand over is made at from the ICS session to a licensed wireless network session.

As part of the hand over the emergency series call is placed at in the session queue such that when the licensed wireless network session is established an emergency services call is transparently placed i.e. the subscriber doesn t have to redial the number to the licensed wireless network. The licensed wireless network then obtains at the location of the subscriber in its usual manner and the subscriber location information is forwarded at to the emergency service.

The bus collectively represents all system peripheral and chipset buses that support communication among internal devices of the computer system . For instance the bus communicatively connects the processor with the read only memory the system memory and the permanent storage device .

From these various memory units the processor retrieves instructions to execute and data to process in order to execute the processes of the invention. The read only memory ROM stores static data and instructions that are needed by the processor and other modules of the computer system. The permanent storage device on the other hand is a read and write memory device. This device is a non volatile memory unit that stores instruction and data even when the computer system is off. Some embodiments of the invention use a mass storage device such as a magnetic or optical disk and its corresponding disk drive as the permanent storage device . Some embodiments use one or more removable storage devices flash memory card or memory stick as the permanent storage device.

Like the permanent storage device the system memory is a read and write memory device. However unlike storage device the system memory is a volatile read and write memory such as a random access memory. The system memory stores some of the instructions and data that the processor needs at runtime.

Instructions and or data needed to perform processes of some embodiments are stored in the system memory the permanent storage device the read only memory or any combination of the three. For example the various memory units contain instructions for processing multimedia items in accordance with some embodiments. From these various memory units the processor retrieves instructions to execute and data to process in order to execute the processes of some embodiments.

The bus also connects to the input and output devices and . The input devices enable the user to communicate information and select commands to the computer system. The input devices include alphanumeric keyboards and cursor controllers. The output devices display images generated by the computer system. The output devices include printers and display devices such as cathode ray tubes CRT or liquid crystal displays LCD .

Finally as shown in bus also couples computer to a network through a network adapter not shown . In this manner the computer can be a part of a network of computers such as a local area network LAN a wide area network WAN or an Intranet or a network of networks such as the Internet . Any or all of the components of computer system may be used in conjunction with the invention. For instance some or all components of the computer system described with regards to comprise some embodiments of the user equipment AP FAP UNC GMLC AAA and subscriber database described above. However one of ordinary skill in the art will appreciate that any other system configuration may also be used in conjunction with the invention or components of the invention.

The foregoing description for purposes of explanation used specific nomenclature to provide a thorough understanding of the invention. However it will be apparent to one skilled in the art that specific details are not required in order to practice the invention. Thus the foregoing descriptions of specific embodiments of the invention are presented for purposes of illustration and description. They are not intended to be exhaustive or to limit the invention to the precise forms disclosed obviously many modifications and variations are possible in view of the above teachings. The embodiments were chosen and described in order to best explain the principles of the invention and its practical applications they thereby enable others skilled in the art to best utilize the invention and various embodiments with various modifications as are suited to the particular use contemplated. For example in some embodiments the location based services described above have been adapted for the 911 emergency service of the United States. However it should be apparent to one of ordinary skill in the art that the location based services can similarly be adapted to the European equivalent 112 emergency service. Furthermore the invention may be used in areas other than emergency services e.g. whenever there is a need to identify a location of a caller .

Moreover while the invention has been described with reference to numerous specific details one of ordinary skill in the art will recognize that the invention can be embodied in other specific forms without departing from the spirit of the invention. For instance specific details of one or more examples can be combined to provision user equipment. The MSISDN IMSI MAC ID and the location name of the access point can be substituted with similar information to provision user equipment. The disclosed techniques can be used for integrated system that includes licensed wireless communication systems other than GSM GPRS GERAN or UTRAN or communication systems other than a UMAN.

Additionally some embodiments of the ICS referred to user equipment of a licensed communication network. However it should be apparent one of ordinary skill in the art that various other implementations of the ICS such as the femtocell architecture described with regards to and any associated or compatible user equipment is adaptable to provide the location based services described above. Moreover certain terms as disclosed may be used interchangeably without diverging from the spirit of the invention. For example the terms AP and FAP may be interchanged.

In some examples and diagrams two components may be described or shown as connected to each other. The connection may be a direct wire connection or the two components may be communicatively coupled to each other through other components or through wireless or broadband links. Thus one of ordinary skill in the art would understand that the invention is not to be limited by the foregoing illustrative details but rather is to be defined by the appended claims.

