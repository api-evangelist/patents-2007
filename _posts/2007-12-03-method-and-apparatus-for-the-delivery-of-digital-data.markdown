---

title: Method and apparatus for the delivery of digital data
abstract: A method and apparatus for the delivery of digital data to an end user () from a network () comprising at least two different data sources () is disclosed. Each of the at least two different data sources () can deliver the digital data to the end network at at least one parameter and the data sources () have substantially identical copies of the digital data comprising portions and are connected to the end user (). The method comprises receiving () a list of a subset of the at least two data sources () and selecting () on the basis of the list one or more of the subset of at least two data sources (). At least a portion of the digital data from the selected ones of the at least two data sources () is delivered to the end user (). The parameter for the delivery of the digital data to the end user () is monitored and the configuration () of the selected ones of the at least two data sources () is adjusted () on the basis of the monitored parameter such that a combined configuration of the configurations () of the selected ones of the at least two data sources () matches the specification ().
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07908362&OS=07908362&RS=07908362
owner: Velocix Ltd.
number: 07908362
owner_city: Cambridge
owner_country: GB
publication_date: 20071203
---
The present invention relates to a method and network for the supply of digital data from multiple data sources in particular in a peer to peer network and a spot market for the supply of the digital data.

In the current Internet system an Internet Service Provider ISP provides Internet connections to customers or subscribers. The ISP is connected to other ISPs by backbones which are generally operated by other companies. In order to connect to the Internet the ISP will buy bandwidth on one of the Internet backbones which distributes data between various ones of the ISPs and also between data sources. An ISP in Singapore will for example buy bandwidth on trans pacific cables between Singapore and the United States and on cables between Europe and Australia and Singapore. The bandwidth purchased is symmetric. However many ISPs in the Asia Pacific Region for example are net downloaders of bandwidth as the end users of the digital data i.e. customers of an ISP from those regions are more active consumers of data produced outside of their region than they are providers of data to the Internet. It is also possible for an ISP to also be stakeholder in a backbone system.

Thus the ISP in the Asia Pacific region is a net downloader of data from the Internet. However the ISP has purchased symmetric capacity on the Internet backbones. The capacity purchased is sufficient to accommodate the required download rates for data requested by the ISP customers. However there is substantial overcapacity for uploading data from the ISP to the Internet. As a result uploading of data from the Asia Pacific ISP to the rest of the Internet will require little additional costs. Much of the hardware such as switches is symmetric and therefore to upload data to the network there would be little increase in installed costs.

A Content Delivery Network CDN is a system of computers networked together across the Internet that cooperate to deliver digital data in the form of content such as large media content including videos and audio files to end users. Examples of such content based CDN s include Sandpiper and Skycache as well as Akamai and Digital Island and the Applicant s own VelociX network. The Akamai CDN for example supplies many connections to many users from a single source.

The CDN has one or more servers on which content is stored. These CDN servers are generally deployed in multiple locations and can often be reached from an ISP over multiple backbones. These CDN servers will cooperate with each other to satisfy requests for content by end users such as the ISP customers. In prior art systems the CDN servers will move content behind the scenes to optimize the delivery process of the digital data to the end user. The optimization of the delivery process can take the form of reducing bandwidth costs and or improving end user performance.

The number of CDN servers in the CDN varies and depends on the architecture of the CDN. Some of the CDN s have thousands of nodes with tens of thousands of servers. When a user wishes to download content generally requests for content digital data are sent to the CDN from an end user. These content requests are directed to the one of the CDN servers which can provide the best service. When optimizing for service the CDN servers located in the geographical locations that can serve the requested content most quickly to the end user will generally be chosen to serve the content request. This choice of CDN server may be governed by the principle of choosing the geographical locations that are the fewest hops or fewest number of network seconds away from the end user requesting the digital data termed the requestor . Alternatively the CDN known in the prior art will chose the CDN server so as to optimize the delivery of the digital data across local networks. When optimizing for cost CDN servers located in the geographical locations that are less expensive to serve from may be chosen to serve the content request. Often these two goals tend to align as those CDN servers that are close to the end user have in the prior art systems an advantage in serving costs because they are located within the same network as the end user.

Co Pending UK Patent Application No GB061596.3 U.S. patent application Ser. No. 11 598 115 discloses a content distribution network in which a data monitoring device at a server monitors at least one quality of service QoS parameter for the delivery of digital data. The patent application discloses that one of the QoS parameters may be the cost of delivery of the digital data.

Co Pending UK Patent Application NO GB0615962.8 U.S. patent application Ser. No. 11 598 114 assigned to CacheLogic Ltd Cambridge UK teaches a content distribution network in which the selection of the cache from which to download the digital data is obtained is based at least in part on the location of the user selecting the digital data.

U.S. patent application No US 2004 0148344 assigned to Serenade Systems Mountain View Calif. USA shows a content distribution network using the Internet. The Serenade system shows a peer to peer network in which peer groups are associated and maintained for efficient file distribution. Caches in this application are prioritised based on availability and cost. The network may be configured such that any peer which is not exploiting its available or maximum desired serving bandwidth begins pushing out content to the peer to peer network. As mentioned above CacheLogic Ltd Cambridge UK currently offers a VelociX video delivery system which allows a client wishing to deliver digital data such as a video to do so at an assigned delivery speed and or at a fixed cost. This allows for example end users paying a premium price for the receipt of the video to receive it within a guaranteed timeframe rather than waiting for the arrival of the complete digital data to be dependent on network conditions. The VelociX video delivery system is disclosed at http www.cachelogic.com home pages video index.php downloaded 16 Jun. 2007 

Efforts in the past for creating a market based resource allocation system for the provision of network bandwidth capacity for the distribution of digital data are known. For example international patent application No WO 01 88811 assigned to Invisible Hand Networks teaches the creation of a spot market system for the purchase of bandwidth and or buffer space.

The invention provides a method for the delivery of digital data to an end user from a network comprising at least two different data sources which have at least one parameter associated with them. The at least two data sources have substantially identical copies of the digital data comprising portions and are connected to the end user. The method comprises receiving at least one list of a subset of the at least two data sources with the associated parameter and selecting on the basis of the list one or more of the subset of the at least two data sources such that a configuration of the selected ones of the at least two data sources matches a specification for the delivery of the digital data to the end user. At least a portion of the digital data is delivered from the selected ones of the at least two data sources to the end user. The parameter for the delivery of the digital data to the end user is monitored and the configuration of the selected ones of the at least two data sources is adjusted on the basis of the monitored parameter such that a combined configuration of the configurations of the selected ones of the at least two data sources matches the specification.

The invention allows the selection of the data sources for the supply of the digital data to the end user within the network to be optimized. The selection of the data sources is optimized in the sense that the data sources for the delivery of the digital data are dynamically selected such that during the delivery of the digital data a contracted bandwidth on a network path from a cache to the end user can be met at the least possible cost or congestion. It is immaterial within the network where the data source is located with respect to the end user as long as the selection of the data source together with other previously selected data sources helps to ensure that the contracted bandwidth to the end user from the data sources is met for example at the least cost or with the required rate of delivery.

The invention further allows basing the selection of the data sources on either or both the cost of delivery as well as the target rate of delivery from the data source to the end user. It is therefore possible to combine quality of service rate of delivery in this case with distributing the usage of the data sources as underused ones of the data sources tend to provide the digital data at a lower parameter cost of delivery .

According to one aspect the invention further allows the optimal selection of bandwidth within the network by having the data sources decide independently how to deliver the portions of the digital data to the end user. There is hence no central controller so that end user s privacy concerns can be satisfactorily addressed.

The invention provides further for an apparatus for the delivery of digital data to an end user in which the digital data comprises a plurality of portions. The apparatus of the invention comprises a network of at least two data sources which supply portions of the digital data at a parameter to the end user. At least two different data sources are connected to the end user and a tracker provides a list of the at least two data sources. The apparatus further includes a selection device for selecting on the basis of the list one or more of the two data sources to supply at least some of the portions of the digital data to the end user such that a configuration of the selected ones of the at least two data sources matches a specification for the delivery of the digital data to the end user. A monitoring device for monitoring the parameter for the delivery of the digital data to the end user is included in the apparatus together with an adjusting device for adjusting on the basis of the monitored parameter the configuration of at least one of the selected ones of the at least two data sources such that a combined configuration of the configurations of the selected ones of the at least two data sources matches the specification.

In another aspect of the invention the method for the selection of a data source for delivery of digital data from the data source to an end user comprises receiving proposals for the delivery of the digital data to the end user from at least two data sources which are connected in a network. The proposals offer at a parameter bandwidth on connections from the at least two data sources to an end user for the delivery of the digital data. The parameter is for example the cost of delivery or the rate of delivery of the digital data.

The invention further includes in a further aspect an apparatus for the selection of a data source for the delivery of digital data from the data source which comprises a receiving device for receiving proposals on connections to an end user from at least two data sources connected in a network and offering bandwidth on the network paths at a parameter for the delivery of the digital data. A selection device selects the proposals on the basis of the parameter from the at least two data sources and selects the data sources corresponding to the selected one of the proposals such that a configuration of the selected data sources matches a specification for the delivery of the digital data to the end user.

A peer to peer also termed P2P computer network is a network that relies primarily on the computing power and bandwidth of the participants in the computer network rather than concentrating computing power and bandwidth in a relatively low number of servers. P2P computer networks are typically used for connecting nodes of the computer network via largely ad hoc connections. The P2P computer network is useful for many purposes. Sharing content files containing for example audio video and data is very common. Real time data such as telephony traffic is also passed using the P2P network.

A pure P2P network does not have the notion of clients or servers but only equal peer nodes that simultaneously function as both clients and servers to the other nodes on the network. This model of network arrangement differs from the client server model in which communication is usually to and from a central server. A typical example for a non P2P file transfer is an FTP server where the client and server programs are quite distinct. In the FTP server clients initiate the download uploads and the servers react to and satisfy these requests from the clients.

Some networks and channels such as Napster OpenNAP or IRC find use a client server structure for some tasks e.g. searching and a P2P structure for other tasks. Networks such as Gnutella or Freenet use the P2P structure for all purposes and are sometimes referred to as true P2P networks although Gnutella is greatly facilitated by directory servers that inform peers of the network addresses of other peers.

One of the most popular file distribution programmes used in P2P networks is currently BitTorrent which was created by Bram Cohen. BitTorrent is designed to distribute large amounts of data widely without incurring the corresponding consumption in costly server and bandwidth resources. To share a file or group of files through BitTorrent clients first create a torrent file . This is a small file which contains meta information about the files to be shared and about the host computer the tracker that coordinates the file distribution. Torrent files contain an announce section which specifies the URL of a tracker and an info section which contains suggested names for the files their lengths the piece length used and a SHA 1 hash code for each piece which clients should use to verify the integrity of the data they receive.

The tracker is a server that keeps track of which seeds i.e. a node with the complete file or group of files and peers i.e. nodes that do not yet have the complete file or group of files are in a swarm the expression for all of the seeds and peers involved in the distribution of a single file or group of files . Nodes report information to the tracker periodically and from time to time request and receive information about other nodes to which they can connect. The tracker is not directly involved in the data transfer and is not required to have a copy of the file. Nodes that have finished downloading the file may also choose to act as seeds i.e. the node provides a complete copy of the file. After the torrent file is created a link to the torrent file is placed on a website or elsewhere and it is normally registered with the tracker. BitTorrent trackers maintain lists of the nodes currently participating in each torrent. The computer with the initial copy of the file is referred to as the initial seeder.

Using a web browser users navigate to a site listing the torrent download the torrent and open the torrent in a BitTorrent client stored on their local machines. After opening the torrent the BitTorrent client connects to the tracker which provides the BitTorrent client with a list of clients currently downloading the file or files.

Initially there may be no other peers in the swarm in which case the client connects directly to the initial seeder and begins to request pieces. The BitTorrent protocol breaks down files into a number of much smaller pieces typically a quarter of a megabyte 256 KB in size. Larger file sizes typically have larger pieces. For example a 4.37 GB file may have a piece size of 4 MB 4096 KB . The pieces are checked as they are received by the BitTorrent client using a hash algorithm to ensure that they are error free.

In the standard BitTorrent protocol there is no information about delivery speed from any one of the peers. The BitTorrent client will give peers in the swarm four sources for the pieces of the file. It will provide the peers with details of three best seeds and at least one random seed. The reason for this is that the BitTorrent client is trying to maximise its own amount of data as will be further explained below.

As further peers enter the swarm all of the peers begin sharing pieces with one another instead of downloading directly from the initial seeder. Clients incorporate mechanisms to optimize their download and upload rates. Peers may download pieces in a random order and may prefer to download the pieces that are rarest amongst it peers to increase the opportunity to exchange data. Exchange of data is only possible if two peers have a different subset of the file. It is known for example in the BitTorrent protocol that a peer initially joining the swarm will send to other members of the swarm a BitField message which indicates an initial set of pieces of the digital data which the peer has available for download by other ones of the peers. On receipt of further ones of the pieces the peer will send a Have message to the other peers to indicate that the further ones of the pieces are available for download.

The user makes a request at the peer to download the digital data. The peer communicates with the server and provides information for the digital data to be downloaded to the server . Subsequently the server locates one of the torrent files related to the digital data requested for download by peer such as for example torrent file . In various embodiments of the invention torrent files includes information related to the name size number of pieces and check sum error for the digital data to be downloaded by peer

Subsequently in various embodiments of the present invention the tracker server provides a list of peers present in the P2P network with the pieces of the digital data to be downloaded The peer thereafter communicates with the available list of peers for downloading the related digital data. The peer communicates with peers by sending a bitfield of the pieces of the digital data that peer has. After peer receives all the bitfields from peers it sends a message to the peers where it finds relevant data and starts downloading the pieces of the requested digital data.

The peer communicates with the CLS . In an embodiment of the present invention the information sent by the peer to the CLS may also contain the IP address of the peer . Based on the received information the CLS communicates a location string to the peer . In an embodiment of the present invention the CLS may get the location string from the database . The database stores information about the IP address ranges of countries ISPs regions towns etc for the purpose of generating specific location strings with respect to peers .

The peer then using the location string and information from the Torrent File makes communication with the ISP DNS .

In various embodiments of the present invention the information sent by peer to ISP DNS may be as following 

An example of the information sent by CLS to peer may be as following bt 1234.bt bigcorp bigispnyc.find cache.com where bt represents the BitTorrent protocol used by the peer 1234 representing a specific hash value associated with the digital data to be downloaded by the peer bigcorp representing the publisher a fictional Big Corporation of the digital data to be downloaded bigispnyc representing the location string for the peer the New York point of presence for a fictional Big ISP .

Based on this communication the ISP DNS redirects the request to the central DNS which is the name server for the domain contained in the communication . Thereafter the central DNS provides an address of the cache DNS to the ISP DNS . The cache DNS thus receives a DNS request from the ISP DNS for the digital data to be downloaded. Subsequently the cache DNS allocates one of the caches such as for example cache . In various embodiments of the present invention the cache DNS may allocate one of the caches based on the load availability and content on each of them. The cache DNS communicates this information to the ISP DNS which in turn communicates the information to the peer . The peer thereafter makes a communication with the cache for downloading the digital data. The communication between the peer and cache is explained in detail in .

The peer sends a request to the cache for downloading the digital data. The cache is connected to the first content server and or the second content server and the private tracker . In various embodiments of the present invention the first content server and the second content server both include complete copies of a plurality of stored digital data in the P2P network . According to one aspect of the present invention the first content server and or the second content server is are connected to a publisher s computer network. Both the content server and the second content server receive the digital data which are to be distributed from the publisher s computer network. For example the publisher wishing to distribute a video file in the P2P network would first upload the video file to the first content server or the second content server . Thereafter the video file can be subsequently downloaded by the peers from the first content server or the second content server .

According to one aspect of the present invention as soon as the publisher uploads a piece of the digital data on the first content server or the second content server the digital data becomes available for the peers to be downloaded. Thus as the publisher progresses with the upload of subsequent pieces of the digital data the peers are able to download those uploaded pieces in parallel. Therefore the capability of the system to execute parallel uploads and downloads of the digital data from the first content server or the second content server ensures an efficient real time availability of digital data in the P2P network .

The cache downloads the digital data based on the request from the peer from the first content server or the second content server or from cache . The private tracker knows which of the digital data are available on which of the caches and first content servers and the second content server and provides this information to the cache . If the digital data requested by the peer is available on the cache the peer downloads the digital data from the cache . If the digital data is not available on the cache the cache downloads the requested digital data from the first content server and or the second content server and or the cache . Thereafter the cache makes the digital data available to the peer for downloading. According to one aspect of the present invention the peer may also download the related digital data from the other peers available in the P2P network such as for example peer and peer

According to another aspect of the present invention the cache may upload digital data from the peers available in the P2P network . In such a case the cache acts as one of the peers .

As discussed above the private tracker maintains a track of all the data available on the first content server and the second content server and the caches . The public tracker is connected to all of the caches and to all of the peers in the P2P network . The public tracker maintains a track of all the data digital data transferred among the caches and the peers . In particular the public tracker maintains a list of all of the peers and the caches which hold copies of the digital data available in the P2P network .

The business logic unit is connected to all the caches and the private tracker . The business logic unit authenticates peers before allowing the peers to upload any digital data. Further the business logic unit is connected to the central database server . The business logic unit acts as an interface between the P2P network and the central database server . Central database server acquires log reports from the private tracker and caches through the business logic unit for all the data transferred to and from the caches and the first content server and the second content server . Using the information from the central database server obtained via the business logging unit such as the log reports the user interface unit provides the required information for billing purposes and for report generation.

In an embodiment of the present invention the central database server may be connected to the public tracker . In another embodiment of the present invention the public tracker may be connected to the private tracker .

Furthermore the data POPs are also located in remote geographical locations across the globe such as for example New York Frankfurt and so forth. It should be understood by those skilled in art that the number of the data POPs locations are scalable and may be increased with the increase in network traffic and digital data available in the P2P network . The data POPs such as the data POP and are connected with all the available service POPs in the P2P network . The connection between the digital data POPs and service POPs enables a real time data update and information transfer between the data POPs from the service POPs 

In an embodiment of the present invention a geographical location may include both the service POP and the data POP

In various embodiments of the invention the central database server is located in each of the service POPs . The central database server of each of the service POPs are connected to each other and act as a central database unit.

It should be understood by those skilled in the art that the components illustrated in the arrangement for the service POP are scalable and may be increased based on the network traffic and the digital data available in the P2P network .

It should be understood by those skilled in the art that the components illustrated in the arrangement for the data POP are scalable and may be increased based on the network traffic and the digital data available in the P2P network .

As discussed above in connection with the peer downloads from the cache and from the other peers available in the P2P network . The rates of delivery of digital data representing the pieces of the digital data vary from the multiple sources as does the quality and the cost in providing the digital data. For example the digital data from the peers is not necessarily of high quality and the rate of delivery of the digital data can be but is not necessarily slow. On the other hand the rates of delivery of the digital data from the caches can be fairly high particularly if the connection from the caches to the peer has a high bandwidth. The quality of the digital data is also high for example the digital data does not contain many errors. However the cost of delivering the digital data from the caches is higher than the cost of delivering the digital data from the peers .

There is a further issue with the caches . The cost of the connection from the peer to the caches is normally related to the maximum throughput provided by the caches . As a result for example during the day the caches may be extremely busy but at night the caches may not be so busy. The caches and the connection from the peer to the caches will have capacity available to the caches during the night which has been paid for. The incremental cost in delivering the digital data from the caches during the night is accordingly much smaller than the incremental cost in delivering the digital data from the server during the day.

The rate of delivery of the digital data to the peer is therefore a combination of the rates of delivery of the digital data from the other peers and the caches . The cost for the delivery of the digital data varies according to which ones of the multiple sources i.e. peers and or caches supplies the digital data. If the digital data is supplied principally from the other peers to which the peer is connected the cost of the delivery of the digital data will be small. In particular if the other peers are served by the same ISP the cost will be very small.

An unacceptable quality of service is when the peer does not receive the digital data at sufficient speed or the received digital data contains too many errors. One example of an unacceptable quality of service may occur when a user at the peer wishes to watch a video. The video is stored as digital data in the form of video data. A certain amount of digital data has to reach the peer within a fixed period of time where it is stored in a video buffer in order for the peer to watch the video. If the digital data representing the pieces of the digital data is not received at sufficient rate of delivery at the peer then the user will experience an interruption in the transmission of the video. This will be explained in more detail with respect to .

The pieces of the digital data may be downloaded from the caches and the peers . The downloading of the digital data from the caches is more costly as the bandwidth is wider the digital data may have to pass over leased lines but the rate of the delivery of the digital data is much higher. The peer can get more than enough digital data from the caches to enable the user to view the video and the quality of data will be high.

In order to perform this combination of the delivery of data the caches are provided with data delivery monitors and as shown in . illustrates not only the data delivery monitors and but also two of the other peers and supplying the peer with digital data and the caches and supplying the peer with digital data. It will be understood that in practice the peer will be connected to multiple other peers and possibly to more than one cache .

The data delivery monitors are provided with predetermined quality of service QoS parameters. Different ones of the digital data will have different predetermined quality of service parameters. The data delivery monitor monitors the rate of delivery of the digital data from the caches to the peer . The monitored real time quality of service parameters are compared with predetermined quality of service parameters. The predetermined quality of service parameters can be pre programmed into the data delivery monitor and or may be adjusted using an application programming interface. The rate of delivery of the digital data to the peer may be adjusted on the basis of the comparison as will be discussed below. It will be noted that the data delivery monitors attached to each of the caches operate independently of each other.

The quality of service parameters include but are not limited to the rate of receipt of the delivery of the digital data to the peer the cost of the delivery of the digital data and the error rate of the received digital data. For example the pre determined quality of service parameters could include the requirement that the digital data is received at a rate between 1 Mb and 1.2 Mb per second to allow the viewing of the video by the user at the peer . The pre determined quality of service parameters might also require that the total cost for the delivery of the digital data not exceed for example per Gigabyte.

The caches preferably also include data delivery controllers and . The function of the data delivery controllers is to receive the QoS information from the data delivery monitor and to adjust the rate of delivery of the digital data from the caches . Each ones of the data delivery monitors operates independently of other ones of the data delivery monitors .

The data delivery monitor in one aspect of the invention monitors the receipt of the digital data by monitoring content availability messages such as BitField and Have messages in the BitTorrent protocol which are sent by the peers . Equivalent techniques and messages exist in other P2P protocols.

In an aspect of the invention the peer may also select to preferentially source the digital data from underused or cheaper caches as discussed above. To take an example using the nearest caches of the digital data for the peer in Germany is for example located in Frankfurt. It would be from a location viewpoint optimal to use the caches in Frankfurt for the delivery of the digital data. On the other hand if the peer is accessing the digital data in the morning it is probable that the caches in San Jose is underutilised because of the different time zones whilst the caches in Frankfurt is operating at or close to its maximum throughput. There may be bandwidth available from the San Jose caches available at minimal incremental cost. As a result the peer will attempt to receive the digital data preferentially from the San Jose caches in order to minimise costs. Alternatively it is possible that content servers are present in locations which have lower costs.

This can be illustrated in more detail with respect to which shows an aspect of the present invention of a network for the delivery of digital data to an end user from a first cache and a second cache . The end user is connected by at least two different network paths to the first cache and the second cache respectively. The first cache and the second cache each supply the portions of the digital data at a given parameter to the end user . Both the first cache and the second cache contain substantially identical copies of the digital data. In one aspect of the invention this given parameter is the rate of delivery of the digital data but the given parameter might also indicate the cost of delivery of the digital data or it could be another parameter. A specification comprises a range of values for the given parameter. For example the specification includes but is not limited to a contracted minimal bandwidth for the delivery of the digital data to the end user and the cost of the digital data. The contracted minimal bandwidth is generally the result of negotiations between the operators of the network and content providers of the digital data as will be explained later. The content providers have their content for example the digital data distributed by the operators of the network at the contracted bandwidth as the content provider is in turn bound by a contract to the end user to deliver the digital data at the contracted bandwidth. The contracted bandwidth can be relevant if the end user paid the content provider to receive the digital data in form of a video for example and hence expects to enjoy smooth streaming of the video across the network without jamming and interruptions.

It should be noted that ownership of the first cache and the second cache are likely to be different and also the network path between the first cache and or the second cache and the end user may be owned by different entities. There are contractual arrangements between the owners of the first cache and the second cache as well as the suppliers of the network paths and the ISPs to which the end user is connected to allow the use of the network paths between the first cache and or the second cache and the end user .

Each ones of the first cache and the second cache have a configuration and which indicates a target rate of delivery of the digital data. The target rate of delivery is the rate of delivery with which each one of either the first cache or the second cache is capable of delivering the portions of the digital data to the end user . In general but not always the first cache and the second cache have different configurations and

The network further includes a tracker . The tracker provides to the end user a list of the first cache and the second cache as well as other caches and peers in the network which can supply portions of the digital data. For example the list may provide references such as URLs pointing to the first cache and second cache

The end user will typically connect to all of the sources of data which are given in the list . Thus the end user will connect in this example to both the first cache and the second cache as well as to any peers which can supply relevant portions of the digital data.

The network also includes a first monitoring device at the first cache and a second monitoring device at the second cache . The first monitoring device monitors the delivery of the portions of the digital object from the first cache to the end user as discussed above. Similarly the first cache includes a first adjusting device for adjusting the configuration of the first cache . The second monitoring device and a second adjusting device perform similar functions for the second cache . The first adjusting device and the second adjusting device adjust on the basis of the delivery monitored by the first monitoring device and the second monitoring device whether the speed of receipt of the digital data received by the end user matches the specification . The adjustment by the first adjusting device and the second adjusting device is done in a manner such as to ensure that a combined configuration i.e. the combined speed of delivery of the digital data from the first cache and the second cache as well as any peers matches the specification . For example if the configuration of one of the selected ones of the first cache and the second cache is 0.5 MB s and the other one is 0.4 MB s then the combined configuration would amount to 0.9 MB s. Therefore one can increase the combined configuration to 1.0 MB s by increasing the 0.4 MB s configuration by 0.1 MB s to 0.5 MB s. According to one aspect of the invention the selected ones of the first cache and the second cache receive have messages from the end user about what portions of the digital data the end user has received from which ones of the selected ones of the first cache and the second cache . The results of the have messages indicate the speed of receipt of the digital object at the end user .

According to one aspect of the invention the selected ones of the first cache and the second cache receive have messages from the end user about what portions of the digital data the end user has received from which ones of the selected ones of the first cache and the second cache . The results of the have messages indicate the speed of receipt of the digital object at the end user .

The first cache and the second cache operate substantially independently from each other and increase or decrease their configuration independently of each other. Thus an expensive one of the first cache or the second cache can reduce the delivery of the digital data if the expensive one detects that sufficient digital data has been being supplied to the end user from other sources.

The caches in the network thus dynamically adjust their delivery of the digital data to the end use to ensure that at substantially all times during the download the digital data is delivered to the end user at least at the contracted bandwidth and for the least possible cost.

The first cache and the second cache each has a target profile stating how many bytes of the digital data should have been received at various points during the download as is shown in . The Y axes shows the number of bytes delivered and the X axes the time. Obviously at time zero neither of the first cache nor the second cache can have delivered anything at all but both of the first cache and the second cache have a target to reach. The line for cache is substantially higher than the line for cache because its cost of delivery for cache is less than the cost of delivery for cache . The target rate of receipt of the digital object at the end user is shown in the lower continuous line.

The winding curve on the graph shows the actual receipt of the digital data by the end user . In the first portion of the graph both the first cache and the second cache contribute portions of the digital object. Once the curve passes the delivery rate for the first cache there is no need for the first cache to delivery any more portions to the end user as the end user is being adequately supplied from the less expensive cache . Thus the first cache no longer supplies portions of the digital data to the end user the portions of the digital data are supplied solely from the less expensive second cache and any peers . Similarly once the curve goes above the line for the second cache then the second cache no longer needs to supply portions of the digital data as the peers in the network supply the portions of the digital data at an adequate delivery rate. This continues until the curve drops below the required rate at which point the second cache and if necessary the first cache can switch in again.

If the digital data is not required immediately then it is possible for neither of the first cache nor the second cache to initially supply portions of the digital data. The end user waits to see whether the peers will supply adequate data.

In one example of the invention the target rate for the receipt of the digital data is initially high whilst a video buffer is being filled. Once the video buffer is filled then the target rate drops.

The profile for the first cache or the second cache does not need to be a straight line and the intercept the point at which the line crosses the Y axis does not have to be positive. A range of curves might be used for long downloads where it is desirable for the download to complete using only peer sources if possible. Such curves might lie on the X axis until halfway through the expected delivery time.

In step the list of the first cache and the second cache and some of the peers which can supply the digital data is received from the tracker .

In step the end user connects to the peers the first cache and the second cache to receive the portions of the digital data.

At step at least one of the portions of the digital data from the connected ones of the first cache or the second cache or the peers connected in step is delivered to the end user .

At step messages are sent from the end user to the connected ones of the first cache and the second cache indicating which portions of the digital data the end user has received. This is compared in step with the specification and at step the configuration or of the selected ones of the first cache and the second cache are adjusted if necessary. This adjustment is done in a manner such that a combined configuration matches the specification . The combined configuration is derived from the configuration and of each of the selected ones of the first cache and the second cache as explained above.

The invention can be used in a network and method for allocating bandwidth for the delivery of digital data. In one pricing model for the delivery of digital data from a content provider the content provider contracts with the operator of the content distribution network to distribute the digital data at a particular price. It is therefore in the interest of the CDN operator to distribute the digital data at the cheapest price. As a result the CDN operator is interested in finding the cheapest servers e.g. the first cache or the second cache or server farms from which the digital data is provided. As long as the requirements for delivery speed are met at the end user it is immaterial whether the portions are provided by the content distributions servers e.g. first cache or second cache or whether the portions are provided by peers not shown in the network . The CDN operator can therefore switch in faster servers in order to meet the contracted delivery speeds.

Operators of the content e.g. the first cache or the second cache servers are interested in optimising the use of their caches. As discussed above some ISPs have substantial incoming data but little outgoing data but have infrastructure for a symmetrical downloading and uploading of digital data. As a result uploading channels on the ISP network are underutilised. In order to increase utilisation the ISP can offer bandwidth on the underutilised uploading channels to a CDN operator. The price of the offered bandwidth can vary depending on the current amount of data being uploaded into the Internet by the ISP s own subscribers. During the day in which the ISP customers are more active the uploading channels are used more heavily by the ISP customers. The ISP does not have as much capacity for uploading digital data for supply to end users who are not ISP customers. Thus the price of the bandwidth can be higher than that during sleeping hours in the time zone in which the ISP is operating. During night time hours for example little traffic is being uploaded and the price of the bandwidth can be diminished to encourage the CDN operator to use the ISP for the distribution of the digital data. The ISP has the infrastructure in place which is underutilised the only incremental costs will be the invoicing structures.

The content provider does not need to know from which cache e.g. the first cache or the second cache its content is being distributed. It is immaterial to its business model. Only the CDN operator needs to negotiate the business arrangements with ISPs and owners of server farms to obtain the best possible price.

In an ideal arrangement more than one ISP can offer bandwidth from the cache to the end user to the CDN operator at differing prices dependent on the current utilisation of the uploading channels by the ISP subscribers. Thus the CDN operator can chose to select the most economical and or the fastest delivery bandwidth offered by the more than one ISP. This allows the development of a spot market in which the ISP offers bandwidth capacity from the cache at a guaranteed minimum delivery speed for a particular price. The CDN operator can chose to accept this offer or at least purchase an option on the offer or to decline the offer. Once the offer is accepted it is within a very short time frame allocated to the CDN operator.

The proposal selection device will select from among the first proposal and the second proposal corresponding to the specifications that proposal or alternatively those proposals which have a preferred value for the parameter e.g. the cheapest price for the cost of the bandwidth or the supply of the digital data.

After the proposal selection device has made the selections the information of the available ones of the first cache and the second cache available for the delivery of the digital data is supplied to the tracker so that the tracker can supply the list to the end users as explained above.

In one aspect embodiment of the present invention a difference between the different proposals is based on a different cost model for the network path and or the operation of the first cache and the second cache . One possibility for such cost model contemplated by the present invention is the availability of uploading capacities on the network paths at the first cache or the second cache as discussed above.

One aspect of the present invention includes a spot market for bandwidth trading. In this aspect of the invention the proposal selection device receives multiple proposals e.g. the first proposal and the second proposal from multiple suppliers of the digital data which may be the first cache and the second cache or could be other storage devices . The proposal selection device monitors the proposals continually or at least on a regular basis and selects the best proposals available. The tracker then supplies to the end user the ones of the multiple suppliers offering the best available conditions e.g. price for the delivery of the digital data. This selection can happen substantially in real time or over the course of a longer time frame.

Note that it is not necessary that the proposal or to be received from the caches and . They may be received from another device in the same network as the network that the cache or is installed in.

This aspect of the invention will be further explained by means of the flow chart as shown in . In step the proposals and are received from the multiple suppliers of the digital data connected in the network and offering the bandwidth along a network path from the end user to the first cache and or the second cache at the given parameter for the delivery of the digital data. The given parameter comprises in this aspect of the invention a price of the bandwidth. At least one of the received proposals or corresponding to specifications for the delivery of the digital data is then selected in step . The specification will generally comprise a contracted minimal bandwidth for the delivery of the digital data and or a contracted price for the delivery of the digital data.

Finally in step in the tracker will be supplied with the list of the first cache and or the second cache which can supply the digital data to the end users .

In a further step further proposals are requested and if these are forthcoming the selection process is continued. In an ideal market more than one CDN operator will be seeking bandwidth from more than one supplier of bandwidth and or server farms. In addition other distributors of data requiring bandwidth will also be active in the marketplace.

In one aspect of the invention the parameters can be changed by the controller of the content delivery network and application programming interfaces are available to do this.

The invention has been described in terms of an illustrative example. The person skilled in the art will recognize that the invention can be practiced with modification within the spirit and scope of the attached claims. At least it should be noted that the invention is not limited to the detailed description of the invention and or of the examples of the invention. It is clear for the person skilled in the art that the invention can be realized at least partially in hardware and or software and can be transferred to several physical devices or products. The invention can be transferred to at least one computer program product. Further the invention may be realized with several devices.

