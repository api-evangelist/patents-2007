---

title: Hardware driven display restore mechanism
abstract: A method and system for restoring output to a display device. The method includes receiving a request to restore the output, modifying output timing so output is visible on a display device, and invoking an output configuration application. The method and system allow a user to restore the output on a display device after the output has been configured to settings which exceed the capabilities of the display device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09001016&OS=09001016&RS=09001016
owner: NVIDIA Corporation
number: 09001016
owner_city: Santa Clara
owner_country: US
publication_date: 20070919
---
This application is related to commonly assigned U.S. patent application Ser. No. 11 903 156 entitled SOFTWARE DRIVEN DISPLAY RESTORE MECHANISM by Herz et al. which is incorporated herein in its entirety.

Increasing distribution of digital content has helped the growth of more advanced display technologies such as high definition televisions. At the same time computers have developed an increasing role in entertainment systems and thus connected with high definition devices such as televisions. In order to get the best possible visual experience the output settings need to match content format and the capabilities of the display device. Therefore there are times when a user will need to change the resolution of the output or when a new device is connected.

A problem exists however when the user sets output settings e.g. resolution or refresh rate beyond the capabilities of a display device. For example the user may be trying to watch a high definition DVD and sets the display resolution to a 1080p while the display device e.g. plasma television only supports a display resolution up to 720p. Such changes to the display resolution are typically implemented via a television handheld remote control that manipulates one or more on screen menus e.g. a menu of options graphically presented on the television screen . Upon pressing the remote control button to select the high resolution the user will then be presented with either a blank screen or a corrupted and incomprehensible video signal because the display device is not capable of displaying the input signal provided to it.

Some prior art solutions have attempted to solve this problem e.g. the user selecting a unsupported display resolution by waiting for a user to acknowledge that the resolution change worked. If no acknowledgement is received within a defined time out period the resolution is restored to the previous working resolution. Unfortunately this time out method is not consistently reliable because depending upon how it is implemented e.g. set top box media center PC etc. the timeout function may freeze or stop functioning.

With respect to PC based systems e.g. small form factor set top box PC systems wired or wirelessly connected PCs etc. the software based functionality e.g. operating systems of the systems do not provide even a time out mechanism. In this case the user will be stuck with the unsupported resolution. For example the user may be stuck with a blank screen because he she cannot see an application on screen control panel menu or the like to fix the output settings. Being suddenly confronted with a blank screen the user may also not realize what the mistake was and further be stuck because he she does not know how to go about fixing the problem. In some instances the only solution to restore the resolution is to reboot or restart the computer system.

Further an output configuration application may be running on a computer system e.g. connected to a home entertainment system in user space and thus not in protected mode. This attribute tends to make the application unreliable for ensuring the user is not left with an unusable output on a display device. For example the output configuration application waiting for an acknowledgement from a user may be running in user space and stop functioning as a result of a bug or malfunction in another user space application e.g. 3party software spyware viruses etc. .

Thus a need exists for a reliable way for users to restore the resolution so that the output is not left at a resolution unsupported by a display device. What is further needed is a way to automatically return to a displayable resolution so the user is not presented with a blank screen and thus no on screen menu or interface that can correct the problem. The required system should be transparent and intuitively comprehended by the user.

Embodiments of the present invention provide a solution that enables a user to reliably restore the output to settings supported by a display device. Embodiments of the present invention further provide a user with a transparent and intuitively comprehended system for restoring output settings and usability of a display device.

In one embodiment the present invention is implemented as a method for restoring an output mode of a display output for a display e.g. LCD display projection TV display plasma display and the like . The method includes receiving a signal to change a resolution of the display output. The display output is provided to the display and is configured to drive the display e.g. standard definition video output high definition video output etc. . Upon receiving the signal an interrupt is generated for a display driver executing on a computer system. The display driver is configured to control a display processor of the computer system. In response to the interrupt graphics system processing operations are modified to restore a display capable resolution of the display output to a compatible output mode for driving the display. Additionally a control panel application is executed on the computer system to present an on display control for changing the output mode.

In this manner embodiments of the present invention implement a reliable way for a user to restore a display capable resolution of the display output to a mode that will be supported by the display device. The user can be provided with an easy way to generate a signal e.g. pushing a button on a remote computer system etc. that will automatically initiate the restoration of the display to a compatible resolution thereby for example greatly assisting the user in those circumstances where the user inadvertently changes the output mode of the display output to an unusable output.

In another embodiment the present invention is implemented as a system for outputting graphics. The system includes a plurality of output connectors e.g. DVI VGA Component etc. for coupling a plurality of display devices. The display devices are driven by a display processor for handling graphics processing and outputting a video signal on the plurality of output connectors. The display processor also includes a plurality of connectors. A second processor controls a plurality of functions of the display processor by executing a display driver and an application for changing a plurality of graphics settings of the display device. An input device is communicatively coupled to at least one of the plurality of connectors of the display processor and invokes a change in output timing so the output is viewable on at least one of the display devices coupled to the output connectors.

In another embodiment the present invention is implemented as a graphics processing unit GPU . The GPU includes a graphics data source for receiving graphics data from a graphics content source and a plurality of outputs operable to drive a plurality of display device s with processed graphics data. The system further includes a connector for receiving a signal to restore the output to a compatible output mode and a plurality of pipelines wherein at least one of the plurality of pipelines is configurable for facilitating output of a compatible output mode. In one embodiment the signal to restore the output to a compatible output mode may be received via a GPIO pin. In another embodiment the signal to restore the output to a compatible output mode may be received via an application which receives signals from an RF IR or the like receiver.

Reference will now be made in detail to the preferred embodiments of the present invention examples of which are illustrated in the accompanying drawings. While the invention will be described in conjunction with the preferred embodiments it will be understood that they are not intended to limit the invention to these embodiments. On the contrary the invention is intended to cover alternatives modifications and equivalents which may be included within the spirit and scope of the invention as defined by the appended claims. Furthermore in the following detailed description of embodiments of the present invention numerous specific details are set forth in order to provide a thorough understanding of the present invention. However it will be recognized by one of ordinary skill in the art that the present invention may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail as not to unnecessarily obscure aspects of the embodiments of the present invention.

Some portions of the detailed descriptions which follow are presented in terms of procedures steps logic blocks processing and other symbolic representations of operations on data bits within a computer memory. These descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. A procedure computer executed step logic block process etc. is here and generally conceived to be a self consistent sequence of steps or instructions leading to a desired result. The steps are those requiring physical manipulations of physical quantities. Usually though not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated in a computer system. It has proven convenient at times principally for reasons of common usage to refer to these signals as bits values elements symbols characters terms numbers or the like.

It should be borne in mind however that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the present invention discussions utilizing terms such as processing or accessing or executing or storing or rendering or the like refer to the action and processes of a computer system e.g. computer system of or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission or display devices.

The CPU and the GPU can also be integrated into a single integrated circuit die and the CPU and GPU may share various resources such as instruction logic buffers functional units and so on or separate resources may be provided for graphics and general purpose operations. The GPU may further be integrated into a core logic component. Accordingly any or all the circuits and or functionality described herein as being associated with the GPU can also be implemented in and performed by a suitably equipped CPU . Additionally while embodiments herein may make reference to a GPU it should be noted that the described circuits and or functionality can also be implemented and other types of processors e.g. general purpose or other special purpose coprocessors or within a CPU.

System can be implemented as for example a desktop computer system or server computer system having a powerful general purpose CPU coupled to a dedicated graphics rendering GPU . In such an embodiment components can be included that add peripheral buses specialized audio video components IO devices and the like. Similarly system can be implemented as a handheld device e.g. cellphone etc. direct broadcast satellite DBS terrestrial set top box or a set top video game console device such as for example the Xbox available from Microsoft Corporation of Redmond Wash. or the PlayStation3 available from Sony Computer Entertainment Corporation of Tokyo Japan. System can also be implemented as a system on a chip where the electronics e.g. the components and the like of a computing device are wholly contained within a single integrated circuit die. Examples include a hand held instrument with a display a car navigation system a portable entertainment system and the like.

Input device s may include devices such as a remote control an IR receiver device a button on a system chassis or the like. Input device s may be coupled to processing unit via one or more of a plurality of connectors. In one embodiment input device s may be communicatively coupled to processing unit via a general purpose input output pin or connector. General purpose input output connectors may be used for input in a master mode and output in a slave mode. In another embodiment a simple serial port such as IC can be used. In one embodiment processing unit is a graphics processing unit GPU and is responsible for handling graphics data and rendering graphics data for output on outputs s to display device s . In one embodiment input device may be used to change or restore a render capable output resolution of graphics data by processing unit which is displayed on display device s . For example if the user sets a resolution that is too high or exceeds the capabilities of display device s display device s may show nothing or corrupted or incomprehensible images and a user may then use input device to signal processing unit that the resolution needs to be restored to a display capable resolution that allows the user to select a display capable resolution for display device s .

In one embodiment a button on input device will directly e.g. button on a chassis or indirectly e.g. button on remote control signal the processing unit that a display capable resolution needs to be restored. In response to the signal from input device processing unit may signal a display driver executing on processing unit which modifies the graphics processing operations of processing unit and thereby changes the output timings to display device s . In one embodiment output s may be connected to a single display device e.g. one of display device s and when the output timings are changed the output connector which a signal is sent out over is changed. In one embodiment the output may be changed to a lower resolution output and or analog output to ensure the video signal is now visible.

Processing unit may be coupled to processing unit . In one embodiment processing unit may execute a display driver for controlling a plurality of functions and operations of processing unit and may execute an application for changing a plurality of graphics settings e.g. a control panel application .

The embodiment illustrates example components or modules that in various embodiments are instantiated and executed by a CPU e.g. CPU of and or a GPU e.g. GPU under the control of computer readable and computer executable instructions. However it should be appreciated that the aforementioned components of system can be implemented in hardware or software or in a combination of both and that various other components or variations of the components recited in system can be used to implement the functionality of embodiment of the present invention.

In one embodiment as depicted in system includes remote control event remote control background application chassis button event a processor engine e.g. as executed by hardware software of a GPU control panel application and graphics driver which includes resource manager interrupt service routine ISR and display driver .

Processor engine may receive signals from chassis button event and remote control button event to restore a rendered output to a display device. The signals regarding the remote control button event are received via remote control background application . It is appreciated that processor engine may receive signals via other buttons and interfaces with the same signal being issued to processor engine .

After a user has changed the output resolution the output of a coupled display device e.g. display may be blank corrupted or otherwise incomprehensible video. The user may then press a remote control button to create a remote control button event or press a chassis button to create a chassis button event to begin the process of restoring display intelligibility e.g. the lowest common denominator resolution . In one embodiment the remote control button event may send a signal to the remote control background application or processor engine . For example the user presses a remote control button which sends an IR signal to an IR receiver connected to a USB port of the computer system a 1394 port etc. and this signal may be relayed to the remote control background application or processor engine . In one embodiment remote control background application may be executed by a central processing unit CPU . The remote control background application may signal processing engine that a display capable resolution needs to be restored.

Processing engine may then signal resource manager that the output needs to be a display capable resolution. In one embodiment processing engine generates an interrupt which is handled by interrupt service request module which is part of resource manager . Resource manager may be part of a graphics driver which runs in protected or kernel mode of an operating system. As part of handling the interrupt interrupt service request module may signal display driver that the output needs to be a display capable resolution. In one embodiment the output to a compatible output mode e.g. display capable resolution can have a changeable output connector. Display driver may then modify the graphics processing of GPU as described further below with reference to .

In one embodiment display driver also runs in protected mode or kernel mode of an operating system. Software functionality and or procedures and applications executing within kernel mode are systematically protected from interference from other software processes that execute in user mode e.g. and memory protection etc. . Software functionality and or procedures that run in user mode do not have the same degree of systematic protection. Accordingly kernel mode software routines and processes are more reliable than softer routines processes applications drivers and the like running in user space.

In one embodiment display driver may modify graphics processing by modifying the functions of raster unit such that raster unit rasterizes only a portion of graphics data. Graphics data may be received by raster unit directly from programmable view port in or after passing through programmable view port as indicated by dashed lines. For example if the graphics data is 1920 1080 1080i p and the display device can only support 720 480 raster unit may rasterize only a 720 480 portion. The portion of rasterized graphics data may be then be sent out to a display device via scan out module to output to display device s and will be visible to a user. Output from raster unit may be sent to scan out module for output via DAC for conversion for output on an analog connector such as VGA or composite CVBS . Alternatively scan out module may output via TMDS module via DVI HDMI or Display Port. Scan out module may also output via TV encoder which modifies the output for televisions or similar devices. Scan out module may also output via LVDS to an integrated LCD.

The display driver may further modify the output timing or horizontal and vertical resolution so output is visible on a display device. In one embodiment display driver may set the output timing to a standard setting known to be supported by most display devices. For example the output timings may be set to 480i. A standard or output timing mode that is used because of support for many display devices and thus ensures that the display can comprehend or render the video which may be referred to as the lowest common denominator. The adjusting of the output timings does not interfere with other graphics processing operations. For example the display driver does not have to change the resolution color depth or refresh rate and thus other operations such as 3D applications and full screen playback can continue uninterrupted.

After the output timings are changed a user will now be able to see a portion of the graphics on the screen based on the portion of the graphics screen being rasterized. The user may then use a navigation device e.g. remote control or mouse to navigate around to find the control panel application window that has been invoked as described herein and adjust the resolution within the capabilities of the display device.

In another embodiment display driver may modify the operations of scaling pipeline . For example if the graphics data received at viewport in has a resolution of 1920 1080 e.g. 1080i p and the output timing can be restored to 1280 720 the graphics data may be scaled without excessive loss of usability by the scaling pipeline to allow the resolution to be visible on a display device. For example even though a 1280 720 screen has far fewer pixels than a 1920 by 1080 screen the difference in resolution would probably still enable the use of a readable control panel menu by the user. For example even though the control panel menu might appear highly aliased it should still be legible and usable. Thus the resolution entering view port out is different from the resolution entering view port in . In one embodiment various other graphics functions e.g. 3D rendering pipeline may be stalled until a vertical sync interrupt is generated.

Display driver may have a policy which handles the decision of whether to modify the operations of scaling pipeline raster unit or other pipelines. Scaling may be used when the difference in output timing is relatively small as in the above example. Rasterizing only a portion of graphics data may be used when the difference is large e.g. 1080i p to 480i p . This aspect accounts for those cases where the restored display capable resolution has a very much smaller resolution e.g. 640 480 then the improperly selected output mode e.g. 1920 by 1080 . In such cases if the entire high resolution screen is scaled down to the low resolution the aliasing would be too severe for most instances of a on screen menu control panel to be legible and be used by a user. It is appreciated that the restoring of the display capable resolution or output timing may supersede load detection and Extended Display Identification Data EDID .

Interrupt service routine ISR may then notify or invoke control panel application . Control panel application may be used to change various output settings and provide a prompt to a user to verify that the new output settings work and output to a display device is comprehensible. If user cannot or does not verify that the output settings work a timeout may occur and control panel application may signal ISR to restore previous output settings. Control panel application may be launched when the system starts up and remain in the background or otherwise be hidden and when ISR signals control panel application control panel application may become visible. In one embodiment control panel application displays or reflects the current resolution or output timing on the graphics settings page or window. For example if the output timings were changed to 480i control panel application may have the resolution setting corresponding to 480i selected. In another embodiment the user may be presented with a message or wizard informing the user that the display capable resolution has been restored and he she may now attempt to change it again.

In one embodiment the input device used to restore output to a display capable resolution may be invoked several times and the various resolutions that may be outputted may be cycled through. For example with each press of a button by a user the output timing may be increased e.g. 480i to 720p to 1080i to 1080p and rastering and or scaling may be restarted with corresponding settings to the new output timing.

In one embodiment the refresh rate may also be changed when the display capable resolution is restored. The refresh rate may be selected according to the display devices connected such as 60 hz NTSC 50 hz PAL SECAM or 24 hz e.g. projectors . The change in refresh rate may be based on information a user entered in an application e.g. control panel application for the type of display device e.g. PAL NTSC ATSC .

The following discussion sets forth in detail the operations of the present technology for network communication management. With reference to flowcharts and each illustrate example blocks used by various embodiments of the present technology. Flowcharts and include processes that in various embodiments are carried out by a processor under the control of computer readable and computer executable instructions. Although specific blocks are disclosed in flowcharts and such blocks are examples. That is embodiments are well suited to performing various other blocks or variations of the blocks recited in flowcharts and . It is appreciated that the blocks in flowcharts and may be performed in an order different than presented and that not all of the blocks in flowcharts and may be performed.

At block a request is received to restore the output. The request may have been received via plurality of input devices as described herein such as a remote control or a button on system chassis. The request may have been issued by a user after changing the resolution settings such that the resolution settings exceeded the capabilities of the display device such that the output of the display device is blank corrupted or otherwise incomprehensible.

At block output timing is modified so output is visible on a display device. The output timings may be changed as described herein such that the output of a display device is now comprehensible to a user. As described herein the graphics processing operations may have changed e.g. scaling or rasterizing so the user is able to view content on the display device and change the resolution to appropriate settings for the display device.

At block the connector used for outputting to a display device is changed. In one embodiment the connector may be changed to one that is supported by more display devices. For example the output may be changed from a DVI connector to a composite CVBS connector to ensure the data is visible on the display device.

At block the refresh rate is modified. In one embodiment the refresh rate may be modified along with the output timings as described herein as to further ensure that the output on a display device is comprehensible. For example if information e.g. collected when output setting were configured is available that the display device is an NTSC device the refresh rate may be set to hertz.

At block an output configuration application is invoked. The output configuration application may allow a user to change output settings e.g. resolution refresh rate etc. . The output configuration application may be a control panel application as described herein. The output configuration application may be running in the background e.g. invisible prior to being invoked and thus becomes visible upon becoming invoked . The output configuration application may be running as the user had just used the output configuration application to set output settings which exceeded the capabilities of the display device. The output configuration application may further reflect the current output settings e.g. output timings .

At block a signal is received to change the resolution. The request may be received via plurality of input devices as described above such as a remote control or a button on system chassis. The request may have been issued by a user after changing the resolution settings such that the resolution settings exceed the capabilities of the display device such that the display device s output is incomprehensible. In one embodiment the signal may be communicated to a processor e.g. GPU via a pin on the processor e.g. general purpose input output as described herein.

At block an interrupt is generated. In one embodiment a processor e.g. GPU generates an interrupt which will be serviced by an interrupt service routine which is part of a resource manager of a graphics driver as described herein.

At block a display driver is signaled. In one embodiment the display driver is signaled by an interrupt service routine as described herein. The display driver may part of a processor e.g. graphics processor driver and runs in kernel or protected mode and thus is more reliable than a driver or application running in user space.

At block graphics processing system operations are modified. The graphics processing system operations may be modified by a display driver as described herein with reference to .

At block the difference between the current output settings and the output settings to be applied is determined. For example if the output timings are going to be changed from corresponding to a resolution of 1920 1080 e.g. 1080i p to 1280 720 e.g. 720p the difference may be used for determine how graphics processing operations will be modified. A policy may be applied based on the determination of the difference between the current output settings and the output settings to determine how graphics processing operations will be modified as described herein.

At block only a portion of graphics content is rendered. In one embodiment graphics processing operations are modified as described herein such that only a portion of graphics output is rasterized which allows a user to see a portion of the graphics output and navigate around in order to change the output settings to a more appropriate setting corresponding to the display device. In one embodiment the rasterization of only a portion of the graphics output may be performed in response to a determination of a large change in output settings e.g. 1080i to 480i as described herein.

At block graphics content or information is scaled. In one embodiment graphics processing operations are modified as described herein graphics output is scaled e.g. by a scaling pipeline which reduces the output such that a user can use the graphical user interface to set output settings appropriately for the display device. The graphics processing may be scaled when the determination of the output settings to be applied and the previous settings is relatively small e.g. 1080i to 720p . The relatively small difference may allow scaling of the graphics without excessive distortion which would otherwise prevent a user from using the output on the display device.

At block graphics processing is stalled. In one embodiment when the graphics processing system operations are modified as described herein operations e.g. 3D rendering may be stalled until a vertical sync interrupt is generated. This stalling of certain graphics processing operations allows the graphics processing operations to resume more quickly than if the pipelines were emptied or flushed after each output settings change.

At block output timings are changed. The output timings may be changed as described herein such that the output of a display device is now comprehensible to a user. For example the output timings may be set to 480i to ensure that the graphics output is now visible on a display device.

Referring back to at block a control panel application is invoked. A control panel application may allow a user change various graphics settings including the resolution as described herein. The control panel application may be running in a hidden or background mode since having been launched upon startup. The control panel application may also be running or executing as the user used the control panel application to change output settings e.g. resolution or refresh rate which exceeded the capabilities of the display device and caused a request to change the resolution to be made. In one embodiment the output settings displayed by the control panel will reflect the current output settings as described herein.

At block a notification message of a change in output properties is presented. A visual notification window wizard or other messaging means may be presented to a user via a graphical user interface indicating the output settings have been changed in response to a request to change the resolution as described herein. In one embodiment the notification message may be a control panel application message.

At block a system is booted. The system may be computing system which has multimedia capabilities and is connected to a display device that has been restarted or booted from a turned off state.

At block a control panel application is started. As described herein the control panel application may facilitate setting of various graphics output settings. The control panel application may be started in a background or hidden mode and thus be ready to be invoked e.g. by an interrupt service routine .

At block load detection is performed. The load e.g. electrical may be detected on each output interface. For example an HDMI and composite connection may be detected. During load detection extended display identification data EDID may be received which describes the capabilities of a display device.

At block a check if this is the first boot of the system is performed. First boot information may be stored on a storage device e.g. hard drive within the computing system.

At block the resolution is set based on EDID. During the first boot output settings such as resolution may be set based on the EDID which provides information on the capabilities of a display device.

At block the last or previous display or output settings are reinstated. When the boot sequence is determined to be other than a first boot previous display settings may be applied.

At block a check if there is a change to the mode setting or connectors is performed. If the user changed the resolution or output connector then block is performed. If there was no change of resolution by the user then load detection at block is performed.

At block a resolution change form is presented. The resolution change form may be part of a output configuration or control panel application as described herein.

At block the resolution is changed. A resolution change is applied after being selected by a user within an output configuration tool which may exceed the capabilities of the display device.

At block a check is made if a request to restore output is made. The request may have been made via a remote control button or chassis button as described herein by a user in response to a resolution change which resulted in output of a display device being incomprehensible.

At block the output timing is changed. The output timing may be made after graphics processing operations have been modified as described herein so that output of a display device is restored to a state where a user can utilize a control panel application to set the resolution and other graphics settings more appropriately tailored to the capabilities of the display device.

The foregoing descriptions of specific embodiments of the present invention have been presented for purposes of illustration and description. They are not intended to be exhaustive or to limit the invention to the precise forms disclosed and many modifications and variations are possible in light of the above teaching. The embodiments were chosen and described in order to best explain the principles of the invention and its practical application to thereby enable others skilled in the art to best utilize the invention and various embodiments with various modifications as are suited to the particular use contemplated. It is intended that the scope of the invention be defined by the claims appended hereto and their equivalents.

