---

title: Easy-to-use data report specification
abstract: A method and system for the graphical specification and modification of reports is disclosed which enables data reports to be easily created via a report design dialogue. The report design dialogue includes a group-level outline panel containing controls for grouping, as well as other report controls such as those for sorting and aggregating. A method and system for creating a group-level outline panel using an existing database report is also disclosed. Finally, a computer-readable medium storing a computer-interpretable data structure that stores one or more report specifications is disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07788257&OS=07788257&RS=07788257
owner: Microsoft Corporation
number: 07788257
owner_city: Redmond
owner_country: US
publication_date: 20071026
---
This application is a divisional application of application Ser. No. 11 020 940 filed on Dec. 23 2004 titled EASY TO USE DATA REPORT SPECIFICATION which is incorporated herein by reference in its entirety for all that is taught and disclosed therein.

The present invention relates generally to the field of software applications. More particularly the present invention relates to software applications that store data and report data such as database applications. More particularly still aspects of the present invention relate to specifying reports that may include grouping sorting and aggregation of data in data reports.

In order to manage large quantities of data computer software applications such as spreadsheet and database applications have been developed to organize and store the data in a logical manner. Typical spreadsheet and database applications comprise a large number of records of information wherein each record comprises a predetermined number of fields. In the context of a database a database management system is typically used to provide the software tools to manipulate the database more simply. Example database management systems include Microsoft Access and Microsoft SQL Server among others. Databases generally allow users to establish complex data interrelationships which increases the functionality of database applications but also makes them difficult for new users to understand and master.

A typical database management system provides the user the ability to add modify or delete data query data using filters and the ability to report records in the database. In contrast to filtering which may remove records from the user s view reporting simply reorganizes existing records without actually removing any content. Reporting may include grouping organizing records into groups hierarchically in the case of multiple groupings sorting aggregation performing numerical processing across one or more groups of records or other statistical processing of values within records in the database. Moreover the usual database management system also provides functionality related to maintaining the security and integrity of the database data.

Generating a readable report having large quantities of data in a spreadsheet or database application can be a complex and daunting task especially to new users. Database applications can be especially difficult to use since entire query languages are often used such as Structured Query Language or SQL to enable the more sophisticated reports and these languages are complex and have many nuances and are therefore intimidating to new users.

In accordance with the present invention a computer implemented method is provided for report specification. A signal to perform a grouping is received. In response to the signal a new group level is created. One or more default values for one or more controls in the new group level are subsequently created. Finally a grouping is performed according to the default control values and the results are displayed on a screen.

In accordance with other aspects the present invention relates to a computer implemented method for creating a group level outline panel using an existing database report. A signal is received to open an existing report. The existing report is opened parsed and analyzed to determine its group structure. A report dialogue is then generated using the group structure and the report dialogue is displayed on a screen.

In accordance with yet other aspects the present invention relates to a system for specifying reports. A receiving module receives report control signals and selections relating to a group level outline panel. A processing module generates a group level outline panel using an existing report. A creation module creates a new group level and sets default values for the new group level. A grouping module performs a database grouping. A sorting module performs a database sorting. An aggregating module performs a database aggregation. Finally a display module displays a group level outline panel and displays results of database groupings.

In accordance with still other aspects the present invention relates to a computer readable medium storing a computer interpretable data structure that stores one or more report specifications. The data structure includes one or more groupings each grouping corresponding to a database field and one or more controls each control corresponding to a report specification option.

The invention may be implemented as a computer process a computing system or as an article of manufacture such as a computer program product or computer readable media. The computer readable media may be a computer storage media readable by a computer system and encoding a computer program of instructions for executing a computer process. The computer program readable media may also be a propagated signal on a carrier readable by a computing system and encoding a computer program of instructions for executing a computer process.

These and various other features as well as advantages which characterize the present invention will be apparent from a reading of the following detailed description and a review of the associated drawings.

Prior to the present invention users had to manually formulate and modify reports using a suitably structured query language generally by designing and typing in query commands in order to produce display . Alternatively in some applications such as Microsoft Access a wizard assisted users with the creation of reports but users had no mechanism for easy editing of existing reports. Further some wizards do not provide the real time feedback of effecting report changes as they are made but rather only perform reporting once a report has been specified in its entirety.

The present invention by allowing a graphical dialogue for real time creation and modification of reports using a report specification written in plain English sentences solves many problems in the prior art and allows database and spreadsheet products to be more accessible than ever before to new users as discussed in more detail below.

Given that the present invention may be implemented as a computer system is provided to illustrate an example of a suitable computing system environment on which embodiments of the invention may be implemented. In its most basic configuration system includes at least one processing unit and memory . Depending on the exact configuration and type of computing device memory may be volatile such as RAM non volatile such as ROM flash memory etc. or some combination of the two. This most basic configuration is illustrated in by dashed line .

In addition to the memory the system may include at least one other form of computer readable media. Computer readable media can be any available media that can be accessed by the system . By way of example and not limitation computer readable media might comprise computer storage media and communication media.

Computer storage media includes volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Memory removable storage and non removable storage are all examples of computer storage media. Computer storage media includes but is not limited to RAM ROM EPROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can accessed by system . Any such computer storage media may be part of system .

System may also contain a communications connection s that allow the system to communicate with other devices. By way of example and not limitation communication connection s includes a wired network or direct wired connection and wireless connections such as acoustic RF infrared and other wireless media. The term computer readable media as used herein includes both storage media and communication media.

System may also contain a communications connection s that allow the system to communicate with other devices. The communications connection s is an example of communication media. Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. The term computer readable media as used herein includes both storage media and communication media.

In accordance with an embodiment the system includes peripheral devices such as input device s and or output device s . Exemplary input devices include without limitation keyboards computer mice pens or styluses voice input devices tactile input devices and the like. Exemplary output device s include without limitation devices such as displays speakers and printers. For the purposes of this invention the display is a primary output device. Each of these devices is well know in the art and therefore not described in detail herein.

As can be seen in dialogue a specified control within dialogue may be selected. One skilled in the art will appreciate that this control need not be located within the report dialogue itself. Rather control could appear anywhere on a computer desktop or other computer display abstraction and still fall within the scope of the present invention. Likewise a keyboard mouse or other input device could be used to signal a report dialogue instead of a clickable control . In an embodiment the controls when read from left to right comprise an English language sentence describing the effects of a given group level outline panel. This easy to read format not only makes the group level outline panel easier to use but also makes it clearer to the user what the effects of a given modification to a group level outline panel will be. In one embodiment the structure of a group level outline panel shows how grouping sorting and aggregation settings may affect one another. For example group on x sort by y when read left to right may be used to indicate that first records will be grouped and then the resulting groups will be sorted. Similarly group on x and aggregate may be used to indicate that first records will be grouped and then the resulting groups will be aggregated.

After control has been activated dialogue is replaced by dialogue which includes a group level outline panel . Arrow is displayed to indicate that selection of control causes the display of group level outline panel . Group level outline panel prompts the user to select a field on which to group using prompt . In one embodiment prompt is displayed in a different color to make it clear to the user that it can be modified. In other embodiments prompt may be highlighted using a bold font an italicized font by underlining one or more words associated with the prompt or other method of calling attention to text. In yet another embodiment non alphabetical symbols may be used to signify a prompt . In still another embodiment all group level outline panel text may appear with the same color and effects. One skilled in the art will appreciate that a dialogue box may be reused instead of replaced without departing from the scope of the claimed invention.

If prompt of dialogue is selected dialogue is replaced with dialogue . Dialogue includes a group level outline panel as in dialogue but with the addition of a pulldown menu that lists database fields table columns by which records may be grouped. Selecting a field from pull down menu causes grouping to be performed Method is the name of the selected field in exemplary dialogue . Following selection the dialogue is replaced with dialogue and group level outline panel is expanded to include additional report controls and as shown in dialogue . Further a more control appears which can be used to make still more report controls appear. Report controls and are initially set to default values discussed below in conjunction with .

One skilled in the art will appreciate that dialogue boxes and may be reused instead of replaced without departing from the scope of the claimed invention.

In the interest of economy of desktop space to avoid cluttering the dialogue with controls that are needed only rarely only the most frequently used controls are presented in a group level outline panel in the exemplary embodiment. In another embodiment features that a developer wishes to advertise i.e. powerful features of which users may not be aware may be placed in a group level outline panel. As may be appreciated an aspect of some embodiments of the present invention relates to identifying and displaying information and associated controls likely to be used and or needed to build a report. To that end a further embodiment only expands the details of a selected group level of the group level outline panel. Such limited display reduces clutter which reduces potential confusion such as when many group levels exist thereby making it easier for users to discern which phrases are relevant to their current selection.

In the exemplary embodiment of group level outline panel by control is a frequently needed report modifier. By control is used to select whether a group is defined to include records with an entire value in common or only with a portion of a value in common. Sort control determines in what order the resulting record groups are sorted. Sort control provides context sensitive control for sorting grouped data. This means that for an alphabetical or alphanumeric field grouped records may be sorted in various orders based on the starting letter e.g. with A on top or with Z on top as shown in exemplary dialogue . In another embodiment numeric fields may yield a with 0 on top sort direction control a with 9 on top sort direction control etc. In this way the English language description of the report changes dynamically based on the selected field or table column being grouped.

Header control controls whether a header a separating space at the top of a group level will be placed in the report. Headers serve to visually differentiate group levels from one another. Footers serve the same function except that they appear at the bottom of a group level and may be similarly enabled using header control .

Totals control allows users to aggregate records. Aggregation is the numerical processing of values across records such as summing a group of values averaging a group of values computing a minimum or maximum of a group of values counting the number of a values in a group etc. By using totals control a report that aggregates across groups may be produced such that each group has its own independent set of totals. Such a report contains an additional total row at the bottom of each group indicating the sum of the values in a selected column for a selected group. Similarly totals control can be used to select numeric averaging across groups numeric median and other statistical computations.

More control may be used to expand group level outline panel to include additional controls. Correspondingly a less control not pictured may be used to limit group level outline panel to only the most frequently needed controls. In an embodiment more control can be selected repeatedly to make successively more additional controls visible. In another embodiment which controls are initially visible and which controls become visible upon successive use of more control is determined by monitoring usage patterns for a user and giving frequently used controls priority of less frequently used controls.

In one embodiment selecting more control altering one of the newly displayed report controls and then selecting the less control not pictured will result in the newly modified value appearing in the reduced group level outline panel. In a particular embodiment any values that are not set to the default should be displayed along with their corresponding control since these affect the resulting report in a non default manner. If all non default values are not presented the user may forget about a modifier being selected and become confused by the resulting report.

The controls presented here are purely exemplary in nature and do not represent all possible types of controls that may be used in conjunction with the present invention. Likewise different controls relevant to database reports may be used in place of these exemplary controls without departing from the scope of the claimed invention.

In an embodiment controls are chosen based on the context of grouped by data. For example grouping on a numeric field may trigger the availability of sort order controls including 0 on top 9 on top etc. In another example grouping on an alphabetical field may trigger the availability of sort order controls including A on top Z on top etc. In still another example grouping on a date field may trigger the availability of sort order controls including newest on top oldest on top etc. Similarly grouping on a numeric field may trigger the availability of certain aggregation or other mathematical processing controls such as Compute total Compute minimum Compute maximum compute average etc.

In an embodiment modifications to a group level outline panel result in real time updates to records shown on the screen. As a result users creating or modifying a group level outline panel may receive instant feedback with regard to the effects of the action.

Create operation groups records by the selected field discussed below in conjunction with . Create operation also modifies group level outline panel to display frequently needed report modifier controls and .

Set default operation then sets default values for one or more report modifier controls. In one embodiment only default values for the controls currently visible to the user are set with the remaining controls being set upon the selection of more control . In another embodiment all default control values are set regardless of whether they will be immediately visible to the user. In an embodiment a default value set by set default operation represents the most frequently needed value for a control. In another embodiment the default value set by set default operation represents the most intuitive initial value for a control.

After set default operation sets one or more default values group operation groups records according to those default values. In an embodiment group operation creates one or more queries associated with a report and executes those queries. In an embodiment group operation creates an SQL query and executes it. While SQL is a predominant query language used today in database management systems filter queries may be created in any query language including specialized versions of SQL such as HQL Health Query Language or query languages unrelated to SQL. Execution of a query may occur at the database management system level or may be delegated to a lower level program that accesses the database. Queries may be executed on the same system as the database management system is running or sent out to one or more remote systems for execution. In the latter case the remote system returns results either directly or indirectly to the database management system so that the results of the query may be displayed.

Group operation next updates the display to reflect the new grouping including updating the group level outline panel to show the new grouping and updating the records shown in the report. In one embodiment group operation updates the display by actually rendering a group level outline panel or reported records on the screen. In an alternative embodiment group operation relies on application programming interfaces APIs or other indirect method of updating screen contents.

Window contains a drag prompt that prompts a user to drag a column from a database table. A mouse pointer can be seen selecting the Ship Name column said column containing numerous ungrouped names. In an embodiment drag prompt may also be used to drag a column from an existing report to refine the grouping done by an existing report. In an embodiment a handle is presented to the user the handle e.g. a small box with dots displayed therein providing the user a tangible item to select and drag in order to drag a column. Each column therefore may have a handle .

In window the mouse pointer can be seen dropping the Ship Name field onto drag prompt having dragged the handle there from its original position as seen in window .

In window the results of the drag and drop operation can be seen. A group level outline panel grouping on Ship Name has appeared along with a grouped report . Grouped report lists each Ship Name value only once for each group of records. One skilled in the art will appreciate that this feature not only reduces redundant data from cluttering up a report but also produces an easy to read hierarchical report format.

In an exemplary embodiment depicted in drag prompt and subsequent group level outline panel information is displayed separately from tabular database data such that prompts and group level outline panels do not overlap the data. In contrast to traditional approaches to specifying a report tabular data remains readable throughout the grouping process providing additional feedback to users engaged in specifying a report.

First receive operation receives a signal to open an existing report. As discussed above the existing report need not have been created by an application containing the present invention. In an embodiment an existing report may be in the form of a file. In another embodiment an existing report may be in the form of a stream being received by a client from a database server. Receive operation triggers parse operation to read the report. Parse operation then reads the existing report into memory.

Analyze operation analyzes the report s structure including the grouping hierarchy specified therein if one exists and uses that structure as a model for building a corresponding group level outline panel. If no grouping hierarchy is specified embodiments of the invention may create a grouping hierarchy. Display operation then renders the group level outline panel in a report dialogue along with any necessary group level outline panel controls. The resulting report dialogue and group level outline panel allow a user to easily edit an existing report of arbitrarily high complexity regardless of the origin or creation method of the existing report. In one embodiment display operation also executes the existing report and organizes the displayed data records on the screen accordingly.

Three dialogues and can be seen. In one embodiment of the present invention dialogue includes a group level outline panel which includes a Method group and below that a Company group. A mouse pointer is being used to select the Company group.

Dialogue illustrates the Company group of group level outline panel having been dragged to the Method group of group level outline panel as can be seen by the new position of the mouse pointer . When the Company group is dropped on the Method group the resulting group level outline panel may be seen in dialogue . Group level outline panel reflects the new grouping ordering and resulting group hierarchy that will appear in the actual report not shown .

In the exemplary embodiment presented above in conjunction with only the currently selected group in this case Company has a group level outline panel including report controls displayed. In an alternate embodiment report controls are present for all groups not just the group currently selected.

Alternatively or additionally receive operation may receive input from the user via a report design dialogue. Receive operation may also adjust values for existing report controls via a group level outline panel. Receive operation sends received value adjustments to create operation for implementation and may also receive group level outline panel data from create operation so that the report design dialogue may be kept up to date.

In one embodiment creation module creates one or more group levels using the structure data received from processing module . In an alternate embodiment creation module creates one or more group levels using input received from receive operation . In yet another embodiment creation module creates one or more group levels using both structural data received from processing module and user input from receive operation .

Creation module then sets one or more default values for controls in each group level. As discussed previously default values may be selected based on a variety of different criteria including which value is most likely to be needed in the current context which value is likely to be the most intuitive to the user etc. Creation module then sends the resulting group levels and control values to grouping module for performance of the specified groupings.

Grouping module performs one or more groupings according to the grouping specification data received from creation module . In one embodiment grouping module constructs and issues a query in a suitable query language such as SQL. In another embodiment grouping module performs grouping by directly accessing a data table. Grouping module sends the results of a grouping to display module .

Sorting module sorts one or more groupings according to the sorting specification received from creation module . In one embodiment sorting module constructs and issues a query in a suitable query language such as SQL. In another embodiment sorting module performs sorting by directly accessing a data table. In yet another embodiment sorting module performs sorting by directly accessing the results of an SQL query issued by grouping module . Sorting module sends the results of a sorting to display module .

Aggregating module performs aggregation or other numerical processing on one or more groupings according to the aggregation specification received from creation module . In one embodiment aggregation module constructs and issues a query in a suitable query language such as SQL. In another embodiment aggregation module performs aggregation by directly accessing a data table. In yet another embodiment aggregation module performs aggregation by directly accessing the results of an SQL query issued by grouping module . Aggregation module sends the results of an aggregation to display module .

Display module receives results of a grouping from grouping module and displays those results on a screen. In one embodiment display module renders the results directly on the screen. In an alternate embodiment display module uses an API or other indirect method to display data on a screen. A grouping specification sorting specification or aggregation specification may subsequently be refined by a user via receiving module discussed above.

In one embodiment a grouping specification may contain other group level attributes. For example a sort direction attribute may control whether records in a given group are sorted in ascending order or descending order. In another exemplary embodiment a keep together attribute may control whether records in the group are kept together when printed. Other group level attributes are also contemplated.

Grouping module may additionally perform intelligent visualization of intervals. In one exemplary embodiment when customer name field is grouped by the first letter of the last name a group heading specifying each starting letter will be generated at the beginning of each group. In another exemplary embodiment when customer address field is grouped by city a group heading specifying each city will be generated at the beginning of each group. This may be done to improve readability of a grouped report and for other reasons. In an alternate embodiment only the first record of each group will show the grouped by data see where the Ship Name field includes only one entry for each group .

An embodiment of the invention relates to both the process and the user interface for group creation and illustrate exemplary screenshots for doing the same. illustrates an example screenshot showing a control that is used to begin the process of creating a grouping. Control is similar to control discussed above in conjunction with and in an embodiment may be clicked on or otherwise selected by a user to trigger the appearance of a group level outline panel not shown . Ungrouped data may also be seen in screenshot .

Comparing illustrates another aspect of some embodiments of the present invention. That is some embodiments of the present invention identify and display information and associated controls likely to be used or needed to build a report while hiding other controls. Yet other embodiments further this concept to display only the details of a selected group level of the group level outline panel. For instance in group level outline panel is selected and such panel is expanded to show relevant controls. however illustrates a group level control that is in an embodiment part of a sub group level . The sub group level may be independently selected and when selected only controls associated with the group level are displayed while those associated with group level are hidden. Such limited display reduces clutter and reduces potential confusion such as when many group levels exist thereby making it easier for users to discern which phrases are relevant to their current selection.

Other contextually appropriate grouping refinements are also envisioned such as by day by month and by year for date fields and or by first digit by first two digits etc. for numeric fields and so on. The various embodiments described above are provided by way of illustration only and should not be construed to limit the invention. Those skilled in the art will readily recognize various modifications and changes that may be made to the present invention without following the example embodiments and applications illustrated and described herein and without departing from the true spirit and scope of the present invention which is set forth in the following claims.

