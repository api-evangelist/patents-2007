---

title: Battery remaining capacity detecting apparatus and battery remaining capacity detecting method
abstract: A battery remaining capacity detecting apparatus includes a remaining capacity calculating section, first and second target remaining capacity calculating sections and a remaining capacity revising section. The first and second target remaining capacity calculating sections are configured to calculate first and second target remaining capacities using first and second calculation processes when first and second prescribed battery related conditions are satisfied, respectively. The second calculating process has a lower accuracy than the first calculation process, and the second prescribed battery related condition is satisfied with a higher frequency than the first prescribed battery related condition. The remaining capacity revising section is configured to revise the remaining capacity toward the first and second target remaining capacities using revision amounts equal to or smaller than first and second revision amount upper limit values, respectively with the second revision amount upper limit value being smaller than the first revision amount upper limit value.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07688032&OS=07688032&RS=07688032
owner: Nissan Motor Co., Ltd.
number: 07688032
owner_city: Yokohama
owner_country: JP
publication_date: 20070730
---
This application claims priority to Japanese Patent Application No. 2006 212277 filed on Aug. 3 2006. The entire disclosure of Japanese Patent Application No. 2006 212277 is hereby incorporated herein by reference.

The present invention relates to a battery remaining capacity detecting apparatus and a battery remaining capacity detecting method.

Japanese Laid Open Patent Publication No. 2002 170600 discloses a conventional battery remaining capacity detecting apparatus that detects a remaining capacity of a battery by integrating the charge discharge current of the battery over time. When such conventional remaining capacity detecting apparatus integrates the charge discharge current of the battery over a long period of time the error of the detected current accumulates and thus there is the possibility that the error between the actual remaining capacity and the detected remaining capacity becomes large. Therefore the conventional battery remaining capacity detecting apparatus as mentioned above performs a battery remaining capacity revision control by calculating the remaining capacity of the battery based on a voltage of the battery measured when the current of the battery is in a steady state constant current state and using the calculated remaining capacity value to revise the remaining capacity obtained by integrating the charge discharge current of the battery.

In view of the above it will be apparent to those skilled in the art from this disclosure that there exists a need for an improved battery remaining capacity detecting apparatus. This invention addresses this need in the art as well as other needs which will become apparent to those skilled in the art from this disclosure.

With the battery remaining capacity revision control in the conventional battery remaining capacity detecting apparatus as described above there are few opportunities for revising the remaining capacity obtained by integrating the charge discharge current because the revision control is performed using the remaining capacity value calculated based on the battery voltage measured when the current of the battery is in a steady state. Consequently there are times when an accurate remaining capacity of the battery cannot be obtained in the conventional battery remaining capacity detecting apparatus.

Accordingly one object of the present invention is to provide battery remaining capacity detecting apparatus and method configured and arranged to obtain an accurate remaining capacity of the battery.

In order to achieve the above mentioned object a battery remaining capacity detecting apparatus includes a remaining capacity calculating section a first target remaining capacity calculating section a second target remaining capacity calculating section and a remaining capacity revising section. The remaining capacity calculating section is configured to calculate a remaining capacity of a battery by an integration calculation process based on a value obtained by integrating one of a charge discharge current and a charge discharge power of the battery over time. The first target remaining capacity calculating section is configured to calculate a first target remaining capacity of the battery using a first calculation process that is different from the integration calculation process when a first prescribed battery related condition is satisfied. The second target remaining capacity calculating section is configured to calculate a second target remaining capacity of the battery using a second calculation process when a second prescribed battery related condition is satisfied. The second calculation process is different from the integration calculation process and the first calculation process with the second calculating process for calculating the second target remaining capacity having a lower accuracy than the first calculation process for calculating the first target remaining capacity. The second prescribed battery related condition being satisfied with a higher frequency than the first prescribed battery related condition. The remaining capacity revising section is configured to revise the remaining capacity calculated by the remaining capacity calculating section toward the first target remaining capacity using a revision amount equal to or smaller than a first revision amount upper limit value when the first prescribed battery related condition is satisfied and to revise the remaining capacity calculated by the remaining capacity calculating section toward the second target remaining capacity using the revision amount equal to or smaller than a second revision amount upper limit value when the second prescribed battery related condition is satisfied the second revision amount upper limit value being smaller than the first revision amount upper limit value.

These and other objects features aspects and advantages of the present invention will become apparent to those skilled in the art from the following detailed description which taken in conjunction with the annexed drawings discloses a preferred embodiment of the present invention.

Selected embodiment of the present invention will now be explained with reference to the drawings. It will be apparent to those skilled in the art from this disclosure that the following description of the embodiment of the present invention are provided for illustration only and not for the purpose of limiting the invention as defined by the appended claims and their equivalents.

Referring initially to a drive system of a vehicle e.g. an electric vehicle having a battery remaining capacity detecting apparatus in accordance with one embodiment of the present invention is illustrated. As shown in the drive system includes a battery pack an inverter and a motor . Moreover the drive system is further provided with a voltage sensor a current sensor a thermistor a battery control unit a pair of high voltage relays and a high voltage harness and a vehicle control unit .

The battery pack includes a plurality of cells C to Cn connected in series. The battery pack is arranged as for example a conventional lithium ion secondary battery that produces a direct current DC voltage. The DC voltage of the battery pack is converted into a three phase alternating current AC voltage by the inverter and applied to the motor that serves as a drive source for the electric automobile. The motor is arranged as for example a conventional three phase AC motor. The high voltage harness is connected between the battery pack and the inverter . The high voltage harness is provided with the high voltage relays and as shown in . The ON OFF status of each of the high voltage relays and is controlled by the battery control unit .

The voltage sensor is configured and arranged to detect a total voltage BATVOL i.e. an output voltage of the battery pack . The current sensor is configured and arranged to detect the charge current and the discharge current of the battery pack hereinafter referred to as charge discharge current BATCUR . The charge discharge current BATCUR has a negative value when the battery pack is being charged and has a positive value when the battery pack is discharging. The thermistor is provided to detect the temperature of the battery pack .

The vehicle control unit is connected to the battery control unit with a vehicle internal LAN. The vehicle control unit is configured to execute overall general control of the vehicle.

As shown in the battery control unit includes a CPU a memory device and a timer . The battery control unit is configured to receive signals indicative of the total battery voltage BATVOL detected by the voltage sensor the battery charge discharge current BATCUR detected by the current sensor and the battery temperature detected by the thermistor at a prescribed sampling rate. The battery control unit preferably includes a microcomputer with a battery remaining capacity detecting control program that controls the calculation of the state of charge SOC of the battery pack as discussed below. The battery control unit can also include other conventional components such as an input interface circuit an output interface circuit and storage devices such as a ROM Read Only Memory device and a RAM Random Access Memory device. The memory circuit e.g. the memory device stores processing results and control programs such as ones for the first second and third target SOC calculation operations that are run by the processor circuit. The battery control unit is operatively coupled to the battery pack the high voltage relays and and other various components in a conventional manner. The internal RAM of the battery control unit stores statuses of operational flags and various control data. The internal ROM of the battery control unit stores the various data for various operations. The battery control unit is capable of selectively controlling any of the components of the control system in accordance with the control program. It will be apparent to those skilled in the art from this disclosure that the precise structure and algorithms for the battery control unit can be any combination of hardware and software that will carry out the functions of the present invention. In other words means plus function clauses as utilized in the specification and claims should include any structure or hardware and or algorithm or software that can be utilized to carry out the function of the means plus function clause.

The memory device is configured and arranged to store data indicating the relationship between the open circuit voltage of the battery pack i.e. the voltage of the battery pack when the battery pack is neither charging nor discharging and the state of charge SOC of the battery pack i.e. the ratio of the remaining capacity to the fully charged capacity data indicating the relationship between the internal resistance and the state of charge SOC of the battery pack and data indicating the relationship between the temperature of the battery pack and a temperature compensation coefficient for revising the internal resistance of the battery pack . These data are obtained experimentally and stored in advance. The open circuit voltage of the battery pack is also called the no load voltage because it corresponds to the voltage when the battery pack is not carrying a load. The state of charge SOC is also called simply remaining capacity because the state of charge SOC is a numeric value that indicates the remaining capacity of the battery pack .

The battery control unit is configured to continuously calculate the state of charge SOC of the battery pack by integrating the charge discharge current BATCUR detected when the battery pack is charging or discharging integration calculation process . Additionally the battery control unit is configured to revise reset the calculated state of charge SOC using a revision control process that will be described in more detail below.

First the method of calculating the state of charge by integrating the charge discharge current BATCUR will now be explained. The battery control unit is configured to calculate a latest updated value AHCAP new ampere hours Ah of the electric current integration capacity of the battery pack remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR based on the previous value AHCAP old Ah of the electric current integration capacity calculated in the previous control cycle and a current detection sampling rate RUNARATE seconds sec using the equation 1 shown below. As explained previously the value of the charge discharge current BATCUR amperes A is negative when a charge current is detected and is positive when a discharge current is detected. AHCAP new AHCAP old BATCUR RUNARATE 3600 1 

The battery control unit is configured to calculate an initial value of AHCAP old based on the state of charge SOC using the equation 1 below. The state of charge SOC is calculated based on the open circuit voltage of the battery pack in the no load state state obtained when the high voltage relays and are off and the open circuit voltage versus the state of charge SOC data stored in the memory device which is data expressing the relationship between the open circuit voltage and the state of charge SOC as seen in for example . Initial value of AHCAP old AHFULL SOC 100 1 

In the equation 1 above a value AHFULL indicates the capacity Ah of the battery pack when the battery pack is fully charged.

Using the equation 2 shown below the battery control unit is configured to calculate the state of charge SOC of the battery pack based on the electric current integration capacity AHCAP new calculated with the above equation 1 . The state of charge SOC calculated by integrating the charge discharge electric current BATCUR is indicated as AHSOC . AHSOC AHCAP new AHFULL 100 2 

The methods of calculating target values of the state of charge i.e. the target SOC for revising the state of charge AHSOC calculated based on the value obtained by integrating the charge discharge current BATCUR will now be explained. In this illustrated embodiment the remaining capacity detecting apparatus of the present invention is configured to calculate a first target SOC a second target SOC and a third target SOC for revising the state of charge AHSOC calculated by integrating the charge discharge current BATCUR.

The battery control unit is configured to calculate the first target SOC first target remaining capacity with a first computation process when a first reset condition is satisfied. The first reset condition is arranged such that the first target SOC is calculated with the lowest frequency among the three target SOCs i.e. the first reset condition for calculating the first target SOC is satisfied less often than second and third reset conditions for calculating the second and third target SOCs respectively . The first computation process is configured such that the calculation accuracy of the first target SOC is the highest among the three target SOCs.

More specifically the battery control unit is configured to calculate the first target SOC based on the open circuit voltage of the battery pack . The battery control unit is configured to use the terminal voltage voltage between terminals of the battery pack when a prescribed amount of time Ta has elapsed since an absolute value of the charge discharge current BATCUR became smaller than a prescribed current I first prescribed current value as the open circuit voltage. The battery control unit is configured to calculate the first target SOC based on this open circuit voltage and the open circuit voltage versus the state of charge SOC data stored in the memory device which is data expressing the relationship between the open circuit voltage and the state of charge SOC such as one shown in . The prescribed current I is a value small enough to assume that the battery pack is neither charging nor discharging i.e. in the no load state .

The battery control unit is configured to use the terminal voltage of the battery pack as the open circuit voltage when a prescribed amount of time Ta has elapsed since the absolute value of the charge discharge current BATCUR became smaller than the prescribed current I for the following reasons.

Thus in order to perform the first computation process for calculating the first target SOC the first reset condition must be satisfied in which the prescribed amount of time Ta has elapsed since the absolute value of the charge discharge current BATCUR became smaller than the prescribed current I.

The battery control unit is configured to calculate the second target SOC first or second target remaining capacity by a second computation process when a second reset condition is satisfied. The second reset condition is arranged such that the second target SOC is calculated with the second highest frequency among the three target SOCs i.e. the second reset condition for calculating the second target SOC is satisfied less often than a third reset condition for calculating the third target SOC but more often than the first reset condition for calculating the first target SOC . The second computation process is configured such that the calculation accuracy of the second target SOC is the second highest among the three target SOCs i.e. the calculation accuracy of the second computation process for calculating the second target SOC is higher than that of the third computation process for calculating the third target SOC but lower than that of the first computation process for calculating the first target SOC .

The second computation process for calculating the second target SOC will now be explained. First the battery control unit is configured to calculate the internal resistance REST of the battery pack based on the state of charge calculated based on the current integration value and the internal resistance versus the state of charge SOC data stored in the memory device which is data expressing the relationship between the internal resistance and the state of charge SOC such as the one shown in . Since the internal resistance changes in accordance with the temperature of the battery pack the calculated internal resistance is revised using the temperature compensation coefficient. The temperature compensation coefficient is obtained based on the temperature of the battery pack detected by the thermistor and the battery temperature versus the revision coefficient data stored in the memory device which is data expressing the relationship between the battery temperature and the revision coefficient temperature compensation coefficient for revising the internal resistance .

When a prescribed amount of time e.g. 5 seconds has elapsed since the battery pack started discharging and the discharge current has become equal to or smaller than a prescribed current I second prescribed current value the battery control unit is configured to calculate the open circuit voltage EZERO volts V of the battery pack using the equation 3 below based on the voltage BATVOL V detected by the voltage sensor the discharge current BATCUR detected by the current sensor and the internal resistance REST calculated by the method described above. Generally if the discharge current is too large then the internal resistance rises sharply and the error between the open circuit voltage EZERO calculated with the equation 3 and the actual open circuit voltage increases. Therefore the prescribed current I is set so as to establish a range upper limit value of current values for which the open circuit voltage EZERO can be calculated accurately with the equation 3 and the open circuit voltage EZERO is only calculated using the equation 3 when the discharge current is equal to or below the prescribed current I. EZERO BATVOL BATCUR REST 3 

Finally the battery control unit is configured to calculate the state of charge SOC i.e. the second target SOC based on the open circuit voltage EZERO calculated using the equation 3 and the open circuit voltage versus the state of charge SOC data stored in the memory device such as one shown in .

Thus in order to perform the second computation process for calculating the second target SOC the second reset condition must be satisfied in which a prescribed amount of time e.g. 5 seconds has elapsed since the battery pack started discharging and that the discharge current is equal to or below the prescribed current I. Since the only requirement regarding the prescribed current I is that it be small enough to avoid an abrupt increase in the internal resistance the value of the prescribed current I is larger than the value of the prescribed current I used to define the first reset condition which determines when the first target SOC can be calculated . Therefore the frequency with which the second reset condition is satisfied is higher than the frequency with which the first reset condition is satisfied.

The prescribed amount of time used in the second reset condition is set so as to coordinate the condition for detecting the current with a third reset condition described later and can be changed as necessary.

The battery control unit is configured to calculate the third target SOC second or third target remaining capacity by a third computation process when a third reset condition is satisfied. The third reset condition is arranged such that the third target SOC is calculated with the highest frequency among the three target SOCs i.e. the third reset condition for calculating the third target SOC is satisfied more often than the first and second reset conditions . The third computation process is configured such that the calculation accuracy of the third target SOC is the lowest among the three target SOCs.

The third computation process for calculating the third target SOC will now be explained. First while the battery pack is charging or discharging more specifically when a prescribed amount of time e.g. 5 seconds similarly to the second reset condition has elapsed since the battery pack started discharging the battery control unit is configured to collect a plurality of data points comprising the voltage BATVOL detected by the voltage sensor and the discharge current BATCUR detected by the current sensor . The collected data points of the voltage BATVOL and the discharge current BATCUR data are plotted on a graph configured such that the voltage is indicated on the vertical axis and the current is indicated on the horizontal axis. Then the battery control unit is configured to calculate a straight regression line generally called an I V line or I V curve based on the plotted points. is a map showing an example of the regression line calculated based on data points of the detected voltage values and the detected current values. The voltage corresponding to a point in where the regression line intersects the voltage vertical axis where the discharge current is 0 is taken as the open circuit voltage of the battery pack . Then the battery control unit is configured to calculate the state of charge i.e. the third target SOC based on the open circuit voltage of the battery pack calculated using the regression line e.g. the regression line shown in and the open circuit voltage versus the state of charge SOC data stored in the memory device such as one shown in .

Thus in order to perform the third computation process for calculating the third target SOC the third reset condition must be satisfied in which a number of data points i.e. total voltage BATVOL versus discharge current BATCUR data points required for calculating a regression line have been collected. The third reset condition is satisfied when a predetermined number of data points i.e. the number of data points required for calculating the regression line have been collected and thus the third reset condition is not dependent on the value of the discharge current of the battery pack . For example the third reset condition can be determined based on a prescribed time being elapsed since the last revision by the third computation process with the prescribed time being set so that the predetermined number of data points can be collected within the prescribed time. Alternatively the third reset condition can be determined based on the battery condition indicative of that the predetermined number of data points has been collected. Consequently the third reset condition is satisfied with a higher frequency than the first and second reset conditions described above.

In step S the CPU is configured to determine if the first reset condition is satisfied. If the first reset condition is satisfied Yes in step S then the CPU proceeds to step S.

In step S the CPU is configured to calculate the first target SOC using the first computation process described previously. The calculated first target SOC is indicated as ECAPSOC. After calculating the first target SOC ECAPSOC the CPU proceeds to step S.

In step S the CPU is configured to calculate a revision amount upper limit value that serves as an upper limit to the amount by which the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised based on the first target SOC ECAPSOC . More specifically the CPU is first configured to calculate a maximum value SOCRSTMAX of the electric current integration error accumulated since the previous reset control previous revision control using the equation 4 below based on the time TIMRST seconds measured by the timer SOCRSTMAX MAXDSOC TIMRST 4 

In the equation 4 above a value MAXDSOC represents a maximum value of the electric current integration error per unit time that has been converted into a value having the same unit as the state of charge SOC value. The maximum value MAXDSOC of the electric current integration error per unit time is preferably set in advance based on the error between the detected current value acquired by the battery control unit and the actual current value i.e. the detection error of the current sensor . This error is preferably determined in advance experimentally or by some other appropriate methods.

The CPU is then configured to compare the maximum value SOCRSTMAX of the electric current integration error calculated with the equation 4 above to a first revision amount upper limit value SOCRST that has been set in advance and to set the smaller of the two values as a revision amount upper limit value SOCRST. In other words if the condition SOCRSTMAX SOCRST exists then the revision amount upper limit value SOCRST is set to the value of the maximum value SOCRSTMAX of the electric current integration error SOCRST SOCRSTMAX . On the other hand if the condition SOCRST

After step S the CPU proceeds to step S. In step S the CPU is configured to reset revise the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack based on the first target SOC ECAPSOC calculated in step S. More specifically in step S the CPU is configured to reset the remaining capacity AHSOC differently depending on whether or not the absolute value of the difference between the first target SOC ECAPSOC and the remaining capacity AHSOC is equal to or smaller than the revision amount upper limit value SOCRST set in step S.

If the condition ECAPSOC AHSOC SOCRST exists in step S then the value of the remaining capacity AHSOC is changed to the value ECAPSOC i.e. the value of the first target SOC.

On the other hand if the condition ECAPSOC AHSOC SOCRST and the condition ECAPSOC AHSOC exist then the remaining capacity AHSOC is revised in accordance with the equation 5 shown below. AHSOC latest value AHSOC previous value SOCRST 5 

In short the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised toward the first target SOC ECAPSOC and the revision amount used to accomplish the revision is limited so as to be equal to or smaller than the revision amount upper limit value SOCRST.

After step S the CPU proceeds to step S. In step S the CPU is configured to clear sets to 0 the time measurement value of the timer . Then the CPU proceeds to step S.

On the other hand if in step S the CPU determines that the first reset condition is not satisfied No in step S then the CPU proceeds to step S.

In step S the CPU is configured to determine if the second reset condition is satisfied. If the second reset condition is satisfied Yes in step S then the CPU proceeds to step S.

In step S the CPU is configured to calculate the second target SOC using the second computation process described previously. The calculated second target SOC is indicated as ECAPSOC. After calculating the second target SOC ECAPSOC the CPU proceeds to step S.

In step S the CPU is configured to calculate a revision amount upper limit value that serves as an upper limit to the amount by which the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised based on the second target SOC ECAPSOC . Similarly to step S the CPU is configured to calculate a maximum value SOCRSTMAX of the electric current integration error using the aforementioned equation 4 based on the time TIMRST seconds measured by the timer . Then the CPU is configured to compare the maximum value SOCRSTMAX to a second revision amount upper limit value SOCRST. The CPU is then configured to set the smaller of the two values as the revision amount upper limit value SOCRST. The second revision amount upper limit value SOCRST is preferably set in advance to a prescribed value that is smaller than the first revision amount upper limit value SOCRST.

After step S the CPU proceeds to step S. In step S the CPU is configured to reset revise the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack based on the second target SOC ECAPSOC calculated in step S. The method of revising the remaining capacity AHSOC is the basically same as the method used in step S.

More specifically in step S the CPU is configured to reset the remaining capacity AHSOC differently depending on whether or not the absolute value of the difference between the second target SOC ECAPSOC and the remaining capacity AHSOC is equal to or smaller than the revision amount upper limit value SOCRST set in step S.

If the condition ECAPSOC AHSOC SOCRST exists then the CPU is configured to change the value of the remaining capacity AHSOC to the value ECAPSOC i.e. the value of the second target SOC.

On the other hand if the condition ECAPSOC AHSOC SOCRST and the condition ECAPSOC AHSOC exist then similarly to step S the CPU is configured to revise the remaining capacity AHSOC in accordance with the equation 5 shown below. AHSOC latest value AHSOC previous value SOCRST 5 

In short the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised toward the second target SOC ECAPSOC and the revision amount used to accomplish the revision is limited so as to be equal to or smaller than the revision amount upper limit value SOCRST.

After step S the CPU proceeds to step S. In step S the CPU is configured to clear set to 0 the time measurement value of the timer . Then the CPU proceeds to step S.

On the other hand if in step S the CPU determines that the second reset condition is not satisfied No in step S the CPU proceeds to step S.

In step S the CPU is configured to determine if the third reset condition is satisfied. If the CPU determines that the third reset condition is not satisfied No in step S the CPU returns to step S. If the CPU determines that the third reset condition is satisfied Yes in step S then the CPU proceeds to step S.

In step S the CPU is configured to calculate the third target SOC using the third computation process described previously. The calculated third target SOC is indicated as ECAPSOC. After calculating the third target SOC ECAPSOC the CPU proceeds to step S.

In step S the CPU is configured to calculate a revision amount upper limit value that serves as an upper limit to the amount by which the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised based on the third target SOC ECAPSOC . Similarly to steps S and S the CPU is configured to calculate a maximum value SOCRSTMAX of the electric current integration error using the aforementioned equation 3 based on the time TIMRST seconds measured by the timer . Then the CPU is configured to compare the maximum value SOCRSTMAX to a third revision amount upper limit value SOCRST. The CPU is then configured to set the smaller of the two values as the revision amount upper limit value SOCRST. The third revision amount upper limit value SOCRST is preferably set in advance to a prescribed value that is smaller than the second revision amount upper limit value SOCRST. In other words the relationship expressed in the equation 7 below exists among the first revision amount upper limit value SOCRST the second revision amount upper limit value SOCRST and the third revision amount upper limit value SOCRST. SOCRST3

After step S the CPU proceeds to step S. In step S the CPU is configured to reset revise the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack based on the third target SOC ECAPSOC calculated in step S. The method of revising the remaining capacity AHSOC is the basically same as the method used in steps S and S.

More specifically in step S the CPU is configured to reset the remaining capacity AHSOC differently depending on whether or not the absolute value of the difference between the third target SOC ECAPSOC and the remaining capacity AHSOC is equal to or smaller than the revision amount upper limit value SOCRST set in step S.

If the condition ECAPSOC AHSOC SOCRST exists then the CPU is configured to change the value of the remaining capacity AHSOC to the value ECAPSOC i.e. the value of the third target SOC.

On the other hand if the condition ECAPSOC AHSOC SOCRST and the condition ECAPSOC AHSOC exist then similarly to steps S and S the CPU is configured to revise the remaining capacity AHSOC in accordance with the equation 5 shown below. AHSOC latest value AHSOC previous value SOCRST 5 

In short the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised toward the third target SOC ECAPSOC and the revision amount used to accomplish the revision is limited so as to be equal to or smaller than the revision amount upper limit value SOCRST.

After step S the CPU proceeds to step S. In step S the CPU is configured to clear set to 0 the time measurement value of the timer . Then the CPU proceeds to step S.

In step S the CPU is configured to determine if a shut down request has been received. When the driver turns off the key switch ignition switch not shown the battery control unit receives the shut down request. If the CPU determines that the shut down request has not been received No in step S then the CPU returns to step S and repeats the remaining capacity detecting control as shown in the flowchart of . On the other hand if the CPU determines that the shut down request has been received Yes in step S the CPU ends this processing sequence for calculating the remaining capacity state of charge SOC of the battery pack .

Accordingly the battery remaining capacity detecting apparatus in accordance with the illustrated embodiment is configured to calculate the remaining capacity AHSOC by integrating the charge discharge current BATCUR of the battery pack . The battery remaining capacity detecting apparatus is further configured to calculate a first target remaining capacity the first target SOC or the second target SOC for revising the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack when the first prescribed battery related condition the first reset condition or the second reset condition is satisfied and to calculate a second target remaining capacity the second target SOC or the third target SOC for revising the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack when the second prescribed battery related condition the second reset condition or the third reset condition is satisfied the second prescribed battery related condition occurring being satisfied at a higher frequency than the first prescribed battery related condition. The second calculation process the second computation process or the third computation process of the second target remaining capacity is arranged to be less accurate than the first calculation process the first computation process or the second computation process of the first target remaining capacity. If the first prescribed battery related condition is satisfied then the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack is revised toward the first target remaining capacity the first target remaining capacity serving as a target value with a revision amount that is equal to or smaller than a first revision amount upper limit value SOCRST or SOCRST . Meanwhile if the second prescribed battery related condition is satisfied then the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR is revised toward the second target remaining capacity the second target remaining capacity serving as a target value with a revision amount that is equal to or smaller than a second revision amount upper limit value SOCRST or SOCRST that is smaller than the first revision amount upper limit value. As a result a balance can be achieved between the frequency and the accuracy with which the remaining capacity AHSOC is revised. More specifically although the number of revisions revision frequency would be small if only revisions based on the first target remaining capacity were executed the number of revisions is increased by using the second target remaining capacity as well. Additionally although the revisions based on the second target remaining capacity are less accurate comparing to revisions based on the first target remaining capacity those revisions do not cause abrupt changes in the remaining capacity i.e. do not cause large differences between the latest remaining capacity and the previous remaining capacity because they are limited by a smaller revision amount upper limit value than the revisions based on the first target remaining capacity i.e. the second revision amount upper limit value is smaller than the first revision amount upper limit value . Thus the revision accuracy can be prevented from declining excessively when the remaining capacity is revised based on the second target remaining capacity which is less accurate than revisions based on the first target remaining capacity .

Moreover the battery remaining capacity detecting apparatus in accordance with this illustrated embodiment is configured such that the first revision amount upper limit value and the second revision amount upper limit value are both equal to or smaller than the maximum error SOCRSTMAX that occurs when the remaining capacity AHSOC is calculated by integrating the charge discharge current BATCUR of the battery pack . As a result the remaining capacity AHSOC is prevented from being revised by a larger amount than is necessary. More specifically the amount of time TIMRST elapsed since integration of the charge discharge current started is measured and the maximum error SOCRSTMAX accumulated while calculating the remaining capacity AHSOC by integrating the charge discharge current BATCUR is determined based on the measured amount of time and a maximum error MAXDSOC per unit time of the integration value obtained by integrating the charge discharge current BATCUR of the battery pack .

Furthermore the battery remaining capacity detecting apparatus in accordance with the illustrated embodiment is configured such that when the third prescribed battery related condition third reset condition is satisfied the third target remaining capacity third target SOC is calculated for revising the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack and the remaining capacity AHSOC calculated by integrating the charge discharge current BATCUR is revised toward the third target remaining capacity using a revision amount that is equal to or smaller than a third revision amount upper limit value SOCRST . The third prescribed battery related condition is arranged so that the third prescribed battery related condition occurs more frequently than the second prescribed battery related condition. The third calculation process the third computation process for calculating the third target remaining capacity is arranged to be less accurate than the second calculation process the second computation process for calculating the second target remaining capacity. As a result still more balance can be achieved between the frequency and the accuracy with which the remaining capacity AHSOC is revised. More specifically by executing revisions based on the third target remaining capacity the number of revisions can be increased even further while abrupt changes in the remaining capacity is prevented because the revision amount is limited by a third revision amount upper limit value SOCRST that is smaller than the second revision amount upper limit value.

The present invention is not limited to the particular constituent features of the illustrated embodiment. Fore example although in the illustrated embodiment the state of charge SOC AHSOC is calculated continuously by integrating the charge discharge current BATCUR of the battery pack it is also acceptable to calculate the state of charge SOC AHSOC by integrating the charge discharge power of the battery pack .

Although in the illustrated embodiment three target SOC values i.e. the first target SOC the second target SOC and the third target SOC are calculated for revising the state of charge AHSOC calculated based on a value obtained by integrating the charge discharge current BATCUR of the battery pack it is also acceptable to calculate for example only two target SOC values e.g. the first target SOC and the second target SOC the first target SOC and the third target SOC or the second target SOC and the third target SOC . Furthermore the methods of calculating the target SOC values used for revising the state of charge AHSOC calculated by integrating the charge discharge current BATCUR of the battery pack are not limited to those described in the illustrated embodiment. In other words other conventional methods or processes for calculating the state of charge remaining capacity of the battery pack can be utilized as the first second or third calculation process of the present invention.

In the illustrated embodiment in order to calculate the second target SOC the open circuit voltage EZERO of the battery pack is calculated based on the voltage BATVOL detected by the voltage sensor the discharge current BATCUR detected by the current sensor and the internal resistance REST when the prescribed amount of time has elapsed since the battery pack started discharging and the discharge current has become equal to or smaller than the prescribed current I. It is also possible to calculate the open circuit voltage EZERO using the same method when the battery pack is being charged.

Although in the illustrated embodiment the revision amount upper limit values are set with respect to all of the target SOC values the first to third target SOCs it is acceptable not to set a revision amount limit value when the state of charge AHSOC calculated by integrating the charge discharge current BATCUR is revised based on the first target SOC which is calculated with the highest degree of accuracy. In other words the upper limit of the revision amount used for revising based on the first target SOC can be avoided for example by setting the first revision amount limit value SOCRST to a large value such as infinity .

Although the illustrated embodiment presents an example in which the battery remaining capacity detecting apparatus is employed in an electric vehicle the battery remaining capacity detecting apparatus can also be employed in a hybrid vehicle a fuel cell vehicle or in other systems other than a vehicle that uses a battery.

The battery control unit preferably constitutes the remaining capacity calculating section the first target remaining capacity calculating section the second target remaining capacity calculating section the third target remaining capacity calculating section the remaining capacity revising section and the maximum error calculating section mentioned in the claims. The timer preferably constitutes the time measuring section mentioned in the claims.

Accordingly the battery remaining capacity detecting apparatus in accordance with the illustrated embodiment of the present invention is configured to revise the remaining capacity of the battery based on both the first target remaining capacity and the second target remaining capacity that is calculated more frequently than the first target remaining capacity. Consequently the remaining capacity of the battery can be revised a relatively greater number of times. Additionally although the second target remaining capacity is calculated less accurately than the first target remaining capacity it does not degrade the accuracy of the revision process because the revisions based on the second target remaining capacity are limited by a second revision amount upper limit value that is smaller than the first revision amount upper limit value used for revisions based on the first target remaining capacity. As a result the detected remaining capacity can be revised at a higher frequency and with a smaller amount of revision error thereby enabling the remaining capacity of a secondary battery to be detected accurately.

In understanding the scope of the present invention the term comprising and its derivatives as used herein are intended to be open ended terms that specify the presence of the stated features elements components groups integers and or steps but do not exclude the presence of other unstated features elements components groups integers and or steps. The foregoing also applies to words having similar meanings such as the terms including having and their derivatives. Also the terms part section portion member or element when used in the singular can have the dual meaning of a single part or a plurality of parts. The term detect as used herein to describe an operation or function carried out by a component a section a device or the like includes a component a section a device or the like that does not require physical detection but rather includes determining measuring modeling predicting or computing or the like to carry out the operation or function. The term configured as used herein to describe a component section or part of a device includes hardware and or software that is constructed and or programmed to carry out the desired function. Moreover terms that are expressed as means plus function in the claims should include any structure that can be utilized to carry out the function of that part of the present invention. The terms of degree such as substantially about and approximately as used herein mean a reasonable amount of deviation of the modified term such that the end result is not significantly changed.

While only selected embodiments have been chosen to illustrate the present invention it will be apparent to those skilled in the art from this disclosure that various changes and modifications can be made herein without departing from the scope of the invention as defined in the appended claims. For example the size shape location or orientation of the various components can be changed as needed and or desired. Components that are shown directly connected or contacting each other can have intermediate structures disposed between them. The functions of one element can be performed by two and vice versa. The structures and functions of one embodiment can be adopted in another embodiment. It is not necessary for all advantages to be present in a particular embodiment at the same time. Every feature which is unique from the prior art alone or in combination with other features also should be considered a separate description of further inventions by the applicant including the structural and or functional concepts embodied by such feature s . Thus the foregoing descriptions of the embodiments according to the present invention are provided for illustration only and not for the purpose of limiting the invention as defined by the appended claims and their equivalents.

