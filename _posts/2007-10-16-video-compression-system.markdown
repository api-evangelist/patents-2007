---

title: Video compression system
abstract: A video compression system processes images captured from a video camera mounted to a vehicle. Vehicle-mounted sensors generate vehicle motion information corresponding to a current state of motion of the vehicle. An optical flow estimation circuit estimates apparent motion of objects within a visual field. A video encoder circuit in communication with the optical flow estimation circuit compresses the video data from the video camera based on the estimated apparent motion.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08358686&OS=08358686&RS=08358686
owner: Harman Becker Automotive Systems GmbH
number: 08358686
owner_city: Karlsbad
owner_country: DE
publication_date: 20071016
---
This application claims the benefit of priority from European Patent Application No. 06 021719.7 filed Oct. 17 2006 which is incorporated by reference.

This disclosure relates to video systems. In particular this disclosure relates to video data compression systems.

Vehicle video recording systems may require large amounts of storage. Video data may be compressed based on the differences from video frame to video frame in a pixel oriented manner. However such compression techniques may be computationally expensive and are not robust. These compression techniques may not faithfully predict frame to frame changes.

A video compression system includes a video camera mounted to a vehicle and vehicle mounted sensors. The vehicle mounted sensors generate vehicle motion information corresponding to a current state of motion of the vehicle. An optical flow estimation circuit generates an estimated motion of objects within a visual field of the video camera. A video encoder circuit in communication with the optical flow estimation circuit compresses the video data from the video camera in accordance with the estimated motion.

Other systems methods features and advantages will be or will become apparent to one with skill in the art upon examination of the following figures and detailed description. It is intended that all such additional systems methods features and advantages be included within this description be within the scope of the invention and be protected by the following claims.

Video data compression processes may reduce the bandwidth and amount of storage capacity required for transmitting and storing video data. Compression processes may be based on spatial redundancy and temporal redundancy. Spatial redundancy may relate to similarities between neighboring pixels while temporal redundancy may relate to the similarities between consecutive frames. Spatial and temporal compression processes may reduce the amount of information saved and or encoded. Statistical coding processes may convert data into a compressed data stream.

The video compression system may include multimedia components such as a video encoder circuit a video decoder circuit a video display device and a storage device . The video encoder circuit the video decoder circuit and the storage device may communicate over a multimedia bus according to a predetermined protocol such as Media Oriented Systems Transport protocol or FireWire IEEE1394 networking protocol. Other protocols may be used in alternative systems. Data may be transferred between the multimedia bus and the digital communication bus through the gateway . The gateway may communicate with the multimedia bus and the digital communication bus which may utilize different formats and protocols so that sensor data may be delivered to the video encoder circuit without the use of a wiring harness.

A video camera may generate video data or transmit image data to the video encoder circuit . The video camera may be mounted to the vehicle or in the vehicle in a forward facing direction to provide front view images for recording and or displaying on the video display device . Front view images may be displayed to the user to create a record of events whether the vehicle is in motion or is stopped. Front view images may be useful for accident investigation or law enforcement.

The video camera may be mounted to the vehicle or in the vehicle in a rearward facing direction to provide rear view images for recording and or display. Rear view images may be displayed to the user to assist with parking and or lane changes. Other cameras may be mounted to or in the vehicle and may face other directions. The video compression system may compress and store the video data provided by the cameras . Alternatively the video compression system may directly transmit the images provided by the video camera to the display device unit without compression and or storage.

The video encoder circuit may receive a video signal from the video camera and compress the video signal. The video encoder circuit may receive the sensor data from the plurality of sensors via the digital communication bus and the gateway . The video encoder circuit may output compressed video data to the multimedia bus for transmission to the recording device or the video decoder circuit . The video encoder circuit may determine the vehicle s current state of motion from the data received from the sensors . The video encoder circuit may process the signals or data received from the sensors to increase the rate of motion vector processing.

The plurality of sensors may be part of a control system that controls driveability while controlling emissions or may be part of a supplemental restraint system a navigation system or a combination of in vehicle sensors in the vehicle . The sensor may measure shaft rotation e.g. such as a tachometer may act as a forward direction indicator a rearward direction indicator a distance sensor a velocity sensor a direction sensor compass and an angle sensor coupled to the steering wheel. Some of the sensors may include equipment also available in the after market such as an accelerometer linear acceleration radial acceleration a gyroscope and a GPS receiver .

The video decoder circuit may receive compressed video data from the video encoder circuit and or the recording device through the multimedia bus . The video decoder circuit may decode the compressed video data and transmit the decoded video data to a user display device . The display device may be an LCD display device or monitor which may provide video images to the user.

The storage device may receive compressed video data from the video encoder circuit over the multimedia bus . The recording device may record and store the data on a recording medium such as magnetic tape hard disk or optical disc. The recording device may retrieve the video data from the recording medium and transmit the retrieved video data to the video decoder circuit over the multimedia bus . The recording device may be configured to store and retrieve prerecorded video data for entertainment purposes such as movies from commercially available DVDs or wireless sources.

Video input data for each video image or frame may be divided into a plurality of video blocks or video segments by a segmentation circuit . The video encoder circuit may determine motion vectors for each of the video blocks or segments of a particular video image based on an estimated apparent motion and a location of the video block within the video image.

A predictive coding circuit may generate predicted video images . A subtraction circuit may subtract the predicted video images from each of the segmented blocks of data to provide a prediction error . The predictive coding circuit may predict a video block based on previously encoded video blocks stored in a memory and based on model parameters provided by a model circuit or motion estimation circuit. The model parameters provided by the model circuit may represent an internal model of the image content. The model circuit may receive the video input data and may receive optical flow data from an optical flow estimation circuit .

A data compression circuit may receive the prediction error and apply compression processes to generate compressed video data . The compression processes may include orthogonal transformation quantization and or variable length coding.

A local decoder may receive the compressed video data from the data compression circuit and may reverse the operations performed by the data compression circuit and subtraction circuit to provide a local reference copy of the image. The reference copy of the image may be reconstructed during processing. The model circuit motion estimation may generate current or updated the model parameters by comparing the model to the video input data and by applying the estimated optical flow data from the optical flow estimation circuit .

The optical flow estimation circuit may include a motion reconstruction circuit that reconstructs the vehicle s current state of motion based on the sensor data and may generate the estimated optical flow data on a block by block basis. The estimated optical flow data may include motion vectors which may characterize the current state of the vehicle motion and may indicate the apparent motion of objects in the video input data . The optical flow estimation circuit may determine the apparent motion of objects within the camera s visual field based on the vehicle s current state of motion and the relevant camera parameters.

The vehicle s current state of motion may be based on the sensor data such as velocity driving direction linear acceleration and radial acceleration. If the available sensor information does not fully reconstruct of the state of motion velocity and driving direction may be derived while other parameters may use default values. Based on the current state of motion of the vehicle the optical flow within the camera s visual field may be estimated based on geometrical considerations camera frame rate and actual displacement of objects per frame.

The optical flow estimation circuit of may generate the motion vectors by searching a predefined search range of possible motion vectors. This may permit adaptive processing of a search range of the motion vectors depending on encoding requirements and sensor data . In this manner the video data provided by the camera may be compressed based on a motion estimation and compensation scheme which may reduce computational requirements.

The optical flow estimation circuit may establish the search range or the starting values for searching the motion vectors according to the estimated apparent motion. The motion vectors may be derived without searching the entire video image. The optical flow estimation circuit may chose the starting value for determining the motion vectors by selecting the appropriate vector of the vector field for each block of the video image. The precision of the resulting motion vectors may be improved using an iterative process that converges to the motion vectors which may provide an accurate description of the actual vehicle motion.

The model parameters may be transmitted to the predictive coding circuit to predict the video frames or images and may be transmitted to the data compression circuit for inclusion in the compressed video data . The predictive coding circuit may predict video frames based on the model parameters which may correspond to the motion vectors provided by the optical flow estimation circuit . This may reduce temporal correlation between consecutive video images.

The optical flow estimation circuit may provide the optical flow information for the estimated apparent motion in form of qualitative information such as a type of flow field zoom in or zoom out leftward motion or rightward motion. This information may be used to increase the data compression rate. The optical flow estimation circuit may also provide optical flow information for the estimated apparent motion in the form of a vector field representation. The motion e.g. apparent motion of objects may be described quantitatively using vector fields depending on the location of the object within the visual field of the camera. A starting value or search range for determining the motion vectors may be set even if the apparent motion of objects in one part of the visual field is different from objects in another part. For example if the vehicle is backing into a parking place at a velocity v of 1 meter per second a stationary object within sight of the camera may also move at velocity of 1 meter per second. If the camera s frame rate f is 25 images per second then the object s displacement s for two consecutive video images may be determined as s v f 40 millimeters. Given the camera s viewing direction and focal length the optical flow information and thus the apparent motion of objects within the video images may be derived.

The estimated apparent motion of objects within the visual field of the camera may be derived even if information regarding the current state of motion is incomplete. For example if the angular sensor indicates a right hand curve or turn objects recorded by a forward facing camera may appear to move to the left. If a sensor attached to the gear shift indicates that the vehicle is moving in reverse objects recorded by the rearward facing camera may appear to move towards the edge of the image zoom in . Such qualitative information on the optical flow field may be used to increase the video compression rate.

Reconstruction of the optical flow may be based on sensor information that may be indirectly related to the vehicle s state of motion. Ultrasonic or radio frequency based sensors radar may measure the vehicle s velocity for example when backing into a parking space. Such sensors may measure relative velocities of oncoming vehicles. The information provided by these sensors along with distance information may be used to increase the accuracy of the estimated optical flow field by confirming assumptions on distance and motion of objects within the camera s visual field.

Alternatively motion vectors may be determined using non linear optimization processes such as gradient based processes. An optimum translation may be found by computing a gradient of the sum of absolute pixel differences between the translated block of a previous video image and the current video image. The translation may be iteratively adjusted based on the computed gradient until the sum of the absolute pixel is minimized. For iterative processes the accuracy of the final result and the speed of convergence may depend on the starting value. An accurate value may be based on the estimate of the apparent motion based the sensor data which may reduce the number of processing iterations.

Iterative processing or searching may be avoided if predicted motion vectors are used directly. For example the model circuit motion estimation of may calibrate the model the motion vectors by applying a process to every predetermined number of video images based on the video input data and may update the model for the remaining video images based on the sensor data only. This may reduce the computational load for determining the motion vectors. For example if an acceleration sensor indicates that there is no change to the vehicle s state of motion the set of motion vectors need not be updated to predict the next video image.

However the set of motion vectors may be updated if the sensors indicate a change in the vehicle s state of motion. Linear acceleration or deceleration may translate into a scale factor applied to the motion vectors. Even if changes to the vehicle s state of motion are not completely known the available information may be used to update motion vectors to improved starting points for iterative and or search processes corresponding to the actual motion vectors.

The motion vectors may be determined Act using the estimated optical flow field. The motion vectors may be determined based on the received video data Act . The estimated optical flow field may be used as a starting point for iteratively determining the motion vectors to define a restricted search range or to update previously determined motion vectors. A current video image may be predicted Act based on the motion vectors. The prediction errors and the motion vectors may then be encoded Act and compressed video data may be output Act .

The video compression system may not be limited to video encoding processes based on motion estimation and compensation. The video compression system may use other processes for predicting video images such as pattern recognition to recognize and track objects such as other vehicles road markings traffic signs and landmarks.

The logic circuitry and processing described above may be encoded in a computer readable medium such as a CD ROM disk flash memory RAM or ROM an electromagnetic signal or other machine readable medium as instructions for execution by a processor. Alternatively or additionally the logic may be implemented as analog or digital logic using hardware such as one or more integrated circuits including amplifiers adders delays and filters or one or more processors executing amplification adding delaying and filtering instructions or in software in an application programming interface API or in a Dynamic Link Library DLL functions available in a shared memory or defined as local or remote procedure calls or as a combination of hardware and software.

The systems may include additional or different logic and may be implemented in many different ways. A processor or controller may be implemented as a microprocessor microcontroller application specific integrated circuit ASIC discrete logic or a combination of other types of circuits or logic. Similarly memories may be DRAM SRAM Flash or other types of memory. Parameters e.g. conditions and thresholds and other data structures may be separately stored and managed may be incorporated into a single memory or database or may be logically and physically organized in many different ways. Programs and instruction sets may be parts of a single program separate programs or distributed across several memories and processors. The systems may be included in a wide variety of electronic devices including a cellular phone a headset a hands free set a speakerphone communication interface or an infotainment system.

While various embodiments of the invention have been described it will be apparent to those of ordinary skill in the art that many more embodiments and implementations are possible within the scope of the invention. Accordingly the invention is not to be restricted except in light of the attached claims and their equivalents.

