---

title: Electronic mail connector
abstract: Technologies are described herein for providing a bi-direction e-mail transport between a management (“CRM”) server computer and an e-mail server computer. An e-mail connector communicates with a CRM server computer to determine whether any e-mail messages are pending send at the CRM server computer. If any e-mail messages are pending send, the e-mail connector retrieves the e-mail messages from the CRM server computer. The e-mail connector then communicates with an e-mail server computer to send the retrieved e-mail messages to their intended recipients. The e-mail connector may also retrieve e-mail messages from the e-mail server computer and determine whether the e-mail messages are CRM related. If the e-mail messages are CRM related, the e-mail connector is operative to transmit the CRM-related e-mails to the CRM server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08352553&OS=08352553&RS=08352553
owner: Microsoft Corporation
number: 08352553
owner_city: Redmond
owner_country: US
publication_date: 20070430
---
Customer relationship management CRM systems allow businesses to manage the relationships with their customers including the capture storage and analysis of customer information. Some types of CRM applications are hosted on a remote computer system and offered to subscribers as a service. Subscribers to such a hosted CRM service can utilize the hosted CRM application to manage the relationships with their customers. In many CRM systems electronic mail e mail is the preferred method of communicating with customers.

When communicating with customers through a CRM system via e mail it is desirable for e mail messages to be submitted for delivery directly from the CRM subscriber s e mail system rather than from the CRM system itself. In fact ensuring that e mails are sent from the subscriber s e mail system rather than from the CRM system is often necessary because only the subscriber s e mail system has rights to submit e mail messages for delivery from the intended simple mail transfer protocol SMTP domain. Moreover ensuring that e mail messages are sent from the subscriber s e mail system protects the CRM system from issues related to large dangerous illegal and voluminous e mail messages. This also allows the subscriber to maintain their local e mail quotas policies and archiving rules with respect to CRM related e mail messages.

In many CRM installations such as where the CRM application is hosted at a remote computing system the subscriber s e mail system is outside the control of the CRM system because it executes remotely. The subscriber s e mail system may also be protected by a firewall or other network security device or require credentials for access. In these scenarios previous CRM systems have relied on e mail spoofing also referred to as send impersonation to create the appearance that CRM related e mail messages are being transmitted from the subscriber s e mail system. E mail spoofing refers to the process of altering the sender address and possibly other parts of an e mail header to cause an e mail to appear as if it originated from a different source. Through the use of spoofing a message sent from a CRM system can appear as if it was sent from a subscriber s mail system.

The use of spoofing to send CRM related e mail messages is problematic however because many e mail systems identify spoofed e mail messages as unsolicited bulk e mail UBE . As a result these types of messages are often quarantined or deleted prior to reaching their intended recipient. Because a CRM subscriber s relationships with its customers are so valuable the possibility that CRM related e mail messages may be identified as UBE and not delivered to a customer is highly undesirable. Moreover send impersonation bypasses all of the controls set for the sender s e mail system such as policies and quotas. For example a company may require that a legal disclaimer be appended to all send e mails. However send impersonation will bypass the e mail system and cause the disclaimer not to be appended.

Technologies are described herein for providing a bi directional e mail transport between a CRM server computer and an e mail server computer. Through aspects presented herein a CRM server computer can send e mail messages through a subscriber s e mail system without the use of spoofing. Because CRM related e mail messages are sent by the subscriber s e mail system rather than being spoofed and sent by a CRM system the risk that CRM related e mail messages will be identified as UBE is greatly reduced.

According to one aspect presented herein an e mail connector is disclosed that provides a transport for e mail messages between a CRM server computer and an e mail server computer. The e mail connector communicates with the CRM server computer to determine whether any CRM related e mail messages are pending send at the CRM server computer. If any e mail messages are pending send the e mail connector retrieves the e mail messages from the CRM server computer. The e mail connector then communicates with an e mail server computer to send the retrieved e mail messages to their intended recipients. According to one embodiment the CRM server exposes an application programming interface API through which the e mail connector can retrieve e mail messages that are pending send and perform other functions.

According to other aspects the e mail connector is further operative to retrieve e mail messages from the e mail server computer and to determine whether the e mail messages are CRM related. If the retrieved e mail messages are CRM related the e mail connector is operative to transmit the CRM related e mails to the CRM server. The API includes methods through which the e mail connector can determine if e mail messages are CRM related and transmit CRM related e mail messages to the CRM server computer. In this manner the e mail connector provides a bi directional e mail transport between the CRM server computer and the e mail server computer for both incoming and outgoing CRM related e mail messages.

According to additional aspects the e mail connector may be implemented as a plug in to an e mail client application program. In this implementation the plug in is operative to utilize stored user credentials or a current security context to authenticate itself with the e mail server computer. Once authenticated the e mail client application plug in can send CRM related e mail messages through the e mail server on behalf of the user whose credentials are used for authentication. Moreover the plug in can utilize all of the capabilities provided by the e mail client application. For instance because the e mail client application is already configured to communicate with the e mail server the plug in does not need to be reconfigured for such communication. The plug in can also promote received e mail messages to the CRM server computer if the e mail messages are determined to be CRM related.

According to other aspects the e mail connector may be implemented as a plug in to a service executing on a server computer. In this implementation the plug in may utilize stored service credentials to authenticate itself with the e mail server computer. Alternately the plug in may authenticate itself on the server computer using stored user credentials. This may be useful for instance to transmit CRM related e mail messages from the server computer on behalf of a user when the e mail client application plug in is not executing.

The above described subject matter may also be implemented as a computer controlled apparatus a computer process a computing system or as an article of manufacture such as a computer readable medium. These and various other features will be apparent from a reading of the following Detailed Description and a review of the associated drawings.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended that this Summary be used to limit the scope of the claimed subject matter. Furthermore the claimed subject matter is not limited to implementations that solve any or all disadvantages noted in any part of this disclosure.

The following detailed description is directed to technologies for providing a bi directional e mail transport between a CRM server computer and an e mail server computer. Through the embodiments presented herein an e mail connector communicates with a CRM server computer to retrieve e mail messages that are pending send from the CRM server computer. If any e mail messages are pending send the e mail connector retrieves the e mail messages and sends the e mail messages through an e mail server using stored credentials or a current security context. The e mail connector also retrieves incoming e mail messages received at the e mail server computer and submits the e mail messages to the CRM server. If the CRM server decides that the e mail should be accepted the e mail messages are added to the CRM server. In embodiments all e mail messages may be accepted only e mails related to other e mails may be accepted only e mail messages from a sender matching the e mail address of a CRM contact may be accepted or other more complex filtering rules may be utilized. Through the use of the e mail connector in this manner the CRM system can send and receive CRM related e mail messages using an external e mail system. Additional details regarding this process and others will be described below with respect to .

While the subject matter described herein is presented in the general context of program modules that execute in conjunction with the execution of an operating system and application programs on a computer system those skilled in the art will recognize that other implementations may be performed in combination with other types of program modules. Generally program modules include routines programs components data structures and other types of structures that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that the subject matter described herein may be practiced with other computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and the like.

In the following detailed description references are made to the accompanying drawings that form a part hereof and which are shown by way of illustration specific embodiments or examples. Referring now to the drawings in which like numerals represent like elements through the several figures aspects of a computing system and methodology for providing a bi directional e mail transport between a CRM system and an e mail system will be described. In particular are network and software architecture diagrams that provide details regarding an illustrative operating environment for the embodiments presented herein along with aspects of several software components disclosed herein.

The illustrative computing system shown in includes a CRM server . The CRM server executes a CRM application and maintains an associated CRM database . The CRM server provides functionality for managing relationships with business customers including the capture storage and analysis of customer information. This data is stored by the CRM application in the CRM database . Customer data stored in the CRM database may be associated with a customer number order number or other type of CRM object. According to implementations the CRM database is a structured query language SQL database. It should be appreciated however that any type of database technology may be utilized to embody the CRM database .

The CRM functionality provided by the CRM application may be accessed through the use of a web browser application executing on the CRM client computer . In this manner the CRM client computer can be utilized by a CRM subscriber to access functionality provided by the CRM application for creating and viewing customer information for communicating with customers via the CRM server and for performing other CRM related functions. The CRM server utilizes e mail as a primary method of communicating with customers. The CRM application stores CRM related e mail messages in the CRM database or in another database accessible to the CRM application .

Customers receive e mail messages sent from the CRM application using an e mail client application B executing on the external customer computer . Customers may also receive such e mail messages through the use of a web browser application program and a hosted web mail service. In response to receiving an e mail message from the CRM server a customer may utilize the e mail client application B or a hosted web mail service to transmit a response e mail message to the CRM server . As will be described in detail below such e mail messages may be sent and received by the CRM server through the use of an e mail connector executing on the CRM client computer or the server computer .

The computing system shown in also includes an e mail server computer . The e mail server computer executes an e mail server application that hosts at least one mailbox . The mailbox is utilized to store incoming and outgoing e mail messages for a corresponding e mail account maintained by the e mail server application . It should be appreciated that the e mail server may comprise any type of e mail server including but not limited to a post office protocol POP e mail server an EXCHANGE SERVER from MICROSOFT CORPORATION of Redmond Wash. an IBM LOTUS NOTES server from IBM SOFTWARE GROUP or a web based e mail solution such as HOTMAIL WINDOWS LIVE MAIL from MICROSOFT CORPORATION. As will be described in greater detail below the e mail connector provided herein can be configured for use with any type of e mail server computer.

According to the various implementations presented herein the CRM application is a hosted application remotely accessible over a distributed computing network such as the Internet. It should be appreciated however that the CRM application may be installed at a subscriber s site and accessed over a local area network by the CRM client computer . Similarly the e mail server application may be executed on a remotely located e mail server computer or on an e mail server computer operated at the same location as the CRM server and the CRM client computer . In this regard it should be appreciated that the CRM server the CRM client computer the e mail server computer and the server computer may be at the same or different physical locations and connected via appropriate local or wide area networks.

As will be described in greater detail below a CRM e mail client plug in is provided in one implementation. The CRM e mail client plug in provides functionality for interacting with the CRM application from within the e mail client application A. In one embodiment this functionality includes creating a bi directional e mail transport between the CRM application and the e mail server application . In order to provide this functionality the CRM e mail client plug in allows an e mail connector A to be utilized that provides a conduit between the e mail server application and the CRM application .

As will be described in greater detail below an e mail message may be transmitted from the e mail client application B to the e mail server application . The e mail server application stores the e mail message in the mailbox . Periodically the e mail connector A polls the e mail server application for new e mail messages. The e mail connector A may utilize stored user credentials to authenticate itself to the e mail server application . If new e mail messages are present at the e mail server computer such as the e mail message the e mail connector A will retrieve the messages from the e mail server application . The e mail connector A will then transmit the e mail messages to the CRM application for inclusion in the CRM database .

According to another implementation a CRM connector service is provided for creating a bi directional transport for e mail messages between the CRM application and the e mail server application . The CRM connector service is a service that may be executed on a headless server computer such as the server computer . The CRM connector service also includes an e mail connector B. Periodically the e mail connector B polls the e mail server application for new e mail messages. The e mail connector B may utilize service credentials to authenticate itself with the e mail server application . For instance an e mail account may be created at the e mail server application that is not associated with a particular user. The e mail connector B may utilize the service credentials to access such an account.

Alternatively the e mail connector B may utilize stored user credentials to authenticate itself to the e mail server application . In this way the e mail connector B may be utilized as a backup to the e mail connector A. For instance if the CRM e mail client plug in is not executing the CRM connector service and the e mail connector B may be utilize to provide the e mail transport between the CRM application and the e mail server application . If new e mail messages are present at the e mail server computer such as the e mail message the e mail connector B will retrieve the messages from the e mail server application . The e mail connector B will then transmit the e mail messages to the CRM application for inclusion in the CRM database . According to embodiments a World Wide Web Web interface may be provided for supplying e mail access credentials to the CRM connector service . Additional details regarding a process for transmitting e mail messages to the CRM application are provided below with respect to .

According to various implementations a user may be permitted to specify the method they prefer for e mail processing. For instance an appropriate user interface may be provided to a user that allows the specification of whether no e mail processing is to be performed e mail messages are to be processed by the CRM e mail client plug in or that e mail messages are to be processed by the CRM connector service . In this manner a user can select the most appropriate mechanism for processing e mail messages at any given time.

Turning now to additional details regarding the operation of the e mail connectors A B will be provided. In particular illustrates an embodiment wherein the e mail connectors A B provide a conduit to the e mail server application for e mail messages outgoing from the CRM application . In this embodiment the e mail connectors A B communicate with the CRM application to determine whether any e mails are pending send. If so the e mail connectors A B retrieve the e mails pending send from the CRM application . In the example shown in the e mail message is being retrieved from the CRM application by the e mail connectors A B. According to implementations the e mail connectors A B may download e mail messages in bulk from the CRM application . Moreover the CRM application implements synchronization mechanisms for ensuring that each e mail messages is only sent once by one of the e mail connectors A B.

Once an e mail connector has retrieved an e mail message to be sent the e mail connector authenticates itself with the e mail server application and sends the e mail message. The e mail message may then be retrieved by its intended recipient using an appropriate e mail client application such as the e mail client application B. In this manner the e mail connectors A B provide a conduit for e mail messages sent by the CRM server . Additional details regarding this process are provided below with respect to .

In both of the embodiments described above the CRM application is operative to expose an API for use by the e mail connectors A B. The API provides methods through which the e mail connectors A B can retrieve e mail messages pending send from the CRM application in bulk add e mail messages received from the e mail server application to the CRM database determine whether an e mail message is CRM related and perform other functions. Additional details regarding the API are provided below with respect to .

According to implementations the CRM connector service is operative to configure itself utilizing information obtained from the CRM application . In particular according to one implementation the CRM connector service obtains information regarding a user from the CRM application including an e mail address. The CRM connector service applies a configuration template to this information to generate a runtime configuration file. The runtime configuration file is utilized to schedule the e mail processing activities of the CRM connector service . Through this mechanism the CRM connector service can detect configuration changes update its configuration and reschedule its e mail processing activities.

Referring now to additional details will be provided regarding the e mail connector . In particular is a software architecture diagram showing the architecture of an e mail connector utilized in one embodiment described herein. As shown in the e mail connector utilizes one or more pluggable e mail providers A B. Each of the e mail providers A D provides functionality for interfacing with a corresponding e mail server A D respectively. For instance the e mail provider A may provide functionality for interfacing with a POP3 e mail server computer while the e mail provider B provides functionality for interfacing with a MICROSOFT EXCHANGE SERVER e mail server computer. In this manner multiple disparate e mail servers may be supported by a single e mail connector .

The illustrative e mail connector shown in also includes a connector service . The connector service is responsible for interfacing with each of the e mail providers A D and the CRM provider and for performing the functionality described below with respect to . The CRM provider provides an interface to the CRM application . It should be appreciated that multiple CRM providers may be utilized to provide an interface to multiple disparate CRM applications. In this manner a single e mail connector may be utilized to provide a connection between multiple disparate e mail servers and multiple disparate CRM applications.

According to other implementations the connector service provides an architecture that supports the use of pluggable providers created by third parties. A provider may be created from scratch or by specializing an existing provider. The creation and use of pluggable providers in this manner permits the architecture shown in to be highly extensible as the connector can provide support for virtually any e mail protocol through the use of a pluggable provider. Moreover it should be appreciated that the connector architecture shown in also allows remote connection between CRM and e mail systems over the Internet by using the appropriate protocols and authentication methods. Previous solutions were limited to the same domain and sometimes the same computer.

Referring now to additional details will be provided regarding the embodiments presented herein for providing an e mail connection between an e mail server computer and a CRM server computer. In particular is a flow diagram showing a routine that illustrates aspects of the operation of the e mail connector for processing incoming e mail messages to the CRM server in one implementation described herein.

It should be appreciated that the logical operations described herein are implemented 1 as a sequence of computer implemented acts or program modules running on a computing system and or 2 as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance and other requirements of the computing system. Accordingly the logical operations described herein are referred to variously as operations structural devices acts or modules. These operations structural devices acts and modules may be implemented in software in firmware in special purpose digital logic and any combination thereof. It should also be appreciated that more or fewer operations may be performed than shown in the figures and described herein. These operations may also be performed in a different order than those described herein with respect to the various figure.

The routine begins at operation where the e mail connector determines whether the e mail server application should be polled for new e mail messages. According to embodiments the time between polling operations may be configured in the e mail connector . It should also be appreciated that although a polling mechanism is described herein an appropriate push mechanism may be utilized to transfer e mail messages from the e mail server application to the e mail connector .

If at operation the e mail connector determines that a polling operation is not required the routine returns to operation . If however a polling operation is required the e mail connector polls the e mail server application for new e mail messages. As described above the e mail connector may authenticate itself with the e mail server application utilizing stored user credentials stored service credentials or a current security context prior to communicating with the e mail server application . If new e mail messages are present at the e mail server application the routine continues from operation to operation . If no new messages are identified the routine returns from operation to operation where another polling operation may be performed after a predetermined period of time has elapsed.

At operation the e mail connector utilizes a temporary variable to store the identity of a current e mail message in a collection of new e mail messages to be processed. In particular the value of a current e mail message variable is set to the first new e mail message retrieved from the e mail server application . The routine then continues to operation where the e mail connector determines whether the current e mail message has previously been transmitted to the CRM application . The e mail connector may maintain data structures or other data indicating which e mail messages have already been processed and forwarded to the CRM application .

If the current e mail message has previously been transmitted to the CRM application the routine proceeds from operation to operation . If the current e mail message has not been previously transmitted to the CRM application the routine proceeds to operation where the e mail connector determines whether the current e mail message is CRM related. According to one implementation the API includes methods for use by the e mail connector in making this determination. In particular a method may be exposed through the API that allows the e mail connector to submit portions of the current e mail message. Using the submitted data the CRM application can determine whether the current e mail message is CRM related. A response is then provided to the e mail connector indicating whether the current e mail message is CRM related. Other processes may also be performed by the e mail connector to determine whether the current e mail message is CRM related.

If the current e mail message is not CRM related the routine proceeds from operation to operation . If the current e mail message is CRM related the routine proceeds to operation where the e mail connector transmits the current e mail message to the CRM application for inclusion in the CRM database . When the CRM application receives the e mail message it may create a CRM activity based on the e mail message link the e mail message to an existing CRM activity or perform other processing.

From operation the routine proceeds to operation where the e mail connector determines whether there are any additional new e mail messages to be processed. If so the routine proceeds from operation to operation where the variable storing the current e mail message is set to the next new e mail message. The routine then returns to operation where the current e mail message is processed in the manner described above. If no new e mail messages remain to be processed the routine proceeds from operation to operation where the above described process is repeated.

According to implementations various procedures may be utilized to retry the process illustrated in following the failure to receive an e mail message. For instance in embodiments the particular strategy utilized may depend upon the type of protocol utilized or the type of mailbox for which messages are being received. For example if the mailbox is a sink mailbox not associated with a user account messages not accepted by the CRM application may be retried until a predetermined period of time has passed. For a user mailbox multiple retries may be made in a round robin fashion. The user may also provide preferences regarding how retries are performed. Other processes and algorithms may also be utilized.

Turning now to a routine will be described that illustrates aspects of the operation of the e mail connector for processing outgoing e mail messages from the CRM server to the e mail server application in one implementation described herein. The routine begins at operation where the e mail connector determines whether the CRM application should be polled for new e mail messages. As discussed above the time between polling operations may be configured in the e mail connector . An appropriate push mechanism may alternately be utilized to transfer e mail messages from the CRM application to the e mail connector .

If at operation the e mail connector determines that a polling operation is not required the routine returns to operation . If however a polling operation is required the routine continues to operation where the e mail connector polls the CRM application for new e mail messages that are pending send. The e mail connector also polls the CRM application for e mails that appear to be stuck in the sending state. If no new messages are identified the routine returns from operation to operation where another polling operation may be performed after a predetermined period of time has elapsed. If new e mail messages pending send or e mail messages that are stuck in the sending state are available from at the CRM application the routine continues from operation to operation .

At operation the e mail connector retrieves the oldest e mail that is pending send or that is in the sending state from the CRM application . The routine then continues to operation where the e mail connector marks the retrieved message as being sent. The e mail connector also increments a variable maintained at the CRM application called the attempt count that indicates the number of attempts that have been made to send the message. From operation the routine continues to operation where the e mail connector authenticates itself with the e mail server application with the user credentials or the service credentials in the manner described above. Once the e mail connector has been authenticated the routine continues to operation where the e mail connector attempts to send the e mail message through the e mail server application . The routine then continues to operation .

At operation the e mail connector determines if the e mail message was sent. If the e mail message was sent the routine proceeds from operation to operation where the sent e mail message is marked as having been sent at the CRM application . The routine then proceeds from operation to operation described above where the process repeats. If at operation the e mail connector determines that the e mail message was not sent the routine proceeds from operation to operation .

At operation the e mail connector determines whether the attempt count variable described for the e mail message exceeds a predefined threshold. The threshold specifies the number of retry attempts that should be made for each e mail message before failure. If the attempt count does not exceed the threshold the routine continues from operation to operation where the e mail message is marked as pending send at the CRM application . If the attempt count exceeds the threshold the routine continues from operation to operation where the e mail is marked as having failed send at the CRM application . From operations and the routine returns to operation described above where the process shown in repeats.

Referring now to an illustrative computer architecture for a computer capable of executing the software components described above with respect to will be discussed. The computer architecture shown in illustrates a conventional desktop laptop or server computer and may be utilized to embody any of the computer systems described herein.

The computer architecture shown in includes a central processing unit CPU a system memory including a random access memory RAM and a read only memory ROM and a system bus that couples the memory to the CPU . A basic input output system containing the basic routines that help to transfer information between elements within the computer such as during startup is stored in the ROM . The computer further includes a mass storage device for storing an operating system application programs and other program modules which will be described in greater detail below.

The mass storage device is connected to the CPU through a mass storage controller not shown connected to the bus . The mass storage device and its associated computer readable media provide non volatile storage for the computer . Although the description of computer readable media contained herein refers to a mass storage device such as a hard disk or CD ROM drive it should be appreciated that computer readable media can be any available media that can be accessed by the computer .

By way of example and not limitation computer readable media may include volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. For example computer readable media includes but is not limited to RAM ROM EPROM EEPROM flash memory or other solid state memory technology CD ROM digital versatile disks DVD HD DVD BLU RAY or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by the computer .

According to various embodiments the computer operates in a networked environment using logical connections to remote computers through a network such as the network . The computer may connect to the network through a network interface unit connected to the bus . It should be appreciated that the network interface unit may also be utilized to connect to other types of networks and remote computer systems. The computer may also include an input output controller for receiving and processing input from a number of other devices including a keyboard mouse or electronic stylus not shown in . Similarly an input output controller may provide output to a display screen a printer or other type of output device also not shown in .

As mentioned briefly above a number of program modules and data files may be stored in the mass storage device and RAM of the computer including an operating system suitable for controlling the operation of a networked desktop laptop or server computer. The mass storage device and RAM may also store one or more program modules. In particular the mass storage device and the RAM may store the CRM application the e mail server application the e mail client application A and the e mail connector each of which has been described above with reference to . Other program modules may also be stored in the mass storage device and utilized by the computer .

Based on the foregoing it should be appreciated that technologies for providing a bi directional e mail transport between a CRM server computer and an e mail server computer are disclosed herein. Although the subject matter presented herein has been described in language specific to computer structural features methodological acts and computer readable media it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features acts or media described herein. Rather the specific features acts and mediums are disclosed as example forms of implementing the claims.

The subject matter described above is provided by way of illustration only and should not be construed as limiting. Various modifications and changes may be made to the subject matter described herein without following the example embodiments and applications illustrated and described and without departing from the true spirit and scope of the present invention which is set forth in the following claims.

