---

title: Partially parallel magnetic resonance imaging using arbitrary k-space trajectories with image reconstruction based on successive convolution operations
abstract: In a first step of image formation by MRI or the like, a gridding convolution is performed for each coil using a Kaiser-Bessel kernel, so that each coil channel now contains data on grid points. In the second step, another 2D convolution is performed on each of the gridded coil data sets in either k-space or image space, and all the convolutions are summed up to produce the composite k-space data set for the target coil. In the third step, the composite data set is then transformed to form an un-aliased image for that coil. In the fourth step, the un-aliased images for all the coils are combined using square-root-of-sum-of-squares to form the final reconstructed image.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07583082&OS=07583082&RS=07583082
owner: University of Virginia Patent Foundation
number: 07583082
owner_city: Charlottesville
owner_country: US
publication_date: 20070419
---
The present application claims the benefit of U.S. Provisional Application Nos. 60 793 087 filed Apr. 19 2006 and 60 875 724 filed Dec. 19 2006 whose disclosures are hereby incorporated by reference in their entireties into the present disclosure.

The work leading to the present invention was supported in part by NIH Grant No. R01 HL 079110. The government has certain rights in the invention.

The present invention is directed to imaging by magnetic resonance MR or the like and more particularly to imaging using successive convolution operations followed by summing.

Magnetic resonance imaging MRI is a well known imaging technique described e.g. in U.S. Pat. No. 6 020 739 to Meyer et al whose disclosure is hereby incorporated by reference in its entirety into the present disclosure. Partially parallel acquisition PPA has become an important technique for speeding up magnetic resonance image acquisitions exploiting advances in the design of multi coil arrays and multiple channel receiver systems. Several approaches have been proposed with the common strategy of using the spatial difference in sensitivity profiles of coil array elements to reduce the aliasing artifacts due to under sampling in k space resulting in shorter image acquisition time. In general there are two types of techniques image space based e.g. SENSE and k space based reconstructions e.g. SMASH and GRAPPA . SENSE gives optimal SNR while reducing aliasing artifacts however it requires accurate coil sensitivity profiles which are not available in some applications. In addition for non Cartesian acquisitions SENSE necessitates the inversion of large scale matrices or multiple iterations to get an artifact reduced image which is not suitable for some applications such as real time imaging.

K space based methods on the other hand usually acquire several auto calibration ACS lines in low frequency part of k space and use those lines in a calibration process which generates a series of linear coefficients that can be applied in the high frequency k space to fill in missing data points due to under sampling. These k space based methods use the fact that multiple coil sensitivity profiles can be linearly combined to approximate a sinusoidal spatial distribution effectively shifting the combined k space data a certain amount in the phase encoding FE direction. This model works well for Cartesian trajectories because all the data on one sampled PE line are shifted the same amount in the same direction. However it is not straightforward to apply this model to non Cartesian trajectories because the required shift can be different from one point to another along the trajectory.

There have been several non Cartesian GRAPPA reconstruction methods during the past few years most of which segment k space and use different sets of coefficients for different segments assuming the data points in each segment share the same coefficients. For common non Cartesian trajectories e.g. spiral and radial the number of segments required to get a decent degree of artifact suppression could be very large. All the k space based methods try to fill in the missing k space sample points on non Cartesian trajectories followed by a gridding operation that interpolates these points onto Cartesian grids.

It is therefore an object of the invention to overcome the above noted deficiencies of the prior art.

To achieve the above and other objects an aspect of various embodiments of the present invention provides among other things auto calibrating k space based parallel reconstruction method and system which addresses the above mentioned problems The acronym for the technique is BOSCO parallel reconstruction based on successive convolution operations because two successive convolutions a gridding convolution followed by a BOSCO convolution form the basis of the technique.

Typically the second convolution is performed in k space. However it can alternatively be performed in image space in a manner which will be disclosed below.

Given the 2D nature of non Cartesian trajectories they do not have apparent PE and FE directions so it is reasonable that an intrinsically 2D convolution kernel would naturally be useful for non Cartesian k space scanning. In the first step a gridding convolution is performed for each coil using a Kaiser Bessel kernel so that each coil channel now contains data on grid points. In the second step another 2D convolution is performed on each of the gridded coil data sets and all the convolutions are summed up in k space to produce the composite k space data set for the target coil. In the third step the composite data set is then transformed to form an un aliased image for that coil. As in GRAPPA those two convolutions are repeated with each coil as the target resulting in multiple un aliased images with different sensitivity profiles and all of these coil images are combined in image space using square root of sum of squares or a similar method to generate a final image with a relatively uniform sensitivity profile across the FOV.

A preferred embodiment of the invention will be set forth in detail with reference to the drawings in which like reference numerals refer to like elements or method steps throughout.

In parallel imaging MR signals are received simultaneously from multiple RF channels each corresponding to a separate coil with a specific spatial sensitivity profile. We use variable density and constant density spiral k space trajectories as two examples of common non Cartesian trajectory although others could also be used. As shown in the variable density spirals have two sampling densities with the inner k space being fully sampled to support the full FOV and the outer k space being 2 8 under sampled to accelerate the imaging speed. Constant density spirals have the same sampling density throughout k space.

An exemplary difference between BOSCO and other non Cartesian parallel reconstruction approaches but not limited thereto is that all of the channel data are re sampled to grid points using the commonly used gridding method. All further processing of the data is based on the gridded dataset. Gridding is essentially a convolution of the non Cartesian k space samples with a convolution kernel re sampled at grid points. In BOSCO 1 gridding is performed for all of the channels using a Kaiser Bessel window. From another perspective all the previously published k space based non Cartesian parallel reconstruction methods try to do a convolution to fill in missing non Cartesian sampling points followed by a gridding step to generate the reconstructed image BOSCO on the other hand effectively swaps the order of those two operations by performing a gridding first before the convolution in k space

Another exemplary difference between BOSCO and other non Cartesian parallel reconstruction approaches hut not limited thereto is that the BOSCO kernels that are used in the k space convolution are intrinsically un constrained 2D kernels whereas the convolution kernels used in other k space based non Cartesian parallel reconstruction techniques are essentially constrained 1D or 2D kernels in different orientations.

In BOSCO coil sensitivity maps are not directly measured as proposed in some parallel reconstruction methods instead the sensitivity information is incorporated into a training process where inner k space of multiple source channels is used to mimic the inner k space of the target channel. More specifically given R as the acceleration factor every R th spiral interleaf is extracted from all of the source channels to form an Rx under sampled inner k space for each of those source channels and these under sampled spiral interleaves are gridded to grid points using the same Kaiser Bessel kernel as shown above. As to the training target the inner fully sampled k space after gridding is used for each target channel. The grid matrix sizes are scaled such that the spacing between grid points is the same for all the gridding processes throughout the whole reconstruction i.e. the grid matrices from both the whole k space and the inner k space support the same FOV. The BOSCO training tries to find a set of 2D convolution kernels BOSCO kernels one for each of the source channels so that if we convolve each source channel with its corresponding kernel and sum up all the resulting k space data we get the k space that resembles the target k space best in the minimum mean square error MMSE sense. This problem can be easily formulated as the following linear optimization problem argmin 1 

where x is a column vector containing all the BOSCO kernels for all the source channels b is all the target k space values put in a column vector and A is a matrix consisting of appropriate values from the source channels. Specifically suppose the number of source channels is N the k space grid size used for training is n by n and the BOSCO kernel size is m by m then x is an mN 1 column vector b is an n 1 column vector and A is an n mNmatrix. The element Aof matrix A is the k space point from channel p the value of which during the convolution with the BOSCO kernel will be added to the target k space point i after weighting by the value of BOSCO kernel element j. In general equation 1 is an over determined linear optimization problem which can be solved by setting the derivatives of equation 1 with respect to every unknown element of x to be zero and solving for x from the resultant linear equations. The solution for 1 is 

The size of the BOSCO kernels affects the artifact level in the reconstructed image and can be varied as needed. While larger BOSCO kernels tend to give better suppression of aliasing artifacts due to under sampling they also add to the computational complexity. From our experience no significant difference in terms of artifact level is visually detectable if a BOSCO kernel size of at least 5 5 is used for a FOV of 280 mm and a coil setup using Siemens surface coil arrays.

An aspect of various embodiments of the present invention uses each of the physical RF channel data sets as the training target and does a separate BOSCO training for each target although in general the fully sampled inner k space with any coil sensitivity modulation could be used as the target because the sensitivity information is automatically accounted for in the training.

The training will be summarized with reference to . Data from the source channels are used. Data from the target channel is used. The target channel data is first gridded to form data . For 2 acceleration every other spiral interleaf is extracted from the inner k space of all source channels for constant density spiral trajectory that step can be omitted. The resulting data are gridded to provide gridded data which would then be BOSCO correlated in steps and summed in step . An MMSE problem is formulated in step as described above such that the resulting image would be the best fit for the target channel data .

BOSCO reconstruction will now be described in greater detail. The BOSCO kernels generated by training represent the optimal way under current imaging settings to mimic the real full sampled k space using linear combinations of under sampled k space from multiple RF coils with different sensitivity profiles. It should be emphasized that different targets correspond to different kernel sets while different kernels in a given kernel set correspond to different source channels. In the BOSCO reconstruction each kernel in the kernel set that corresponds to a current target is convolved with its corresponding source k space and the resulting k space data are added together and inverse Fourier transformed to generate a un aliased image for the current target. This step is repeated for every target resulting in one un aliased image for each target and each un aliased image usually has similar localized sensitivities as the target. In the final step all the target sub images are combined in the image domain using square root of sum of squares or a similar method which gives a relatively flat sensitivity profile across the FOV and better SNR compared to phased addition

Block wise BOSCO reconstruction will now be described. In general for a given target only channels that have relatively large overlapping sensitivity should be included in the BOSCO reconstruction for that target because channels with little or no overlapping sensitivities would mainly contribute noise instead of signal in the reconstructed image Based on this idea an effective approach to improve the SNR of BOSCO reconstruction is to divide all the channels into multiple blocks according to certain locality criteria i.e. only channels that have relatively large overlapping sensitivity profile should be in the same block. For each block the above mentioned BOSCO training and reconstruction are performed and again the resulting BOSCO images from different blocks are combined using the square root of the sum of the squares to optimize SNR As the acceleration factor increases it is reasonable that the number of channels in one block should increase as well in order to achieve satisfactory aliasing artifact suppression.

BOSCO regularization will now be described. The linear optimization problem in BOSCO training implies inversion of the matrix A which could cause SNR loss if the matrix A is ill conditioned. As convolution of k space translates to multiplication in the image domain the BOSCO reconstruction is equivalent to a linear combination in the image domain of all the channels on a pixel by pixel basis. Because all the source channels are under sampled every pixel value consists of two components i.e. the original pixel value and the superimposed value as a result of aliasing from other pixels. Suppose sand Aare the original pixel value and the aliased energy respectively for channel j and pixel then the BOSCO reconstruction is equivalent to finding a set of linear weighting factors Wsuch that

The above equation can be solved using a similar method to that used in solving equation 1 and the solution is 

In equation 2 the first term controls the accuracy of the fit i.e. the aliasing artifact level in the reconstructed image while the second term tries to trade off the aliasing artifact suppression for better SNR. The regularization parameter can be adjusted in different applications with larger yielding better SNR and smaller giving better artifact suppression.

As shown in the regularization parameter has impact on both the SNR and the artifact suppression. As the regularization parameter increases the SNR of the reconstructed image improves at the expense of the artifact suppression. Regularization parameters corresponding to the intersection of the two curves are preferred.

An alternative way to regularize is to use a regularization target which constrains the image domain masks corresponding to the BOSCO kernels such that the pixel values are always combined constructively without phase cancellation. That can be achieved by constraining the phase of the mask values to be the conjugate of the phase of the training target and imposing unit amplitude for all the mask values. Accordingly the regularization target xcan be generated by taking the Fourier transform of the unit amplitude phase constrained 2D masks and assembling the results into a column vector in the same way in which the training target b is assembled. The main difference from 0 order Tikhonov regularization is that the prior information vector xis the Fourier transform of a unit amplitude mask whose phase is conjugate to that of the target.

To demonstrate the clinical application of the BOSCO methods in vivo data from healthy volunteers were acquired on a 1.5 T Siemens Avanto Scanner Siemens Medical Systems Erlangen Germany using two surface coil arrays and images were reconstructed using BOSCO. As shown in which is a coronary artery image acquired on a normal volunteer with a variable density spiral sequence with and under sampling factor of 2 the BOSCO image has good SNR and is virtually free of aliasing artifacts. The BOSCO algorithm was implemented using Matlab Mathworks Natick Mass. USA .

To further demonstrate the effect of regularization on the BOSCO reconstruction additional in vivo data were acquired using similar coil settings and two BOSCO reconstructions were performed with and without regularization. As shown in the regularization gives higher SNR compared to the non regularized BOSCO image. More specifically show in vivo images acquired on a healthy volunteer using variable density spiral sequence with an acceleration factor of 4. Both images use the same raw data set but were reconstructed using non regularized and regularized BOSCO. The SNR of regularized image is higher than that of the non regularized image. Since BOSCO only involves convolutions of k space data with relatively small kernel sizes 5 5 for the image shown in that can be quickly performed once the kernels are determined it requires much less computation than a non Cartesian SENSE reconstruction which makes it suitable for applications such as real time imaging. BOSCO is fully auto calibrating eliminating the need for measuring accurate sensitivity maps which can be difficult in some applications.

The above disclosure supposes that the second convolution takes place in k space. However an alternative embodiment can be realized in which the second convolution takes place in image space. However by the convolution theorem of Fourier transforms R. N. Bracewell McGraw Hill it is well known that convolving two arrays together is equivalent to multiplying their Fourier transforms. Thus it is also possible to implement the second BOSCO convolution as a multiplication in image space. This is likely to be the preferred embodiment for many applications.

c The BOSCO convolution kernels are zero padded to the same size of the gridded matrix and then transformed into image space.

d Each channel s data is then multiplied pixel by pixel by the transform of the corresponding BOSCO kernel and the resulting images are summed up in image space to form a composite unaliased image for that target coil.

e The composite images for each of the target coils are then combined using the square root of the sum of the squares or a similar method to generate a final image with a relatively uniform sensitivity profile across the image.

The above disclosure uses spiral trajectories as an example to show the reconstruction algorithm. BOSCO can be applied for other types of non Cartesian and Cartesian trajectories with minor adjustments in the algorithm.

c Decimate the fully sampled inner radial k space by a factor of T where T is the acceleration factor and grid the decimated radial views to produce the training source data.

d BOSCO training using the gridded target and source data produced in steps b and c . same as before 

g Combine the images from different targets using square root of sum of squares to produce the final reconstructed image. same as before 

For Cartesian trajectories since the data points are already on grids no gridding operation is needed in BOSCO. Except for this difference the algorithm is the same as that of non Cartesian trajectories. The alternative algorithm for Cartesian trajectories is as follows with reference to 

e Combine the images from the different targets using square root of sum of squares to produce the final reconstructed image. same as before .

The above disclosure uses 2D trajectories as an example to show the reconstruction algorithm. BOSCO can also be applied on 3D spiral radial and Cartesian trajectories in which case the BOSCO kernels should be 3D kernels in k space the gridding should be a 3D gridding the BOSCO convolution should be a 3D convolution the BOSCO training target should be a 3D data set the BOSCO training source should be a 3D data set and the BOSCO training is a 3D calibration.

While a preferred embodiment of the present invention and variations thereon have been set forth in detail above those skilled in the art who have reviewed the present disclosure will readily appreciate that other embodiments can be realized within the scope of the invention. For example numerical values are illustrative rather than limiting as are references to specific brand names or products. Therefore the present invention should be construed as limited only by the appended claims.

