---

title: System and method for parallel scanning
abstract: A system and method for parallel scanning among multiple scanning entities. According to various embodiments of the present invention, buffers are allocated from a pool of memory pages, with one packet being located on each page. Each of the pages is mapped such that unprivileged scanners, privileged scanners, and hardware-based scanners are all capable of accessing the pages. By having the packets located on separate pages, additional data other than the packets at issue do not have to be shared, and copying is not necessary to complete the scanning process.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08069315&OS=08069315&RS=08069315
owner: Nokia Corporation
number: 08069315
owner_city: 
owner_country: FI
publication_date: 20070830
---
The present invention relates generally to security technologies for use with a device or network. More particularly the present invention relates to the scanning of data packets by multiple technologies for security purposes.

This section is intended to provide a background or context to the invention that is recited in the claims. The description herein may include concepts that could be pursued but are not necessarily ones that have been previously conceived or pursued. Therefore unless otherwise indicated herein what is described in this section is not prior art to the description and claims in this application and is not admitted to be prior art by inclusion in this section.

In perimeter security the firewall is the typical first line of defense for a network. A firewall is a collection of security measures that are used to prevent unauthorized electronic access to a computer system or network. In terms of the overall protection of a network defense in depth refers to the application of multiple layers of security technologies referred to herein as scanners at the perimeter of the network and within the network in order to protect it. In recent years there has been a trend towards the combining multiple security technologies or scanners within a single device. Although such combinations of scanners makes security management easier it also results in a significantly higher demand on the device that is performing the scanning in terms of both performance and flexibility.

Virtual memory is a system for dynamically mapping a program s address or addresses to one or more physical memory addresses. In an unprivileged mode of execution an individual computer program cannot access any of the device s physical memory other than its own and the program cannot run special instructions in the processor that can affect the hardware state for other programs. The unprivileged mode is also referred to as a user mode. In a privileged mode of execution the computer program can access any part of the computer hardware and may modify aspects of other programs. The privileged mode of execution typically refers to the operating system OS of the device. Still further the device at issue typically contains firmware which is the software that is preinstalled within an execution unit.

With regard to the security technologies or scanners that are used within and at the perimeter of a network many of these technologies are implemented as software programs that run in the unprivileged mode on the operating system. Additionally other technologies run in the privileged mode while others are built into the firmware of special purpose hardware. This creates a significant issue as the three different implementations of these technologies unprivileged privileged and hardware have conventionally been incompatible with the other. Additionally these technologies tend to be run in a serialized manner and tend to run at different rates. Still further these technologies typically require that the data to be scanned be delivered in different layers of the protocol stack from each other. Because the technologies are run in different modes they also tend not to be capable of sharing memory with each other resulting in a requirement for making copies of the data to be scanned.

In some previous implementations the above issues have been addressed by having separate hardware inline for each type of scanner e.g. stand alone firmware intrusion detection and prevention IDP software anti virus software etc. Attempts to address the above identified issues have also involved running each scanner on separate software blades and then broadcasting or coping the packets to each blade.

Various embodiments of the present invention provide for a parallel scanning method. Various embodiments of the present invention involve a method of mapping queuing and marking packets of network traffic in order to apply multiple scanning technologies which are implemented in different modes in parallel with each other. This arrangement increases the efficiency and speed of processing packets of data while also permitting the different implementation modes to operate together.

Additionally it is noted that unprivileged scanners have virtual memory space allocated for holding packets such that each packet is on a separate physical memory page. Various embodiments of the present invention help to eliminate the necessity for copies of data as discussed previously. Various embodiments also serve to decrease the amount of time it takes to scan a packet for multiple security risks by allowing the process to occur in parallel rather than in series.

These and other advantages and features of the invention together with the organization and manner of operation thereof will become apparent from the following detailed description when taken in conjunction with the accompanying drawings wherein like elements have like numerals throughout the several drawings described below.

Various embodiments of the present invention provide for a parallel scanning method. Various embodiments of the present invention involve a method of mapping queuing and marking packets of network traffic in order to apply multiple scanning technologies which are implemented in different modes in parallel with each other. This arrangement increases the efficiency and speed of processing packets of data while also permitting the different implementation modes to operate together.

For exemplification the system shown in includes a mobile telephone network and the Internet . Connectivity to the Internet may include but is not limited to long range wireless connections short range wireless connections and various wired connections including but not limited to telephone lines cable lines power lines and the like.

The exemplary communication devices of the system may include but are not limited to a electronic device a combination personal digital assistant PDA and mobile telephone a PDA an integrated messaging device IMD a desktop computer a notebook computer etc. The communication devices may be stationary or mobile as when carried by an individual who is moving. The communication devices may also be located in a mode of transportation including but not limited to an automobile a truck a taxi a bus a train a boat an airplane a bicycle a motorcycle etc. Some or all of the communication devices may send and receive calls and messages and communicate with service providers through a wireless connection to a base station . The base station may be connected to a network server that allows communication between the mobile telephone network and the Internet . The system may include additional communication devices and communication devices of different types.

The communication devices may communicate using various transmission technologies including but not limited to Code Division Multiple Access CDMA Global System for Mobile Communications GSM Universal Mobile Telecommunications System UMTS Time Division Multiple Access TDMA Frequency Division Multiple Access FDMA Transmission Control Protocol Internet Protocol TCP IP Short Messaging Service SMS Multimedia Messaging Service MMS e mail Instant Messaging Service IMS Bluetooth IEEE 802.11 etc. A communication device involved in implementing various embodiments of the present invention may communicate using various media including but not limited to radio infrared laser cable connection and the like.

In addition to the above the system depicted in includes a program referred to herein as a scanq task or queuing task manager that is configured to add new data packets and remove completed scanning packets from the queue of packets being scanned by the privileged scanners the unprivileged scanners and the hardware based scanner . The scanq task allocates buffers from a pool of memory pages with one packet per memory page . The memory pages are mapped so that all of the unprivileged mode scanners can access the same packet the privileged scanners can access it and the hardware scanner can also access it. In this arrangement each packet is located on a separate memory page in order to avoid the various scanners having to share data other than the desired packets. The scanq task records how many scanners are in the system as well as where each scanner places its drop mark at the end of a packet buffer.

During use the hardware scanner optimally prepares the packet to be aligned so that the layer frame of the packet is placed in the same offset to the memory page regardless of the size of the layer header for the packet. Although this often results in a small amount of space in the beginning of the memory page remaining unused when a packet s layer header is smaller than the largest packet s layer header this aligning method avoids having to shift the packet data around in the memory in order to align it later. The hardware scanner also completes layer defragmentation and assembly tasks and also computes the checksum in order to detect any errors the data.

During the scanning process each of the scanners indicates when they have completed scanning buffers by inserting a mark on the end of the appropriate buffer page beyond the packet data. The scanner at issue then invokes the scanq task to see if the last scan has occurred i.e. if other scanners still need to scan the buffer . If not then the scanq provides the buffer at issue to any other scanners that indicate they are ready for a packet. On the other hand if the packet at issue has been inspected scanned by all of the scanners as indicated by the presence of drop marks then the task scanq drops the packet.

The various embodiments of the present invention described herein is described in the general context of method steps or processes which may be implemented in one embodiment by a computer program product embodied in a computer readable medium including computer executable instructions such as program code executed by computers in networked environments. Generally program modules may include routines programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. Computer executable instructions associated data structures and program modules represent examples of program code for executing steps of the methods disclosed herein. The particular sequence of such executable instructions or associated data structures represents examples of corresponding acts for implementing the functions described in such steps or processes.

Software and web implementations of various embodiments of the present invention can be accomplished with standard programming techniques with rule based logic and other logic to accomplish various database searching steps or processes correlation steps or processes comparison steps or processes and decision steps or processes. It should be noted that the words component and module as used herein and in the following claims is intended to encompass implementations using one or more lines of software code and or hardware implementations and or equipment for receiving manual inputs.

The foregoing description of embodiments of the present invention have been presented for purposes of illustration and description. The foregoing description is not intended to be exhaustive or to limit embodiments of the present invention to the precise form disclosed and modifications and variations are possible in light of the above teachings or may be acquired from practice of various embodiments of the present invention. The embodiments discussed herein were chosen and described in order to explain the principles and the nature of various embodiments of the present invention and its practical application to enable one skilled in the art to utilize the present invention in various embodiments and with various modifications as are suited to the particular use contemplated.

