---

title: Systems and methods for deblurring data corrupted by shift variant blurring
abstract: The present invention provides methods, systems and machine readable medium including machine readable code for deblurring data corrupted by shift variant blurring. A first version of data having shift variant blurring characterized by a first shift variant point spread function is provided. A target shift invariant point spread function is selected. A second shift variant point spread function is derived wherein a combination of the first and second shift variant point spread functions generates the target shift invariant point spread function. The second shift variant point spread function is applied to the first version of the data thereby generating a second version of the data having shift invariant blurring characterized by the target shift invariant point spread function. A linear shift invariant filter is applied to the second version of the data thereby generating a deblurred version of the data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07860333&OS=07860333&RS=07860333
owner: University of Utah Research Foundation
number: 07860333
owner_city: Salt Lake City
owner_country: US
publication_date: 20070109
---
This invention was made with government support under Grant numbers EB001489 and EB003298 awarded by National Institutes of Health. The United States government has certain rights to this invention.

The invention generally relates to data processing and more particularly to systems and methods for deblurring data corrupted by shift variant blurring.

Imaging devices are routinely used in the medical industry. Examples of such imaging devices include but are not limited to Positron Emission Tomography PET imaging devices and Single Photon Emission Computed Tomography SPECT imaging devices. The imaging devices capture two dimensional projection images of a target or a patient. The two dimensional projection images are reconstructed into a three dimensional volumetric image of the target or the patient. The reconstructed images are often corrupted by uniform attenuation non uniform attenuation and shift variant blurring.

One prior art method for compensating for the shift variant blurring involves the use of a frequency distance principle FDP algorithm. The FDP algorithm is a pre processing algorithm. In other words the FDP algorithm attempts to compensate for shift variant blurring in the two dimensional projection images of the target prior to using the two dimensional projection images to reconstruct the three dimensional image of the target. The FDP algorithm makes an assumption that there is no uniform or non uniform attenuation present in the two dimensional projection images generated by the imaging devices. This assumption often results in the amplification of noise and the introduction of artifacts in the reconstructed three dimensional image of the target.

Another prior art method for compensating for shift variant blurring involves the use of an intrinsic iterative reconstruction algorithm. The intrinsic iterative reconstruction algorithm is implemented during the reconstruction of the two dimensional projection images of the target into a three dimensional image of the target. While the intrinsic iterative reconstruction algorithm is effective at compensating for shift variant blurring the implementation of the intrinsic iterative reconstruction algorithm can take hours or even days. Such long processing times to obtain a three dimensional image of a target can lead to delays in diagnosis and treatment of a patient s medical condition.

Another prior art method involves the use of shift invariant filters to attempt to compensate for shift variant blurring. Shift invariant filters are typically not very effective at filtering shift variant blurring.

Thus what is needed is a system and method for deblurring data corrupted by shift variant blurring to overcome one or more of the challenges and or obstacles described above.

One aspect of the invention provides a method of deblurring data corrupted by shift variant blurring. The method includes providing a first version of data having shift variant blurring characterized by a first shift variant point spread function selecting a target shift invariant point spread function deriving a second shift variant point spread function wherein a combination of the first and second shift variant point spread functions generates the target shift invariant point spread function applying the second shift variant point spread function to the first version of the data thereby generating a second version of the data having shift invariant blurring characterized by the target shift invariant point spread function and applying a linear shift invariant filter to the second version of the data thereby generating a deblurred version of the data.

Another aspect of the invention provides a machine readable medium for storing a machine executable program for deblurring data corrupted by shift variant blurring. The machine readable medium includes machine readable code for providing a first version of data having shift variant blurring characterized by a first shift variant point spread function machine readable code for selecting a target shift invariant point spread function machine readable code for deriving a second shift variant point spread function wherein a combination of the first and second shift variant point spread functions generates the target shift invariant point spread function machine readable code for applying the second shift variant point spread function to the first version of the data thereby generating a second version of the data having shift invariant blurring characterized by the target shift invariant point spread function and machine readable code for applying a linear shift invariant filter to the second version of the data thereby generating a deblurred version of the data.

Another aspect of the invention provides a method for deblurring data corrupted by shift variant blurring. The method includes providing a first version of data having shift variant blurring blurring the first version of the data further using a shift variant blurring kernel thereby generating a second version of data having shift invariant blurring and applying a linear shift invariant filter to the second version of the data thereby generating a deblurred version of the data.

The foregoing and other features and advantages of the invention will become further apparent from the following detailed description of the presently preferred embodiments read in conjunction with the accompanying drawings. The detailed description and drawings are merely illustrative of the invention rather than limiting the scope of the invention being defined by the appended claims and equivalents thereof.

Referring to a perspective view of one example of an embodiment of a nuclear imaging assembly in accordance with the principles of the present invention is shown. While the illustrated example of a nuclear imaging assembly is a SPECT nuclear imaging assembly the use of other types of nuclear imaging assemblies are also considered to be within the scope of the invention. The nuclear imaging assembly generally includes a subject support structure a base gantry a rotatable gantry and one or more gamma ray imaging devices . A subject such as for example a patient is typically injected with one or more radiopharmaceuticals or radioisotopes. The injected radiopharmaceuticals are absorbed by and localize within a target organ or target in the subject . The accumulated radiopharmaceuticals emit energy in the form of gamma rays or photons that illuminate the target. The nuclear imaging assembly creates images of the distribution of the accumulated radioactive pharmaceuticals within the subject target.

The subject support structure supports the subject to be imaged. Examples of subjects include but are not limited to patients animals portions of animals and phantoms. The rotatable gantry is mounted on the base gantry and defines a subject receiving aperture with a subject imaging region within the subject receiving aperture . One or more gamma ray imaging devices are adjustably mounted to the rotatable gantry . In one embodiment the gamma ray imaging devices are positioned at regular intervals around the subject imaging region . For example a total of three gamma ray imaging devices may be positioned on the rotatable gantry at 120 intervals around the subject imaging region . In another embodiment the gamma ray imaging devices may be circumferentially adjustable to selectively vary their relative spacing with respect to each other on the rotatable gantry . In one embodiment separate translation devices such as motors and drive assemblies not shown independently translate the gamma ray imaging devices laterally in directions tangential to the subject imaging region along linear tracks or other appropriate guide structures. In another embodiment the gamma ray imaging devices are also independently movable in a radial direction with respect to the subject imaging region . In yet another embodiment the gamma ray imaging devices can be selectively canted or tilted with respect to the radial lines from the center of the subject imaging region . A motor and drive system not shown is employed to control the movement of the gamma ray imaging devices . In one embodiment each gamma ray imaging device can be positioned and controlled individually. In another embodiment the gamma ray imaging devices can be positioned and controlled together as a unit.

In one embodiment the base gantry can be advanced towards and or retracted from the subject support structure so as to appropriately position the subject within the subject imaging region to obtain desired images of the target. In another embodiment the subject support structure can be advanced towards and or retracted from the base gantry to achieve the desired positioning of the subject within the subject imaging region . In yet another embodiment the subject support structure can be raised or lowered to appropriately position the subject within the subject imaging region .

Each of the one or more gamma ray imaging devices includes a collimator and a detector . Each detector typically includes a scintillation crystal which produces a flash or scintillation of light each time it is struck by radiation emanating from the radioactive dye in the subject . An array of photomultiplier tubes and associated circuitry produces an output signal which is indicative of the x y position of each scintillation on the crystal.

In operation the subject is placed on the subject support structure and the subject support structure is appropriately positioned within the subject receiving aperture such that the target is positioned within the subject imaging region . The one or more gamma ray imaging devices are appropriately positioned with respect to the target to be imaged. The one or more gamma ray detectors are rotated or indexed in a generally circular orbit about the subject imaging region . The direction of the rotation of the gamma ray imaging devices defines the axis of rotation. The one or more gamma ray imaging devices detect the radiation emitted by the target from a plurality of different directions and capture multiple two dimensional images where each image provides a different angular view of the target. The collected two dimensional images are used to compute or reconstruct three dimensional volumetric representations of the target.

In another embodiment of the invention one or more gamma ray imaging devices are mounted onto a base gantry. The subject support structure includes a rotatable subject support portion. The one or more gamma ray imaging devices are maintained in stationary positions with respect to the subject imaging region. In operation the subject is appropriately positioned on the rotatable subject support portion and the rotatable subject support portion is appropriately positioned within the subject imaging region. The rotatable subject support portion is rotated about an axis of rotation where the axis of rotation is generally parallel to the planar faces of the one or more gamma ray imaging devices . The one or more gamma ray imaging devices detect the radiation emitted by the target from a plurality of different directions and capture multiple two dimensional images where each image provides a different angular view of the target. The collected two dimensional images are used to compute or reconstruct three dimensional volumetric representations of the target.

Referring to a block diagram of a system that may be used to implement one embodiment of a method of deblurring an image in accordance with the principles of the present invention is shown. Examples of devices that may include the system include but are not limited to a computer. In one embodiment the system is integrated as a component of the nuclear imaging assembly . In one embodiment the system generally includes a controller communicatively coupled to a memory an input device and an output device . The controller generally retrieves and executes machine readable instructions or software programs that are stored in the memory .

The memory generally includes an operating system module and a data deblurring module . The memory may include additional application modules that may facilitate the operation of the system and image deblurring functions. The memory may include one or more of a non volatile memory a volatile memory and or one or more storage devices. Examples of non volatile memory include but are not limited to electrically erasable programmable read only memory EEPROM and read only memory ROM . Examples of volatile memory include but are not limited to static random access memory SRAM and dynamic random access memory DRAM . Examples of storage devices include but are not limited to hard disk drives compact disc drives digital versatile disc drives and flash memory devices.

The controller is communicatively coupled to one or more input devices and one or more output devices . Examples of input devices include but are not limited to a scanner a memory storage device reader a keyboard and a mouse. In one embodiment one or more input output interfaces are provided to enable data transfer between the controller and other devices such as for example a nuclear imaging assembly and another computer. In one embodiment an input output interface is provided to a network that enables the exchange of data between the nuclear imaging assembly and the system . Examples of output devices include but are not limited to a display screen a computer storage device and a printer. Examples of computer storage devices include hard disk drives compact disc drives digital versatile disc drives and flash memory devices.

Referring to a block diagram of one embodiment of a data deblurring module in accordance with the principles of the present invention is shown. The two dimensional images of the target collected by the one or more gamma ray imaging devices are typically corrupted by target specific non uniform attenuation collimator specific blurring effect and target specific scattering effect. The target specific scattering is also known as the Compton scatter effect. One embodiment of the data deblurring module generally includes a data reconstruction module a point spread function PSF determination module a data blurring module and a data filter module . The data deblurring module generally receives the corrupted version of the two dimensional images of the target collected by the one or more gamma ray imaging devices for processing and generates a deblurred version of a three dimensional image of the target.

Another embodiment of the data deblurring module generally includes a PSF determination module a data blurring module and a data filter module . The data deblurring module generally receives a three dimensional image of the target reconstructed from the corrupted two dimensional images for processing. The reconstructed three dimensional image is typically corrupted by shift variant blurring. The data deblurring module processes the received reconstructed three dimensional image and generates a deblurred version of the reconstructed three dimensional image of the target.

In one embodiment PSF determination module the data blurring module the data filter module and the optional the data reconstruction module are all included within a single device. In one embodiment the PSF determination module the data blurring module the data filter module and the optional data reconstruction module are distributed over one or more communicatively coupled devices.

As mentioned previously the two dimensional images of the target collected by the one or more gamma ray imaging devices are typically corrupted by target specific non uniform attenuation collimator specific blurring effect and target specific scattering effect. The two dimensional images of the target may also be corrupted by uniform attenuation. The data reconstruction module generally receives the two dimensional images collected by the one or more gamma ray imaging devices and generates a reconstructed three dimensional image of the target with non uniform attenuation compensation.

In one embodiment a transmission scan of the target is provided to the data reconstruction module . The transmission scan of the target is typically acquired using for example x rays or gamma rays. The data reconstruction module uses the transmission scan of the target to generate an attenuation map of the target. The attenuation map is an image of the linear attenuation coefficients associated with a specific target for a specified photon energy level. In one embodiment an attenuation map of the target is provided directly to the data reconstruction module . In one embodiment a magnetic resonance imaging MRI system is used to generate an attenuation map of the target. It should be noted that while the use of a number of different techniques for generating an attenuation map of the target have been described the use of alternative techniques for generating an attenuation map of the target that may be apparent to one of ordinary skill in the art are also considered to be within the scope of the invention.

One embodiment of the data reconstruction module employs a filtered backprojection FBP reconstruction algorithm and uses the two dimensional images of the target and the attenuation map of the target to generate a reconstructed three dimensional image of the target that has been compensated for the non uniform attenuation. One embodiment of the data reconstruction module employs a filtered backprojection FBP reconstruction algorithm to generate a reconstructed three dimensional image of the target that has been compensated for the uniform attenuation. In one embodiment the data reconstruction module uses Novikov s FBP algorithm to generate the reconstructed three dimensional image of the target with non uniform attenuation compensation. In one embodiment the data reconstruction module uses Novikov s FBP algorithm to generate the reconstructed three dimensional image of the target with uniform attenuation compensation. One embodiment of the data reconstruction module employs an iterative reconstruction algorithm and uses the two dimensional images of the target and the attenuation map of the target to generate a reconstructed three dimensional image of the target that has been compensated for the non uniform attenuation. One embodiment of the data reconstruction module employs an iterative reconstruction algorithm to generate a reconstructed three dimensional image of the target that has been compensated for the uniform attenuation. It should be noted that while the use of techniques for compensating non uniform and or uniform attenuation in the reconstruction of a three dimensional image has been described the use of alternative techniques for compensating non uniform and or uniform attenuation that may be known to one of ordinary skill in the art may be used without departing from the spirit of the invention.

While the reconstructed three dimensional image generated by the data reconstruction module has been compensated for the non uniform attenuation the reconstructed three dimensional image remains corrupted by the collimator specific blurring effect and the Compton scatter effect. The combined effects of the collimator specific blurring and the Compton scatter effect results in the presence of shift variant or non stationary blurring in the reconstructed three dimensional image. The shift variant blurring can be characterized using a shift variant position spread function PSF in the image domain.

In one embodiment the PSF determination module receives the reconstructed three dimensional image generated by the data reconstruction module and generates a shift variant PSF characterizing the shift variant blurring present in the reconstructed three dimensional image in the image domain. In one embodiment the PSF determination module generates a shift variant PSF characterizing the shift variant blurring attributable to the combination of the collimator specific blurring and the Compton scatter effect present in the reconstructed three dimensional image in the image domain. In one embodiment the PSF determination module generates a shift variant PSF characterizing the shift variant blurring attributable to the collimator blurring effect present in the reconstructed three dimensional image in the image domain. In one embodiment the PSF determination module generates a shift variant PSF characterizing the shift variant blurring attributable to the Compton scatter effect present in the reconstructed three dimensional image in the image domain.

In one embodiment the PSF determination module determines a first shift variant PSF or a collimator specific PSF characterizing collimator specific blurring in the reconstructed three dimensional image. The first shift variant PSF of the reconstructed three dimensional image is in the image domain. In one embodiment the PSF determination module determines the first shift variant PSF based on collimator specifications provided by the collimator manufacturer. In one embodiment the PSF determination module derives the first shift variant PSF based on an analysis of collimator generated projections of a point source and or line source. The PSF determination module determines a shift variant PSF for each of the two dimensional projections generated by the collimator and uses the shift variant PSFs for the two dimensional projections to derive the first shift variant PSF of the reconstructed three dimensional image in the image domain. In one embodiment The PSF determination module employs Novikov s FBP algorithm to derive the first shift variant PSF of reconstructed three dimensional image in the image domain from the detector PSF where the detector is associated with the collimator. While a number of different techniques have been described for determining the first shift variant PSF associated with collimator specific blurring for a reconstructed three dimensional image in the image domain alternative techniques for determining the first shift variant PSF of the reconstructed three dimensional image in the image domain known to one of ordinary skill in the art may be used without departing from the spirit of the invention.

In one embodiment the PSF determination module determines a second shift variant PSF or a target specific scattering PSF characterizing the Compton scatter effect on the reconstructed three dimensional image. The second shift variant PSF of the reconstructed three dimensional image is in the image domain. In one embodiment the PSF determination module determines the second shift variant PSF based on an attenuation map of the target.

In one embodiment an attenuation map of the target is provided directly to the PSF determination module . In one embodiment the attenuation map is provided from the data reconstruction module to the PSF determination module . In one embodiment a transmission scan of the target is provided to the PSF determination module . The PSF determination module uses the transmission scan to generate an attenuation map of the target. In one embodiment a magnetic resonance imaging MRI system is used to generate an attenuation map of the target. It should be noted that while the use of a number of different techniques for generating an attenuation map of the target have been described the use of alternative techniques for generating an attenuation map and determining the scatter effect of the target that may be apparent to one of ordinary skill in the art are also considered to be within the scope of the invention.

While one technique has been described for determining the second shift variant PSF associated with the Compton scatter effect for a reconstructed three dimensional image in the image domain alternative techniques for determining the second shift variant PSF of the reconstructed three dimensional image in the image domain known to one of ordinary skill in the art may be used without departing from the spirit of the invention.

In one embodiment the PSF determination module uses the first shift variant PSF associated with collimator specific blurring and the second shift variant PSF associated with the Compton scatter effect to derive the shift variant PSF characterizing the shift variant blurring present in the reconstructed three dimensional image in the image domain. While one manner of determining a shift variant PSF for the reconstructed image in the image domain characterizing the shift variant blurring attributable to the combination of the collimator specific blurring and the Compton scatter effect present in the reconstructed three dimensional image has been described the use of alternative techniques for determining the shift variant PSF for the reconstructed image in the image domain are also considered to be within the scope of the invention.

For illustrative purposes the following definitions will be used. The function g x y z will be used to represent the reconstructed three dimensional image generated by the data reconstruction module . The function h x y z x y z will be used to represent the shift variant PSF representative of the shift variant blurring present in the reconstructed three dimensional image generated by the PSF generation module . The function f x y z will be used to represent an unblurred or true version of the reconstructed three dimensional image.

The relationship between the reconstructed three dimensional image g x y z the shift variant PSF h x y z x y z and the unblurred version of the reconstructed three dimensional image f x y z at a point x y z of the three dimensional image of the target can be mathematically modeled in the spatial domain as indicated in Equation 1 below 

The data blurring module generally receives the reconstructed three dimensional image g x y z and the shift variant PSF h x y z x y z characterizing the shift variant blurring present in the reconstructed three dimensional image g x y z and generates a blurrier version of the reconstructed three dimensional image having a target shift invariant or stationary PSF. One embodiment of the data blurring module selects a target shift invariant PSF. In one embodiment the selected target shift invariant PSF is the PSF of the blurriest section of the reconstructed three dimensional image g x y z . In one embodiment the selected target shift invariant PSF is a shift invariant PSF that exceeds the PSF of the blurriest portion of the reconstructed three dimensional image. In one embodiment the selected target PSF is the PSF of a relatively blurrier section of the reconstructed three dimensional image. The data blurring module derives a blurring kernel. The derived blurring kernel has a shift variant PSF such that the combination of the shift variant PSF h x y z x y z of the reconstructed three dimensional image and the shift variant PSF of the blurring kernel generates the target shift invariant PSF.

For illustrative purposes the function h x y z will be used to represent the selected target shift invariant PSF the function k x y z x y z will be used to represent the blurring kernel defined by the shift variant PSF. The relationship between the shift variant PSF h x y z x y z of the reconstructed three dimensional image the selected target shift invariant PSF h x y z and the blurring kernel defined by the shift variant PSF k x y z x y z can be mathematically modeled in the spatial domain as indicated in Equation 2 below Equation 2 where the symbol represents a three dimensional convolution operator.

For illustrative purposes H u v w x y z will be used to represent the Fourier transform of h x y z x y z H u v w will be used to represent the Fourier transform of h x y z and K u v w x y z will be used to represent the Fourier transform of k x y z x y z . The parameters u v and w represent frequencies along the x y and z axes respectively. Based on the relationship between the functions h x y z h x y z x y z and k x y z x y z defined in the spatial domain in Equation 2 the relationship between H u v w x y z H u v w and K u v w x y z can be mathematically modeled in the frequency domain as indicated in Equation 3 below Equation 3 Dividing both sides of the Equation 3 by H u v w x y z generates the relationship indicated in Equation 4 below Equation 4 

In one embodiment the data blurring module receives the reconstructed three dimensional image g x y z and the shift variant PSF h x y z x y z characterizing the shift variant blurring present in the reconstructed three dimensional image. The data blurring module selects the PSF of the blurriest section of the reconstructed three dimensional image g x y z as the target shift invariant PSF h x y z . The data blurring module determines the Fourier transforms H u v w and H u v w x y z of the target shift invariant PSF h x y z and the shift variant PSF h x y z x y z respectively. The data blurring module divides the Fourier transform of the target shift invariant PSF H u v w by the Fourier transform of the shift variant PSF H u v w x y z of the three dimensional reconstructed image to determine the Fourier transform of the shift variant PSF defining the blurring kernel K u v w x y z . The data blurring module takes the inverse Fourier transform of K u v w x y z to derive the shift variant PSF function defining the blurring kernel k x y z x y z . The data blurring module applies the derived blurring kernel k x y z x y z to the reconstructed three dimensional image g x y z having the shift variant PSF of h x y z x y z thereby generating the blurrier version of the reconstructed three dimensional image having the target shift invariant PSF h x y z .

For illustrative purposes the function q x y z will be used to represent the blurrier version of the reconstructed three dimensional image having the target shift invariant PSF h x y z . The relationship between the blurrier version of the three dimensional reconstructed image q x y z having the shift invariant PSF h x y z the reconstructed three dimensional image g x y z having the shift variant PSF h x y z x y z and the blurring kernel k x y z x y z at a point x y z of the reconstructed three dimensional image can be mathematically modeled as indicated in Equation 5 below 

One embodiment of the data blurring module derives the shift variant PSF defining the blurring kernel k x y z x y z based on a relationship between the variances of the target shift invariant PSF h x y z and the shift variant PSF h x y z x y z characterizing the shift variant blurring present in the reconstructed three dimensional image g x y z and the PSF defining the blurring kernel k x y z x y z . For illustrative purposes the variances of the PSF functions h x y z h x y z x y z and k x y z x y z will be represented as and respectively. The relationship between the variances and can be mathematically modeled using a Gaussian model as indicated in Equation 6 below Equation 6 Subtracting from both sides of the Equation 6 generates the relationship indicated in Equation 7 below Equation 7 The data blurring module receives the reconstructed three dimensional image g x y z and the shift variant PSF h x y z x y z characterizing the shift variant blurring present in the reconstructed three dimensional image. The data blurring module selects the PSF of the blurriest section of the reconstructed three dimensional image g x y z as the target shift invariant PSF h x y z . The data blurring module derives the variances and of the PSF functions h x y z and h x y z x y z respectively. The data blurring module subtracts the variance of the shift invariant PSF characterizing the shift variant blur present in the reconstructed three dimensional image from the variance of the target shift invariant PSF to determine the variance of the shift variant PSF defining the blurring kernel . The data blurring module uses the variance of the shift variant PSF defining the blurring kernel to derive the shift variant PSF defining the blurring kernel k x y z x y z . The data blurring module applies the derived blurring kernel k x y z x y z to the reconstructed three dimensional image g x y z having the shift variant PSF of h x y z x y z thereby generating the blurrier version of the reconstructed three dimensional image q x y z having the target shift invariant PSF h x y z . The data blurring module forwards the blurrier version of the reconstructed three dimensional image q x y z having the target shift invariant PSF h x y z to the data filter module for processing.

In one embodiment the data blurring module uses a rotational convolution method to further blur the reconstructed three dimensional image g x y z to generate the blurrier version of the reconstructed three dimensional image q x y z having the target shift invariant PSF h x y z . The rotational convolution method can be used in instances where the shift variant PSF h x y z x y z primarily reflects the shift variant collimator specific blurring in the reconstructed three dimensional image and where the two dimensional images of the target were captured using one or more gamma ray imaging devices that were rotated in generally circular orbit around the target.

An illustrative example of the implementation of the rotational convolution method in accordance with the principles of the present invention is described with reference to . depicts an example of a true unblurred three dimensional image of a target f x y z consisting of three spheres. The origin of the coordinate system coincides with the axis of rotation of the gamma ray imaging devices .

Referring to the example illustration in the data blurring module incrementally rotates the reconstructed three dimensional image g x y z about the origin of the coordinate system through a number of relatively small angles in a clockwise direction and a through a number of relatively small angles in a counter clockwise direction. The blurriest section of the reconstructed three dimensional image g x y z define the boundaries of the rotation of the reconstructed three dimensional image g x y z .

The data blurring module determines a weighted sum of the rotated versions of the reconstructed three dimensional image g x y z thereby generating a blurrier version of the reconstructed three dimensional image q x y z characterized by the target shift invariant blurring PSF h x y z . This relationship can be mathematically modeled as indicated in Equation 8 below 

The data filter module generally receives the blurrier version of the reconstructed three dimensional image q x y z having shift invariant blur characterized by the target shift invariant PSF h x y z and generates a deblurred or true version of the reconstructed three dimensional image f x y z . The data filter module applies a shift invariant linear filter to the blurrier version of the reconstructed three dimensional image q x y z to compensate for the target shift invariant PSF h x y z . In one embodiment the data filter module applies a non iterative filter to the blurrier version of the reconstructed three dimensional image q x y z to generate the deblurred version of the reconstructed three dimensional image f x y z .

In one embodiment the data filter module de convolves the blurrier version of the reconstructed three dimensional image q x y z to compensate for the target shift invariant PSF h x y z . In one embodiment the data filter module implements a convolution procedure in the image domain to deblur the blurrier version of the reconstructed three dimensional image q x y z . In one embodiment the data filter module implements a multiplication procedure in the frequency domain to deblur the blurrier version of the reconstructed three dimensional image q x y z . In one embodiment the data filter module employs a fast Fourier domain de blurring filter to deblur the blurrier version of the reconstructed three dimensional image q x y z . In one embodiment the data filter module applies an iterative filter to the blurrier version of the reconstructed three dimensional image q x y z to generate the deblurred version of the reconstructed three dimensional image f x y z . While a number of different types of filters that can be used to compensate for the target shift invariant PSF in the blurrier version of the reconstructed three dimensional image have been described the use of alternative filters to compensate for shift invariant PSF may be used without departing from the spirit of the invention.

It should be noted that while systems implemented using software or firmware executed by hardware have been described above those having ordinary skill in the art will readily recognize that the disclosed systems could be implemented exclusively in hardware through the use of one or more custom circuits such as for example application specific integrated circuits ASICs or any other suitable combination of hardware and or software.

Referring to a flowchart of one embodiment of a method of deblurring an image in accordance with the principles of the present invention is shown. A set of two dimensional images of a target collected by a nuclear imaging assembly is received by the data reconstruction module at step . The two dimensional images are also referred to as two dimensional projection images. The received two dimensional images of the target are typically corrupted by target specific non uniform attenuation collimator specific blurring effect and target specific scattering effect. The data reconstruction module reconstructs a three dimensional image of the target from the received two dimensional images of the target using a filtered backprojection algorithm FBP at step . In another embodiment the data reconstruction module reconstructs a three dimensional image of the target from the received two dimensional images of the target using an iterative algorithm. The reconstructed three dimensional image generated by the data reconstruction module has been compensated for the non uniform attenuation. The reconstructed three dimensional image generated by the data reconstruction module has also been compensated for the uniform attenuation. However the reconstructed three dimensional image remains corrupted by the collimator specific blurring effect and the target specific scattering effect.

The PSF determination module generates a shift variant PSF characterizing the shift variant blurring present in the reconstructed three dimensional image in the image domain at step . The shift variant PSF of the reconstructed three dimensional image characterizes the shift variant blurring attributable to the combination of the collimator specific blurring and the target specific scatter effect present in the reconstructed three dimensional image in the image domain.

The data blurring module selects the PSF of the blurriest portion of the reconstructed three dimensional image as a target shift invariant PSF at step . The data blurring module derives a blurring kernel defined by a shift variant PSF such that the combination of the shift variant PSF of the reconstructed three dimensional image and the shift variant PSF of the blurring kernel generate the target shift invariant PSF at step . The data blurring module applies the derived blurring kernel to the reconstructed three dimensional image thereby generating a blurrier version of the reconstructed three dimensional image at step . The blurrier version of the reconstructed three dimensional image has shift invariant blurring characterized by the target shift invariant PSF. The data filter module applies a shift invariant linear filter to the blurrier version of the reconstructed three dimensional image having the invariant target PSF thereby generating a deblurred version of the reconstructed three dimensional image at step .

It should be noted that while the steps in the method have been described in a particular order performing one or more of the steps in a different order or performing a subset of the described steps are also considered to be within the scope of the invention.

Referring to a flowchart of a method of deblurring data corrupted by shift variant blurring in accordance with the principles of the present invention is shown. A first version of data having shift variant blurring characterized by a first shift variant point spread function is provided at step . A target shift invariant point spread function is selected at step . A second shift variant point spread function is derived at step wherein a combination of the first and second shift variant point spread functions generates the target shift invariant point spread function. The second shift variant point spread function is applied to the first version of the data thereby generating a second version of the data having shift invariant blurring characterized by the target shift invariant point spread function at step . A linear shift invariant filter is applied to the second version of the data thereby generating a deblurred version of the data. It should be noted that while the steps in the method have been described in a particular order performing one or more of the steps in a different order is also considered to be within the scope of the invention.

One embodiment a machine readable medium stores a machine executable program for deblurring data corrupted by shift variant blurring. The machine readable medium includes machine readable code for providing a first version of data having shift variant blurring characterized by a first shift variant point spread function machine readable code for selecting a target shift invariant point spread function machine readable code for deriving a second shift variant point spread function wherein a combination of the first and second shift variant point spread functions generates the target shift invariant point spread function machine readable code for applying the second shift variant point spread function to the first version of the data thereby generating a second version of the data having shift invariant blurring characterized by the target shift invariant point spread function and machine readable code for applying a linear shift invariant filter to the second version of the data thereby generating a deblurred version of the data.

One embodiment of a method for deblurring data corrupted by shift variant blurring includes providing a first version of data having shift variant blurring blurring the first version of the data further using a shift variant blurring kernel thereby generating a second version of data having shift invariant blurring and applying a linear shift invariant filter to the second version of the data thereby generating a deblurred version of the data.

It should be noted that while systems and methods for deblurring a three dimensional image corrupted by a shift variant PSF has been described systems and methods for deblurring one dimensional data as well as systems and methods for deblurring two dimensional data such as for example two dimensional images are also considered to be within the scope of the invention. For example in geophysics the migration of seismic data is often modeled as shift variant convolution. The systems and methods for deblurring data corrupted by shift variant PSF may be used to deblur such data. Two dimensional ultrasound images are an example of two dimensional data that may be corrupted by shift variant blurring. The methods and systems for deblurred data corrupted by shift variant blurring may be used to compensate for the shift variant blurring in such two dimensional data. While examples of specific one and two dimensional data that can be deblurred using the disclosed systems and methods for deblurring data corrupted by shift variant blurring the processing of other types of one and two dimensional data by the disclosed systems and methods for deblurring data corrupted by shift variant blurring are also considered to be within the scope of the invention.

While the embodiments of the invention disclosed herein are presently considered to be preferred various changes and modifications can be made without departing from the spirit and scope of the invention. The scope of the invention is indicated in the appended claims and all changes that come within the meaning and range of equivalents are intended to be embraced therein.

