---

title: Document classification toolbar
abstract: Electronic document classification is disclosed. A toolbar adds the ability to classify documents based on specific properties such as security classification, information type, document type, document retention, document caveats, and the like associated. The toolbar through dropdown selections allows users to select the appropriate classification and properties based upon the content of the document and have appropriate classifiers added to the document. Document classification properties are generated that are associated with the document in the document properties and by inserting visual markings that allow users to quickly identify the security, sensitivity, intended distribution or retention. By utilizing the classification toolbar a user can classify an document by one or more classification levels and be ensured that the classification will be visible to any person viewing the document.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08024304&OS=08024304&RS=08024304
owner: Titus, Inc.
number: 08024304
owner_city: 
owner_country: CA
publication_date: 20071023
---
This application claims priority from U.S. provisional application No. 60 863 067 filed Oct. 26 2006 which is hereby incorporated by reference.

The present disclosure relates to computer systems and software and in particular to electronic document management and security using a document classification toolbar.

Electronic documents commonly used in the corporate and government environments are generated being word processing applications spreadsheets slide presentations the most common being MICROSOFT OFFICE application suite. With today s pervasive networking systems such as local area networks LANs wide area networks WANs and the Internet and software tools such as e mail it is very easy for individuals to move these documents around to different computers computer systems and other individuals without little or no thought as to the sensitivity of the content contained therein. As a matter of security in the electronic workplace there is therefore a need to classify manage and control the creation and flow of documents e mail correspondence and the like.

Some document management solutions allow the user to associate classifications to a document when a document is added to a document management repository governed by document management systems. These classification properties are stored in the document library database and are not actually attached to the document itself and are dependent on the document management system for identification and enforcement.

When a document is removed from the document management repository and sent to or shared with someone it loses the associated properties because the properties are not part of the document. The classification may not also be visible on any printed copies of the document itself. As a result the person receiving the document has no easy way to identify the classification of the document and they therefore do not know what limitations should be placed on the handling and distribution of the document. In addition compliance systems verifying the handling or distribution of the document have no way to decide what to do with the document as there are no properties attached to the document and potential contained in the document itself.

There is therefore a need for an improved classification and management system for electronic documents.

In an aspect there is provided a method for document classification in a document creation application comprising the steps providing a classification toolbar within a document in the document creation application the classification toolbar providing at least a first classification selection input populating classification selections in the classification toolbar based upon pre defined classification criteria receiving a classification selection input selected by a user from the classification selections populated in the toolbar determining if classification input is valid based upon administrator defined classification policy applying visual cues to the document to identify that the document has been classified and assigning XML classification properties to the document metadata based upon the classification selections when the classification input is valid.

In accordance with another aspect there is provided a method for document classification in a document creation application comprising the steps providing a classification toolbar within the document the classification toolbar providing at least a first classification selection input populating classification selections in the classification toolbar based upon pre defined classification criteria receiving identification of a selected text portion of the document from a user receiving a portion classification selection input selected by the user from the classification selections populated in the toolbar determining if portion classification input is valid based upon administrator defined classification policy applying visual cues to the document to identify a portion of the document has been classified applying visual markers identifying the selected classification at the beginning and end of the portion that has been classified and applying XML properties within the document representing the classification of the portions.

In accordance with yet another aspect there is provided a computer readable medium containing instructions for providing document classification in a document creation application the instructions which when executed by a processor perform the steps of providing a classification toolbar within a document in the document creation application the classification toolbar providing at least a first classification selection input populating classification selections in the classification toolbar based upon pre defined classification criteria receiving a classification selection input selected by a user from the classification selections populated in the toolbar determining if classification input is valid based upon administrator defined classification policy applying visual cues to the document to identify that the document has been classified and assigning XML classification properties to the document metadata based upon the classification selections when the classification input is valid.

In accordance with still yet another aspect there is provided a computer readable medium containing instructions for providing document classification in a document creation application the instruction which when executed by a processor perform the steps of providing a classification toolbar within the document the classification toolbar providing at least a first classification selection input populating classification selections in the classification toolbar based upon pre defined classification criteria receiving identification of a selected text portion of the document from a user receiving a portion classification selection input selected by the user from the classification selections populated in the toolbar determining if portion classification input is valid based upon administrator defined classification policy applying visual cues to the document to identify a portion of the document has been classified applying visual markers identifying the selected classification at the beginning and end of the portion that has been classified and applying XML properties within the document representing the classification of the portions.

Other aspects and features will become apparent to those ordinarily skilled in the art upon review of the following description of specific embodiment of the invention in conjunction with the accompanying figures.

It will be noted that throughout the appended drawings like features are identified by like reference numerals.

Due to compliance legislation such as the Sarbanes Oxley Act in the United States or more precisely the Public Company Accounting Reform and Investor Protection Act of 2002 policies such as the Health Insurance Portability and Accountability Act HIPAA or other legal or corporate guidelines there is a need for greater security of information. Companies need to be able to determine the classification of documents so that their employees will handle information correctly in terms of privacy security distribution and retention. The best way to do this is to generate recognizable classification properties and visual markers in the documents when they are being created so that everyone will know the level of sensitivity of the documents and how to handle them.

By creating classification criteria metadata properties inserted in a document travel with the document and also allow automatic processes to check the handling of the document. For example a messaging gateway or content scanner can verify the classification of documents being sent out of the company via e mail for any violations of policy. In addition classification criteria can allow the automatic insertion of to visual cues to identify the associated classification in a standard manner. Heretofore this cannot be done with productivity suites such as MICROSOFT OFFICE software ADOBE ACROBAT OPENOFFICE COREL WORDPERFECT OFFICE and VISIO . Most document creation applications allow users to add optional properties to the document such as Title Author Subject but cannot force the user to enter any properties before a document is saved or enforce classification standards. The document classification system described herein can force the user to select classification properties to be associated with the document or portions therein in addition to providing visual cues inserted within the document in standard format to ensure classification properties are appropriately identified and transmitted. Automatic insertion of visual markings in document including headers and footers in addition to advanced formatting capabilities which allow the user to apply the classification markings to specific areas of the header and footer left justified center right justified etc. to provide a consistent level of visibility not previously available. Custom properties that are associated with the document travel with the document and reflect the classification of the document can be integrated with rights management systems to limit access and distribution of document based upon the associated classification.

Event driven logic is utilized to force user to classify a documents before saving sending or printing as described in more detail below. In addition to providing overall document classification portions of the document can be classified at a different level than the document classification with unique classification markings associated to clearly identify the selected portion. All SAVE PRINT and SEND events are interpreted within the document productivity software and ensure that classification selections have been made before these actions. Prevention or warning can be displayed when the user attempts to downgrade a classification of a document. In the downgrade prevent mode if the user tries to downgrade the classification for example from SECRET to UNCLASSIFIED they can be prevented based upon the existing properties associated with it. Alternatively the document can be automatically classified based on the users profile. For example all users in the finance department could be configured to automatically apply a classification of FINANCIAL INFO to all their documents. Visual markings within the document such as header footer or watermarks can be automatically inserted based upon the selected classification.

Context sensitive classification selections which change based on user selection can also be provided by the toolbar. For example if the user selects CONFIDENTIAL as a classification they can then be prompted to indicate which department generated the confidential information and how long the information should be retained as a corporate record.

Classification selection enables the automatic creation of properties that will travel with the document and may be enforced by document classification software either residing on the computer or or by a central server . Trusted label support provides verification that classification of the document has not been modified tampered with which can be done by calculating a hash of the document properties on saving and recalculating the hash on re opening of the document by the software operating on the client. In addition the classification policy allows users to search a network or PC for documents with specific classifications. Automatic logging may be provided for all classification actions by the user can be provided which can be used to audit user compliance. For example all classification warnings classification errors or all classification events who classified when classification properties were assigned name of document etc can be logged and reviewed by an administrator. Digital rights management policies such as Windows No Print or No Change can also be applied and controlled.

The collection of classification properties can be context sensitive and the selections are configurable. For example if the user selects Confidential as the security classification they could then be prompted for a retention property or a distribution property. On the other hand if the user selects Unclassified as the document type there would be no need to collect any other classification properties. As an example the classification collection logic could be implemented as follows 

This example can be extended to many levels of classification allowing the organizations to collect many classification properties for each document. The toolbar is built dynamically based on the user selections. As an example of a possible configuration if the user selected a sensitivity of PERSONAL no other selections are necessary. If the user selects a sensitivity of COMPANY CONFIDENTIAL the toolbar is dynamically configured to further prompt the user for the allowed distribution of the document e.g. LEGAL DEPT ONLY . In this way the toolbar can expand as the user is entering the classification information. Only subsequent classification criteria associated with the first selection is dynamically presented in the toolbar as will be discussed in connection with .

It should be understood that although on two classification criteria are shown each in a toolbar may present multiple classification criteria for selection by the user.

Context sensitive text such as disclaimers can be added within the document body or within the header of footer portions. These disclaimers can be intelligently added to be tailored to the classification of the document and the associated content. For example if UNCLASSIFIED was the selected classification the following text could be appended This document is the property of XXX Corp. If you are not the intended recipient of the document please note the originator whereas a different postfix such as This document has been marked as Confidential to XXX Corp. Unauthorized reproduction or transmission of the document is prohibited if the classification selected was CONFIDENTIAL. Visual cues such as font characteristics can also be used in the added text for instance color special fonts font size or formatting table etc can all be applied to text.

Portions of the document content may also be classified independently of the overall document however when a portion classification is selected which is higher then the document selection the document properties may be upgraded to match the selection such as for example a security or sensitivity related criteria. In document paragraph is selected by the user for individual classification. By making selections using toolbar visual cues and can be added within the document to clearly identify the associate classification criteria. In this example a classification of SECRET has been selected and a caveat RelToUSA CAN which is not the same as the current selected document caveat RelToNATO. The classification markings for portions are represented within the document as Extensible Markup Language XML properties of the document as shown in . In the case or MICROSOFT WORD for example the base XML version of the document is modified with custom classification properties which represent the classification portion markings and the overall document classification. The markings may be custom to the application or organization or may be defined as per the Intelligence Community Classification and Control Markings Manual also known as the CAPCO Guide.

High level functions are available to the user when composing a document through operation of the toolbar. These functions are also available if the user wants to apply classification information to an opened document that currently has no classification properties or an opened document that already has assigned classifications. Classification selection can be forced on Save Exit or Print from a pop up dialog rather than presenting a classification toolbar. In addition a downgrade warning for preventing downgrades when Saving or Printing can also be provided. Although a word processing document is shown should be understood that the application of the classification criteria is equally applicable to any form of document including but not limited to MICROSOFT WORD EXCEL and POWERPOINT formats. Any document creation product can be utilized which do not currently allow classification of documents.

The classification toolbar can also provide built in integration for users of the MICROSOFT WINDOWS Rights Management Services RMS platform. Administrators can define associated RMS permissions such as Read Full Control Printing Copy and Paste and document expiration based on the classification label chosen. The RMS permissions or templates are defined within the MICROSOFT RMS Administration tool. Once these RMS permissions are defined they can be associated with classification criteria. This is done via Windows registry settings that indicate to the document classification toolbar if RMS protection should be automatically assigned based on a classification selection by the user. If RMS protection is to be applied then another Windows registry would be used to indicate what protection should be assigned for each classification. As an example a presentation assigned an HR ONLY label could be automatically assigned RMS permissions that would not allow anyone outside the HR department to view the presentation. The Document Classification Administration tool sets the correct Windows Registry settings based on the configuration selected by the administrator. These settings can then be applied to user desktops using scripts or MICROSOFT Group Policy.

Administrator defined settings are captured in the configuration file which is the central source of configuration information. The configuration file may be local on the computer and or be provided by the document server . This enables customization of the list of labels for classification ability for administrator to configure warnings or prevent users from downgrading classifications ability for administrator configuration to apply different customized headers footers and watermarks depending on the classification selected administrator can define default labels define if when the label s will appear in the document title or file name define the formatting and color of any visual marking text within the document such as the header or footer portions define if when the label s will appear including the ability to display abbreviations of the classifications force the user to make an explicit selection of a label before saving and sort and search a PC s or network s document database based on the document s classification.

The following logic describes some example modules in the software and the methods associated with those modules. It also describes the events associated with each module. The COfficeDocument module contains the following methods 

Determine if any of the fields in the range match the value for the first property or match the value for the second property

xxiv. STDMETHODIMP COfficeDocument Invoke DISPID dispIdMember REFIID riid LCID lcid WORD wFlags DISPPARAMS pDispParams VARIANT pVarResult EXCEPINFO pExcepInfo UINT puArgErr 

xxvi. std string COfficeDocument ReadBuiltInProperty Word DocumentPtr pDocument std string strPropertyName 

xl. COfficeDocument CWordApplicationEventHandler AddOfficeDocument Word  DocumentPtr pDocument bool fNew bool fIsE mail 

xlvi. STDMETHODIMP CWordApplicationEventHandler Invoke DISPID dispIdMember REFIID riid ECM lcid WORD wFlags DISPPARAMS pDispParams VARIANT pVarResult EXCEPINFO pExcepInfo UINT puArgErr 

xlvii. HRESULT CWordApplicationEventHandler ProcessCommand int nControlID int nCommand bool fMakeDirty 

It will be apparent to persons skilled in the art that many alternatives modifications and variations can be made without departing from the scope as defined in the claims. The method steps described may be embodied in sets of executable machine code stored in a variety of formats such as object code or source code. Such code is described generically herein as programming code or a computer program for simplification. Clearly the executable machine code may be integrated with the code of other programs implemented as subroutines by external program calls or by other techniques as known in the art.

A computing environment for executing the document creation application and the classification toolbar may be implemented as computer software in the form of computer readable code executed. The computing environment may be any number of computing or computer based platforms such as mobile devices personal computer notebook computers or personal digital assistants. The computer comprises central processing unit CPU and memory. The CPU may be a single processor or multiprocessor system. In various computing environments main memory and storage can reside wholly on computer environment or they may be distributed between multiple computers.

Input devices such as a keyboard and mouse may be coupled to a bi directional system bus of a computer for receiving input for creating documents within the web client. The keyboard and mouse are for introducing user input to a computer and communicating that user input to processor if required. Computer may also include a communication interface. Communication interface provides a two way data communication coupling via a network link to a network by wired or wireless connection or may provide an interface to other host devices by a direct radio frequency connection. In any such implementation communication interface sends and receives electrical electromagnetic or optical signals which carry digital data streams representing various types of information. Communication between the communication interface unit and the network or host use electrical electromagnetic or optical signals which carry digital data streams. The signals through the various networks and the signals on network link and through communication interface which carry the digital data to and from computer are exemplary forms of carrier waves transporting the information.

The computer processor or similar device may be programmed in the manner of method steps or may be executed by an electronic system which is provided with means for executing these steps. The storage device may include both fixed and removable media such as magnetic optical or magnetic optical storage systems Random Access Memory RAM Read Only Memory ROM or any other available mass storage technology. The storage device or media may be programmed to execute such method steps. As well electronic signals representing these method steps may also be transmitted via a communication network.

The embodiments described above are intended to be illustrative only. The scope of the invention is therefore intended to be limited solely by the scope of the appended claims.

