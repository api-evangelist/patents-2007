---

title: Network apparatus, terminal apparatus, program, and recording medium
abstract: A network apparatus connected to at least one terminal apparatus via a network is disclosed. The terminal apparatus instructs operation of hardware unique to the network apparatus. The network apparatus includes an interface part for communicating with the terminal apparatus by using the same protocol as the terminal apparatus. The interface part receives an instruction to operate the hardware from various types of software executed in the terminal apparatus and instructs the hardware to operate in accordance with the received instruction.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08261291&OS=08261291&RS=08261291
owner: Ricoh Company, Ltd.
number: 08261291
owner_city: Tokyo
owner_country: JP
publication_date: 20070709
---
The present invention relates to a network apparatus a terminal apparatus a program and a recording medium and more particularly to a network apparatus for operating its own unique hardware based on an instruction from a terminal apparatus a terminal apparatus for remotely operating unique hardware of the network apparatus a program for rendering the network apparatus to operate and a computer readable recording medium on which the program is recorded.

As one known example there is a system having an apparatus connected to a terminal apparatus via a network in which the apparatus reads an original document placed on its original plate in accordance with an instruction from the terminal apparatus. For example Japanese Laid Open Patent Application No. 2003 274100 hereinafter referred to as Patent Document 1 discloses a system allowing a multi function machine MFP in a network to conduct an original document reading process by using rsh protocol.

Patent Document 1 also discloses a method of remotely reading an original document by using rsh protocol used in a TWAIN driver network TWAIN driver .

The first difficulty is that the rsh protocol is not commonly used compared to for example the widely used HTTP HyperText Transfer Protocol . Another difficulty is that the rsh protocol is not suited for transmitting image data since it is a protocol configured to operate by receiving commands. Therefore it is difficult to design and implement with respect to software used for devices or software used for clients. Yet another difficulty is that the rsh protocol cannot be used from a Web browser.

The present invention may provide a network apparatus a terminal apparatus a program and a recording medium that substantially obviates one or more of the problems caused by the limitations and disadvantages of the related art.

Features and advantages of the present invention are set forth in the description which follows and in part will become apparent from the description and the accompanying drawings or may be learned by practice of the invention according to the teachings provided in the description. Objects as well as other features and advantages of the present invention will be realized and attained by a network apparatus a terminal apparatus a program and a recording medium particularly pointed out in the specification in such full clear concise and exact terms as to enable a person having ordinary skill in the art to practice the invention.

To achieve these and other advantages and in accordance with the purpose of the invention as embodied and broadly described herein an embodiment of the present invention provides a network apparatus connected to at least one terminal apparatus via a network the terminal apparatus instructing operation of hardware unique to the network apparatus the network apparatus including an interface part for communicating with the terminal apparatus by using the same protocol as the terminal apparatus wherein the interface part receives an instruction to operate the hardware from various types of software executed in the terminal apparatus and instructs the hardware to operate in accordance with the received instruction.

Furthermore another embodiment of the present invention provides a terminal apparatus connected to a network apparatus via a network for remotely operating the hardware unique to the network apparatus the terminal apparatus including a device driver for instructing operation of the hardware wherein the device driver communicates with the network apparatus by using the same protocol used by a plurality of other terminal apparatuses connected to the network apparatus via the network.

Furthermore another embodiment of the present invention provides a program installed in a network apparatus connected to at least one terminal apparatus via a network the terminal apparatus instructing operation of hardware unique to the network apparatus the network apparatus including a storage apparatus and a processor the processor including an interface function part for communicating with the terminal apparatus by using the same protocol as the terminal apparatus wherein the interface function part receives an instruction to operate the hardware from various types of software executed in the terminal apparatus and instructs the hardware to operate in accordance with the received instruction.

Other objects and further features of the present invention will be apparent from the following detailed description when read in conjunction with the accompanying drawings.

In the following embodiments of the present invention will be described with reference to the accompanying drawings.

The network apparatus includes a processor a work memory a storage apparatus including a recording medium e.g. flash ROM a document reading apparatus an input output circuit and unique hardware of the network apparatus hereinafter also referred to as unique hardware or unique hardware items . It is to be noted that the document reading apparatus may be included as one of the unique hardware items described below .

The processor conducts for example control of the network apparatus itself. The processor operates the document reading apparatus and the unique hardware for executing unique functions of the network apparatus . The processor is also used for executing a Web server function of the network apparatus .

The work memory is used as a space for executing software or temporarily storing read out images. The storage apparatus includes a recording medium e.g. flash ROM capable of electrically re writing data. The storage apparatus is for storing for example control programs used for executing various functions of the network apparatus and storing other software including a program of the present invention.

The input output circuit is used for connecting to the network . The document reading apparatus is for reading data from a document placed on an original plate not shown . The unique hardware includes any hardware unique to one or more network apparatuses for conducting a Web server function of the network apparatus .

The network apparatus shown in is connected to two terminal apparatuses via the network . The terminal apparatus is operated manipulated by a user to thereby allow various instructions of the user to be transmitted to the network apparatus .

Among the two terminal apparatuses the terminal apparatus is for allowing a user to transmit various instructions to the network apparatus by using a Web browser and the terminal apparatus is for allowing a TWAIN driver to transmit various instructions to the network apparatus by using a TWAIN compatible application.

TWAIN is a type of specification that is used for interconnecting an image input device e.g. digital camera and a personal computer. If an image input device compatible with TWAIN is used various instructions can be transmitted by using a TWAIN compatible application.

The software includes a user interface layer an application layer and a service layer. The user interface layer is for providing a user interface for the user. The application layer is for realizing each function of an application. The service layer is for controlling the hardware to provide a corresponding function to each application.

The user interface layer includes a device user interface UI and a Web user interface UI . The device UI provides a user interface for a control panel of the network apparatus . The Web UI provides a user interface for a terminal apparatus of the user so that the user can operate manipulate the network apparatus by using a Web browser or a TWAIN compatible application.

The Web UI includes a Web screen module and a reading resource . The Web screen module is provided for each screen. The Web screen module generates a screen to be displayed by the Web browser or the TWAIN compatible application and performs various processes e.g. changing of settings upon request. The reading resource is a generic name for the below described image resource and a status resource of the document reading apparatus .

The application layer includes a copier application a facsimile application a printer application and a scanner application . The copier application is for realizing a copier function. The facsimile application is for realizing a facsimile function. The printer application is for realizing a printer function. The scanner application is for realizing a scanner function.

The service layer includes a printing service a reading service a network service and a memory service . The printing service is for controlling a plotter apparatus included in the hardware . The reading service is for controlling the document reading apparatus . The network service is for controlling the input output circuit . The memory service is for managing the work memory .

For example in a case where the user desires to copy a document original by using the control panel of the network apparatus the device UI first receives an instruction from the user. Then the device UI sends an instruction indicating the content of a copying operation to be executed to the copier application . The copier application in accordance with the copying operation sent by the device UI instructs the reading service and the printing service to perform a reading and printing of the document. Thereby the user can receive output of a copy of the document copier output .

It is to be noted that REST is an abbreviation of Representational State Transfer which indicates a simple Web based interface using for example XML or HTTP. REST has the following characteristics that are significantly different from those of SOAP Simple Object Access Protocol .

The service providing side does not store states of communications among messages commonly referred to as session data . Having no such session data stored is referred to as stateless . The service providing side corresponds to a side for receiving instructions. The service requesting side corresponds to the side giving out instructions. Furthermore the service s provided by the providing side is not actually a service but a resource data . The resource is uniquely identified by URI Uniform Resource Identifier .

In REST a resource can be controlled by using methods defined by HTTP such as obtain GET add POST update PUT and delete DELETE . In this embodiment resources corresponding to image reading and state of the document reading apparatus are provided. Therefore only the method of obtaining GET is supported in this embodiment.

The parameters of the image resource include resolution reading density document type reading size reading area when an undefined size is designated document placement location color mode document placement orientation file format and data format when an error occurs. Any one of the parameters of the image resource may be omitted. Default values may be used as parameters for an undesignated image resource.

For example in a case where a preview image is desired when performing image reading from a Web browser a resolution of 25 dpi is designated. In this example the designation of other parameters is omitted since default values may be used for the other parameters. In a case where the user desires to read out data from plural monochrome documents and obtain the read out data in the form of a PDF file the designated resolution is 200 dpi the designated document type is text the designated color mode is monochrome and the designated file format is multi page PDF. Default values may be used for the parameters corresponding to reading density reading size and document placement orientation. The parameter corresponding to document placement location may be set automatically. Therefore the parameters corresponding to reading density reading size document placement orientation and orientation placement position may be omitted. shows examples of using image resources in a case where a preview image is desired when performing image reading from a Web browser and a case where the user desires to read out data from plural monochrome documents and obtain the read out data in the form of a PDF file.

Simply a corresponding interface needs to be called accessed in a case of a state resource of the document reading apparatus since there are no parameters of the state resource of the document reading apparatus . shows an example of using a state resource of the document reading apparatus . By accessing the interface corresponding to the state resource of the document reading apparatus data in an XML format are obtained. The obtained XML format data include data indicating whether an automatic document feeding apparatus ADF is mounted on the document reading apparatus data indicating the type of ADF data indicating whether a document is placed on the ADF data indicating the type of error occurring in the ADF data indicating the operation state of the document reading apparatus and data indicating the number of read out pages in a case of reading data by using an image resource.

The image resource and the state resource of the document reading apparatus can be used anytime without any complicated preparations e.g. session management authentication required by a Web service using SOAP for example. The image resource and the state resource of the document reading apparatus can be easily used even by a Web browser which is unable to perform complicated processes.

The below described first embodiment shows an example of a case where the user gives out various instructions to the network apparatus from a Web browser executed in the terminal apparatus . The below described second embodiment shows an example of a case where the user gives out various instructions to the network apparatus from a TWAIN driver using a TWAIN compatible application executed in the terminal apparatus

The reading condition setting area includes a resolution setting selection box a density setting selection box a document type setting selection box a reading size setting selection box a document placement orientation setting selection box and a file format setting selection box .

Reference numeral in shows a screen which is displayed when a reading process is in progress hereinafter referred to as reading in progress screen or simply as progress screen for the sake of convenience . The progress screen is displayed as a result of depressing or selecting hereinafter simply referred to as depressed for the sake of convenience the reading execution button . The progress screen includes a message area for indicating that a reading process is being executed or indicating an error message. When the network apparatus finishes reading an image of the document and completes obtaining the data image data of the image the progress screen automatically switches to another screen for indicating the obtained image data.

When the user first displays the control screen by operating the Web browser no images are shown in the preview area . However when the user depresses the preview execution button a document placed in the document reading apparatus is read with a predetermined low resolution and displayed in the preview area .

In this case however when the document reading process with the Web browser cannot be executed e.g. due to another user currently executing a reading process scanner with the control panel of the network apparatus or work memory currently being used for executing a printing process printer the read out image cannot be displayed in the preview area . Thus a message indicating the cause of the error is displayed in the message area . is a schematic diagram showing an example where an error message is displayed on a screen displayed on the Web browser of the user. Since the screen shown in is substantially the same as the screen shown in except for a part of the screen of like parts are not described in further detail.

Returning to default values initially set in the network apparatus are displayed in the resolution setting selection box the density setting selection box the document type setting selection box the reading size setting selection box the document placement orientation setting selection box and the file format setting selection box for setting the conditions of the reading process.

In a case where the user requires no change in the default values the user may depress the reading execution button . By depressing the reading execution button the progress screen is displayed in another window indicating that the reading process is in progress. After the reading process is completed the screen is displayed. In a case where the user desires a resolution different from the default value various choices of resolution can be displayed by clicking the resolution setting selection box . Accordingly the user selects a desired resolution from the displayed choices e.g. 1200 dpi 600 dpi 400 dpi 300 dpi 200 dpi 100 dpi .

In a case where a document is desired to be read with a density different from that of the default value the user clicks the density setting selection box for displaying choices of density and selects a desired density from the displayed choices. For example density may be selected from five levels e.g. level 1 through 5 or from three types e.g. dark normal light .

In a case where a document is desired to be read as a document type different from that of the default value the user clicks the document type setting selection box for displaying choices of document type and selects a desired document type from the displayed choices. The types of document may include for example photograph illustration and text . By selecting a document type an image process suited for the selected document type can be performed on the image read out from a document.

In a case where a document is desired to be read as a document having a size different from that of the default value the user clicks the reading size setting selection box for displaying choices of reading size and selects a desired reading size from the displayed choices. The types of reading sizes may include for example A4 A5 A6 B5 B6 postcard and undefined size . A square box indicating the reading area is displayed in the preview area in accordance with the selected reading size.

By using a mouse not shown to perform a dragging maneuver on the preview area the dragged area is displayed as a square box. The area of the square box defines the reading area. By using the mouse to perform a dragging maneuver on one of the sides of the square box the shape of the square box can be changed. Furthermore by using the mouse to perform a dragging maneuver on an inside part of the square box the position of the reading area can be moved without changing the shape of the square box. In addition by using the mouse to perform a dragging maneuver on the preview area the reading size setting selection box is automatically set as undefined size .

Although these maneuvers may be executed without displaying a preview image in the preview area in this embodiment the mouse is used to select the reading area by referring to the preview image displayed in the preview area .

In a case where a document is desired to be placed and read in a direction orientation different from that of the default value the user clicks the document placement orientation setting selection box for displaying choices of orientation and selects a desired orientation from the displayed choices. The orientations for placing a document may include for example portrait and landscape . By selecting a document placement orientation an image is obtained by reading a document in the selected orientation direction .

In a case where a document is desired to be read with a file format different from that of the default value the user clicks the file format setting selection box for displaying choices of file format and selects a desired file format from the displayed choices. The file formats may include for example JPEG and multi page PDF. By selecting a file format an image is obtained by reading a document in accordance with the selected file format.

In a case where the user changes the reading condition in the density setting selection box and depresses the preview execution button a preview process is executed by displaying a preview image in the control screen in accordance with the density set in the density setting selection box . That is the user can confirm the results of changing the density condition by the preview image displayed in the preview area .

Likewise in a case where the user changes the reading condition in the document type setting selection box and depresses the preview execution button a preview process is executed by displaying a preview image in the control screen in accordance with the document type set in the document type setting selection box . In executing the preview process an image process suitable for the selected document type is performed on the image to be displayed as the preview image. Thus the user can confirm the results of changing the document type by the preview image displayed in the preview area .

In a case where the reading execution button is depressed the above described progress screen is displayed as a separate window in the screen . In this case when the document reading process with the Web browser cannot be executed e.g. due to another user currently executing a reading process scanner with the control panel of the network apparatus or work memory currently being used for executing a printing process printer a message indicating the cause of the error is displayed in the message area . shows the screen in a case where an error message is displayed. More specifically an error message indicating the cause of the error is displayed in an error message area in the screen .

Then in Step S the Web browser issues a request obtain image resource to the network apparatus Step S . The network service in the network apparatus receives accepts the request issued by the Web browser .

Then in Step S the network service distributes the request received from the Web browser in Step S to the Web UI located in the user interface layer. That is the network service delivers the received request as is to the Web UI .

When the Web UI receives the request from the network service the network apparatus based on the content of the request comprehends that the button depressed in the screen is the preview execution button or the reading execution button and that the reading conditions e.g. resolution density document type reading size designated by the user are the parameters for obtaining the image resource.

In this example color mode document placement location and data format when error occurs are not included in the request from the Web server . In such a case where reading conditions are not designated default values are used. Therefore in this example color automatic and HTML are used as default values corresponding to color mode document placement location and data format when error occurs . By designating HTML or XML as the data format when error occurs it can be determined whether the software used in the terminal apparatus is the Web browser or a TWAIN driver.

Then in Step S in a case where automatic is designated as the document placement location the Web UI queries the reading service whether a document is placed in the automatic document feeder ADF . Then in Step S in a case where a document is placed in the ADF it is regarded that the ADF has been designated as the document placement location. In a case where no document is placed in the ADF it is regarded that the contact glass has been designated as the document placement location. Step S in shows a case where a document is placed in the ADF. Accordingly the reading service reports that the document is placed in the ADF to the Web UI .

Then in Step S the Web UI sends an instruction reading instruction from remote along with parameters for obtaining the image resource to the scanner application . Then in Steps S and S the scanner application receiving the instruction from the Web UI instructs the document reading apparatus to perform reading via the reading service .

Then in Step S the document reading apparatus reads image data from a document compresses the read image data and stores the image data in an image memory managed by the memory service . After the document reading apparatus completes the reading process the compressing process and the storing process the operation proceeds to Step S. In Step S the document reading apparatus reports to the reading service that image data have been stored in the image memory.

Then in Step S the reading service receiving the report of S reports that the reading process for the first page of the document is completed to the scanner application . When an unread document s is still remaining in the ADF in a case where multi page PDF is designated as the file format for reading the documents placed in the ADF the scanner application instructs the document reading apparatus to read the next document via the reading service by performing the Steps S S.

Then in Step S the scanner application reports completion of the reading process to the Web UI in a case where i the reading process is performed by placing the document on the contact glass ii the reading process is performed by placing the document in the ADF and designating JPEG as the file format or iii performing the reading process by placing the document in the ADF but having no document remaining in the ADF.

Then in Step S the Web UI receiving the report of completion from the scanner application and reads out the image data stored in the image memory by the document reading apparatus . Then in Step S the Web UI requests the network service to transmit the image data to the Web browser of the user. Then in Step S the network service transmits the image data to the Web browser of the user. When the transmission of the image data is completed the operation proceeds to Step S. In Step S the network service reports completion of transmission to the Web UI .

Then in Step S the Web UI instructs the memory service to discard the image data transmitted in Step S upon receiving the transmission completion report from the network service . Although it is possible to have the image data discarded at a timing other than the reception of the transmission completion report from the network service e.g. discarding a previous read out image data when storing a subsequent read out image data in the memory service operation becomes complicated. Therefore the operation shown in the sequence diagram of is suitable from the aspect of simplifying operations.

When the reading execution button in the control screen is depressed the progress screen is displayed in the Web browser . The progress screen includes a message area for displaying a message indicating that reading is in progress. The progress screen also includes a progress state display area that changes along with progress of the reading process. In this example the progress state display area displays the page number that is currently being displayed. When the network apparatus completes reading an image from the document and the terminal apparatus obtains data of the read image image data from the network apparatus the progress screen is automatically switched to another screen that displays the obtained image data.

In Step S when the reading execution button of the control screen is depressed by the user the Web browser requests the network apparatus to transmit data of the progress screen . Then in Step S the network apparatus transmits HTML data of the progress screen to the Web browser in response to the request of Step S.

The Web browser receiving the HTML data of the progress screen interprets the HTML data and displays the progress screen . Then in Step S the Web browser requests obtaining the image data written in the received HTML data to the network apparatus . The image data are obtained in the form of obtaining an image resource of the network apparatus .

Then the network apparatus begins to perform a reading process on a document s and the Web browser attempts to display the image data corresponding to the image requested in Step S. However no data are transmitted from the network apparatus until the network apparatus finishes reading images of all documents pages . Therefore the Web browser is in a waiting state.

The Web browser periodically requests obtaining a resource of the state of the reading apparatus reading apparatus state resource in Steps S S S and S concurrently with the requesting of obtaining image data. The process of obtaining the reading apparatus state is performed by using for example a technology referred to as Ajax Asynchronous JavaScript XML .

In the sequence diagram shown in since the document reading apparatus is still in the middle of reading the first page of the document the network apparatus transmits page 0 as the number of read pages reading completed pages in response to the first state obtaining request transmitted from the Web browser in Step S. The Web browser receiving the page 0 data updates the message area to indicate that reading of page 1 is in progress.

It is to be noted that the Web browser also obtains data other than the read number of pages when the Web browser requests obtaining the resource of the state of the document reading apparatus . Such data include for example data regarding the type of ADF data indicating whether an ADF is mounted data indicating whether a document is placed in the ADF and data indicating the operating state of the document reading apparatus . However since such other data are not required by the Web browser according to an embodiment of the present invention the other data are simply ignored.

In Step S the Web browser requests obtaining the reading apparatus state resource again after a predetermined period elapses. Then since the document reading apparatus has completed reading the first page of the document and is in the middle of reading the second page of the document the network apparatus transmits page 1 as the number of read pages reading completed pages in response to the state obtaining request transmitted from the Web browser in Step S.

The Web browser receiving the page 1 data updates the message area to indicate that reading of page 2 is in progress.

It is to be noted that the predetermined period prior to Step S may be an interval no greater than one second or an interval of a few seconds. Although the progress state can be displayed more promptly if the interval is shorter it may overload the document reading apparatus and the network environment. Therefore considering that it takes more than a few seconds to read a single page of a document it is preferable for the interval to be approximately one or two seconds.

Then the same processes are performed on the remaining pages of the document in Steps S S to thereby complete the reading of the document. Then in Step S the network apparatus upon completing the reading of the document transmits image data of the document to the Web browser . After the Web browser completes receiving the image data the Web browser being in a waiting state as described in Step S immediately displays the image s of the received image data.

For example an error may occur for a low cost network apparatus having a small work memory when the user designates reading a large size document with a high resolution. In this case it is necessary to report this error to the user.

In Step S when the user depresses the reading execution button in a case where 1200 dpi is set in the resolution setting selection box and A4 is set in the reading size setting selection box the Web browser transmits a request for the progress screen progress screen data to the network apparatus .

Then in Step S the network apparatus transmits HTML data of the progress screen to the Web browser in response to the request of Step S. The Web browser receiving the HTML data of the progress screen interprets the HTML data and displays the progress screen . Then in Step S the Web browser requests to obtain the image data written in the received HTML data from the network apparatus . The image data are obtained in the form of an image resource of the network apparatus .

The network apparatus confirms each parameter of the reading conditions. In this example due to the constraint of the work memory a document cannot be read with a size of A4 and a resolution of 1200 dpi. Therefore in Step S the network apparatus transmits HTML data of an error screen as shown in to the Web browser instead of transmitting HTML data of the progress screen . is a schematic diagram showing an example of the error screen .

In the processes performed in Steps S S are substantially the same as those performed in Steps S S of . In Steps S S when document jam error occurs in the ADF in the middle of reading the second page of the document the document reading apparatus reports the error to the scanner application through the reading service . Then in Step S the scanner application reports to the Web UI that the reading process has ended in error.

Then in Step S the Web UI receiving the error end report instructs the document reading apparatus to discard the image data stored in the image memory. Then in Step S the Web UI requests the network service to transmit HTML data of an error screen see to the Web browser of the user.

Then in Step S the network service transmits the HTML data of the error screen to the Web browser of the user. Then in Step S the network service after completing the transmission of the HTML data of the error screen reports completion of the transmission to the Web UI .

Although it is possible to discard the image data that has been read before the error occurred at a timing other the reception of the transmission completion report of Step S e.g. at a timing when storing the subsequent read out image data in the memory service the operation becomes complicated. Therefore the operation shown in the sequence diagram of is suitable from the aspect of simplifying operations.

The reading condition setting area for setting the condition of the reading process includes a color mode setting selection box a resolution setting selection box a density setting selection box a document type setting selection box a reading size setting selection box a document placement orientation setting selection box and a document placement location setting selection box .

When the user first displays the control screen by using the application software no image is displayed in the preview area . When the user depresses the preview execution button the document placed in the document reading apparatus of the network apparatus is read with a predetermined low resolution and displayed in the preview area .

In this case however when the document reading process with the TWAIN driver cannot be executed e.g. due to another user currently executing a reading process scanner with the control panel of the network apparatus or work memory currently being used for executing a printing process printer the read out image of the document cannot be displayed in the preview area . Accordingly as shown in a pop up dialog window is displayed for indicating the cause of the error. shows an example of the pop up dialog screen indicating the error.

In this example where a process of obtaining an image resource reading process cannot be executed due to an error such as another operation being in progress the TWAIN driver executes a process of obtaining a document reading apparatus state resource of the document reading apparatus . Thereby the TWAIN driver obtains the operating status of the document reading apparatus identifies the cause of the error and displays a message corresponding to the error in the pop up dialog window.

Returning to default values initially set to the network apparatus are displayed in the color mode setting selection box the resolution setting selection box the density setting selection box the document type setting selection box the reading size setting selection box the document placement orientation setting selection box and the document placement location setting selection box .

In a case where the user requires no change in the default values the user may depress the reading execution button . By depressing the reading execution button the read data are transferred to the application software of the terminal apparatus . In a case where the user desires a color mode different from the default value various choices of color modes can be displayed by clicking the color mode setting selection box . Accordingly the user selects a desired color mode from the displayed choices e.g. color gray scale and monochrome .

In a case where a document is desired to be read with a resolution different from that of the default value the user clicks the resolution setting selection box and selects a desired resolution from the displayed choices. In a case where a document is desired to be read with a density different from that of the default value the user clicks the density setting selection box for displaying choices of density and selects a desired density from the displayed choices.

In a case where a document is desired to be read as a document type different from that of the default value the user clicks the document type setting selection box for displaying choices of document type and selects a desired document type from the displayed choices.

In a case where a document is desired to be placed and read in a direction orientation different from that of the default value the user clicks the document placement orientation setting selection box for displaying choices of orientation and selects a desired orientation from the displayed choices.

In a case where a document is desired to be placed and read at a location different from that of the default value the user clicks the reading placement location setting selection box for displaying choices of reading placement location and selects a desired reading placement location from the displayed choices. The locations for reading the document may be for example ADF or contact glass . Thereby the document can be read at the selected locations.

In a case where the user changes the reading condition in the color mode setting selection box and depresses the preview execution button a preview process is executed by displaying a preview image in the control screen in accordance with the color mode set in the color mode setting selection box . That is the user can confirm the results of changing the color mode condition by the preview image displayed in the preview area .

Likewise in a case where the user changes the reading condition in the density setting selection box and depresses the preview execution button a preview process is executed by displaying a preview image in the control screen in accordance with the density set in the density setting selection box . That is the user can confirm the results of changing the density condition by the preview image displayed in the preview area .

Likewise in a case where the user changes the document type setting selection box and depresses the preview execution button a preview process is executed by displaying a preview image in the control screen in accordance with the document type set in the document type setting selection box . In executing the preview process an image process suitable for the selected document type is performed on the image to be displayed as the preview image. Thus the user can confirm the results of changing the document type by the preview image displayed in the preview area .

When the reading execution button is depressed the reading process is initiated. After the reading process is completed the read image data are transferred to the application software of the terminal apparatus and displayed on the control screen . In this case when the document reading process with the TWAIN driver cannot be executed e.g. due to another user currently executing a reading process scanner with the control panel of the network apparatus or work memory currently being used for executing a printing process printer the read image data are not transferred to the application software of the terminal apparatus and the cause of the error is displayed in the pop up dialog window.

The request issued from the TWAIN driver is received accepted by the network service in the network apparatus . Then in Step S the network service distributes the request received from the TWAIN driver in Step S to the Web UI . That is the network service delivers the received request as is to the Web UI .

Then in Step S the Web UI receiving the request to obtain reading apparatus state of the document reading apparatus queries the reading service for various information items data . The Web UI may query for example whether an automatic document feeding apparatus ADF is mounted on the document reading apparatus data indicating the type of ADF data indicating whether a document is placed on the ADF data indicating the type of error occurring in the ADF data indicating the operation state of the document reading apparatus and data indicating the number of read pages.

Then in Step S the reading service may return corresponding data in response to the query from the Web UI such as data indicating that an ADF is mounted on the document reading apparatus data indicating that a document is placed on the ADF data indicating that no error exists in the ADF data indicating that the document reading apparatus is not operating data indicating that the document reading apparatus is in a standby state reading not yet started and data indicating that 0 pages have been read.

In Steps S and S the Web UI transmits the data received from the reading service to the TWAIN driver via the network service . After the TWAIN driver confirms that the ADF is mounted on the document reading apparatus and that there is no error in the ADF the TWAIN driver adds ADF to the choices of the document placement location setting selection box . Then in Step S the TWAIN driver displays the control screen .

Since some of the above described data from the network service e.g. data indicating that a document is placed on the ADF data indicating that no error exists in the ADF data indicating the operation state of the document reading apparatus number of read pages when reading is in progress are not required to be displayed on the control screen of the TWAIN driver such data are simply ignored.

Then in Step S the user depresses the preview execution button or the reading execution button on the control screen of the TWAIN driver . Then in Step S the TWAIN driver issues sends a request again for obtaining a reading apparatus state resource of the document reading apparatus to the network apparatus in the same manner as Step S.

Then in Steps S S various data are transmitted to the TWAIN driver in the same manner as Steps S S. The TWAIN driver refers to data indicating whether a document s is placed in the ADF. In a case where no document is placed in the ADF even though the user designated the ADF as the document placement location a pop up dialog window is displayed indicating the error as shown in . is a schematic diagram showing an example of the pop up window indicating an error.

Then in Step S the TWAIN driver issues sends a request to obtain the next image resource. The network service in the network apparatus accepts receives the request issued from the TWAIN driver .

Then in Step S the network service distributes the request received from the TWAIN driver in Step S to the Web UI . That is the network service delivers the received request as is to the Web UI .

In a case where the color mode designated by the user is color or gray scale the TWAIN driver designates JPEG as its file format. In a case where the user designates monochrome as the color mode the TWAIN driver designates TIFF as the file format. This is because a reading process is instructed to the network apparatus with respect to every single page even in a case of reading plural documents with the ADF and the reading process is repeated as long as there is a document placed in the ADF. Furthermore XML is used as the data format in a case where error occurs. This is because data of XML format is easier to process compared to data of HTML format.

When the Web UI receives the request from the network service the network apparatus based on the content of the request comprehends that i the button depressed in the control screen is the preview execution button or the reading execution button and ii reading conditions designated by the user e.g. resolution density document type reading size and the file format implicitly designated by the TWAIN driver are the parameters for obtaining the image resource. Then in Step S the Web UI sends an instruction reading instruction from remote along with parameters for obtaining the image resource to the scanner application .

Then in Steps S and S the scanner application receiving the instruction from the Web UI instructs the document reading apparatus to perform reading via the reading service . Then in Step S the document reading apparatus reads image data from a document compresses the read image data and stores the image data in an image memory managed by the memory service . After the document reading apparatus completes the reading process the compressing process and the storing process the operation proceeds to Step S. In Step S the document reading apparatus reports to the reading service that image data have been stored in the image memory.

Then in Step S the reading service receiving the report of S reports that the reading process for the first page of the document is completed to the scanner application . Then in Step S the scanner application reports completion of the reading process to the Web UI .

Even if an unread document s is still remaining in the ADF the completion of the reading process is reported in a state where the unread document s is left remaining in the ADF. This is due to the TWAIN driver instructing that a single page be read by using JPEG or single page TIFF .

Then in Step S the Web UI receiving the report of completion from the scanner application reads out the image data stored in the image memory by the document reading apparatus . Then in Step S the Web UI requests the network service to transmit the image data to the Web browser of the user. Then in Step S the network service transmits the image data to the Web browser of the user.

When the transmission of the image data is completed the operation proceeds to Step S. In Step S the network service reports completion of transmission to the Web UI . Then in Step S the Web UI instructs the memory service to discard the image data transmitted in Step S upon receiving the transmission completion report from the network service .

Then in Step S the TWAIN driver upon receiving the image data transfers the image data to the application software . Since the format of the image data from the network apparatus is either JPEG format or TIFF format the application software cannot recognize such format of the image data. Therefore before transferring the image data to the network apparatus the image data are converted into a format that can be recognized by the application software .

Then in order to determine whether an unread document s is remaining in the ADF the TWAIN driver issues sends a request again for obtaining a reading apparatus state resource of the document reading apparatus to the network apparatus . In the same manner described above in Steps S S various data are obtained. In a case where the TWAIN driver receives data indicating that an unread document s is remaining in the ADF the TWAIN driver obtains image data of the remaining document by issuing sends a request to obtain the image resource in the same manner described in Steps S S. In a case where no unread document is remaining in the ADF i.e. reading of all documents completed the TWAIN driver completes the operation and returns control to the application software.

For example an error may occur for a low cost network apparatus having a small work memory when the user designates reading a large size document with a high resolution. In this case it is necessary to report this error to the user.

In Step S when the user depresses the reading execution button in a case where 1200 dpi is set in the resolution setting selection box and A4 is set in the reading size setting selection box the TWAIN driver sends a request to obtain an image resource to the network apparatus .

Then in Step S the network apparatus confirms each parameter of the reading conditions. In this example due to the constraint of the work memory a document cannot be read with a size of A4 and a resolution of 1200 dpi. Therefore in this step the network apparatus transmits XML data of an error screen see to the TWAIN driver instead of transmitting image data of a read document. is a schematic diagram showing an example of the XML data of the error screen . The TWAIN driver receiving the XML data analyzes the content of the received XML. In this case the TWAIN driver analyzes that the error is due to the user having designated reading conditions that cannot be used in combination for performing the reading process. Accordingly the TWAIN driver displays a pop up dialog window error screen as shown in . shows an example of the pop up dialog screen indicating the error.

In the processes performed in Steps S S are substantially the same as those performed in Steps S S of . That is the user depresses the preview execution button or the reading execution button of the control screen of the TWAIN driver .

Then the TWAIN driver issues sends a request to obtain the image resource to the document reading apparatus . The network service in the network apparatus accepts receives the request issued from the TWAIN driver . Then the network service distributes the request received from the TWAIN driver to the Web UI . That is the network service delivers the received request as is to the Web UI . Then the Web UI sends an instruction reading instruction from remote to the scanner application .

Then the scanner application receiving the instruction from the Web UI instructs the document reading apparatus to perform reading via the reading service . Then the document reading apparatus reads image data from a document compresses the read image data and stores the image data in an image memory managed by the memory service . After the document reading apparatus completes the reading process the compressing process and the storing process the document reading apparatus reports to the reading service that image data have been stored in the image memory.

Then the reading service receiving the report from the document reading apparatus reports that the reading process for the first page of the document is completed to the scanner application . Then the scanner application reports completion of the reading process to the Web UI .

Then the Web UI receiving the report of completion from the scanner application reads out the image data stored in the image memory by the document reading apparatus . Then the Web UI requests the network service to transmit the image data to the TWAIN driver . Then the network service transmits the image data to the TWAIN driver .

When the transmission of the image data is completed the network service reports completion of transmission to the Web UI . Then the Web UI instructs the memory service to discard the image data transmitted in S upon receiving the transmission completion report from the network service .

Then the TWAIN driver upon receiving the image data transfers the image data to the application software . Since the format of the image data from the network apparatus is either JPEG format or TIFF format the application software cannot recognize such format of the image data. Therefore before transferring the image data to the network apparatus the image data is converted into a format that can be recognized by the application software .

Furthermore in the processes performed in Steps S S are substantially the same as those performed in Steps S S. That is when the TWAIN driver confirms that a next document next page is placed in the document reading apparatus by obtaining the reading apparatus state resource of the document reading apparatus the TWAIN driver instructs the document reading apparatus to read the next document via the reading service .

When document jam error occurs in the ADF in the middle of reading the second page of the document next document the document reading apparatus reports the error to the scanner application through the reading service . Then the scanner application reports to the Web UI that the reading process has ended in error.

Then the Web UI receiving the error end report instructs the document reading apparatus to discard the image data stored in the image memory. Then the Web UI requests the network service to transmit XML data indicative of the error see to the TWAIN driver . is a schematic diagram showing an example of the XML data indicating the error.

Then the TWAIN driver receiving the XML data analyzes the content of the received data. Since the cause of the error occurred in the middle of executing the reading progress the TWAIN driver obtains the reading apparatus state of the document reading apparatus . In this example since the type of error that occurred in the ADF is document jam the error is displayed in a pop up dialog window as shown in .

In the sequence diagram of the image data of the first page of the document which is read without error are already transferred to the application software . However since the second page of the document could not be read due to the error the error is reported to the application software . Alternatively the error may be ignored and control can be returned to the application software .

With the above described embodiment of the present invention a single easy to use interface is used to execute image reading with the WEB browser or image reading with the TWAIN driver without requiring different protocols or interfaces in the network apparatus network apparatus side .

Furthermore since a single easy to use interface is used instead of preparing different protocols or plural interfaces in the network apparatus processes of designing or implementing different protocols and plural interfaces can be eliminated.

Furthermore in addition to being able to easily design and implement a Web service for remotely reading a document the Web service can be realized with a small ROM RAM. Furthermore a designer of a Web page a designer of the TWAIN driver or a system integrator of a system outside of a company can easily develop software for reading remotely reading images.

The present invention provides a single interface which not only can be easily operated with a Web browser but can also provide advanced functions required by the TWAIN driver . Although a Web service using SOAP requires a large ROM or RAM for managing sessions and states statuses the interface of the present invention can be easily designed and implemented without requiring such large ROM or RAM.

Hence the network apparatus the terminal apparatus the program and the recording medium according to the above described embodiments of the present invention provide an advanced interface of a network apparatus which can be easily used from outside via a network and easily designed and implemented for remotely performing reading images even where one or more terminal apparatus instructing the reading of the images use various software.

Further the present invention is not limited to these embodiments but variations and modifications may be made without departing from the scope of the present invention.

The present application is based on Japanese Priority Application No. 2006 191986 filed on Jul. 12 2006 with the Japanese Patent Office the entire contents of which are hereby incorporated by reference.

