---

title: Application based routing arrangements and method thereof
abstract: An application-based routing arrangement for routing a plurality of data packets associated with a set of applications partially through a network is provided. The application based policy includes the first set of rules associated with the first application of the set of applications, which includes the first routing specification for routing the first set of data packets. The application routing table is configured to dynamically update the first set of parameters when the first application is connected to the network. The application routing table also includes a hook module to configure the matching of the first data packet associated with the first application against the application routing table to determine the first routing specification using the first routing specification if a match is found.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08874789&OS=08874789&RS=08874789
owner: Trend Micro Incorporated
number: 08874789
owner_city: Tokyo
owner_country: JP
publication_date: 20070928
---
In a network environment such as the internet information may be shared among users even though the users may be geographically dispersed. In a typical day millions of data packets e.g. inter protocol packets ma be shared between users across the network. Those skilled in the art are aware that a network may include a plurality of computer systems connected together via a plurality of network devices e.g. routers switches gateways firewalls etc. over a communication medium e.g. wired medium wireless medium optical medium and the like . Examples of a network may include but are not limited to the internet a personal area network PAN a local area network LAN a wide area network WAN and the like.

To route a data packet through the network a protocol stack at each network device e.g. node may maintain a routing table to determine the route for transporting the data packet from the source location to the final destination. As discussed herein a routing table refers to a list that may provide a path for routing a data packet based on the destination address of the data packet. To travel from a source location to a destination location the data packet may have to hop from one network device e.g. node to the next. Traditionally each routing table may only have knowledge of the next hop . In other words even though there may be different paths for sending a data packet from a source location to a destination location the best route may have already been established based on cost and nodes e.g. routers switches gateways firewalls etc. availability. Thus the routing table at each of the node may include the next hop that will enable the data packet to be transmitted along the best route and reach its final destination.

In an example an email is sent from location A to a destination B. Upon receiving a data packet associated with the email a protocol stack in a router may refer to a routing table to determine the path for routing the data packet. The routing table may include the destination address and the path associated with the destination address. Based on the routing table the protocol stack may be able to route the data packet to the next hop along the best route to the destination location.

However the method of routing data packets primarily based on destination address provides little flexibility for data packets that may need to be sent along a different route. Consider the situation wherein for example a user wants to send all entails created by an email application through a secured path such as a virtual private network VPN . Even though the user may have this special security requirement not all emails transmitted will be sent through a secured path. Instead the path each email may be transmitted may depend upon the destination address of the email. In an example emails that are sent to destination B may be sent along a secured path however emails sent to destination C may be routed along an unsecured path. As a result the routing table is not able to accommodate the special requirements that a specific application may have since the routing table does not take into account the application source to determine routing.

The invention relates in an embodiment to an application based routing arrangement for routing a plurality of data packets associated with a set of applications partially through a network. The application based policy includes the first set of rules associated with the first application of the set of applications which includes the first routing specification for routing the first set of data packets. The application routing table is configured to dynamically update the first set of parameters when the first application is connected to the network. The application routing table also includes a hook module to configure the matching of the first data packet associated with the first application against the application routing table to determine the first routing specification using the first routing specification if a match is found.

The above summary relates to only one of the many embodiments of the invention disclosed herein and is not intended to limit the scope of the invention which is set forth in the claims herein. These and other features of the present invention will be described in more detail below in the detailed description of the invention and in conjunction with the following figures.

The present invention will now be described in detail with reference to a few embodiments thereof as illustrated in the accompanying drawings. In the following description numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent however to one skilled in the art that the present invention may be practiced without some or all of these specific details. In other instances well known process steps and or structures have not been described in detail in order to not unnecessarily obscure the present invention.

Various embodiments are described hereinbelow including methods and techniques. It should be kept in mind that the invention might also cover articles of manufacture that includes a computer readable medium on which computer readable instructions for carrying out embodiments of the inventive technique are stored. The computer readable medium may include for example semiconductor magnetic opto magnetic optical or other forms of computer readable medium for storing computer readable code. Further the invention may also cover apparatuses for practicing embodiments of the invention. Such apparatus may include circuits dedicated and or programmable to carry out tasks pertaining to embodiments of the invention. Examples of such apparatus include a general purpose computer and or a dedicated computing device when appropriately programmed and may include a combination of a computer computing device and dedicated programmable circuits adapted for the various tasks pertaining to embodiments of the invention.

In one aspect of the invention the inventor herein realized that routing of a data packet such as an Internet protocol IP packet may be performed at an application level thereby enabling applications with special requirements to be accommodated. In accordance with embodiment of the invention an application based routing arrangement is provided. Embodiments of the invention include an application based policy for storing rules that may be associated with one or more applications. Embodiments of the invention also include dynamically updating an application routing table based on an API connection established when an application establishes a network connection with a destination.

In one or more embodiments of the invention an application based routing arrangement is provided for routing IP packets created by an application through a specified routing specification e.g. path regardless of the destination address. In an embodiment of the invention the application based routing arrangement may include a hook module such as a socket API hook. The hook module may get its policy from application based policy and basing on the policy may update application route table. As discussed herein an application based policy refer to a set of rules that a user may define to provide guidance on how an IP packet for a specific application may be routed. In an example an IP packet from a specific email application is routed through routing specification X which may be a virtual private network VPN .

In embodiment of the invention the hook module is also configured for at least updating an application routing table. An application routing table is a routing table that is implemented at the same level as the application. In an example if the application is residing on a personal computer then the application routing table is also located at the user s personal computer. In another example if the application is residing at the gateway then the application routing table is also stored at the gateway level.

As can be appreciated from the foregoing the application routing table is an additional component that is being added to a routing module which traditionally has included a standard routing table. Those skilled in the art are aware that a standard routing table may include routing instructions for data packets based on a destination address e.g. IP address .

In an embodiment the application routing table may be dynamically updated by the hook module when an API connection is established between an application and a destination. For example when an application is trying to establish a network connection e.g. internet connection with a server the hook module may update the application routing table with the API parameters. The parameters may include but are not limited to the protocol e.g. transmission control protocol user datagram protocol etc. that may be utilized in order to enable the interaction between the source and the destination the destination address the destination port the source port and the like. In addition the parameters may be associated with a routing specification for receiving and or sending the data packets. In an embodiment the routing specification may be defined in the application based policy.

In an embodiment of the invention IP packets created by applications that may have rules defined on an application based policy may be routed to its destination address based on the parameters stored on the application routing table. As can be appreciated from the foregoing IP packets that are routed based on the application routing table are routed based along the same routing specification regardless of the destination IP address stored in the IP packet.

The features and advantages of the present invention may be better understood with reference to the figures and discussions that follow.

Unfortunately if application has special requirements e.g. special security requirement for sending IP packets generated by application standard routing table may not be able to accommodate the special security requirement. In an example user wants to route all IP packets created by application through a virtual private network VPN . However standard routing table may not allow for special accommodation.

In an embodiment application based routing arrangement may include an application based policy which includes a set of rules that a user may define to provide guidance on how IP packets with special security requirements may be handled. In an example application based policy may include a rule indicating that all IP packets generated by application are to be routed through VPN. In another example application based policy may include another rule indicating that all IP packets generated by application to certain destination addresses are to be routed through a designated routing specification. As can be appreciated from the foregoing application based policy may include a plurality of rules. Application based policy may be updated as special security requirements are required for new application and or special security requirements are changed for existing application.

In another embodiment application based routing arrangement may include an application routing table which may be updated by a hook module such as a socket API application programming interface hook. Hook module may be configured to extract parameters from the API that may be established when an application is trying to interact with another application via the internet. Parameters that may be included on application routing table may include but are not limited to the protocols utilized the destination address the source port and the destination port. In addition hook module may associate the API parameters with a routing specification for receiving and or sending the data packets. In an embodiment the routing specification may be defined in the application based policy.

Consider the situation wherein for example a user at computer wants to download a file from website . The user at computer may launch a browser application such as application and request for connection with website . When computer tries to connect with website hook module may be activated.

In an embodiment hook module may be configured to query application based policy when an API connection is established for an application such as application to determine if a rule has been established for the application. As aforementioned application based policy may include rules for routing IP packets created by applications. shows in an embodiment of the invention examples of rules that may be stored in application based policy . In an example if an IP packet is generated by application or the rules may specify routing the IP packet via routing specification X as shown in line and line . In another example if an IP packet is generated by application the rules may specify routing the IP packet via routing specification Y as shown in line . In yet another example if an IP packet is generated by application the rules may specify routing the IP packet to network A. Rules may be added deleted and or changed as needed.

If no rules are created specifically for the application then no additional steps may need to be performed. However if a rule exists for application hook module may update application routing table with the API parameters e.g. protocol utilized the destination address the source port the destination port etc and the routing specification for transmitting the data packets as defined in the application based policy. shows in an embodiment of the invention examples of parameters that may be stored in application routing table . In an example routing parameters associated with application may include destination IP address is X1 destination port is Y1 source port is Z1 protocol is TCP route is routing specification X as shown in line . Thus with hook module application routing table may be dynamically updated. In other words parameters may be added and deleted from application routing table when an API connection is established or terminated. In an example application routing table may be updated each time the destination source changes. Also each time a destination source is no longer valid the hook module may remove the parameters associated with the specific destination source from the application routing table.

When an IP packet is sent from application to website a routing module may compare the data stored on application routing table with the data stored in the IP packet. If a match is found the IP packet may be routed along a path to website . In an embodiment path may be the routing specification that has been defined in application based policy as the path to use in transmitting IP packets generated by application . As can be appreciated from the foregoing the routing specification that may be utilized by the IP packets created by a specific application may be the same regardless of the destination address that may be stored in the IP packet.

However if a match is not found then routing module may check standard routing table to determine the route for transmitting the IP packets based on the destination IP address stored within the IP packet. In an example based on standard routing table the IP packet is to be transmitted along a path .

As can be appreciated from the foregoing by providing an application based routing arrangement applications with special requirements may be accommodated while still providing a standard routing table to route IP packets that may not have special needs.

At a first step a network is accessed. Consider the situation wherein for example a user is trying to upload a file to a server via a file transfer protocol FTP application. Those skilled in the art are aware that when a network connection is established an API is usually established.

At a next step the socket API hook may check the API connection to determine if the API connection is being either connected or being closed. In an example an API connection is being connected if the FTP application is connecting to the server for the first time. In another example an API connection is being closed if the FTP application is terminating its connection with the server.

If the API connection is not being either connected or closed then at a next step the application routing table is not modified.

Referring back to step if the API connection is either connected or closed then at a next step the socket API hook may checks to see if a rule is available for the caller e.g. FTP application within an application based policy.

If no rule is established for the application then at step the application routing table is not modified.

However if a rule exists for the application then at a next step the socket API hook may dynamically update the application routing table. In an embodiment if the API connection is being established then the application routing table may be updated with the API parameters e.g. destination port destination IP source port protocol etc. . However if the API connection is being closed then the API parameters associated with the FTP application may be deleted from the application routing table.

At a first step an IP data packet from the application is compared against an application routing table.

At a next step a match is determined. In other words the data stored in the IP packet is compared against the parameters stored on the application routing table.

If a match exists then at a next step the IP packet is routed in accordance with the parameters stored in the application routing table. In an example if an IP packet is created by an application A then the IP packet is routed along routing specification X as defined in the application routing table which is based on the rules stored in the application based policy.

However if a match does not exist then at a next step the IP packet is routed based on the standard routing table. In an example the IP packet is routed according to the destination IP address of the IP packet.

As can be appreciated from the forgoing one or more embodiments of the present invention provide for an application base routing arrangement which supports IP packets that may have special requirements while still being configured to be capable of routing standard IP packets through the traditional routing arrangement. With the application based routing arrangement users are empowered by being able to establish rules for applications that may have special routing requirements.

While this invention has been described in terms of several preferred embodiments there are alterations permutations and equivalents which fall within the scope of this invention. Although various examples are provided herein it is intended that these examples be illustrative and not limiting with respect to the invention.

Also the title and summary are provided herein for convenience and should not be used to construe the scope of the claims herein. Further the abstract is written in a highly abbreviated form and is provided herein for convenience and thus should not be employed to construe or limit the overall invention which is expressed in the claims. If the term set is employed herein such term is intended to have its commonly understood mathematical meaning to cover zero one or more than one member. It should also be noted that there are many alternative ways of implementing the methods and apparatuses of the present invention. It is therefore intended that the following appended claims be interpreted as including all such alterations permutations and equivalents as fall within the true spirit and scope of the present invention.

