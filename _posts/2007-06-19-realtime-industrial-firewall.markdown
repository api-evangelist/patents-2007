---

title: Real-time industrial firewall
abstract: Providing for employing a real time firewall to secure components of an automation control network from unauthorized communication to or from such components is disclosed herein. A monitoring component can inspect at least a portion of an instance of communication directed toward or originating from a component of the automation control network. Such inspection can, e.g., be a deep packet inspection based on information received from a communication request and/or response protocol. A filtering component can selectively admit or deny propagation of the instance of communication based on the inspection and a predetermined security criterion. In such a manner, the subject innovation can provide for limited access to network components from office network machines and for securing components of an automation control network from influence by unauthorized entities.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08782771&OS=08782771&RS=08782771
owner: Rockwell Automation Technologies, Inc.
number: 08782771
owner_city: Mayfield Heights
owner_country: US
publication_date: 20070619
---
Automation control devices can often be connected via electronic communication networks that can coordinate such devices and deliver time critical process commands. Due to technological advances in such networks and in computing technology in general automated and semi automated processes are able to run more efficiently than similar entities in the recent past. For example office networks comprising human machine interfaces HMIs such as computers and other programmable electronic controllers can be largely separate from automation devices being connected by only a single communication channel. Consequently typical office network communication e mail transfer of data files manipulation of data files and or sharing of data files for instance can be isolated from a control network such as a plant floor manufacturing assembly line or the like. Such isolation can further improve the communication capacity of intra office and intra control communication.

Imperfections associated with human action can be minimized through employment of precise machines as well. Many factories utilizing such devices supply data related to manufacturing to databases or web services referencing databases that are accessible by system process project managers. Such databases can be stored within or remote from the automation and control devices that typically generate such data or a combination of both. For example components of an automation control network can determine a frequency of performance average power consumption typical error information and rate etc. associated with devices of the control network. In addition the data provided by such components can be delivered to components of an alarm system intended to notify system process project managers of issues that need to be addressed. Utilizing alarm systems for instance can further aid in fully automating and or isolating automation control devices from officer HMI devices.

While various advancements have been made with respect to automating an industrial process utilization and design of controllers has been largely unchanged. In more detail industrial controllers have been designed to efficiently undertake real time control. For instance conventional industrial controllers receive data from sensors and based upon the received data control an actuator drive or the like. These controllers recognize a source and or destination of the data by way of a symbol and or address associated with source and or destination. More particularly industrial controllers include communications ports and or adaptors and sensors actuators drives and the like are communicatively coupled to such ports adaptors. Thus a controller can recognize an identity of a device when data is received and further deliver control data to an appropriate device.

As separation and human initiated supervision of automation networks and devices increases such networks and devices can increase process throughput while decreasing business overhead. More specifically fewer employees must be maintained to supervise the actions of network devices. In addition such devices and processes can be run with less downtime effectively operating around the clock. As automation control networks have become more independent additional research has been initiated to consolidate the interactions between HMI devices and automation devices and to help provide security for such interactions. Manufacturing and process entities that invest in automation networks and related equipment have a clear incentive to secure and advance the product of their investments.

The following presents a simplified summary of the claimed subject matter in order to provide a basic understanding of some aspects described herein. This summary is not an extensive overview and is not intended to identify key critical elements or to delineate the scope of the claimed subject matter. Its sole purpose is to present some concepts in a simplified form as a prelude to the more detailed description that is presented later.

Aspects of the claimed subject matter provide for employing an electronic communication firewall to secure components of an automation control network from unauthorized communication to or from such components. A monitoring component can inspect at least a portion of an instance of communication directed toward or originating from a component of the automation control network. Such inspection can e.g. be a deep packet inspection based on information received from a communication request and or response protocol. A filtering component can selectively admit or deny propagation of the instance of communication based on the inspection and a predetermined security criterion. In addition the filtering component can base admission or denial of propagation on information specified in the communication request and or response if such request response is compliant with the security criterion and suitably related to the instance of communication. In such a manner the subject innovation can provide for limited access to network components from office network machines and for securing components of an automation control network from influence by unauthorized entities.

In accord with additional aspects of the claimed subject matter a replication component can act as a communication proxy for data transfer between the automation control network and or components thereof and external entities. The replication component can store information pertaining to automation control network components including for instance routing addressing name and or topology information and provide such information to external components in response to an authorized request and or response for communication. Moreover a monitoring component can perform a deep packet inspection on a session of electronic communication related to the authorized request response to determine whether information provided by the replication component is contained therein. An instance of communication containing such information can be propagated by a filtering component whereas an instance of communication not containing such information can be denied propagation. In such a manner aspects of the claimed subject matter can secure automation control devices from attempts to hack into the automation control network and from denial of service attacks by malicious sources.

In accord with further aspects of the claimed subject matter a common interface is provided that can establish application level relationships between devices external to and internal to an automation control network. Such relationships can act as a means for authorizing communication between a human machine interface HMI device and a component of the control network at an application level. Moreover such communication can be authorized for all network devices particular devices or particular aspects of each device. More specifically an external device can be given read only or read write access to a single diagnostic control alarm or like function of a single device or combinations of such functions of one or more devices. Monitoring and filtering components can intercept a data packet inbound to or outbound from the control network and deny or admit propagation of such packet based on the application level relationships. In such a manner the subject innovation provides for an efficient mechanism that can establish permissible interactions with components of an automation control network and can limit exposure of such components to un permitted interaction.

To the accomplishment of the foregoing and related ends certain illustrative aspects of the claimed subject matter are described herein in connection with the following description and the annexed drawings. These aspects are indicative however of but a few of the various ways in which the principles of the claimed subject matter can be employed and such subject matter is intended to include all such aspects and their equivalents. Other advantages and novel features will become apparent from the following detailed description of the invention when considered in conjunction with the drawings.

The claimed subject matter is now described with reference to the drawings wherein like reference numerals are used to refer to like elements throughout. In the following description for purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the claimed subject matter. It may be evident however that such matter can be practiced without these specific details. In other instances well known structures and devices are shown in block diagram form in order to facilitate describing the invention.

As used in this application the terms component and system are intended to refer to a computer related entity either hardware a combination of hardware and software software or software in execution. For example a component may be but is not limited to a process running on a processor a processor an object an executable a thread of execution a program and a computer. By way of illustration both an application running on a server and the server can be a component. One or more components may reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computers. The word exemplary is used herein to mean serving as an example instance or illustration. Any aspect or design described herein as exemplary is not necessarily to be construed as preferred or advantageous over other aspects or designs.

Furthermore aspects of the claimed subject matter may be implemented as a method apparatus or article of manufacture using standard programming and or engineering techniques to produce software firmware hardware or any combination thereof to control a computer to implement various aspects of the subject invention. The term article of manufacture as used herein is intended to encompass a computer program accessible from any computer readable device carrier or media. For example computer readable media can include but are not limited to magnetic storage devices e.g. hard disk floppy disk magnetic strips etc. optical disks e.g. compact disk CD digital versatile disk DVD etc. smart cards and flash memory devices e.g. card stick key drive etc. . Additionally it should be appreciated that a carrier wave can be employed to carry computer readable electronic data such as those used in transmitting and receiving electronic mail or in accessing a network such as the Internet or a local area network LAN . Of course those skilled in the art will recognize many modifications may be made to this configuration without departing from the scope or spirit of what is described herein.

Moreover the word exemplary is used herein to mean serving as an example instance or illustration. Any aspect or design described herein as exemplary is not necessarily to be construed as preferred or advantageous over other aspects or designs. Rather use of the word exemplary is intended to present concepts in a concrete fashion. As used in this application the term or is intended to mean an inclusive or rather than an exclusive or . That is unless specified otherwise or clear from context X employs A or B is intended to mean any of the natural inclusive permutations. That is if X employs A X employs B or X employs both A and B then X employs A or B is satisfied under any of the foregoing instances. In addition the articles a and an as used in this application and the appended claims should generally be construed to mean one or more unless specified otherwise or clear from context to be directed to a singular form.

As used herein the terms to infer or inference refer generally to the process of reasoning about or inferring states of the system environment and or user from a set of observations as captured via events and or data. Inference can be employed to identify a specific context or action or can generate a probability distribution over states for example. The inference can be probabilistic that is the computation of a probability distribution over states of interest based on a consideration of data and events. Inference can also refer to techniques employed for composing higher level events from a set of events and or data. Such inference results in the construction of new events or actions from a set of observed events and or stored event data whether or not the events are correlated in close temporal proximity and whether the events and data come from one or several event and data sources.

As will be described in greater detail below various embodiments provide for employing a real time firewall to monitor and filter electronic communication with and or between components of an automation control network. Industrial automation has had an increasing dependence on information technology networks e.g. Ethernet networks and more specifically a PROFInet type industrial control network and computers extending to the process and or manufacturing device level. Threats to business continuity such as viruses worms unauthorized casual or inadvertent access hacker activity or the like possible through increased networking have consequently also expanded to devices on a shop floor for instance. In particular worms can present a costly non directed threat by creating denial of service DoS in time critical network segments by their attempts to propagate.

In addition non automation personnel such as IT programmers can typically be required to have access to factory floor resources. For example access can be for the purpose of creating ties to manufacturing execution systems MES . However such access by non automation personnel can potentially lead to inadvertent access to unintended automation systems and to subsequent safety hazards as a result. Typical IT path filtering is not suited to regulating such access since automation protocols e.g. PROFInet type protocols and or Ethernet automation protocols in general or the like are embedded into Internet protocol IP packets. Consequently a need has arisen for securing and consolidating access to automation control equipment and or networks to streamline efficiency and prevent potential electronic threats from an integrated office network.

With reference now to a high level block diagram of a communication security system for use in conjunction with an automation control environment is depicted. The automation control network can include one or more electronic devices e.g. electronic drives motors logical controllers supervising devices human machine interface HMI devices alarm components display devices robotic devices or the like communicatively coupled such as by an Ethernet type automation network. Such Ethernet type automation network can utilize for example an integrated industrial communication protocol suitable for manufacturing and process automation e.g. a PROFInet type or similar automation control standard . Such a network can further enable homogeneous communication from a management level of a business entity to a field device level. As a further example such Ethernet type network can include a transmission control protocol TCP IP communication standard typical for Ethernet Internet and Intranet based networking and further capable of integrating typical fieldbus systems.

Communication security system can monitor electronic communication e.g. data packets transmitted in accord with various suitable protocols such as TCP IP or the like inbound to outbound from or transmitted between components of automation control network . A monitoring component can inspect at least a portion of an instance of electronic communication to or from or both automation control network . Monitoring component can receive electronic communication inbound to automation control network . An instance of electronic communication e.g. a data packet can typically contain blocks of data including one or more headers e.g. that can specify addressing routing length type and or configuration information as well as where a packet has been directed from such as a media access control MAC address IP address and or port number of a sending and or relaying device a body containing instruction and or diagnosis information or the like and a trailer indicating an end of the instance of electronic communication . Electronic communication can also include either a request or response protocol message appropriate for communication with the automation control network e.g. compliant with an Ethernet or specifically a PROFInet type or like automation standard or can include identification data associating it with a request or response message.

Monitoring component can inspect any suitable portion of an instance of communication including header body and trailer portions or smaller portions thereof to extract information pertinent to security criteria . Security criteria can include for instance information related to authorized communication e.g. devices external and or internal to automation control network authorized to initiate respond to or both communication with each other such as a MAC address IP address port number or the like of an authorized originating and receiving device or combinations thereof. Security criteria can also require an instance of communication to include a request or response protocol message compliant with the information related to authorized communication or include proper data associating it with a compliant request and or response message. Accordingly monitoring component can inspect an instance of communication for such information to facilitate a determination of whether such communication is legitimate.

The following is a specific example to provide context for aspects of system and should not be construed so as to limit the scope of the disclosure. A device external to automation control network can be authorized to receive communication from an internal component not depicted of automation control network respond to the internal component but be restricted from initiating such communication. Security criteria can for instance require a portion of data uniquely specified by the internal component not depicted for a particular session be included within any response by the external device. Any communication by the external device failing to include such uniquely specified portion of data can be determined illegitimate. In such a manner monitoring device and security criteria can facilitate detection of spoofing attacks and assist in isolating automation control network from such attacks.

In accord with additional aspects communication security system can reject or approve of packets to from and or between automation control network and e.g. components and devices thereof thereby securing such network from unauthorized and or redundant communication e.g. initiated by a hacking entity virus worm trojan spoofing attack or by redundant communication from a formerly authorized device or communication session or the like . Filtering component can selectively admit or deny propagation of an instance of communication based on an inspection performed by the monitoring component one or more predetermined security criterion and or information specified in a request or response communication compliant with security criteria . In such a manner system can create a security zone for an automation control network sufficient for rigid security requirements typically required of such networks.

PROFInet and other Ethernet type networks for example can include at least component based automation CBA or distributed automation components as well as input output I O or decentralized periphery components . CBA specifications can typically provide advanced fieldbus application layer object models necessary for distributed automation between smart automation devices having equal rights and having a facet for remote engineering of a system. I O specifications can describe a device model that is based on features of a decentralized periphery and comprise slots subslots channels and the like. More specifically I O specifications can utilize cyclic data transfer e.g. periodic transfer of I O device data inputs and outputs and or acyclic data transfer e.g. a periodic transfer of configuration and process commands immediate transfer of alarm information and the like transmitted to a logic controller or like device.

As depicted by a communication security system can be placed between an office network and an automation control network to protect the control network and components thereof e.g. plant floor automation devices manufacturing shop automation devices processing and or fabrication motors drives controllers robotics etc. . Although a commercial firewall not depicted can be placed at a connection point s between office network and exterior networks thereto e.g. the Internet external intranets or the like communications security system can provide an increased level of security required by rigid requirements of time critical electronic devices. Thus automation control network can be considered a security zone where communication therewith is limited by communication security system to eliminate unauthorized communication and or redundant communication.

I O control devices such as I O controller can perform cyclic and acyclic functions and act as a client type device for one or more field devices such as I O device . Cyclic functionality can include for instance exchange of IO data with I O device s . Acyclic functionality can include for instance obtaining a diagnosis providing configuration instructions parameter data dynamic reconfiguration isochronous operation and or the like. I O supervisors internal to and external to automation control network respectively can include engineering devices that manage commission and diagnose an I O system e.g. HMI and or diagnosis devices such as PCs and . I O supervisors can further provide configuration data e.g. parameter sets to and collect diagnosis data from I O controller and I O device . I O device can be a field device that acts as a server for I O operation and typically communicatively coupled with one or more I O controllers . I O device can also perform cyclic functionality such as exchanging I O data with I O controller and or related I O devices not depicted as well as acyclic functionality such as providing diagnosis data access to record data alarms and alarm data and treating parameters configuration and diagnosis requests and alarms of various I O components .

Cyclic and Acyclic communication to and from automation control network can typically take one or more forms. TCP UDP IP transfer protocols can all be utilized for transfer of data to and from components of control automation network . In addition because TCP IP is a standard in information technology IT data transfer application protocols such as SMTP FTP HTTP and the like can also be utilized for data transfer. Cyclic and acyclic real time communication channels can be established for time critical processes e.g. a soft real time SRT channel as utilized by PROFInet type protocol for instance and for highly demanding applications e.g. an isochronous real time IRT channel also typically utilized by PROFInet type protocols such as motion control. Such cyclic and acyclic channels can be on lower IEEE protocol layers and consequently require smaller data packets and less processing power equating to faster transfer of payload information than session establishment e.g. typical communication request and or response protocol packets communication.

CBA devices and can include distributed automation systems and components distinguished by technological components and included within a modular plant machine factory or the like for instance. In addition CBA devices and components thereof can be modeled utilizing standardized component object modeling COM technology a particular object oriented mapping concept that enables development of applications based on prefabricated components. One particular feature of CBA devices and is that they can form autonomous units and can further form relations with other components. For example CBA devices and and components thereof can be flexibly combined like building blocks and are easy to re use typically regardless of various internal implementations. Mechanisms for accessing CBA devices and can be uniformly defined by a particular Ethernet type communication specification such as TCP IP and or user datagram protocol UDP or the like or combinations thereof.

Monitoring component can inspect at least a portion of incoming outgoing communication for compliance with one or more security criterion not depicted . Such inspection can be based on a request and or response communication e.g. that attempts to establish an application relationship between an external and internal device as authorized by the security criterion directed at CSS to establish an application relationship and subsequent communication between at least one external and at least one internal device. If such request and or response communication contains data in a manner specified by the one or more security criterion e.g. MAC address IP address and or port number of initiating and or receiving devices that are properly designated as authorized to communicate optionally in a particular direction by the one or more security criterion the communication can be determined a compliant communication. Subsequently CSS can forward the communication to an appropriate target device.

In addition monitoring component can inspect non request response instances of communication e.g. that convey I O and or CBA device operation data to from such devices to determine whether a suitable relation to the compliant request response communication exists. For instance a deep packet inspection can be performed on a subsequent communication to determine whether data contained within the compliant communication is present as required by the security criteria e.g. MAC address IP address port number of an authorized initiating and or receiving device portion of a logical and or topological classification of such device or the like . Presence of such data can indicate that the subsequent communication is related to the compliant request response and therefore also compliant.

Monitoring component can also identify a discovery and configuration request message inbound to and or outbound from ACN . Typically such messages will be restricted by filtering component to prevent external devices from obtaining addressing information associated with ACN devices. Typical automation control networks have few if any restrictions to sending and replying to such messages. Consequently a network threat e.g. virus worm etc. that penetrates an external firewall into an office network can harm sensitive control processes as well via monitoring replicating and issuing such discovery and configuration messages. By acting as a communication proxy CSS can intercept such messages and or responses and only provide routing addressing and like information to authorized devices.

A proper request and or response communication can also specify session duration. Session duration can for instance establish one or more conditions e.g. time process completion transfer of an established amount of data and or the like for termination of a session. Once a session is terminated subsequent communication containing information related to a compliant yet terminated request response communication can also be determined unauthorized. As a result CSS can protect ACN from spoofing attacks that attempt to acquire and replicate information related to compliant communication.

Filtering component can selectively deny or admit propagation of an instance of communication based on an inspection performed by monitoring component one or more security criterion and or information specified in a request response communication as specified above. Consequently communication not in accord with a predetermined security criterion e.g. establishing a right for two devices to communicate or communicate as to particular aspects functions operations etc. of one of the devices or the like can be terminated. Particularly discovery and configuration messages not initiated by components of CSS can be blocked by filtering component . In such a manner CSS can restrict device identity topology routing addressing and or like information related to ACN from leaving or entering ACN in accord with one or more security criterion for example.

CSS can also include an identification component that can broadcast a request for and receive a response to a discovery and configuration message e.g. DCP message and store information detailed therein. Such message can include information related to name topology addressing and or routing associated with components of the automation control network and or devices of an external network. In addition identification component can send and receive discovery and configuration messages periodically to maintain a current list of connected devices and information associated with those devices. Subsequently identification component can provide stored information to replication component .

Replication component can act as a communication proxy on behalf of ACN and or components thereof to facilitate communication between external devices. Replication component can receive discovery and configuration information associated with devices communicatively coupled with CSS from identification component . If an external device requests information about a component of ACN replication component can reference one or more security criterion e.g. that establish permissible device communication and if communication is authorized with such component reply to the external device with a device name of the requested component. A device name can be correlated to routing information of a device e.g. by mapping component such that communication directed at replication component specifying a target device name can be forwarded via standard TCP IP mechanisms e.g. forwarded to a MAC address IP address port number and or the like to the target device so long as such communication is not denied by filtering component above for instance .

Mapping component can correlate addressing routing topology control and or like information or combinations thereof associated with a component of the automation control network to a name associated with a device. Such correlation can facilitate routing an instance of communication to a component of the automation control network via the device name. In addition correlation can enable data transfer between two devices via CSS utilizing device name and or topology information. Consequently routing information e.g. IP address associated with one or more components of ACN can be changed or e.g. assigned randomly without disrupting legitimate traffic with ACN devices. Furthermore mapping component can facilitate establishment of access rules e.g. specified by one or more security criterion and authorizing communication with one or more internal components of ACN by way of device name and or topology. In such a manner creation of access rules in conjunction with CSS can be relatively simple e.g. see infra .

I O device can perform and or provide various functions each of which can be controlled independently. Functions of I O device can be organized into a hierarchical topology see e.g. for a detailed discussion of an example I O device topology where a single device can have multiple applications modules each module can have multiple channels and each channel can have multiple functions. More specifically I O device has modules a power supply module a discrete input module having two channels e.g. that can each act as discrete inputs and a discrete output module also having two channels e.g. that can each act as discrete outputs .

Communication between I O controller and I O device can be monitored and filtered by firewall . For example a security criterion can specify that I O controller is authorized to initiate communication with output module only. Under such conditions I O device cannot legitimately initiate communication with I O controller or legitimately respond to communication requests from IO controller directed toward any module or channel other than output module . Firewall can monitor an instance of communication between such devices and discard all such instances not meeting the security criterion. In addition firewall can intercept discovery and configuration request messages directed to or from internal Ethernet network as described supra and respond to them if compliant with the security criterion e.g. if a request is sent by I O controller and or a response from output module to I O controller and discard them if not.

Interface module corresponds to diagnostic I O functions and 2 parameter functions namely bus length and speed selection each having a particular binary format and meaning. The two parameters can form a single access right record specified by one or more security criterion for instance see for a more detailed description of establishing security criteria that can be assigned to a particular internal or external device. A firewall could inspect for and admit a data packet sent by the assigned device specifying such parameters for interface module . A packet sent by another device bearing such information can be discarded.

In addition discrete input module corresponds with two discrete input I Os or channels and discrete output module corresponds with two discrete output I Os or channels and three parameters Substitute value for channel when bus off substitute value for channel 0 substitute value for channel 1 . Such parameters can also form a single access right record that can be assigned to a particular internal or external device. As depicted by devices e.g. I O device can be analyzed as separate modules channels functions etc. each having I Os and or parameters and e.g. other associated functions that can be assigned to a particular device s by one or more security criterion to eliminate non authorized or redundant communication with such devices.

As depicted an I O device is composed of different groups of application objects providing a certain specified level of abstraction. The different groups may reflect hardware components or virtual function units of a field device. More specifically the structural units can be referred to as slots subslots and channels that can correlate to physical units sub units or a single connection point of an I O device for instance. Consequently such structural units represent the levels of abstraction of structural data associated with an I O device. Channels may be further sub divided into IO data objects see e.g. various Index fields corresponding to 10 data objects at of . Access rights to each record channel module application process and or device can be established by authorizing access in accord with the object model device name API number slot number subslot number index number. In such a manner an I O authorization interface can correlate authorized communications in a straightforward manner e.g. see for more detail on authorizing access .

PROFInet type network protocols for instance arrange data into structural units as described above and combine all parameters I Os manufacturer specific record data having open semantics and the like into a record data see e.g. index field of . As described PROFInet type specifications can address such record data by a slot number ranging from 0 to 0x7FFF a subslot number ranging from 1 to 0x7FFF and an index ranging from 0 to 0x7FFF. Furthermore I O data in one subslot can be combined into a data structure which can be dependent on a generic device name or description for instance. In addition particular index entities can be assigned to particular ranges of address numbers. For example the index range 0x8000 to 0xFFFF can be assigned to diagnosis information related to an I O device etc.

A physical device typically represents one physical hardware component although multiple hardware components can be represented by such device . A logical device represents a software component or a firmware component as an autonomous self contained unit. As a more specific example a logical device can represent the functions of a physical device such as an actuator function sensor function controller function or the like. An RT auto can represent automation functionality in the form of a process related component. More specific examples can include for instance a boiler controller or the like. Data can represent both attributes and properties of an RT auto object. Events can represent both methods and services of an RT auto object.

A right to access communicate with each data and or event of one or more RT autos of one or more logical devices of one or more physical CBA devices can be assigned to another device via a firewall interface e.g. see infra for a more detailed discussion of a CBA assignment interface . Such assignment can constitute one or more communication security criterion utilized by the firewall to determine whether an instance of communication is legitimate or not. In such a manner aspects of the claimed subject matter can assign access rights to specified devices to prevent unauthorized and or redundant communication with components of a control network as described herein.

Each ID number indicates an internal device name an external device name and a communication originator specifying direction specific application level security criteria for each communication rule. A status flag can also indicate whether a particular rule has been enabled or disabled and a modification flag can delete a particular rule or bring up an additional interface see e.g. for example modification interfaces to modify specific details of such rule. Interface can also include commands icons radio buttons or the like for creating a new rule validating all rules invalidating all rules deleting all items and accessing available help information .

Interface can include an internal device field and an external device field each with a field for available internal and external devices and information associated with such devices. For example a drop down box can display a list of available internal automation network devices identified by a firewall in as described herein e.g. by an identification component supra . A name of a selected device can be displayed in an appropriate field . Additionally the role IP address and MAC ID associated with such device can be automatically obtained e.g. by an identification component supra and populated to the appropriate fields respectively . An add button or similar can be activated to enter select indicate or the like e.g. either manually and or automatically as known in the art a new device e.g. not previously identified by identification component or like mechanism . In addition a device access control button or similar can be activated to bring up an additional interface for assigning particular aspects of a selected internal device to the selected external device .

External device field can include a field for the name of a selected external device input manually or e.g. auto generated by components of an industrial firewall in accord with the subject disclosure a radio button or the like automatically assigning properties to such a device manually determined e.g. by an identification component supra and a related device properties field . The device properties field can further display routing and like information associated with the external device such as a role of the external device IP address and MAC ID of the device in appropriate fields and respectively . Such routing information can be generated automatically by an industrial firewall as described herein utilizing a DCP identify service and or domain name server DNS identify functions or the like.

In addition interface can include a communication originator field can establish whether the external device or the internal device must initiate communication for a communication session to be valid and permitted by the firewall for instance . In addition a status field can establish whether a particular access rule is valid at a particular point in time. Furthermore interface can include a save button or the like for storing a particular access right in memory a help button or the like for generating and displaying help information associated with interface and a return button or the like for closing interface and for instance bringing up an access right display interface such as that depicted at of .

Examples of possible Index number fields associated with an API slot and or subslot can include I O data fields parameter data fields manufacturer specific record data 1 manufacturer specific record data 2 etc. expected ID data subslot 1 etc. expected ID data slot 1 etc. real ID data for one API and the like. It should be appreciated that a firewall as described herein can obtain structure information related to functions and or components of a device. For example as depicted by a configured device s hardware description file in a generic station description markup language GSDML a type of markup protocol for automation devices can provide device structure information. In addition a hardware configuration file exported from a network configuration tool can also provide device structure information of one or more devices.

As depicted in accessing the various fields and selecting one or more available items contained therein can facilitate creation of access rules for a physical object in a straightforward and efficient manner. In addition a read only or read write access right for each rule can be specified by an access right field . Such access right enables a device to view data associated with a record object indicated by the index numbers or view and change such data respectively. A status field can enable or disable each access rule and a delete field can delete a particular rule. Moreover interface can include commands for adding a new rule saving current access rules at the firewall memory returning to a previous interface providing full access to records and objects of a device deleting access rules browsing a CFG file to update the interface with device structure and object data information e.g. from the hardware configuration file and a help button or similar to bring up instruction related information associated with interface .

An access rule to a particular data event can be established by an ID number for a physical device selecting one or all logical device names one or all RT autos and one or all data event names . In addition each access right can be specified as read only or read write in an access right field . Each access rule can be enabled or disabled by specifying its status in a status field and created access rules can be deleted as indicated at . Furthermore interface can include a command to add a new access rule row save current rules return to a prior interface window e.g. device assignment interface provide full access to a physical device delete all listed rules and call up help files associated with utilizing interface .

An application relationship established for instance by a request packet can have a predetermined life cycle based on a specified criterion e.g. time amount of data to transfer number of processes to complete amount of report and or diagnosis data to be transferred or the like or an open ended life cycle. In general such relationship will persist during connection establishment data transfer and connection release phases. After an application relationship between two or more devices has been established e.g. by specific portions of request packet discussed infra several important values of the specific fields in the connection request and or e.g. in a connection response packet such as depicted in infra packet can be utilized by components of a firewall e.g. monitoring components and or filtering component to determine legitimacy of subsequent packets forming a communication session. Similarly dynamic stateful packet inspection of data packets relating to supervisor ARs and for example implicit ARs are contemplated.

Request packet can be based on a connectionless data transfer protocol e.g. such as distributed computing environment remote procedure calls DCP RPC multi computer distributed software platforms and in contrast to data exchange packets for instance typically requiring a session be established . For example no prior communication need be established for a real time industrial firewall as described herein to apply a security criterion e.g. created through access rules established with interfaces and or for instance to request packet determine its legitimacy and forward it in or out of an automation control network security zone. In addition no other communication need be established for suitable transmitting receiving devices to initiate a communication as specified within request packet .

Request packet can include header information and several configuration blocks for establishing communication between various I O devices. Header information used for routing a packet within a TCP UDP IP environment can include a typical IP header UDP header and DCE RPC header . Additionally request packet can include various communication session establishment blocks including an AR Block Req block one or more I O communication relationship IOCR Block Req blocks one or more Expected Submodule Block Req blocks see and related discussion infra for a more detailed discussion and an Alarm CR Block Req block .

AR Block Req block can be required to establish an I O communication. Such block contains information pertaining to establishing an application relationship between two devices or portions of devices. AR Block Req block can be sub divided into a block header containing typical header information relating to the AR Block Req block including e.g. block length type value etc. . AR type can indicate a type of application to be established. ARUUID can be used to identify an application relationship in a request packet and subsequent data and termination packets. It can typically be at least one piece of information utilized as a signature for deep packet inspection of subsequent data packets transmitted in accord with the application relationship. More specifically ARUUID can contain data indicating an application identifier that can associate a packet with a particular session at an application level. AR Block Req block can further include a session key indicating association with a communication session an initiator MAC address an initiator object UUID AR properties Initiatior Activity Timeout Factor Initiator UDPRT port station name length initiator station name all of which can be pertinent to identifying creating and establishing details for a particular communication with two or more particular automation control network devices.

IOCR Block Req block can be utilized to establish cyclic I O communication and data exchange. It can further include a block header an I O communication relationship IOCR type an IOCR reference an LT block specifying length and type associated with the block IOCR properties data length block a Frame ID a sendclock factor and reduction ratio blocks. Alarm CR Block Req block can be utilized to establish acyclic alarm diagnostic communication channels. A typical Alarm CR Block Req block can include a block header an Alarm CRType an LT block specifying length and type associated with the block an AlarmCR properties block an RTA timeout factor block an RTA retries block and a local alarm reference block .

Referring now to Expected Submodule Block Req block is depicted in further detail at B of . Request block can include one or more Expected Submodule Block Req blocks B which can be utilized by a connection initiator device to notify a connection response device of access rights that the initiator device has with respect to modules of the response device for a given application relationship communication session. Expected Submodule Block Req block B can further include a block header B a number of API s block B and respective API block s B typically one for each application process indicated by a particular API. An API block B can further include an API number B see e.g. API of slot number B e.g. at module ID number B module property B number of submodules B and one or more corresponding submodule block s B. Each submodule block consequently can include an appropriate subslot number B see e.g. subslot of submodule ID number B submodule property B and data event description B corresponding e.g. to records and index items specified at of .

AR Block Res block can include a block header AR type ARUUID session key responder MAC address and responder UDP RT port e.g. in response to an AR Block Req block . IOCR Block Res block can include a block header IOCR Type IOCR reference and FrameID . Alarm CR Block Res block can include a block header Alarm CR Type Local Alarm reference and Max Alarm Data Length .

It should be appreciated fields and or values specified therein of a communication request packet and or response packet can be utilized as signatures for deep packet inspection of subsequent data packets and or blocks. Such deep packet inspection can be utilized for instance to determine whether subsequent data packets blocks are legitimate in accord with one or more security criterion e.g. communication access rules depicted at and as disclosed herein. Values that can be extracted by a firewall for deep packet inspection can include but are not limited to initiator MAC address initiator IP address contained e.g. within IP header ARUUID session key initiator UDP RT port initiator alarm reference responder MAC address responder IP address contained e.g. within IP header responder UDP RT port responder alarm reference input FrameID read from responder to initiator input data update rate calculated from various data update values specified in request packet and or response packet for instance output FrameID output data update rate calculated in a like fashion as input data update rate for instance and one or more of API numbers B B slot numbers B B and or module ID numbers B B or subslot numbers B B and or submodule ID numbers B B and or various combinations of the foregoing.

It should be appreciated that a real time industrial firewall as described herein can perform an initial analysis on a request and or response packet or e.g. packet pair to determine compliance with a security criterion established e.g. via access rules as specified in and admit or deny propagation of a packet on that basis. Subsequent packets issued as part of an application relationship established by a legitimate request response packet pair can receive deep packet inspection to verify that they are in accord with the application relationship communication and admitted on that basis inspected in accord with the initial security criterion or both as applicable to an Ethernet type network protocol utilized by an automation control network described herein.

Referring to methodologies in accordance with various aspects of the claimed subject matter are illustrated. While for purposes of simplicity of explanation the methodologies are shown and described as a series of acts it is to be understood and appreciated that the claimed subject matter is not limited by the order of acts as some acts may occur in different orders and or concurrently with other acts from that shown and described herein. For example those skilled in the art will understand and appreciate that a methodology could alternatively be represented as a series of interrelated states or events such as in a state diagram. Moreover not all illustrated acts may be required to implement a methodology in accordance with the claimed subject matter. Additionally it should be further appreciated that the methodologies disclosed hereinafter and throughout this specification are capable of being stored on an article of manufacture to facilitate transporting and transferring such methodologies to computers. The term article of manufacture as used herein is intended to encompass a computer program accessible from any suitable computer readable device carrier or media.

The data RTC packet can be issued as part of an application relationship communication specified by a related request response data packet pair as described herein see e.g. B A B . Real time cyclic data flows can have data sent from a responding device to an initiating device called Input Data and have a corresponding input Frame ID and data sent from the initiating device to the responding device called Output Data with a corresponding output Frame ID. The inspection can be done by a real time firewall that can intercept a data packet transmitted to or from an automation control network as described herein that compares a frame ID of the packet to input and or output frame ID s .

At a determination is made as to whether a frame ID of the data RTC packet is correct. Such determination can be in comparison to an input frame ID provided by a responding device an output frame ID provided by an initiating device or both. For example if the frame ID of the data RTC packet matches the input frame ID output frame ID or both then the determination at can be that the frame ID is correct. If the frame ID of the data RTC packet does not match the input or output frame ID or both then the determination at can be that the frame ID is not correct. If the determination at is that the frame ID is not correct then the data RTC packet can be discarded at e.g. by a firewall a filtering component or the like as described herein .

If the determination at is that the frame ID of the data RTC packet is appropriate then methodology can proceed to where another determination can be made as to whether the data RTC packet was received e.g. at a real time industrial firewall at monitoring and filtering components etc. as described herein with strict deterministic interval. Strict deterministic interval can be calculated utilizing a cycle counter data block contained within the data RTC packet and a related cycle counter data block specified by a previous or subsequent packet. For example 

At methodology determines whether a destination port number of the UDP RTC packet is correct e.g. specified by a response or request packet . If the destination port number is correct methodology can proceed to otherwise the UDP RTC packet is discarded at . At a determination is made as to whether a frame ID of the UDP RTC packet is correct e.g. as described at supra . If so methodology can proceed to if not the UDP RTC packet is discarded at . At a determination is made as to whether the UDP RTC packet has been received with strict deterministic interval. Such strict deterministic interval can be substantially similar to that described supra at except as indicated by the following equations Strict Deterministic Interval Current Cycle Counter Last Cycle Counter 1000 s Local Elapsed Time 

If determinations at and are all determined to be true methodology can proceed to . At the UDP RTC data packet is forwarded to the target device e.g. specified within the UDP RTC packet . It should be appreciated that determinations made by methodology can be performed by a real time industrial firewall and or monitor and filtering components as described herein. It should be appreciated that determinations and processes performed as part of methodology can be effectuated by a real time industrial firewall as disclosed herein.

The RTA data packet can include data blocks specifying at least one or more of the following destination MAC address source MAC address type and length associated with the data packet a frame ID and an RTA packet data unit PDU block. Additionally the RTA PDU block can further include at least an alarm destination endpoint an alarm source endpoint a PDU type a send sequence number an acknowledge sequence number and an RTA sequence data unit SDU . Moreover the RTA SDU can further include at least an API number a slot number a module ID number a subslot number and a submodule ID number.

At a determination can be made as to whether the alarm destination endpoint specified by the RTA packet is correct e.g. as compared with an alarm destination endpoint specified by a request and or response packet as described herein . If the alarm destination endpoint is incorrect the RTA packet can be discarded at . If the RTA packet is correct methodology proceeds to where a determination is made as to whether the alarm source endpoint is correct. If so methodology proceeds to if not the data packet is discarded at . At the PDU type is inspected to determine whether it is a Data RTA PDU type. If not methodology proceeds to where the data packet is forwarded to a target device. If the RTA packet is an RTA Data packet methodology proceeds to to determine whether the send sequence number is correct.

A send sequence number s of an acyclic data packet can be stored upon receipt e.g. by a firewall as described herein and utilized to check whether subsequent acyclic data packets are correct e.g. see infra for an example methodology to determine whether a sequence number of an acyclic data packet is legitimate . If the send sequence number is not correct the RTA packet is discarded at . If the send sequence number is determined to be correct methodology can proceed to where a determination can be made as to whether an acknowledge sequence number is correct e.g. in a manner substantially similar to that detailed above for a send sequence number or as detailed in infra . If the acknowledge sequence number is determined to be incorrect the RTA packet is discarded at . If the number is determined correct methodology continues at .

At a determination can be made as to whether the API number specified in the API number block is correct e.g. as compared to an API number extracted from a response and or request packet for instance . If incorrect the RTA packet can be discarded at if correct methodology can proceed to . At a slot number and module ID number are checked to determine whether they are correct e.g. compared with respective values specified in a response and or request packet as described supra . If the slot number and or module ID number are correct methodology can proceed to if incorrect the data packet can be discarded at . At a subslot number and a submodule ID number can be checked for correctness. If the subslot and or submodule ID numbers are correct the RTA packet can be forwarded to a target device at . If the subslot and submodule ID numbers are incorrect e.g. as compared with values indicated in a response and or request packet s the RTA packet can be discarded at . It should be appreciated that determinations and processes performed as part of methodology can be effectuated by a real time industrial firewall as disclosed herein.

At a determination is made as to whether Seq Numis equal to Seq Num. If Seq Numis determined not to be equal to Seq Num methodology can proceed to where a sequence number error result is returned to an initiating function and or device e.g. at etc. and to where a data packet containing the sequence number can be discarded e.g. by a firewall as described herein . If the determination at is that Seq Numis equal to Seq Num methodology proceeds to where a determination is made as to whether Sec Numis greater than or equal to Max Seq Num. If Seq Numis greater than or equal to Max Seq Num then methodology can proceed to where Seq Numcan be set to zero e.g. in preparation for a next incoming data packet corresponding to a particular connection. If Seq Numis less than Max Seq Num methodology proceeds to where Seq Numis set equal to Se Num 1 e.g. in preparation for a next incoming data packet corresponding to a particular connection.

At methodology can return a correct sequence result to an initiation function and or device e.g. at etc. . Subsequently methodology can proceed to reference number to receive a later incoming data packet and verify a sequence number and connection associated with such incoming data packet. It should be appreciated that determinations and processes performed as part of methodology can be effectuated by a real time industrial firewall as disclosed herein.

At a determination is made as to whether the CL RPC read and write request packet is a read implicit packet. If yes methodology can proceed to if not methodology can proceed to . At a determination is made as to whether an ARUUID number specified by the CL RPC data packet is correct e.g. compared to an ARUUID number extracted from a response and or request data packet and stored in memory at a firewall . If the ARUUID number is incorrect the CL RPC data packet can be discarded at if it is correct methodology can proceed to .

At a determination is made as to whether an API number is correct if incorrect the data packet can be discarded at if correct methodology can proceed to . At a determination is made as to whether a slot number is correct if incorrect the data packet can be discarded at if correct methodology can proceed to . At a determination is made as to whether a subslot number is correct if incorrect the data packet can be discarded at if correct then methodology can proceed to where the data packet is forwarded to a target device. It should be appreciated that determinations and processes performed as part of methodology can be effectuated by a real time industrial firewall as disclosed herein.

The system bus can be any of several types of bus structure s including the memory bus or memory controller a peripheral bus or external bus and or a local bus using any variety of available bus architectures including but not limited to 8 bit bus Industrial Standard Architecture ISA Micro Channel Architecture MSA Extended ISA EISA Intelligent Drive Electronics IDE VESA Local Bus VLB Peripheral Component Interconnect PCI Universal Serial Bus USB Advanced Graphics Port AGP Personal Computer Memory Card International Association bus PCMCIA and Small Computer Systems Interface SCSI .

The system memory includes volatile memory and nonvolatile memory . The basic input output system BIOS containing the basic routines to transfer information between elements within the computer such as during start up is stored in nonvolatile memory . By way of illustration and not limitation nonvolatile memory can include read only memory ROM programmable ROM PROM electrically programmable ROM EPROM electrically erasable PROM EEPROM or flash memory. Volatile memory includes random access memory RAM which acts as external cache memory. By way of illustration and not limitation RAM is available in many forms such as synchronous RAM SRAM dynamic RAM DRAM synchronous DRAM SDRAM double data rate SDRAM DDR SDRAM enhanced SDRAM ESDRAM Synchlink DRAM SLDRAM and direct Rambus RAM DRRAM .

Computer also includes removable non removable volatile non volatile computer storage media for example disk storage . Disk storage includes but is not limited to devices like a magnetic disk drive floppy disk drive tape drive Jaz drive Zip drive LS 100 drive flash memory card or memory stick. In addition disk storage can include storage media separately or in combination with other storage media including but not limited to an optical disk drive such as a compact disk ROM device CD ROM CD recordable drive CD R Drive CD rewritable drive CD RW Drive or a digital versatile disk ROM drive DVD ROM . To facilitate connection of the disk storage devices to the system bus a removable or non removable interface is typically used such as interface .

It is to be appreciated that describes software that acts as an intermediary between users and the basic computer resources described in suitable operating environment O. Such software includes an operating system . Operating system which can be stored on disk storage acts to control and allocate resources of the computer system . System applications take advantage of the management of resources by operating system through program modules and program data stored either in system memory or on disk storage . It is to be appreciated that the subject invention can be implemented with various operating systems or combinations of operating systems.

A user enters commands or information into the computer through input device s . Input devices include but are not limited to a pointing device such as a mouse trackball stylus touch pad keyboard microphone joystick game pad satellite dish scanner TV tuner card digital camera digital video camera web camera and the like. These and other input devices connect to the processing unit through the system bus via interface port s . Interface port s include for example a serial port a parallel port a game port and a universal serial bus USB . Output device s use some of the same type of ports as input device s . Thus for example a USB port may be used to provide input to computer and to provide output information from computer to an output device . Output adapter is provided to illustrate that there are some output devices like monitors speakers and printers among other output devices which require special adapters. The output adapters include by way of illustration and not limitation video and sound cards that provide a means of connection between the output device and the system bus . It should be noted that other devices and or systems of devices provide both input and output capabilities such as remote computer s .

Computer can operate in a networked environment using logical connections to one or more remote computers such as remote computer s . The remote computer s can be a personal computer a server a router a network PC a workstation a microprocessor based appliance a peer device or other common network node and the like and typically includes many or all of the elements described relative to computer . For purposes of brevity only a memory storage device is illustrated with remote computer s . Remote computer s is logically connected to computer through a network interface and then physically connected via communication connection . Network interface encompasses communication networks such as local area networks LAN and wide area networks WAN . LAN technologies include Fiber Distributed Data Interface FDDI Copper Distributed Data Interface CDDI Ethernet IEEE 802.3 Token Ring IEEE 802.5 and the like. WAN technologies include but are not limited to point to point links circuit switching networks like Integrated Services Digital Networks ISDN and variations thereon packet switching networks and Digital Subscriber Lines DSL .

Communication connection s refers to the hardware software employed to connect the network interface to the bus . While communication connection is shown for illustrative clarity inside computer it can also be external to computer . The hardware software necessary for connection to the network interface includes for exemplary purposes only internal and external technologies such as modems including regular telephone grade modems cable modems and DSL modems ISDN adapters and Ethernet cards.

What has been described above includes examples of the claimed subject matter. It is of course not possible to describe every conceivable combination of components or methodologies for purposes of describing the claimed subject matter but one of ordinary skill in the art may recognize that many further combinations and permutations are possible. Accordingly the claimed subject matter is intended to embrace all such alterations modifications and variations that fall within the spirit and scope of the appended claims. Furthermore to the extent that the term includes is used in either the detailed description or the claims such term is intended to be inclusive in a manner similar to the term comprising as comprising is interpreted when employed as a transitional word in a claim.

