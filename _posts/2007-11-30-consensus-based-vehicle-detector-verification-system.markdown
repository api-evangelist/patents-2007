---

title: Consensus based vehicle detector verification system
abstract: A method, system and computer program product are provided for automating the task of data collection and reduction for highway vehicle detector testing. To evaluate the performance of each detector under test, a set of detection data is accumulated concurrently from each of the detectors. This data consists, at a minimum, of the time of arrival of each vehicle as reported by each detector and a digitized video image of the vehicle at the position-compensated time of detection. The data reduction process allows for applying weighting coefficients to each detection result in the formation of a consensus. These coefficients may be either fixed or adaptively adjusted based upon the learned accuracy of each detector under test. A ground truth reference data set is then generated using the weighted consensus determined from the data generated by all detectors under test. The accuracy of each detector under test is then ascertained by comparison with the ground truth data set, and these comparison results are automatically reported as indications of the accuracy of each detector under test.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08179282&OS=08179282&RS=08179282
owner: Cal Poly Corporation
number: 08179282
owner_city: San Luis Obispo
owner_country: US
publication_date: 20071130
---
The detection of the presence velocity and or length of vehicles on roadways is increasingly recognized as critical for effective roadway congestion management and traffic safety. The use of vehicle presence detectors is common practice for traffic volume measurement control of signalized intersections and on ramp meters. In addition vehicle velocity and classification by length are important for automated incident detection and the characterization and prediction of traffic demand.

Real time detection is also used for actuation of automated driver information systems for example the Caltrans Automated Warning System CAWS on I 5 in Central California. Among the commonly implemented sensing mechanisms used for vehicle detection are changes in inductance loop detectors or magnetic field strength magnetometers RADAR optical and laser transmission or pulse time of flight ultrasonic pulse return electromagnetic signature and acoustic or signature discrimination. Detectors based on each of these methods are known to have advantages and limitations which make them appropriate for some implementations but inappropriate for others.

Loop detectors and magnetometers must be installed in the pavement and are therefore referred to as in pavement detectors. Other above mentioned detection methods require placement of the detectors above or to the side of traffic lanes with each detector operative for one or more traffic lanes. The vehicle presence detectors associated with the various sensing methods have different detection characteristics and yield different results than inductive loop systems which may introduce uncertainties into traffic control systems if the detection characteristics are not determined.

To assess the performance of new or unproven vehicle presence detectors under varying real world conditions a common and objective set of standards data generally referred to as ground truth data is required. Obtaining ground truth data has traditionally been performed manually relying on human observation either directly at the roadway site or from the playback of videotapes.

Accordingly manually evaluating the performance of new or unproven vehicle presence detectors is exceedingly time consuming costly and prone to human error due to the tedium involved in comparing actual observations or video tape records to the results obtained from the detector undergoing testing. As such a need exists in the relevant art to automate the collection of data from multiple detectors operative at the same location the generation of the ground truth data set the comparison of individual detector results with the ground truth data set and the generation of accuracy statistics for each detector under test.

In various exemplary embodiments a method system and computer program product are provided for automating the task of data collection and reduction for highway vehicle presence detector testing. To evaluate the performance of each detector undergoing testing a first set of detection data is accumulated from each of the detectors. The accumulation process allows for compensation of different but proximate detection positions so that outputs of these detectors under test can be directly compared.

In an embodiment a digital image is acquired at the adjusted time of detection for each detector to serve as a reference of later human verification. In an embodiment a ground truth reference data set is then generated using the outputs of all the detectors under test optionally including a computer vision based detection component of the system serving as a high accuracy detector. In an embodiment ground truth actual vehicle detection events are determined by a weighted voting formula that considers the outputs of all detectors and seeking an acceptable level of agreement for each validated detection event.

The accuracy of individual detectors is determined by comparison of individual detection results with the ground truth data set. The true record of the actual time of arrival and optionally other measurements of every actual vehicle in each lane is referred to as the ground truth or reference record. The ground truth record serves as the basis for assessing the accuracy of each detector.

Ambiguous detection events are verified by a human operator using a software tool that presents the images acquired at a normalized time of detection of each detector. Once all ambiguous events have been resolved the results for each detector are compiled and accuracy statistics generated in an automatically generated report.

As discussed in more detail below using the various exemplary embodiments with little or no modification and or user input there is considerable flexibility adaptability and opportunity for customization to meet the specific needs of various users under numerous circumstances.

Embodiments will now be discussed with reference to the accompanying figures which depict one or more exemplary embodiments. Embodiments may be developed in many different forms and should not be construed as limited to the embodiments set forth herein shown in the figures and or described below. Rather the various embodiments disclosed herein are provided to allow a complete disclosure that conveys the principles of the various embodiments as set forth in the claims to those of ordinary skill in the art.

In accordance with one embodiment an apparatus and computer implemented method for fully automated data collection reduction verification and presentation for testing of vehicle presence detectors is presented. The apparatus records a detection event for every detector undergoing testing and for every vehicle passing through a defined field of detection. A verification digital image is also acquired for each detection event which provides a visual record of what was detected by each detector undergoing testing.

In various exemplary embodiments the sequence of video images may be used to both capture the presence of each vehicle traversing a predetermined area and to measure the speed of the vehicle. The computer vision detection method that is used by the system itself can serve as a high accuracy detector of both vehicle time of arrival and speed as well as vehicle length.

In an embodiment evaluation of the performance of a vehicle presence detector undergoing testing is accomplished using a consensus or weighted average of the data obtained from all detectors to be described in detail later. The consensus calculation admits various degrees of known reliability for each detector which may be either fixed or time adaptive based upon a recursive algorithm to be described below. In one embodiment a particular set of detectors may be established as a trusted or reference set of detectors to which the vehicle presence detectors undergoing testing are compared with.

In an embodiment detection data received from each different type of detectors may be weighted to adjust for biases which may occur due to varying traffic or environmental conditions.

In an embodiment the weighting of each type of detector is applied using a time dependent function to assist in normalizing detector responses for low azimuths of the sun which generate longer shadows that are known to adversely impact video based vehicle presence detectors which lack shadow discrimination processing capability. In an embodiment the ground truth data is automatically generated using data received from all of the detectors and filtered using user defined confidence settings.

The primary automation task is to identify records of the same vehicle reported by different detectors in a traffic lane but having different detection zones and detector response latencies. Normalized detection times are calculated from the distance offset of each detector s detection zone from a baseline position using the assumption of constant vehicle velocity over the offset distance. In an embodiment ground truth vehicle velocity may be calculated from sequential digital image frames obtained by a video camera above a traffic lane in which the camera s field of view is known i.e. a fixed viewing geometry above the roadway. 

In an embodiment ground truth vehicle velocity may be calculated using video processing for each vehicle by consensus of those detectors which report velocity in real time. In another embodiment ground truth vehicle velocity may be calculated using detections obtained from duplex inductive loops spaced a known distance apart.

An analogous approach may be used to determine the length of a vehicle for classification purposes. For example vehicle velocities are determined by processing of the acquired video images alone or in conjunction with time of flight measurements from duplex inductive loop detectors if available. When both detector types are available the determined velocities may be averaged. Normalization of detection events are thereafter based on the empirical ground truth velocities.

Raw detection times are normalized by subtraction of the pre signal detection latency to generate the compensated time of detection. A false detection may not have a corresponding velocity measurement if no reliable velocity measurement is available from at least one of the detectors under test. In this case the velocity of the most proximate detected vehicle in that lane is used.

A reported detection is considered valid if it occurs within a user defined admissible time distance aperture centered about the normalized time of detection from all detectors or from a designated set of reference i.e. trusted detectors. The failure of a detector to report a vehicle within the time distance aperture is considered a potential failure to detect error unless a proximate detection is later associated with a grouping of detections during the manual verification process. Detections occurring outside of a time distance aperture or multiple detections inside the same non overlapping aperture are considered potential false detections.

Processing data reduction and reporting is accomplished using one or more of the exemplary computer systems having hardware architecture as is depicted in . The computer system is configured to include a data archival server a local data acquisition client or a remote client as is shown in . The computer system includes a communications infrastructure used to transfer data memory addresses where data items are to be found and control signals among the various components and subsystems associated with or coupled to the computer system . One or more central processors may be provided to interpret and execute logical instructions stored in the main memory . The central processor may include a local cache not shown to improve the transfer of data between the main memory and registers of the central processor s 

The main memory is the primary general purpose storage area for instructions and data to be processed by the central processor . The main memory is used in its broadest sense and includes RAM EEPROM and ROM. A timing circuit is provided to coordinate activities within the computer system in near real time and may be used to make time based assessments of detector data collected by one or more remote detectors and or detectors coupled to an auxiliary interface . The timing circuit may also be used to synchronize with one or more networked clients and or to synchronize with an established time standard. In an embodiment the timing circuit may also be used to normalize detector signals to a common timeframe reference for comparison purposes. The central processor main memory and timing circuit are coupled to the communications infrastructure .

A display interface is provided to drive one or more displays associated with the computer system . The display interface is electrically coupled to the communications infrastructure and provides signals to the display s for visually outputting both graphics and alphanumeric characters. In an exemplary embodiment a display may be incorporated into the housing of the computer system as for example in a laptop configuration. The display may also be coupled to a user interface for interacting with software being executed by the central processor for example in a touch screen embodiment.

The display interface may include a dedicated graphics processor and memory to support the display of graphics or video intensive data. The display may be of any type such as a cathode ray tube gas plasma display or a solid state device such as liquid crystal display LCD. 

A secondary memory subsystem is provided which comprises non volatile computer readable storage units such as a hard disk drive a removable media storage drive removable storage media and or logical media storage drive . One having ordinary skill in the art will appreciate that the hard drive may be replaced with flash memory. The secondary memory may be used to store a plurality of data including by way of example and not limitation an operating system device drivers databases user applications application programming interfaces API communications applications video capture and analyses applications digital signal processing applications internet browsers and plug ins such as scripts ActiveX controls and applets.

Where appropriate computer programs algorithms and routines are envisioned to be programmed in a high level language object oriented language or script for example Java C C C CORBA Visual Basic JavaScript and PHP. Database components may utilize any common database program by way of example and not limitation ORACLE Sequel Server Sybase MySQL SQL MS ACCESS DB2 MS FOXBASE DBASE PostgreSQL and RBASE.

The removable storage drive may be a replaceable hard drive an optical media storage drive or a solid state flash RAM device. Both the removable storage drive and logical media storage drive may include a flash RAM device an EEPROM encoded with programs and data or other computer readable storage media such as an optical disk CD or DVD floppy disk magnetic tape or other media capable of being read by the central processor s .

The communications interface subsystem is provided which allows for electrical connection of peripheral devices to the communications infrastructure which support standard serial parallel USB Firewire PCMCIA PS 2 connectivity and proprietary communications protocols. The communications interface also facilitates the remote exchange of data and synchronizing signals between the computer system and other intelligent devices in processing communications with the computer system over one or more networks . The intelligent devices may include one or more local data acquisition clients and or remote clients and detector appliances in processing communications with the computer system over the network .

The communications interface is envisioned to include a transceiver normally associated with wired and wireless computer networks The transceiver is envisioned to be of a type normally associated with computer networks for example wired and wireless computer networks using a network interface card NIC based on the various IEEE standards 802.11x where x denotes the various present networking communications standards e.g. 802.11a 802.11b 802.11g 802.11n and evolving networking communications standards example WiMax 802.16 WRANG 802.22 and BlueTooth 802.15.3a.

Alternately digital cellular communications formats compatible with for example GSM 3G CDMA TDMA and evolving cellular communications standards. Both peer to peer PPP and client server models are envisioned for implementation. In another embodiment the transceiver may include hybrids of various computer communications standards cellular telephone standards and evolving satellite radio standards. The user interface is provided as a means for a user to control and interact with the computer system . The user interface provides interrupt signals to the processor that may be used to interpret user interactions with the computer system . For purposes of this specification the term user interface includes the hardware and software by which a user interacts with the computer system and the means by which the computer system conveys information to the user.

The user interface employed on the computer system may include a keyboard a pointing device such as a mouse thumbwheel track ball or touchpad. An output device such as a printer may be coupled to the communications interface for outputting of hardcopy information.

An auxiliary interface may be provided in client data acquisition embodiments to allow connection of one or more detectors. For example the auxiliary interface may be used to connect a video frame grabber to the communications infrastructure . An acceptable video frame grabber is commercially available from Cyberoptics of Seattle Wash. located on the Internet at universal resource locator URL www.cyberoptics.com. The types of detectors which may be tested include but are not limited to video cameras motions detectors inductive detectors capacitive detectors binary state dependent detectors acoustical detectors electromagnetic detectors and optical detectors. The auxiliary interface may include multiplexer MUX analog to digital conversion ADC digital signal processing DSP and transistor to transistor logic circuits TTL to convert detector signals into a format interpretable by the computer system .

The operating system may utilize those commercially distributed by Microsoft Corporation of Redmond Wash. e.g. Microsoft Windows Apple Computer Inc. of Cupertino Calif. e.g. OS X any Unix operating system or derivatives thereof e.g. Linux Solaris the Palm OS series of operating systems or any other operating system designed to generally manage operations on a computing system whether known at the time of filing or as developed later.

In an embodiment the local data acquisition client s receive detection signals from each of a plurality of vehicle presence detectors monitoring the various lanes of traffic 1 6. The detection signals are processed by the local data acquisition client s and temporarily stored until the resulting detection data is transported to the data archival server for retrievable storage in the database . One or more remote clients may be used to remotely retrieve the data stored in the database and perform detector evaluations and generate reports. Each remote client includes an application which allows access to the database via the data archival server . The remote client application may be provided as either a separate program or as browser plug in module or applet. The remote clients may also be used to control and configure the data archival server and the local data acquisition clients .

In an embodiment the vehicle presence detectors are provided as one or more network appliances which allow direct connection of the appliances to the network . In the network appliance embodiment the vehicle presence detectors and data processing performed by the local client s are combined to allow the direct connection of the detectors to the network thus eliminating the need for the local data acquisition clients .

In an embodiment the detector performance results are compared with detections made using traditional duplex inductive loop detectors installed in each lane of traffic 1 6 when available. In addition the detector performance results are automatically compared with video images captured with a plurality of video image capture cameras configured to record an image of the detected vehicle as it crosses a particular camera s defined field of view.

In an embodiment the data acquisition client s and the video image capture cameras comprise an image based vehicle detection system. The image based vehicle detection system may be used as a separate detector in a consensus based vehicle presence detection system or as a standalone vehicle presence detection system . One skilled in the art will appreciate that the data acquisition client s and data archival server can be configured as a single standalone processing system. The plurality of vehicle presence detectors undergoing testing may be compared with a reference standard such as the duplex inductive loop detectors a trusted detector as described below captured video images and or compared among the various detectors test as a group.

In an embodiment each detector undergoing testing is positioned to detect vehicles traversing a defined section of a lane on a highway. Likewise a video camera is aligned to capture an image of each vehicle traversing each lane of the highway within the defined detection areas for determining the performance of the detectors undergoing testing under actual conditions.

The traffic pattern of the highway depicted in illustrates several common situations which cause detection difficulties depending on the type of detector employed. For example the standard size vehicles in lanes 1 and 5 should be relatively easy to detect as there are no adjacent or closely following vehicles which could cause a detector to either fail to detect or miscount the number of vehicles present.

However a different situation exists with respect to the truck in lane 2. A truck presents a large detection profile a large electromagnetic footprint a large cross sectional area and an extended length which may cause multiple detections to occur with some types of detectors. For example a vehicle presence detector based on RADAR will detect the truck well before an automobile at the same point on the highway.

As such an early detection may not correspond in time with the detection of the truck by other detectors in the lane and thus the detectors employing RADAR technology may be penalized as a false or missed detection. Likewise the large profile of the truck may obscure a detector s view of the small automobile paralleling the truck in lane 3. The small vehicles present additional detection challenges as well due to their generally smaller electromagnetic footprint which may not always be detected by certain types of detectors.

In another example the automobile spanning lanes 3 and 4 presents a situation where the vehicle may be detected by one or more of the detectors in both lanes 3 and 4 only the detectors in lane 3 only the detectors in lane 4 or not detected at all. This situation is particularly problematic for the duplex inductive loop detectors in adjacent lanes 3 and 4 since a vehicle may have a sufficiently large electromagnetic footprint to trigger detections within both lanes 3 and 4 thus receiving 2 false detections for a single vehicle.

In another example a dual trailer truck or an automobile towing a trailer as is found in lane 4 provides another detection challenge. The gap between the first and second trailer sections may be interpreted by one or more of the detectors as two closely following vehicles rather than as a single extended length vehicle. This again could result in a false detection of the second trailer section . Likewise the duplex inductive loop detector may sense the change in inductive field strength as a gap between the trailer sections rather than as one extended length multi segmented vehicle.

Conversely the two closely spaced vehicles in lane 6 may be interpreted by the detectors as a single larger vehicle rather than two separate vehicles by the duplex inductive loop detector . For example if the lead vehicle triggers a detection in the second inductive loop at about the same time the following vehicle triggers a detection in the first inductive loop only a single detection may result. In this situation the proximity of the vehicle to a median detection time is used to discriminate cases of nearly equal detection probability when detection zones for closely following vehicles overlap.

For explanatory purposes the operation of the detectors monitoring lane 1 is described detail below. However the same general concepts apply for the detectors associated with the remaining lanes 2 6. As the vehicle in lane 1 approaches the duplex inductive loops embedded in the highway the metal in the vehicle changes the inductance in the first inductive loop. The duplex loops are spaced at a fixed longitudinal distance apart usually 20 feet which allows determination of the velocity of the vehicle as it traverses the first and second loops .

Since the metal mass of the vehicle and the resting inductances of the two loops are constant a reasonably accurate determination of the vehicle s velocity can be determined. For detection verification a video camera having a defined field of view sequentially records video images i.e. frames of the position of the vehicle as it traverses the camera s field of view . Since the field of view of the video camera is fixed and known the velocity of the vehicle can then be determined using either the velocity of the vehicle provided by the duplex inductive loops or by the exemplary image processing techniques described below to identify the leading edge of the vehicle as it traverses the camera s field of view which includes the fixed reference points .

The elapsed time required for the vehicle to travel between the reference points is determined from the rate of frame extraction which is typically set at 60 frames per second when analog video cameras are employed. The velocity of the vehicle is then calculated using the elapsed time between the fixed reference points . If the detector undergoing testing within lane 1 detects the vehicle traversing lane 1 the detection signal is processed and where appropriate normalized to coincide with a detection event obtained independently using the video camera imaging and or the duplex inductive loops . When both the inductive loops and a video camera are present the two separately derived velocities may be averaged.

In an embodiment discrete video images of the vehicle are obtained by a video frame grabber to extract sequential video frames from a National Television System Committee NTSC compliant video camera. The video frames are converted into jpeg formatted files for transport to the data archival server . The video grabber is typically disposed internally in a peripheral device slot associated with the local data acquisition client . The video grabber is only needed in situations where an analog video camera is used. Digital video cameras may be used which eliminates the need for the video frame grabber. The video images obtained are temporarily stored in a buffer or queue associated with the local data acquisition client and is time stamped by the receiving local client to allow for normalization of detection thresholds. Additional normalization may be provided for detector latency. Time stamping of the digital images allows the local data acquisition client to associate a digital image with a particular detection event.

In an embodiment the digital images are automatically examined by the video vehicle verification system using the image processing techniques described below to determine the leading edge of the vehicle as it passes by the fixed reference points . The elapsed time between reference points within the camera s field of view is determined from the rate of frame extraction which is typically set at 60 frames per second. The velocity of the vehicle is then calculated using the elapsed time between the start and endpoints within the field of view of the video camera .

In circumstances where a false detection may not have a corresponding velocity measurement the velocity of the nearest proximate vehicle in the same lane is used. A reported detection is considered valid if it occurs within a user defined admissible time distance window centered about the average normalized detection time from all detectors. In an embodiment a reference detector may be used as a trusted detector.

The failure of a detector to report a vehicle within the normalized time distance window is considered a potential failure to detect error unless a proximate detection is later associated with that detection during manual verification. Detections occurring outside of the normalized window or multiple detections inside the same non overlapping window are considered potential false detections. Proximity to the normalized detection time is used to discriminate cases of nearly equal admissibility when detection windows for closely following vehicles overlap.

Referring to an example is provided which illustrates how detectors having differing detection distance thresholds are spatially and or temporally normalized to allow capture of a digital image which can later be used to determine if the triggering detector actually detected a vehicle or if a false detection occurred. Missed detections are determined by other detectors monitoring the same lane of traffic.

It has been empirically determined that certain types of vehicle detectors have threshold detection distances up to several hundred feet from the duplex inductive loop detectors and or by capture using the video camera as a separate detector system . Continuing with the example of the vehicle travelling in lane 1 a detector first detects the vehicle as it approaches a first position T . Assuming for example that this detector provides a first detection signal to a local data acquisition client .

If a single digital image were taken at about this first time 00 00 00.00 the digital image would not match the vehicle within the field of view of the camera . Likewise when the vehicle reaches a second position T another detector detects the vehicle approaching and sends another detection signal to the local data acquisition client a second later at time 00 00 01.00. As before the second detection signal arrives at the local data acquisition client well before the vehicle is within the field of view of the video camera .

It is not until the vehicle arrives at a third position TB at time 00 00 03.00 that this vehicle appears in the field of view of the video camera and is detected by either or both the duplex inductive loop detector and or the digital image capture . The duplex inductive loop detector and or the digital image capture detect the presence of the vehicle which triggers a reference image capture.

As discussed above determining the velocity of each detected vehicle is necessary to normalize detection times and or offset detection distances for various detector types having different detection latencies detection thresholds and detection distances. The normalization of detection times allows for the generation of an unbiased comparison between different detector types. In an embodiment the normalization is also used to identify the closest image to a normalized detection event for comparison manual correction or acquiring ground truth data.

In an embodiment the normalization allows for data reduction purposes to facilitate the fair comparison of detections of the same vehicle reported by different detectors under test. Also in embodiments employing video imaging normalization allows the correct image of the vehicle to be acquired by the video capture system while the vehicle is in the field of view of the video camera even if the position of detection is beyond the field of view.

Detection times are compensated or normalized to a common reference position despite different actual positions of detections. This compensation for different detection positions requires two additional pieces of information the position of detection for a given detector and an estimate of the vehicle speed. The known detection position offset from the reference or baseline position TB for a give detector is divided by the estimated vehicle speed to calculate a pre trigger time prior to the actual time of detection.

In an embodiment a sequence of digitized video images is accumulated in a continuous circular buffer or queue of the receiving local client . The pre trigger delay time is then used to select the previously recorded image in the buffer or queue which will show the vehicle when it was at the baseline position TB in the field of view of the video camera even for detection positions that are well past the camera field of view.

The velocity of the vehicle can be determined by the local client s video image processing algorithm based on optical flow time of flight or it can be a speed value reported by one or more the detectors under test or an average of all of these.

Not all detectors are capable of reporting speed so the speed is usually calculated as the weighted average of the available detectors that are capable of reporting vehicle speed. In an embodiment weighting coefficients may be used in the calculation of this weighted average can be fixed values or adaptively determined values using the same adaptive update approach used for determining the weighted consensus of the detector outputs for generation of ground truth as is described below.

The speed calculation determined by the image processing capability of the local client is performed by a real time computer implemented process that analyzes the sequence of video frames or fields measuring the linear progression of the vehicle through the progression of images and approach at defined locations within the field of view of the video camera . Several computer implemented processes can be used to determine vehicle speed from this progression of vehicle positions.

In one embodiment the elapsed time or frame count between fixed positions in the field of view can be used to perform a simple time of flight calculation of speed by dividing the separation distance by the elapsed time. In one embodiment the positions of the vehicle measured from the video image sequence are fitted to a polynomial equation using a least squares curve fitting calculation. The least squares curve fit yields the coefficients of a polynomial that predicts the position of the vehicle as a function of time.

The polynomial is then differentiated with respect to time to calculate the vehicle speed. The simplest polynomial in this case is a linear equation relationship equation of a line which would subtend the actual progression of positions if the vehicle speed remains constant during the period of observation and no optical distortion was introduced by the camera lens system or field of view as defined in one embodiment by the equation x a vt a 

where x is the vehicle position and t is time and a is the initial position of the vehicle at the start of the measurement sequence when t 0. Differentiating this linear equation with respect to time reveals that the coefficient a is the estimated vehicle speed over the entire progression of vehicle position measurements.

With reference to a detection event from the detector undergoing testing is processed by the local data acquisition client proximate to a detector . The local client generates a time dependent log file for each detection event which is temporarily stored locally on the local data acquisition client . Separate time dependent digital images are accumulated before and after the normalized detection time are likewise temporarily stored in a rolling file for video processing. In an embodiment the detection log file has a format of 

The video images coincident with a normalized detection event are saved in a time stamped jpeg format. The digital image file maintains a resolution of 640 320 pixels as a balance between image resolution data processing and data archival requirements. The most relevant digital image i.e. image closest in time to the normalized detection event is retained for visual comparison and performance evaluation purposes. The bulk of the processing performed by the local data acquisition client involves the capturing and processing of the video frames generated from the video camera.

The detection log files and the most time relevant digital image are either pushed to the server by the client or if there is a temporary connectivity problem between the server and client pulled by the server upon reestablishment of the connectivity over the network . The server includes programmatic instructions to prevent pulling of a log file when the client is attempting to push the same file to the server . Additional programmatic instructions are provided for the server to ensure that a complete log file and image is being pulled rather than one in the process of being written to a hard drive associated with the local client .

In an embodiment each lane of traffic has a dedicated local client assigned thereto. This arrangement minimizes the data processing load on any single local client . In another embodiment a single multi core processor employed in a local client may be used to perform both the data acquisition and data archival functions of the server . One skilled in the art will appreciate that various combinations of computer systems may be used to accomplish the data acquisition digital image reduction and archival functions described herein.

The data archival server includes a database for storing of accumulated detector data and associated video image files. In an embodiment the incoming log file is parsed by programmatic instructions executing on the server to populate a new database record for future review and performance evaluations of the various detectors undergoing testing. The incoming image file is logically associated with the new database record based on the normalized detection time and or by using a unique identifier assigned with the newly created detection record. In an embodiment the image file is stored in a separate directory which is referentially linked to the new database record containing the detection event.

Once a statistically significant sample size has been accumulated in the database for evaluating the detector undergoing testing a number of user selectable queries and editing tools may be executed from a remote client . The remote client allows a user to assign ambiguous detections of one detector to a group of detections made proximately with other detectors and visa versa. The database may be established with user access privileges which control what actions a user is permitted to perform on the database . A number of different reports may be generated and output from the remote client . For example detector performance results may be output as is provided in Table 1 below.

The data included in Table 1 is intended as exemplary only. However assuming that the data was obtained from six different detector types all simultaneously viewing the same traffic within each lane 1 6 the report would indicate that Detector R performed about the same as Detector A and that results of varying accuracy were obtained from Detectors B D with Detector B providing the least accuracy under the same testing conditions encountered by the remaining detectors. In order to ensure that fair comparisons are being made between each detector and the reference detector R the detection events are normalized as is described above.

In one embodiment a trusted detector R is used for comparison with the detectors undergoing testing. In this embodiment a simple acceptable detection percentage relative to the trusted detector R is used to determine whether to include or exclude detectors for at least obtaining ground truth data. In this embodiment the local clients are programmed to accumulate detections from the vehicle presence detectors and normalize the detection events as described above. Optionally digital images may be obtained as described above using the video cameras . The remote client s are then used to evaluate the performance of each detector with respect to the trusted detector R to determine which detection results to include in ground truth data. For example simple detection percentages as compared to the reference detector R based on a desired confidence level 95 as is provided in Table 2 below.

Based on the results Detectors C and D should not be used in determining the ground truth as these detectors did not provide at least 95 of the detections determined by the trusted detector R. During actual performance evaluation of all the detectors the remote clients are programmed to treat normalized detection events obtained from detectors A B and E as the ground truth for comparison with the other detectors. In another embodiment a consensus of all detectors may be programmatically be employed by the remote clients as is described below.

In an embodiment the ground truth data is programmatically determined by a weighted consensus of the detection decisions made by each detector under test. In addition the processing capabilities of the optional video vehicle verification system may be used as well.

In an embodiment each detector is assigned an index number where i is the detector index an integer value i 1 2 . . . n . A typical value for n is 8 detectors under test.

Each potential vehicle detection event is assigned an index number k index an integer value where k 1 2 . . . m. A detection by any one or more of the individual i detectors can cause a detection event. Typically a dataset obtained for an hour would yield about m 2 000 detection events for a centrally located traffic lane on a high usage highway.

The detection outcome for each detector i with respect to any detection event k is either 0 for no vehicle detected or 1 vehicle detected i.e. d k 0 1 where d k 1 for a detection and d k 0 for no detection during that event.

The actual ground truth presence or non presence of a vehicle during event k is determined by a weighted consensus voting process in which the results d k for each detector i are programmatically combined as follows 

A function g k is used to represent the ground truth analog conclusion a real number between 0 and 1 for idetection event possible vehicle . In this embodiment G k 0 1 represents the binary conclusion for the kground truth detection event possible vehicle detected within the admissible time and or distance window for the ievent. The consensus conclusion G k for event k is programmatically determined by thresholding a weighted average according to the function 

In an embodiment once a ground truth record has been established for a particular data set consisting of a sufficient number of events k the correctness of each detector i under test is found by comparison of its reported detection value for each event with that of the ground truth record. In an embodiment c k 0 1 represents the programmatic result of the comparison of the response of detector i with the consensus response G k during event k according to the function c k d k G k where is the logical exclusive NOR XNOR .

Therefore c k is equal to logical 1 only when both d k and G k have the same logical values and c k is equal to logical zero when then they differ. In other words c k 1 if an individual detector i agrees with the consensus conclusion for event k and c k 0 if the detector i disagrees. As with the simple percentage test discussed above results for each detector are compared with the resultant ground truth data set and statistics of the type shown above in Table 1 are automatically generated by the remote client s .

In an embodiment weighting coefficients aare programmatically applied to the voting process described above. The weighting coefficients acan either be fixed based upon human operator assumptions about the relative reliability of each detector or can be learned or adapted during the course of a data reduction run based upon the consistency of the agreement between d k and G k .

The weighting of each avalue corresponding to each detector under test allows the discrimination of consistently reliable from consistently unreliable detectors. For video based detectors it also allows for time compensation of the reliability of detector responses with changes in the illumination conditions which tend to cause video based detectors to become error prone under conditions of low azimuths of the sun which generate long shadows that are known to adversely impact video based vehicle presence detectors.

In an embodiment all detectors start with weighting coefficients aequal to 0.5. If adaptation is elected an initialization period of a few hundred detection events actual vehicles and or false detections is typically allowed to elapse to allow the weighting coefficient values to stabilize before conducting a final detector accuracy data reduction run i.e. actual performance evaluation. 

In one embodiment a simple recursive filter is used to gradually adapt the weighting coefficient for the ia detector based upon its agreement or disagreement with the consensus for each event k. The weighting coefficient a k is slightly modified with each sequential detection event according to the function a k 1 a k 1 c k where is a small factional constant typically set to 0.05 if a 95 confidence level is desired by the user.

With each successive event k a k increases if detector i agrees with the consensus and decreases if detector i disagrees with the consensus. The ultimate limits of a k are between 0 and 1. If every detection is correct i.e. agrees with the consensus a k asymptotically approaches 1 while if a detector consistently fails to detect or falsely detects a k asymptotically approaches 0. Optionally upper and lower limits can be set for a k . Accordingly detectors that are consistently incorrect are devalued in the consensus voting conclusion while consistently accurate detectors are more strongly weighted in the consensus voting conclusion.

Referring to an exemplary database arrangement is depicted for archiving detection and other data in records received from a local client . The database includes a first data structure which represents site data . The site data provides a location description field and a reference geometry field for setting up the video cameras overlooking a roadway.

The location description may include geo positional coordinates e.g. latitude and longitude to allow selected implementation of shadow rejection processing. A second data structure is provided which represents detector data . The detector data provides a detector type field and a detector specific field . The detector specific field s may include detector latency and distance correction factors. A third data structure which represents detection data received from the local client . The detection data provides a detection chronological field date time and a detector cross reference to the detector data structure . A fourth data structure is provided which represents image data .

The image data structure includes a reference image field and reference time field which is cross referenced to the detection data structure . The actual image files may be stored externally to the database by providing a directory and file name in the reference image field . An optional fifth data structure is provided which represents error data . The error data structure includes a system error field and a communications error field .

Referring to a computer implemented process is illustrated in which data acquisition is performed by a local client . The process is initiated by accumulating time dependent video images in a rolling memory buffer or queue. In an embodiment the buffer or queue maintains approximately 300 separate images obtained at a rate of about 60 frames per second or approximately 5 seconds of video images. The background view of the highway as seen by the video cameras is periodically updated to account for changes in ambient lighting conditions. In an embodiment the background images are used in the processing of digital images representing vehicle detections.

The accumulation of video images continues in a first in first out FIFO progression until one or more time dependent detection signals are received by the local client . At this point the current video images identified with a latency corrected detection event by time are processed using infinite impulse response filtering IIR .

IIR filtering is a digital signal processing technique which subtracts the periodically updated background image from each of the video images . A portion of the resulting processed video images provides a time sequence of the detected vehicle isolated from the background as it traverses the video cameras field of view. The background subtraction performed by the image processing applications simplifies the task of identifying the leading edge of the vehicle at various points within the camera s field of view until the leading edge of the vehicle has spanned a known reference distance from which the velocity of the vehicle is determined . In an embodiment the background subtraction processing provides a uniform background color surrounding the vehicle which simplifies differentiation of the pixels associated with the vehicle itself by differences in colors.

In an embodiment if the velocity of the detected vehicle is available from one or more of the detectors the velocity ies are received from the detectors and may be averaged with the velocity determined above .

The velocity determined by the video capture system or averaged as above may be used as a reference standard for normalizing all detections to a common detection time and or spatial distance. In another embodiment the average of all detection times corrected for detector response latency is used to normalize the detections to an average detection time. In an embodiment a weighted consensus detection mechanism as previously described is used as a reference to determine verified failed false or indeterminate detections by any single detector in an entire detection array of detectors for a traffic lane.

As may be apparent all of the local clients and detectors need to be periodically synchronized with a standard network timekeeping source such as the National Institute of Standards and Technology found at URL www.nist.gov. Time drift could cause improper image selection and thus incorrectly record an image unrelated to a detection event.

The image file which is closest in time to the average detection time is retained along with the detection log file s for transport to the data archival server . For exemplary purposes only processing ends in . However in reality the mechanism described above operates as ongoing process.

Referring to a computer implemented process which illustrates data archival performed by the data archival server is provided. The process is initiated by the server obtaining time dependent detection data and corresponding image files from the client located in the field . The detection and image data may be retrieved by the server in a pull operation using a PHP script following a communications outage or other communications interruption. Alternately in one embodiment the local client may perform a push operation using a JavaScript when a communications connection between the local client and the server is reliably available.

The obtained time dependent detection data is parsed by the server and stored in records of the database . The time dependent image files may likewise be stored in the database or alternately stored separately while retaining a retrievable relationship with associated time dependent detection records . If more detector data and or images are available the process repeats until all the time dependent detector and image data is recorded in the database thus ending this process .

Referring to a computer implemented process which illustrates the detector performance evaluation performed by the remote client is provided. The process is initiated by the server accumulating a first set of detection data generated by each of the vehicle presence detectors . Initially the weighting coefficients are predetermined by the user as described above.

As detection events are accumulated from each of the vehicle presence detectors the predetermined set of weighting coefficients are adaptively modified until a sufficient number of detection events have occurred in which the weighting coefficients appear to have stabilized. After a sufficient number of detections have occurred a weighted consensus vote of at least a majority of the vehicle presence detectors is then used to generate a ground truth reference data set from the first set of detection data .

Once the ground truth data has been obtained a second performance set of detection data is then accumulated from by each of the vehicle presence detectors . In an embodiment either or both first and second sets of detection data undergoing testing are normalized to account for differences in latency and or detection threshold distance . The accumulated second set of detection data is then compared with the ground truth data set from which a set of detector test results are generated thus ending the process .

The present inventive embodiments have been described in particular detail with respect to specific possible embodiments. Those of skill in the art will appreciate that the various inventive embodiments may be practiced in other embodiments. For instance those of skill in the art will readily recognize that the order of operations discussed above was presented for illustrative purposes only and that other orders of operations and combination of operations are possible. Consequently the order of operations discussed above does not limit the inventive embodiments as claimed.

In addition the nomenclature used for components capitalization of component designations and terms the attributes data structures or any other programming or structural aspect is not significant mandatory or limiting and the mechanisms that implement the inventive embodiments or its features can have various different names formats and or protocols. Further the apparatus and or functionality of the various inventive embodiments may be implemented via various combinations of software and hardware as described or entirely in hardware elements. Also particular divisions of functionality between the various components described herein are merely exemplary and not mandatory or significant.

Consequently functions performed by a single component may in some embodiments be performed by multiple components and functions performed by multiple components may in some embodiments be performed by a single component. Some portions of the above description present the features of the inventive embodiments in terms of algorithms and symbolic representations of operations or algorithm like representations of operations on information data. These algorithmic and or algorithm like descriptions and representations are the means used by those of skill in the art to most effectively and efficiently convey the substance of their work to others of skill in the art. These operations while described functionally or logically are understood to be implemented by computer programs and or computing systems. Furthermore it has also proven convenient at times to refer to these arrangements of operations as steps or modules or by functional names without loss of generality.

Unless specifically stated otherwise as would be apparent from the above discussion it is appreciated that throughout the above description discussions utilizing terms such as establishing defining requesting analyzing querying verifying providing obtaining accessing selecting listing determining storing reporting outputting displaying etc. refer to the action and processes of a computing system or similar electronic device that manipulates and operates on data represented as physical electronic quantities within the computing system memories registers caches or other information storage transmission or display devices.

Certain aspects of the inventive embodiments include process steps or operations and instructions described herein in an algorithmic and or algorithmic like form. It should be noted that the process steps and or operations and instructions of the inventive embodiments can be performed using software firmware and or hardware and when embodied in software can be downloaded to reside on and be operated from different platforms used by real time network operating systems.

The present inventive embodiments also relates to an apparatus or system for performing the operations described herein. This apparatus or system may be specifically constructed for the required purposes or the apparatus or system can comprise a general purpose system selectively activated or configured reconfigured by a computer program stored on a computer program product as defined herein that can be accessed by a computing system or other device.

Those having ordinary skill in the art will readily recognize that the algorithms and operations presented herein are not inherently related to any particular computing apparatus system computer architecture computer or industry standard or any other specific apparatus. Various general purpose systems may also be used with programs in accordance with the teaching herein or it may prove more convenient efficient to construct more specialized apparatuses to perform the required operations described herein. The required structure for a variety of these systems will be apparent to those of skill in the art along with equivalent variations.

In addition the present inventive embodiments are not described with reference to any particular programming language and it is appreciated that a variety of programming languages may be used to implement the teachings of inventive embodiments as described herein and any references to a specific language or languages are provided for illustrative purposes only and for enablement of the contemplated best mode at the time of filing.

The present inventive embodiments are well suited to a wide variety of computer network systems operating over numerous topologies. Within this field the configuration and management of large networks comprise storage devices and computers that are communicatively coupled to similar and or dissimilar computers and storage devices over a private network a LAN a WAN a private network or a public network such as the Internet.

It should also be noted that the language used in the specification has been principally selected for readability clarity and instructional purposes and may not have been selected to delineate or circumscribe the inventive subject matter. Accordingly the disclosure of the present inventive embodiments is intended to be illustrative but not limiting of the inventive scope which is set forth in the claims below.

In addition the operations shown in the figures are shown in an exemplary order for ease of description and understanding. However those of skill in the art will readily recognize that numerous different orders of operation could be employed. Consequently the order of operations shown in the figures is illustrative only and does not limit the inventive scope as claimed below.

In addition the operations shown in the figures are identified using a particular nomenclature for ease of description and understanding but other nomenclature is often used in the art to identify equivalent operations.

Therefore numerous variations whether explicitly provided for by the specification or implied by the specification or not may be implemented by one of skill in the art in view of this disclosure.

