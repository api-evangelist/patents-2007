---

title: Enterprise security assessment sharing
abstract: An enterprise-wide sharing arrangement uses a semantic abstraction, called a security assessment, to share security-related information between different security products, called endpoints. A security assessment is defined as a tentative assignment by an endpoint of broader contextual meaning to information that is collected about an object of interest. Its tentative nature is reflected in two of its components: a fidelity field used to express the level of confidence in the assessment, and a time-to-live field for an estimated time period for which the assessment is valid. Endpoints may publish security assessments onto a security assessment channel, as well as subscribe to a subset of security assessments published by other endpoints. A specialized endpoint is coupled to the channel that performs as a centralized audit point by subscribing to all security assessments, logging the security assessments, and also logging the local actions taken by endpoints in response to security threats.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08959568&OS=08959568&RS=08959568
owner: Microsoft Corporation
number: 08959568
owner_city: Redmond
owner_country: US
publication_date: 20070314
---
In an enterprise computing environment for example an office of a business a number of personal computers workstations servers and the like along with other devices such as mass storage subsystems internal network interfaces and external network interfaces are typically interconnected to provide an integrated environment in which information may be generated accessed from external sources and shared among various users. Commonly users perform a variety of operations including order receipt manufacturing shipping billing inventory control document preparation and management e mail web browsing and other operations in which creation access and sharing of data is beneficial.

Currently security is typically provided for an enterprise using a variety of different security products that are each normally arranged to monitor only a partial portion of enterprise wide data. That is security products are arranged as separate local islands where each product monitors assesses and takes action with respect to different parts of the data within the enterprise. For example an enterprise may utilize a combination of security products such as a product that protects host computers in the enterprise an edge firewall product a network intrusion detection system NIDS product a network access protection NAP product and other discrete security products in order to provide security for the various different parts of the enterprise.

While these security products often perform satisfactorily in many applications detection of security incidents often suffers from undesirably high levels of false positive and false negative occurrences as a result of the monitoring of only partial enterprise security data. It has also been difficult to provide effective common management across all the enterprise security product islands. Current attempts to correlate enterprise wide security data have high management and maintenance costs and have problems in scaling. More effective enterprise security management would be desirable to enable a single enterprise wide view to enable security administrators to define and enforce clear simple and unified enterprise wide policies for automatic responses to security incidents.

This Background is provided to introduce a brief context for the Summary and Detailed Description that follows. This Background is not intended to be an aid in determining the scope of the claimed subject matter nor be viewed as limiting the claimed subject matter to implementations that solve any or all of the disadvantages or problems presented above.

An enterprise wide sharing arrangement called ESAS Enterprise Security Assessment Sharing is provided in which a semantic abstraction called a security assessment is created to enable sharing of security related information between different security products called endpoints in an enterprise security environment. A security assessment is defined as a tentative assignment by an endpoint of broader contextual meaning to information i.e. data in some context that is collected about an object of interest in the environment such as a computer user service e.g. a website data or the enterprise as a whole. The security assessment utilizes a concise vocabulary for an endpoint to declare that an object in the environment falls into a particular assessment category such as compromised or under attack along with the severity e.g. low medium high critical of the detected incident.

A security assessment is tentative because it is subject to some uncertainty and is valid for a limited period of time. The tentative nature of a security assessment is reflected in two of its components a fidelity field which expresses the level of confidence the endpoint has in its assignment of contextual meaning and a time to live TTL field which reflects the endpoint s estimate of the time period for which the security assessment is expected to be valid. Thus for example a security assessment may be used by an endpoint to declare in light of that endpoint s current understanding of one or more security incidents that a particular machine is compromised with a critical level of severity with medium fidelity and having a TTL of 30 minutes. A variety of types of security assessments may be used in any given enterprise security environment having for example various combinations of assessment category and object type.

Endpoints are enabled with functionality to publish security assessments onto a security assessment channel operating in the environment as well as subscribe to a subset of available security assessments published by other endpoints. The security assessments existing in the environment that are active i.e. those having a TTL which indicates the assessments are still valid function to provide a security context that gives such ESAS enabled endpoint with a new way to look at its own locally available information. That is the security context enables the ESAS enabled endpoint to combine or correlate evidence from security assessments received from a variety of different sources and across object types in order to significantly enhance the quality of its detection of potential security incidents. The ESAS enabled endpoint then makes a decision as to what local action or response is appropriate for each type of security assessment whether received from another endpoint or internally generated by the endpoint itself in accordance with a set of response policies. Incident detection is both efficient and cost effective because the security context enables distributed processing of enterprise wide information in the form of security assessments without the burden of sharing large amounts of raw data throughout the enterprise most of which is completely irrelevant due to the lack of any context . ESAS enabled endpoints are further arranged to roll back the local action upon expiration of the security assessment that prompted the local action i.e. when the security assessment exceeds the time to live specified in the TTL field .

In an illustrative example a specialized endpoint called an ESAS central server is coupled to the security assessment channel that performs as a centralized audit point by subscribing to all security assessments logging the security assessments and also logging the local actions taken by endpoints in response to security incidents in the environment. The ESAS central server provides administrators with a comprehensive view of the history and current status of the enterprise as a whole and of each ESAS enabled endpoint. The utilization of the security assessments enables an administrator to compactly and efficiently configure response policies to incidents that are detected across the entire enterprise. The security assessments function as natural anchors or starting points to define enterprise wide security response policies. A streamlined and consistent management interface is thus enabled to define the desired responses for each type of security assessment across the entire enterprise.

The present ESAS sharing arrangement provides a number of advantages. By employing a security assessment having a concise vocabulary overall data complexity in the enterprise is drastically reduced and only meaningful information is shared between endpoints. Use of the security assessment also eliminates the need to collect large amounts of raw data in a central storage location and thereby enables highly scalable enterprise security solutions to be built on a very cost effective basis. In addition a new endpoint may be readily deployed with on demand extensibility. Security assessments may be shared between the new endpoint and existing endpoints without the need to reconfigure any of the response policies within existing endpoints. The new endpoint simply functions as a new source of security assessments using a semantic abstraction that the existing endpoints already understand. The utilization of security assessments also enables enterprise wide security policies to be established using a very compact and clear methodology without needing to understand all of the possible security events that every endpoint may generate in the enterprise and then try to describe the responsive action for each event.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

Analysis of current enterprise security solutions indicates that there are still significant opportunities for addressing customer needs. For example each separate security product tends to have high rates of false positive and false negative detection of security incidents such as those produced through actions of malware or malicious users. Such low fidelity detection occurs because data from a single type of source i.e. a subset of the enterprise wide data does not normally provide the context needed to make an accurate assessment of the security incident.

The use of automatic actions or responses is very infrequent as a result of the low fidelity detection since confidence in the validity of the detected incident is low. In addition the typical response to a detected incident tends to be very harsh for example a user or machine may be disconnected from the network. Since such harsh actions generally impose significant costs to business activity in the enterprise automation of such actions based on low fidelity detection is not generally performed.

Upon detection of an incident of interest current security products typically perform investigation to determine the validity of the detection i.e. whether the incident is true or false and what action to take in response. Significant resources are expended on investigation to review the detailed data that is collected which may be relevant to the detected incident. Because it is not feasible to collect all data at all times a security product collects only a subset of the available data through application of policies defined by an administrator. Such policies are often static and are commonly defined based on the storage capacity of the collection system and not necessarily by the relevance of the incident data or the data source.

When an incident is detected application of the policies typically results in a review of the data which triggered the detection. When this data is deemed insufficient to generate a high fidelity response typically even more data is collected. For example all of the data traffic into and out of a suspected compromised machine may be monitored. In many cases a large amount of data is collected but is never used and has statistical significance only as noise. Consequently many present security products collect an often overwhelming amount of noise but not enough relevant data is collected.

Another area for improvement is the management and coordination of responses throughout the enterprise. Current enterprise security products inherently provide localized responses to incidents detected in the each separate island. Since the security products are isolated the possible response options are limited to that part of the enterprise in which the particular security product operates. That is actions and responses are capable of being defined in one security product island for separate incidents that are detected but there is no ability to describe a desired action which may be more effective when it is applied in another part of the enterprise or on a global basis. There is currently no single management point to enable enterprise wide definition and enforcement of response policies to security incidents. Nor does a unified response channel and language protocol exist by which each island can communicate to thereby notify the others that something has occurred or an action needs to be taken. The lack of management and coordinated responses results in significant costs being incurred for manual integration and correlation of data across the islands in the enterprise.

Turning now to the figures where like reference numerals indicate like elements shows an illustrative enterprise security environment in which a variety of security products . . . N called endpoints are deployed. It is emphasized that the number and type of endpoints shown in are merely illustrative and the specific number of endpoints can be scaled up or down and different types of security products endpoints can be utilized depending on the requirements of a specific application of enterprise security assessment sharing. For example in addition to those shown in and described below web application protection products SEM SIM Security Event Management Security Incident Management products operational heath monitoring and configuration management products e.g. Microsoft Windows Software Update Services Microsoft Operations Manager or identity management products e.g. Microsoft Active Directory are also usable in some applications.

In enterprise security environment a host security endpoint is deployed to protect assess and monitor a plurality of host computers in the enterprise . A commercial example of the host security endpoint is Microsoft Forefront Client Security which provides unified malware protection for the enterprise s desktops laptops and server operating systems.

An edge firewall is a security product that is arranged to protect the enterprise environment from Internet based threats while providing users with remote access to applications and data through a perimeter network . Edge firewall may be embodied by for example a Microsoft Internet Security and Acceleration ISA server.

A NAP security endpoint performs computer health policy validation by ensuring ongoing compliance with health policies defined by an administrator. Typically access is restricted for computers e.g. desktops and roaming laptops monitored by the NAP security endpoint that do not comply with system health requirements.

A NIDS security endpoint analyzes traffic inside the enterprise over an internal network . The NIDS security endpoint operates to detect malicious activity such as denial of service attacks port scans by monitoring network traffic on the internal network .

A line of business security endpoint protects various line of business applications . Line of business applications include for example an e mail application such as Microsoft Exchange that is used in the enterprise . Security endpoint typically monitors e mail to provide anti virus and anti spam protection.

Each of the security endpoints in the enterprise are normally arranged as individual islands as indicated by the dashed rectangles in . Accordingly each security endpoint is arranged for monitoring a subset of the available data in the enterprise and for performing localized actions in response to a detected incident. In addition each endpoint typically includes a local management function . . . N. As noted above the individual local management functions are not generally integrated to provide a single point of management.

The endpoints are isolated from the mechanics of the actual transport and management of the publish subscribe model through a semantic abstraction layer that is arranged to simplify interactions with the security assessment channel . The abstraction layer comprises tables describing the security assessment types to which the endpoints subscribe and tables describing the security assessment types that endpoints publish as described below not all endpoints generally subscribe to all security assessment types . In addition the abstraction layer provides an API application programming interface for reading received security assessments and an API for generating security assessments.

A specialized endpoint ESAS central server is coupled to the security assessment channel and performs as a centralized audit point for the ESAS arrangement . Accordingly the ESAS central server subscribes to all security assessments and permanently logs them. ESAS central server also receives and logs messages from the endpoints that indicate the local actions that are taken by an endpoint. The ESAS central server thus provides administrators with security assessment monitoring functionality that gives a comprehensive view of the history and current status of the enterprise as a whole and each ESAS enabled endpoint.

A security assessment may be performed on any object of interest in an enterprise security environment such as a user or a device. In this illustrative example assessments include four main object types 1 Host assessments about computers in an enterprise 2 User assessments about users or accounts in enterprise 3 Service assessments about a service provided to the enterprise such as a URL Uniform Resource Locator of a web site that has a reputation as being malicious 4 Enterprise assessments about the enterprise as a whole or a well defined subset of the enterprise such as a department subnet site or branch and 5 Data assessments about business related data e.g. as found in documents e mail business data in a database etc. that is present or accessed by objects in the enterprise.

It is emphasized that these object types are merely illustrative and other object types may be used as required by specific scenarios. In most applications of enterprise security assessment sharing endpoints only publish and subscribe to a subset of all of the available security assessment types since particular endpoints are generally going to have interest in particular objects in the enterprise environment. In addition while some endpoints will be both publishers and subscribers there is no requirement for every endpoint to support both functionalities. For these reasons the publish subscribe model used herein is said to be loosely coupled.

Table 1 below shows an illustrative set of assessment categories and their mapping to specific object types that may be contained in a typical security assessment 

In the present illustrative ESAS arrangement four levels of severity are typically utilized low medium high and critical. Three levels of fidelity are typically utilized low medium and high. Note that the number of levels for both severity and fidelity can be arranged to be different depending on the assessment category. For example it is possible to use the three severity levels for the assessment category of vulnerable machine while using four severity levels for the assessment category of compromised machine. The particular choice of number of levels to be utilized will depend on the requirements of a specific application of the present enterprise security assessment sharing.

A security assessment uses information that is available at the time the assessment is made and relies on the particular security expertise and knowledge that is resident in the endpoint that produces it. A security assessment is tentative because confidence in any particular event can never be absolute and also because the assessment is temporary in nature as it relies on information that is present at the time it was produced. At some future time other information will be available so the security assessment may change.

The tentative nature of a security assessment is reflected in two fields included in each assessment fidelity and time to live TTL . The fidelity field provides a way for endpoints to express their confidence level in an assignment of a broader contextual meaning to information being analyzed. The TTL field enables endpoints to reflect the best estimate of the time period for which the security assessment is expected to be valid. Or alternatively the TTL field provides the best estimate for a future security assessment update. When a TTL expires an endpoint that takes actions based on a security assessment to which it subscribes is expected to roll back such actions when the TTL of that assessment expires. Thus the TTL provides a safety valve functionality to prevent a user or a machine from getting inappropriately trapped with restricted access due to a false positive or the loss of a message somewhere in the enterprise. However if such restricted access is indeed appropriate then either a new security assessment may be generated to continue the restriction or the TTL extended.

The security assessment is designed to enable precise semantics i.e. the meaning imparted by the categorization used in the security assessment using a compact vocabulary. As shown in two of the endpoints in the enterprise log data about events that occur in their respective areas of interest. The host event logs and firewall event logs thus contain very large amounts of data. Typically the data is processed in the respective endpoints using correlation rules and in order to identify events of interest. The correlation rules which are often numerous define the localized sponsors or actions taken responsibly to a detected event.

By comparison the security assessments indicated by reference numeral contain only a relatively small amount of data. As security assessments are utilized to assign broad context to information they provide answers to the questions Who created the assessment When Why For how long And on which object does the assessment apply Thus in order to make use of a security assessment an endpoint need only understand the few assessment types of interest as compared with the unbounded number of information messages that result from application of the correlation rules. Accordingly the complexity of the data collected by each endpoint is reduced by mapping information into one or more of the assessment types. Using security assessments thus enables relevant information to be provided to subscribing endpoints without requiring that large amounts of data or information be shared across the enterprise.

Table 2 below provides an illustrative set of fields that may be included in a typical security assessment.

In this illustrative example of enterprise security assessment sharing each endpoint is arranged to perform at least some of the tasks noted below. In some arrangements each endpoint is enhanced with additional functionality as required to perform such tasks through use of a discrete ESAS agent. Alternatively the enhanced functionality may be more tightly integrated into the core functionality provided by the endpoint and a separate or discrete agent may not necessarily be embodied in the endpoint. Such tasks include 

A plurality of security assessments are available for each of the security assessment types i.e. hosts users reputations and enterprise . As indicated by reference numeral in this illustrative example ESAS agent subscribes to security assessments having a host object type with an assessment category of vulnerable. It is emphasized that a particular combination of object types and assessment categories that is of interest can be different for different endpoints. Again using the loosely coupled publish subscribe model there is no requirement that every endpoint subscribes to every security assessment.

At process block the endpoint processes the received security assessment using correlation rules and locally available data that may be of some relevance. The outputs of such assessment process include the generation of the new assessment and or an invocation of a local action . As noted above such local action is subject to roll back i.e. self recovery when the received assessment expires according to the TTL field contained therein.

It is important to note that the Rule 2 refers to the exclusivity of information and not data as these terms were defined above. Two endpoints can process the same or overlapping data sources provided that the information they extract from the data and later use to generate assessments is exclusive.

To illustrate the implications of Rule 3 consider the following example where a scheduled antivirus scan of a machine detects and removes a piece of known malware. Based on this detection other locally available information a received currently active assessment and on the endpoint s embedded knowledge about current security incidents the endpoint may conclude one of the following 1 a machine was infected in the past but is now clean and does not pose any additional future security risk 2 The machine was infected and while the particular malware was removed it is possible or likely that it still poses a security risk. According to Rule 3 an endpoint should generate a security assessment about the machine in the latter case and not generate one in the former.

Third the subscribing endpoints . . . N and the ESAS central server which receive the security assessment apply their specific security expertise through the application of their own correlation rules and locally available data to trigger an appropriate action. As collectively indicated by reference numeral in the host security endpoint performs an on demand scan. The NAP endpoint revokes the IP security certificate for the identified compromised client and implements a port shutdown. The line of business security endpoint temporarily suspends instant messaging IM traffic to the compromised client based on the received security assessment. The ESAS central server raises an alert for a security analyst e.g. an administrator and also logs all of the security assessments and actions invoked.

The first illustrative scenario described above provides a case where the endpoint detecting the suspicious incident generates a security assessment with high severity and high fidelity i.e. the endpoint has a high degree of confidence that it has validly detected a serious incident . By comparison is a diagram of a second illustrative scenario in which a low fidelity security assessment is sent over the security assessment channel that triggers the generation of a high fidelity assessment by a receiving endpoint which also performs cross object mapping.

This second illustrative scenario is also described in three stages. As indicated by reference numeral the edge firewall first detects a large number of client connections to the perimeter network . However unlike the first illustrative scenario shown in and described in the accompanying text the number of connections being established by the client is not so high that the edge firewall can be absolutely certain that the client has been compromised. In current enterprise security systems when an endpoint sees such data it generally just drops the data and takes no action as there is not enough evidence to warrant the typically harsh response such as disconnecting the machine. By comparison in the present scenario the edge firewall in the second stage sends a security assessment over the security assessment channel that indicates that the particular client is compromised with medium severity and low fidelity as indicated by reference numeral .

Here the subscribing endpoints to the particular object referenced in the security assessment generated by the edge firewall include the host security endpoint and the ESAS central server . While such a low fidelity data normally does not trigger an action to be taken at an endpoint in current security products in accordance with the present enterprise security assessment sharing the host security endpoint looks at its own local data differently in light of the received security assessment from the edge firewall . In this case the local data resulting from an on demand scan at the host security endpoint and the information contained in the security assessment from the edge firewall are used to generate new assessments and . Thus the host security endpoint has information that by itself does not warrant the generation of a new security assessment but when reinforced with even a low fidelity assessment from another endpoint as in this case there is sufficient evidence to justify the creation of the new security assessments and which each have high fidelity.

The host security endpoint places the new security assessments and onto the security assessment channel . The new security assessments and are received over the security assessment channel by the subscribing endpoints which in this illustrative scenario include the edge firewall and the ESAS central server for security assessment and line of business endpoint for security assessment .

Note that the line of business endpoint was not a subscriber to the original security assessment produced by the edge firewall because the reference object type is a machine and the line of business endpoint by virtue of its role in protecting e mail is typically concerned with the users. However in this second illustrative scenario the host security endpoint maps from a host object type to a user object type when it generates a new security assessment . Such cross object mapping capability may be beneficial in many scenarios as it is contemplated that a high severity incident such as malware or malicious activity that potentially compromises the data confidentiality or integrity of a host computer may also potentially compromise the user as well. A security assessment may be generated that cross maps the high severity incident from the host object type to a user object type with a certain degree of fidelity. Similarly a critical severity incident in which malware or malicious activity has actually caused a loss of data integrity on a host computer a security assessment for a user object type may be generated with even higher fidelity.

In stage three the new security assessments and trigger a variety of respective actions at the receiving endpoints as collectively indicated by reference numeral . Specifically the edge firewall blocks all access by the compromised client with the exception of software updates and or mission critical access. The line of business endpoint temporarily suspends outgoing e mails. And as with the first illustrative scenario the ESAS central server continues to log all assessments and actions. As noted above such restrictions are enforced only during the period of time for which the TTL associated with the new security assessments and remains valid. When the new security assessments expire the actions taken by the respective endpoints are rolled back unless the TTL is extended or a new security assessment which invokes the restrictive actions is received.

The host security endpoint reviews the received security assessment and applies its specific security expertise using correlation rules and any relevant locally available data. In this illustrative example the host security endpoint responsively generates a new security assessment containing a user object type to which the line of business security endpoint subscribes.

In the third stage of the scenario the remediation techniques employed by the endpoints are considered expensive in terms of their potential impact on business operations within the enterprise . For example as indicated by reference numeral the line of business security endpoint implements a response policy that entails temporarily suspending outgoing e mail. In addition the host security endpoint performs an on demand scan and if no results are achieved performs a deep scan. While such remediation techniques can be very effective in addressing malware malicious users and other problems they typically impart significant expense to the enterprise. For example a user whose outgoing e mail is suspended will be less productive and deep scanning typically requires one or more reboots which will remove the machine from service for a period of time.

The present ESAS arrangement advantageously enables these effective albeit expensive remediation techniques to be applied in a targeted manner and not merely in a general way or across the board which can be unjustified for some machines and or users. Only objects in the environment that are deemed suspicious using pre defined criteria will be subject to these particular remediation techniques.

Screen is an illustrative example showing the configuration of enterprise wide response policies using fields . . . N for a number of different endpoints for the case of an assessment category of a compromised machine with critical severity which defines a starting point i.e. anchor point for the response policy configuration as indicated by reference numeral . It is emphasized that other user interface screens would be utilized for other assessment categories object types severity levels etc. so that the user is enabled to define response policies for the plurality of different starting points that are likely to be used in a particular enterprise security environment. The response policies in this particular example are set depending upon the fidelity of a particular security assessment for a set severity level of Critical. Fields include a number of respective subfields that are arranged to reflect user defined input using for example text entry boxes drop down menus and the like that are employed in typical GUIs.

As indicated in subfield for a security assessment indicating a compromised machine with critical severity the edge firewall is configured to increase the amount of auditing i.e. moving to a deep audit level that increases the amount of data collected as compared with a normal level of auditing when a security assessment has low fidelity. Subfield shows that for an assessment having medium fidelity the edge firewall increases the auditing level and also restricts Internet access to the suspected compromised machine to only white list URLs which typically include sites that are known to not be malicious. When the fidelity is high as shown by subfield access to the Internet is blocked completely.

Field shows the response policy configuration for the host security endpoint . For a security assessment having low fidelity and indicating a compromised machine with critical severity the host security endpoint increases the amount of auditing to a deep audit level as indicated by subfield . Subfield indicates that for the cases of medium and high fidelity the host security endpoint increases its auditing and also increases performs a deep scan of it hosts where a deep scan may entail the computer to be rebooted one or more times .

Field shows the response policy configuration for the line of business security endpoint . For a security assessment having low fidelity and indicating a compromised machine with critical severity the line of business security endpoint increases the amount of auditing to a deep audit level as indicated by subfield . Subfield indicates that for a security assessment having medium fidelity the line of business security endpoint increases its data collection to a deep audit and also restricts file attachments to e mail. Subfield indicates that for a security assessment having high fidelity line of business security endpoint blocks all instant messaging IM traffic.

Field shows the response policy configuration for the ESAS central server in . For a security assessment having high fidelity the ESAS central server as indicated in subfield executes a port shutdown for the affected machine and generates an alert that the associated user account has been suspended. As with the subfields discussed above subfield is typically arranged to accept user defined input.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

