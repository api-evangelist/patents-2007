---

title: Determining presence for interaction routing
abstract: An Internet Protocol Network Telephony call center having a plurality of agents for serving clients also processes e-mails addresses to the call center, but not to specific agents. An e-mail server receives and routes the e-mail, and includes a router and a database storing skill set information regarding agents. The router extracts information from the e-mails, matches key words in the extracted information with key words from the skill sets, and routes the e-mails to appropriate agents having the necessary skills to respond to the service requirements in the e-mails.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07715332&OS=07715332&RS=07715332
owner: Genesys Telecommunications Laboratories, Inc.
number: 07715332
owner_city: Daly City
owner_country: US
publication_date: 20071025
---
The present patent application is a divisional application of copending patent application Ser. No. 11 049 207 filed on Feb. 1 2005 which is a divisional application of Ser. No. 09 565 872 filed on May 5 2000 and issued as U.S. Pat. No. 6 981 020 which is a divisional of 09 010 793 filed on Jan. 22 1998 and issued as U.S. Pat. No. 6 021 428. The present application is also Ser. No. 09 010 793 is a divisional of Ser. No. 08 929 594 filed on Sep. 15 1997 and now abandoned which was filed as a CIP to Ser. No. 08 795 680 filed Feb. 6 1997 now issued as U.S. Pat. No. 5 765 033 and included all of the disclosure of that case. The prior documents are included at least by reference and priority is claimed to the filing date of 08 795 680.

The present invention in its several aspects presented herein is in the area of telephone communication in the broadest sense that is including all multimedia communication aspects of intelligent networks call center technology including computer telephony integration CTI and Internet protocol telephony networks and related technology.

Telephone is one of the most widely used communication equipment in the world. At first it was merely a convenient tool to allow people to communicate while they are physically separated. Recently many companies use telephones to market products and services provide technical supports to consumer products allow customers to access their own financial data etc. Thus telephone is becoming a major business and marketing tool.

In order to more effectively use telephone for business and marketing purposes call centers have been developed. In a call center a large number of agents handle telephone communication with customers. The matching of calls between customers and agents is typically performed by software. A simple example is used here to describe a few of the many advantages of using call centers. When a call is made to a call center the telephone number of the calling line is typically made available to the call center by a telephone carrier. Based on this telephone number the software in the call center can access a database server to obtain information about the customer who has been assigned that phone number. The software can now route the call to an agent who can best handle the call based on predefined criteria e.g. language skill knowledge of products the customer bought etc. . The software immediately transfers relevant information to a computer screen used by the agent. Thus the agent can gain valuable information about the customer prior to receiving the call. As a result the agent can more effectively handle the telephone transaction.

It can be seen from the above example that the enabling technology requires a combination of telephone switching and computer information processing technologies. The term commonly used for this combined technology is computer telephony integration CTI .

In recent years advances in computer technology and telephony equipment and infrastructure as well has provided many opportunities for improving telephone service. Similarly development of the information and data network known as the Internet together with advances in computer hardware and software has led to a new multi media telephone system known in the art as Internet protocol network telephony IPNT . In IPNT as well as in the older intelligent and CTI enhanced telephony systems both privately and publicly switched it is desirable to handle more calls faster and to provide improved service in every way including such improvements as video calls and conferencing.

In various embodiments and aspects of the present invention described in enabling detail below new and enhanced apparatus and methods are provided for improving telephony systems and service.

In a preferred embodiment of the present invention a system for routing an electronic mail e mail to one of a plurality of agents in an Internet Protocol Network Telephony call center is provided each of the agents having a specific skill set from a variety of possible skill sets the system comprising an e mail server adapted to receive the e mail from a sender an information extractor for extracting information from the e mail a router and a database accessible to the router and storing skill sets of the agents. The router selects the one of a plurality of agents by matching stored information about the specific skill sets with portions of extracted information from the e mail.

In some embodiments a statistics server stat server records activities of the call center and the routing performed by the router further uses the recorded activity in the stat server. Also in some embodiments routing of e mails to selected agents is load balanced based on recorded activity stored in the stat server. An overload threshold may set for number of e mails to be routed and senders of e mails are then notified of a possible delay when the threshold is exceeded.

In some other embodiments the database further stores information on senders of e mails and routing performed by the router further uses the stored information on senders of e mails. The database may also store information about prior relationships of agents and e mail senders and the router uses the relationship information in making routing decisions as well.

In an alternative embodiment a time limit for response to e mails by the agents is set and e mails not answered within the time limit are rerouted to other agents. In other embodiments the information extractor comprises plural and selectable extraction algorithms. One of the extraction algorithms may include a parser and the one of the extraction algorithms uses the parser to search for keywords in the e mail.

The system provided by the several embodiments of the present invention allows e mails to be addressed for service to a single entity and then to be distributed to agents for service who are qualified by particular skills to respond to the need of the client sending the e mail.

The present invention comprises a novel video telecommunication routing system and related methods. The following description is presented to enable any person skilled in the art to make and use the invention. Description of specific applications is provided only as examples. Various modifications to the preferred embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

Call center comprises a video routing device which accepts calls including video calls when predetermined phone numbers are dialed and then routes individual call to one of a plurality of stations in accordance with predefined criteria. These stations include video stations . In an embodiment of the present invention the criteria could vary in real time as the characteristics of the calls and video stations change.

It is possible for call center to process video calls from other video kiosks such as kiosk . Call center may also process conventional voice calls.

In one embodiment of the present invention video stations can be connected to a communication network . This network could be a local area network commonly used in many offices. Other devices such as a database server can also be connected to network . Information of video stations call center personnel and customers can be stored in database server . This information is accessible by video stations . It should be appreciated that database server does not have to be a sophisticated database management system. It could be as simple as a table stored in a small data processing device. Video routing device may optionally be connected to database server so as to access the information. This information can also be stored inside video routing device .

An example of the types of video telecommunication that can be advantageously handled by routing system is intelligent routing of a video conference between a customer located at video kiosk and an appropriate agent sitting by one of the video stations in call center .

Video routing device comprises a switching device for accepting calls from PSTN . Switching device could be a automatic call distributor ACD private branch exchange PBX or a PSTN switch. It should be appreciated that switching device hereinafter ACD PBX can be a customer premise equipment or may be provided by a telephone communication carrier. ACD PBX contains a high bandwidth port for connecting to PSTN and a plurality of low bandwidth ports such as ports . Some of these ports can be connected to video stations . The other low bandwidth ports can be connected to voice based devices. Each of the low bandwidth ports is assigned one or more directory numbers. In one embodiment of the present invention two directory numbers corresponding to two telephone channels are assigned to a video station.

ACD PBX is also connected to a CTI PBX server through a computer telephony integration CTI link . Video routing device comprises two other servers a routing server video ACD for routing video calls and a stat server for storing historic information of call center . CTI PBX server functions as an interface between these two servers and ACD PBX . These three servers are connected to communication network . In the present embodiment the function of these servers are provided by software modules. As explained below these three servers can be used in combination with a conventional ACD PBX to achieve the video routing function of the present invention.

High bandwidth port of ACD PBX is preferably connected to a high capacity telephone line such as a primary rate interface PRI as defined in the CCITT ISDN 1.431 standard. This is one of the standards of the international ISDN protocol. Low bandwidth ports could be a single voice channel or a basic rate interface BRI as defined in CCITT ISDN 1.430 standard. Basically BRI offers two 56 kilo bit per second Kbps user data channels the bearer or B channels and one 16 Kbps signaling channel the D channel . This interface is also referred to as 2B D. The combined bandwidth is 128 Kbps. The PRI offers twenty three user data channels and one 64 Kbps signaling channel. This interface is also referred to as 23B D.

In order to deliver video information at an acceptable level of quality e.g. 15 frame per second current compression technology prefers a bandwidth of at least 112 to 128 Kbps. This amount of bandwidth cannot be provided by a single telephone channel but could be provided by an ISDN BRI. Thus in line connecting video kiosk to PSTN is preferably a BRI line.

As discussed above a BRI line essentially comprises two telephone channels. These two telephone channels must be connected to the same low bandwidth port of PBX in order to allow all the video data from video kiosk to be transmitted to the same video station. A conventional PBX does not have the ability to recognize that two telephone channels originated from the same video kiosk. Thus it is not possible for it to connect them to the same video station.

In one embodiment of the present invention the servers in video routing device i.e. CTI PBX server stat server and routing server video ACD these three servers are collectively called the host are used in combination with a conventional PBX to route calls originated from video kiosk to the appropriate low bandwidth port. In this embodiment ACD PBX is a conventional PBX which comprises a data processing device capable of executing an internal trunk route script. This script contains a plurality of commands which control the operation of ACD PBX . For example the script can connect calls received at high bandwidth port to low bandwidth ports in accordance with certain criteria determine the type of music or announcement to play when a call is put on hold select the strategy to queue calls when all low bandwidth ports are busy etc.

In this embodiment of the present invention the above described servers are used to determine the operation of ACD PBX i.e. the internal trunk route script is essentially disabled . As a result intelligence and routing decisions are moved from ACD PBX to the host. is a flow chart showing a trunk route script which allows the host to control the operation of ACD PBX . ACD PBX receives an incoming call step . ACD PBX places a request to the host for routing the call step . ACD PBX then waits for a response from the host step . If it receives a response from the host control is transferred to host which then performs routing operation in accordance with criteria determined by the host step . Flow chart then ends and another call can be processed by ACD PBX and the host. If ACD PBX does not receive a response from the host it determines whether a response timeout e.g. 10 seconds has elapsed step . If the answer is yes ACD PBX then executes its internal script step . Thus the internal script provides a default routing routine for the call center. Flow chart then ends and another call can be processed by ACD PBX and the host. If the answer is no ACD PBX continues to wait i.e. flow chart branches back to step .

In the preferred embodiment of the present invention video routing is performed by combining the resources of stat server routing server video ACD and CTI PBX server . Stat server contains a database for storing all relevant activities of call center e.g. the current status and history of activities of all low bandwidth ports . Routing server video ACD routes calls to appropriate low bandwidth ports based on factors such as the information contained in stat server the information delivered by ACD PBX and the status of various low bandwidth ports. CTI PBX server acts as a bridge between ACD PBX at one end and stat server and routing server video ACD at the other end. CTI PBX server is designed to interface with PBXs manufactured by different vendors and present a uniform application program interface API to stat server and routing server video ACD . An advantage of this arrangement is that individual components in video routing device could be replaced and enhanced separately. For example substantially the same routing server video ACD and stat server could be used with PBXs from different manufacturers by changing CTI PBX server .

The operation of an embodiment of video routing system is now described in connection with flow chart of . The video routing system in this embodiment operates in a telephone system in which two separate telephone numbers are associated with an ISDN channel. It should be note that this embodiment can be modified in a manner described below to function in a telephone system in which only one telephone number is associated with an ISDN channel.

In system a regular toll free 800 number is pre assigned to carry video information. Thus video kiosk dials this number twice each time using a different phone number associated with the ISDN channel step . The time gap for connecting these two calls to call center by PSTN ranges from less than a second to several seconds. Typically the gap is below one minute.

PSTN connects the calls to call center step . Each time when the 800 number is dialed PSTN delivers two pieces of information to ACD PBX a dial number identification system DNIS for uniquely identifying the toll free 800 number and an automatic number identification ANI for uniquely identifying the telephone line which originates the call. In this embodiment the above described toll free 800 number and the ISDN line connected to video kiosk are pre assigned for video conference purposes. The DNIS and ANIs of the corresponding 800 number and ISDN line should have been previously stored in a database which could be located in routing server video ACD or database server .

In the present invention ACD PBX transfers control of calls to the host step . When ACD PBX receives the DNIS and the first of two ANIs from PSTN it sends these two numbers to CTI PBX server which in turn sends them to routing server video ACD . Routing decision is not made by ACD PBX . Because this DNIS is one of the numbers recognized by routing server video ACD to be associated with a video call the video routine algorithm of routing server video ACD is invoked. This serves as a convenient method for screening out non video calls.

Routing server video ACD then determines if this is a new video call or a part of an existing video call step . It branches to a DN Relate database. An example of a DN Relate database is shown in Table 1 

It should be appreciated that the format and information contained in table 1 is for illustrative purposes only. The design of the table can be easily changed and enhanced by persons of ordinary skill in the art.

In table 1 the entries under the columns DN1 and DN2 correspond to the pairs of directory numbers assigned to video stations. Each pair of directory numbers will be connected to the same video station. The column entitled status indicates the status of the directory numbers. If the entry is unavailable these directory numbers are not available e.g. video station not yet logged in and should not be connected to a new video call. If the entry is available these directory numbers could be used to connect to a new video telecommunication. If the entry is waiting one of the two ANIs has been received and a second ANI needs to be received to complete the video telecommunication. The entries under time stamp contain time related information. This information could be used as part of the input variables of a routing algorithm e.g. the video station waited longest for a video call should be connected first. The entries under Related ANI contain the second of two ANIs used for completing a video connection. The entries of this column can be used by routing server video ACD to connect appropriate video calls to the correct video station.

The last row in table 1 is now explained. The numbers and under DN1 and DN2 respectively correspond to the directory numbers assigned to the same video station. The status is waiting indicating that one of the directory numbers e.g. under DN1 has previously been connected to an incoming video call and this video station is waiting for the second incoming video call. The time under time stamp corresponds to the time the first call is received. The number under related ANI i.e. corresponds to the ANI of the anticipated second call. The method of entering the anticipated ANI in table 1 will be explained below.

Routing server video ACD compares the ANI obtained from ACD PBX to the ANIs stored in the DN Relate database step . If there is a match routing server video ACD knows that this video call relates to an existing call. For example if the received ANI is the database in table 1 indicates that video routing system is waiting for this ANI to complete a video connection and this call should be routed to DN . The status column of the corresponding row should be updated to indicate that video telecommunication has been established step . Routing server video ACD then connects the video call to the waiting directory number i.e. the corresponding entry under DN2 indicated in the database step . Flow chart ends and another call can be processed.

If routing server video ACD does not find any match it needs to look for an available video station step . It checks to see if a video station is available step . Assuming that more than one video stations are available one of them will be selected in accordance with predetermined criteria. For example the time stamp column of a pair of available directory numbers indicates the time this pair of directory numbers first became available. This information could be used as a factor to select the appropriate video station. After an available video station is selected routing server video ACD updates the status of this station step . Specifically it sets the corresponding status to waiting and sets the time stamp in the database. Routing server video ACD then connects the incoming call to the directory number under DN1 of the selected video station step .

Routing server video ACD needs to obtain the corresponding ANI for the remaining call step . It jumps to a ANI relate database. This database contains entries of the pairs of phones numbers associated with the ISDN lines assigned for video telecommunication purposes. For example if a first ISDN line connected to a first video kiosk associates with ANIs and while a second ISDN line connected to a second video kiosk associates with ANIs and the ANI relate database would have entries shown in Table 2 

It should be appreciated that the format and information contained in table 2 is for illustrative purposes only. The design of the table can be easily changed and enhanced by persons of ordinary skill in the art.

As an example if the ANI received by routing server video ACD is the ANI Relate database indicates that the ANI associated with the same video call is . Thus routing server video ACD is able to obtain the second of a pair of ANIs associated with a video connection. It then returns to DN Relate database see table 1 and places the number under the column related ANI of the selected video station. Routing system then waits for incoming calls having this second ANI. Flow chart ends and waits for the next call.

If there is no available video station routing server video ACD sends the call to a queue to wait for an available station step . In the present invention a new method is used to queue video calls. This method is different from those used on standard voice calls. As stated earlier a call cannot be connected to one point and then disconnected to another point. Such operation will destroy the call. As a result the new method described below is needed to handle the queuing.

In step routing server video ACD checks to see if the video call has been in the queue for longer than an allowed time i.e. the timeout period . If the allowed time has expired routing server video ACD records the ANI that attempts to call the call center step . When a video station is later available this ANI can be retrieved by a video agent and a call can be placed by that video agent to the kiosk or person which had originated the call. In the mean time ACD PBX is instructed to disconnect the video call and return a busy signal step . This is the least desirable option. It should be used when no video agents are available and none are seen to become available within a relatively short time frame. The timeout period is set to reflect this consideration.

If the video call has been in the queue for shorter than the allowed time routing server video ACD continues to try to connect the call step . That is flow chart loops back to step . During this period of time the video call remains in a ringing state. The loop continues until the timeout has elapsed. At that time steps and are executed.

It can be seen from the above description of flow chart that video routing device is able to receive video calls and connect them to appropriate video stations if available in call center . Video routing device could also access database server if there is a need to do so to obtain additional information about video kiosk and the video station selected for connection. This information can be sent to an agent monitoring the selected video station.

As pointed out above video routing device can also be used for the situation where only one phone number is assigned to an ISDN channel. In this case there is no need to generate the ANI relate database because the entries in the first and second columns will be the same. The calling ANI is directly written to the appropriate row of the related ANI column. This is because the calling ANI and the anticipated second ANI are the same.

Video stations are connected to routing server video ACD so that video calls can be routed thereto. Video stations are also connected to database server so that information regarding customers products etc. can be downloaded from database server .

It should be appreciated that even though CTI PBX routing server video ACD stat server and database server are shown as separate components they could be combined into one two or three components residing on one or more data processing devices.

The present invention comprises a novel system and related methods for coordinating telephone and data communications. The following description is presented to enable any person skilled in the art to make and use the invention. Description of specific applications is provided only as examples. Various modifications to the preferred embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

It should be appreciated that the present invention relates to coordinating data and telephone communications between any two sites. The description of provider sites and customer sites pertains to an important but not the only application of the present invention envisioned by the inventor. The present invention can be applied to many applications.

Customer site comprises a client computer running a browser of the present invention. Client computer is connected to a modem which is coupled to a TCP IP connection . As a result client computer is able to gain access to the Internet . A user in customer site use browser to communicate with other computers connected to Internet .

Customer site also contains a telephone which allows the user in customer site to make telephone communication with a service agent in provider site . Telephone is coupled to a public switched telephone network PSTN via a telephone channel . In the prior art system it is not possible for the system to coordinate voice via PSTN and data via Internet communication between the user and the service agent. One aspect of the present invention allows such coordination to take place. As a result the user and the service agent can display the same data e.g. the same web page at their respective computer screens and communicate orally or visually if picture phones are installed in both sites at the same time.

Provider site comprises a server connected to Internet through a TCP IP connection . Server supplies various web documents e.g. product information order forms etc. to browsers that request the documents. Provider site contains a service assistance center in which a number of service agents can take telephone calls from users in various customer sites. Service assistance center contains a computer telephony integration CTI system for accepting calls from PSTN and routing calls to a plurality of telephones one of them is shown as telephone . Service assistance center also contains a plurality of computers one of them is shown as computer . CTI system is coupled to PSTN via a high bandwidth telephone channel such as a primary rate interface PRI as defined in the CCITT ISDN 1.431 standard. The service agents use both the computers and telephones to efficiently provide services to various users in the customer sites.

It should be appreciated that the CTI system is not limited to route voice communication. It can also route other types of communication. A CTI system that can route video calls has been disclosed in a copending patent application entitled Video Telecommunication Routing Systems and Methods filed Oct. 25 1995 in the names of Alec Miloslavsky and Jason Goecke. This copending patent application is hereby incorporated by reference. It should also be appreciated that service assistance center and provider site can be in different physical locations as long as they are electrically connected in the manner described below.

The Internet side of the invention is first described. Browser is a piece of software that can display information sent by server . A protocol for communication between customer site and provider site using Internet is the HTTP or web protocol. One of the advantages of web protocol is that the display on browser is a graphic document commonly called a web page containing text images and other information. Each web page has an address in a recognized format the URL or Uniform Resource Locator that enables computers all over the world to access it. Browser sends a request to the URL of a web page in server . Server respond with a file encoded in a special language called the hypertext markup language HTML . This language contains tags which allows a programmer to specify the appearance of the web page and set up hyperlinks to other HTML documents located in the same or other servers . As a result the user in customer site is able to use browser to access information in server .

The web protocol also contains various mechanisms e.g. common gateway interface CGI POST and GET methods etc. for browser and server to communicate with each other. As a result it is possible to design a system for the user in customer site to place orders through the web page. For example the user can click on an icon on a web page to order a product associated with the icon. Server receives and processes the order. This is one of the methods for carrying out electronic commercial transactions.

When the user in customer site is reviewing information on browser or is about to place an order the user may request the attention of a service agent in service assistance center . For example the user may want to ask additional information or provide confidential information such as a credit card number orally to the service agent. It is desirable for the service agent to display on his her computer the same web page displayed on browser while interaction with the user through telephone. It is also desirable for the service agent to obtain as much information about customer site as possible prior to commencing telephone communication with the user.

In the prior art methods the user has to look up the telephone number of the service assistance center and manually call the center. After connected to a service agent the user has to explain his her needs and if necessary describe to the agent the web page being displayed on the browser. The service agent needs to identify the user and may have to access the server to find the web page displayed on the user s computer. It can be seen that this method is very slow and ties up valuable time of a service agent. As a result prior art service assistance centers require many service agents in order to provide adequate service to customers.

One aspect of the present invention provides automatic coordination between the telephone communication and the Internet communication. As an example when the telephone communication is established the web page displayed by browser is automatically displayed on computer together with information about customer site . As a result the service agent may anticipate the user s needs and immediately provides desired services to the user. It should be appreciated that telephone communication in the present system includes voice and or video communication through PSTN .

In the present invention the web page originated from server contains an icon such as a button positioned at a convenient location of the web page. This icon is displayed by browser . When the user wishes to initiate telephone communication with service assistance center he she can click on i.e. select button . There is no need for the user to look up the telephone number of service assistance center . One way for browser to display a clickable button is by embedding at the appropriate place in the associated HTML document a tag of the form . In this example button.gif is the URL addresses of a graphic file in a popular graphic format called GIF associated with the button icon and phone.html is the URL address of a file which can respond to the clicking. This tag tells a browser to display the button image which is preferably stored in server and to treat it as a clickable item that whenever a user clicks on it with a mouse triggers a connection to the file phone.html also preferably stored in server .

When button is clicked browser sends a telephone service request to phone.html in server . Server then sends the request and associated data e.g. the identity of customer site and the HTML document associated with the web page displayed on browser to a service request process SRP . SRP is a software module which could run on server or on a separate data processing device. SRP selects an available service agent in accordance with predetermined criteria e.g. availability of agents previous interaction between a certain agent and customer site . Assuming that the service agent associated with computer is selected the HTML document previously sent to customer site is delivered to computer . Computer contains a browser and can display the HTML document. As a result the service agent who will interact with the user in customer site is able to see the same web page the user is seeing. As explained below other information about customer site can also be sent to computer . This information is accessible by the service agent.

One aspect of the present invention is a CTI system that can provide a telephone connection between the user and the service agent associated with computer . shows a block diagram of CTI system which works with SRP to provide such a connection. Reference numerals in that are the same as that for refer to the same elements.

CTI system comprises a switching device for accepting calls from PSTN . Examples of switching device are but not limited to an automatic call distributor ACD private branch exchange PBX and a PSTN switch. It should be appreciated that switching device hereinafter PBX can be a customer premise equipment or may be provided by a telephone communication carrier. PBX contains a high bandwidth port for connecting to PSTN and a plurality of low bandwidth ports such as ports . Each of the low bandwidth ports is assigned one or more directory numbers. Some of these ports can be connected to telephones used by service agents such as telephones and .

In order to facilitate the operation of service agents each agent has easy access to a telephone and a computer. In a telephone and a computer is set up as a station and assigned to a service agent. For example telephone and a computer is grouped as a station while telephone and a computer is grouped as a station . When a service agent logs in he she can enter his her identification information to computers and respectively. As explained above information on the service agents such as language skill knowledge of products etc. could be used by SRP as some of the factors in selecting an appropriate service agent to interact with a particular user.

PBX is connected to a CTI server through a CTI link . CTI system also comprises a stat server and a routing server . Stat server stores all relevant activities of CTI system e.g. the current status and history of activities of all low bandwidth ports . Routing server routes calls to appropriate low bandwidth ports based on factors such as the information contained in stat server the information delivered by PBX and the status of various low bandwidth ports. CTI system contains a database server containing information of provider site e.g. agent skills and information pertaining to the customers of provider site including information of customer site . CTI system also contains an external router working together with SRP for reserving a specific telephone channel between customer site and the telephone in the station of the selected service agent. The detail operation of external router will be described below.

One function of CTI server is to act as a bridge between PBX at one end and stat server external router and routing server at the other end. CTI server is designed to interface with PBXs manufactured by different vendors and present a uniform application program interface API to stat server external router and routing server . An advantage of this arrangement is that individual components in CTI system could be replaced and enhanced separately. For example substantially the same routing server external router and stat server could be used with PBXs from different manufacturers e.g. AT T Northern Telecom or Ericsson by changing CTI server . Specifically different versions of a particular implementation of CTI server can be designed to match with switches made by different manufacturers provided that the switches have a CTI link . These versions communicate with the same routing server external router and stat server through a standard protocol which is switch independent.

In one embodiment of the present invention stat server external router routing server external router and computers and are connected to a communication network . In the present embodiment the function of these servers and external router are provided by software modules running in one or more computers. It should be appreciated that even though CTI server routing server stat server external router and database server are shown as separate components they could be combined into one two three or four components residing on one or more data processing devices.

SRP is connected to external router and communication network . After a user in customer site clicks on button and issues a request SRP determines the status of the agent computers e.g. whether computers and have been turned on and the identity of agents in the stations. SRP may need to access database server and stat server to obtain the necessary information. SRP then selects an appropriate agent and notifies external router . External router selects a telephone number of a routing point of PBX and associate this telephone number with the directory number of PBX which connects to the telephone of the selected service agent. The routing point is a component in PBX which generates a CTI redirect request to CTI server whenever a call reaches this component. This routing point could be a control directory number virtual directory number or a trunk dial number identification system DNIS . The exact nature of the telephone number is not important as long as it is a number which can reach the routing point. Thus the telephone number could be a private network number a public network number or an international number.

External router notifies CTI server and SRP of this telephone number. SRP causes server to send this telephone number to browser in customer site . Browser can either display this number so that the user can dial it manually or dial the number electronically and notifies the user about the status of the telephone connection. When PBX receives a call having this telephone number it directs the call to CTI server . CTI server sends the call to external router which then delivers this call to the directory number associated with the selected service agent.

PBX keeps a number of such routing points specifically reserved to accommodate requests from SRP . These routing points are used as semaphores by SRP . They are allocated and deallocated as needed. Once a routing point is reserved by SRP for a particular service agent it is considered unavailable. Once the call is routed to the service agent the routing point is again usable.

Another embodiment of the present invention is now described. In this embodiment call center initiates the telephone call in response to a request by a user in customer site instead of customer site initiates the telephone call. Referring now to the user requests a telephone call by clicking on button which could be labeled a call me button . A dialog box appears. It asked the user to enter the telephone number of phone . Browser then sends the telephone number of phone to server in provider site . Alternatively the telephone number could have been previously stored in computer e.g. in the form of a persistent client state information commonly called the cookies in Internet technical literature . Server then sends the telephone number and associated data e.g. the identity of customer site and the HTML document associated with the web page displayed on browser to SRP . SRP then requests service assistance center to call this telephone number and select an agent to talk with the user.

Browser could send other identification information instead of the telephone number to server . For example the name or Internet address of customer site could be sent. Server or SRP could maintain a customer list associating the identification information with the telephone number of phone . As a result service assistance center could call telephone based on information on this customer list.

Other information can also be sent by browser . For example the user can specify a certain time period on a certain date as an appropriate time for receiving calls from service assistance center .

In SRP is connected to an outbound call controller which is in turn connected to switching device and communication network . After SRP received the telephone number of phone it deposits the number in a list server . This server is essentially a queue which contains all the telephones which needs to be dialed out by service assistance center . Typically the queue is arranged in a first in first out manner. However it is possible to set up a different priority scheme for scheduling the calls.

Outbound call controller dials the telephone numbers in list server . The progress of the call is monitored by a call progression detector CPD . Detector returns the status of the call e.g. line busy call received by a facsimile machine call received by a modem etc. . Outbound call controller takes appropriate actions based on this status e.g. it can dial another number in list server if the telephone corresponding to a previously dialed number is busy.

When the telephone number corresponding to phone is dialed and CPD determines that the line is not busy outbound call controller requests routing server to find a free agent who is qualified to handle the call to customer site . SRP can then send the digital data e..g the HTML document displayed on the user s computer to the selected agent. As a result an agent in service assistance center is able to talk with a user in customer site while reviewing the web page displayed on browser in customer site .

In a different version of this embodiment SRP can estimate the length of time for service assistance center to call telephone based on the number of telephone numbers already in list server and the availability of agents. If this length of time is excessively long SRP may ask Internet server to send a message to browser informing the user of the estimated waiting time. The user has the freedom to request a rescheduling of the call.

The present invention comprises a novel call center architecture and related methods. The following description is presented to enable any person skilled in the art to make and use the invention. Description of specific applications is provided only as examples. Various modifications to the preferred embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

Network provider call center provides call center services to other customers such as customer call center . These call centers are linked to PSTN by telephone links. For example customer call center is linked to PSTN by telephone link . Further customer call center is optionally connected to provider call center by a data connector .

In order to illustrate the operation of the present invention the system in is used to perform predictive dialing. In this case agents in customer call center want to contact potential buyers of a product or service. The telephone numbers of these potential buyers are stored in a database in provider call center . Equipments in provider call center dial these telephone numbers. If a telephone number is busy another telephone number is dialed automatically. When a potential buyer answers the call the call is immediately routed to an available agent in customer call center . The agent can then talk to the buyer regarding the product or service.

Customer call center comprises a private branch exchange and or automatic call distributor shown in as PBX and a plurality of stations such as stations and . Each station has a telephone such as telephones and in stations and respectively and a computer such as computers and . The telephones are connected to PBX . The computers are connected to a local area network which is in turn connected to data connector . Agents in customer call center are assigned to these stations to operate the telephones provided therein.

Provider call center comprises a network switch a CTI system and a computer predictive dialer . Network switch contains circuits that can provide switching and call distribution functions. Network switch is coupled to a high bandwidth telephone line so that a plurality of telephone channels are available for connecting to the telephones of potential buyers. Network switch also contains means for keeping an incoming call connected thereto continuously so that this incoming call can be routed at will to any lines controlled by network switch referred herein as the continuous connection function . Network switches made by some manufacturers contain this means. For those network switches that do not contain this means a looped around circuit can be used to provide the same continuous connection functionality. Looped around circuit comprises a pair of station trunks and in a network switch that are physically connected together. This arrangement allows an incoming call originated from an agent in a customer call center terminated at one of the station trunks such as station trunk to be continuously connected to network switch as long as the call is not disconnected by the caller i.e. the agent who initiated the call. The means for keeping incoming calls connected and the looped around circuit are collectively called the continuous connection means. During the time the incoming call is connected to continuous connection means network switch can communicate with the caller i.e. the agent at any time without the need to reestablish the telephone connection.

CTI server acts as a bridge between network switch at one end and stat server and routing server at the other end. CTI server is designed to interface with network switches manufactured by different vendors and present a uniform application program interface API to stat server and routing server . An advantage of this arrangement is that individual components in provider call station could be replaced and enhanced separately. For example substantially the same routing server and stat server could be used with network switches from different manufacturers e.g. AT T Northern Telecom or Ericsson by changing CTI server . Specifically different versions of a particular implementation of CTI server can be designed to match with switches made by different manufacturers provided that the switches have a CTI link . These versions communicate with the same routing server database server and stat server through a standard protocol which is switch independent.

In operation when an agent begins work at one of the stations in customer call center such as station he dials a predetermined telephone number which terminates at network switch . When network switch receives this call it connect the call to the continuous connection means. For the network switches that contains loop around circuit the call is connected to station trunk . As a result telephone in station is connected to network switch until the agent terminates the call. The agent can also send his identification number and other information to routing server using telephone or computer . At this time CTI system knows that station is now in operation and the identity of the agent in station . CTI system can route calls to this station. Other agents can log on to the system using the same method.

In order to illustrate an application of the present invention predictive dialing using call center architecture is described. When predictive dialing starts CPD causes network switch to dial telephone numbers from its list. CPD can be a software comprising a list manager for managing a list of phone numbers to be dialed and a dialer application. CPD is connected to data communication network . When a connection to a potential buyer is established network switch passes this information to CTI system which routes the call to one of the agents in customer call center . Because telephone connections between provider call center and the agents have previously been established network switch can immediately connect the call to the selected agent. As a result there is little delay in establishing communication between the agent and the buyer.

An important advantage of the present invention is that all call center features are centralized. As pointed out above database server and stat server contains information of the activities users and agents of the call center. This information will be centrally available. Routing server can centrally control the operation of the entire system which includes provider call center and all the customer call centers and route calls to the most qualified agent to service a call.

It should be appreciated that the above described operation can be applied to other customer call centers. Also other services in addition to predictive dialing can also be performed by network provider call center . For example the present invention can also be used by provider call center to process all inbound calls of the customer call centers. In this situation the delay in establishing communication between agents and callers may not be an overly important problem. However the ability to centralized information and operation remain an important advantage of the present invention over the prior art.

It should also be appreciated that even though CTI server routing server stat server and database server are shown as separate components they could be combined into one two or three components residing on one or more data processing devices. In one embodiment of the present invention they are implemented as a client server architecture and they can be geographically separated.

In addition to customer call centers individual stations can also use the service of the network call center. As an example shows a station having a telephone and a computer . Phone is connected to PSTN via line and computer is connected to data communication network via data connector . In operation an agent in station dials a predetermined telephone number which terminates at network switch . Switch then connects this call to station trunk . As a result telephone is connected to network switch until the agent terminates the call. Consequently the equipment and software in provider call center are available to station .

The present invention can also be applied to multiple network call centers. The data communication networks in these network call centers such as network of are connected to each other by a high speed data connector. The network switches of these call centers are connected to each other using reserved telephone connections. As a result telephone calls can be routed from one call center to another without undue delay.

The present invention comprises a novel call center architecture and related methods. The following description is presented to enable any person skilled in the art to make and use the invention. Description of specific applications is provided only as examples. Various modifications to the preferred embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

It has been found that the function performed by a standard switch is rather limited and cannot meet the requirements of a typical call center. For example it is desirable to provide information about a call to a workstation such as workstation available to each agent. The telephone and a corresponding workstation form an integral unit such as units and to serve a call. However a switch cannot search process and route data to these workstations. Consequently a new technology called computer telephony integration CTI is needed to route a combination of voice and digital data to desired places.

As a way to implement CTI call center further contains a routing subsystem connected to a CTI server which is in turn connected to switch through a CTI link . The communication between switch and server typically follows the X.25 protocol. CTI server can be considered an interfacing software which allows routing subsystem to interact in a consistent manner with switch which may be made by one of several vendors . Switch notifies CTI server when a call is received. CTI server sends the information to routing routine which selects an agent best qualified to answer the call in accordance with predetermined criteria. CTI server then notifies switch to direct the call to the telephone of the selected agent while routing subsystem directs data relating to the person placing the call to the workstation of the selected agent.

In order to facilitate data communication a communication network is used to digitally connect routing subsystem CTI server and workstation s .

As can be seen in prior art call centers contain separate switch CTI servers and routing subsystems. The problem with this architecture is that routing can only be performed locally. Thus even if there is an agent best suitable to handle a call the call cannot be routed to this agent if he she is located in another call center.

As an example to illustrate the advantages of the global call center architecture a call center may be temporarily swamped with calls and thus need to direct calls to other call centers that are relatively quiet. The global call center architecture of the present invention can direct the calls to an appropriate agent in another call center thereby fully utilizing the resources of the call centers.

Another advantage of the present architecture is that it allows different call centers to maintain specialized resources. There are good reasons why specialized resources can be better acquired by different call centers. For example call centers that are close to universities or high tech areas would be in a better position to hire agents who can provide technical information to customers. Similarly call centers located in metropolitan areas around the coastal areas would be in a better position to hire agents having foreign language skills. Thus calls which require these specialized resources but initially received by a call center located away from the above mentioned areas are likely to find the best qualified agent located in one of these call centers. The present inventions allow these calls to be routed to the best qualified agent in these specialized call centers.

Yet another advantage of the architecture shown in is that all the information can be centrally managed. As a result the information in a database can be easily updated and maintained. In contrast if each call center maintains its own database it would be difficult to enforce data integrity.

Call center contains a CTI server that is connected to switch through a CTI link . Up to this point call center is similar to call center of . However in the present architecture the routing subsystem is not considered part of the call center.

Similarly call center contains a switch and a CTI server linked by a CTI link . Switches and in call centers and respectively are connected by a tie line .

It should be noted that switch and CTI server do not have to be located in the same physical area. The present invention does not impose any condition on the length of CTI link .

Global call center contains a single stat server to gather statistical information of all the call centers. It also contains a routing server for selecting appropriate agents using data in stat server and from other databases . Stat server collects and stores historic data relating to all calls activities of switches and information and activities of all agents and telephones in all the call centers.

One aspect of the present invention is a three layer architecture in which a first layer comprises a plurality of switches and their matching CTI servers. The switches could be manufactured by different vendors. Each switch has a different capability and interface procedure. The matching CTI server is a routine which communicates and controls an associated switch one hand and at the other hand presents a common interface to the second and third layers. The second layer communicates with all the CTI servers in the first layer and all applications in the third layer. The third layer contains one or more applications which use the information contained in the second layer. In this embodiment the second layer accumulates statistics on all aspects of the operation of the call centers such as the agents and all activities of the automatic call distributors. The second layer provides this statistics to various applications in the third layer.

In a preferred embodiment various entities in a call center are associated with software objects. The following are some examples of these objects 

 a Queues and Routing Points These are hardware circuits in switches and are represented as objects. Queue implements hardware controlled ACD mechanism. Routing points sometimes called control directory number CDN can be controlled by external software applications such as a routing routine . b Agent DNs They are hardware ports in a switch and are represented as objects. Each DN is associated with one or more properties. For example some DNs can access another DN directly some DNs are associated with queues some DNs are limited to outgoing calls and some DNs have a period of unavailability after completion of a previous call. In a specific example some of the switches manufactured by Northern Telecom contain basically two kinds of DNs position and extension. Extension DNs can be accessed directly by a telephone and can initiate outgoing calls. Position DNs are associated with one or more queues. They can be accessed only through these queues and cannot initiate outgoing calls. c Agent Places They are logical spaces each containing items associated with the space e.g. one or more DNs possibly attached to different switches and workstations . In a physical implementation these places could be desks. When an agent makes login to one item in a place he she becomes logically logged in for the whole place. Each place is represented as an object and associated with a PlaceID. d Agents Persons objects identified by an AgentID. Agents can move between places dynamically. The stat server has a special routine for dynamically keeping track of the locations of all the agents. For example an agent can work from 9 00 A.M. till 13 00 i.e. 1 00 P.M. at a first place makes a logout e.g. for lunch and then makes a login at a second place at 14 00. The agent location tracking routine maintains the information so that the routing server and other applications knows which DN to dial to reach the agent. Each agent may also have a home place which is a default value if the agent cannot be dynamically tracked. e Groups A number of agents in any combination. Group objects are identified by GroupIDs. There are at least two types of groups. The first type identified herein as SObjectGroupAgents contains a list of AgentIDs. In this case the stat server tracks all agent movements and collect statistics only for included agents. Examples are groups with particular skills. The second type identified herein as SObjectGroupPlaces contains a list of agent places PlaceIDs . Examples of places in the lists are training room main office second floor etc. In this case the stat server tracks events related to places included in the list because it does not matter who works in these places.

The agent DN objects and are also included in agent place objects. In this example agent place object includes DN objects and agent place object includes DN objects and and agent place object includes DN object . It should be noted that the DNs from two different switches can be associated with the same agent place.

Some of the agent place objects can be grouped together to form place group objects. In only one place group object is shown.

Some of the agent objects can be grouped into agent group objects. In only one agent group object is shown.

Stat server provides a set of application programming interfaces APIs for its clients to obtain statistics for various objects such as objects associated with agents agent groups places place groups route points queues etc. Statistics could be current objects states representation e.g. current agent status current number of active calls in a group etc. or historical states representation. Historical representation are accumulated information for certain time intervals e.g. total number of calls total talk time average talk time etc. . Thus the clients have to specify the time interval of interest. Examples of time intervals are 

 a SFixedStartSlidingEnd The start time is fixed e.g. 9 00 A.M. while the end time is sliding e.g. till now . For example the client may request the total number of calls between 9 00 A.M. and now.

 c SFixedLengthSlidingEnd The time interval is fixed while the start and end times are sliding. Example the average call length for the past hour.

Global call center also contains a routing server for selecting agents and places and causing the switches to route calls thereto. Routing server requests statistical information on objects of interest from stat server . Routing server also has access to a separate database containing other relevant information such as information relating to customers and agents in all the call centers in global call center . Using information from stat server and database routing server selects using a software algorithm the best agent for a specific call.

As explained in the statistics of many objects are tracked by stat server . One of the reasons for creating these objects is that routing server typically requests information in the form of agents agent groups agent places and place groups. On the other hand the CTI server sends to stat server information about DNs and CDNs of their associated switches. These objects allow stat server to easily communicate with various clients that can access it.

The operation of global call center is now described using a flow chart . is used to illustrate the flow chart. In this example it is assumed that a call is received by a CDN of switch step of call center while the best suitable agent is located in call center . Instead of routing the call itself switch notifies CTI server of this event step . CTI server assigns a unique connection identification to this call call herein as the first connection ID for convenience and pass this ID together with other information about this call such as its automatic number identification ANI and if applicable dial number identification system DNIS to routing server step . The ANI uniquely identifies the telephone line which originates the call while the DNIS uniquely identifies the toll free 800 number dialed by a telephone. CTI server also notify stat server that a call has been received step The connection ID ANI DNIS and other CTI related parameters are also passed to the stat server .

Routing server then sends API commands to database to request relevant information relating to this call step . For example if a call originates from a telephone having a certain ANI routing server asks database to retrieve information about persons related to this telephone. The details of a special API structure called a status priority table is described in detail in a separate patent application entitled Method and System for Determining and Using Multiple Object States in a Computer Telephony Integration System. This table allows an application to define the priority of various states of an object e.g. the DN object . The stat server can provide statistics to the requesting application in accordance with the predefined priority.

Assuming that the retrieved information indicates that the mother tongue of the persons is French routing server tries to look for an agent who knows French. Routing server then request statistics of all agents who know French from stat server step . In step routing server selects an agent based on this statistics using a predetermined criteria e.g. how many calls have been handled by an agent the length of time an agent has been waiting for calls etc. .

In this example it is assumed that the selected agent is located in call center . Thus routing server needs to i cause the call to be routed to an appropriate DN associated with the selected agent and ii route relevant customer information from database about this call to a workstation associated with the selected agent. The method for achieving the routing is described below.

In step routing server sends a command to CTI server in call center requesting reservation of a CDN in switch . This CDN will be used to accept a call from switch . CTI server assigns a second connection ID to this upcoming call. It then sends the CDN and second connection ID to routing server step .

Upon receiving the information routing server sends a command to CTI server of call center to cause switch to transfer the call to the specified CDN of switch of call center step . This command includes the first connection ID thereby allowing CTI server to associate this command with the call of interest. Routing server also sends customer information retrieved from database to a workstation associated with the selected agent step .

Switch transfers the call to the specified CDN of switch via tie line step . Upon receiving the call switch notifies CTI server . CTI server is able to determine that this call is associated with the second connection ID because it terminates at the specified CDN. It then causes switch to route the call to the DN associated with the selected agent step . CTI server may also optionally notify routing server that routing associated with the second connection ID is completed.

As a result of the above described operations routing server can route calls to agents located in all the call centers. Consequently the resource of all the call centers can be fully utilized.

When a caller dials a telephone number that is preassigned to call center system the call shown as line in is temporarily parked at a network control point in the public switched telephone network PSTN . Network control point has the ability to route call to any one of the call centers and . Upon identifying that the called telephone number is controlled by central controller network control point notifies central controller through a network interface of the arrival of the incoming call via a communication link . Router of central controller determines the optimal routing of call using information in stat server and database . The routing decision is sent to network control point . Call centers and are connected to PSTN through telephone lines and respectively. As a result call is routed to the appropriate call center.

It should be noted that the geographic location of central controller is not important for the present invention. Thus central controller could be located inside or outside of PSTN . It could also be located inside the premise of one of the call centers.

The structure of call centers and are essentially the same. Consequently only one of the call centers is described in detail here. is a block diagram of such a call center . It contains an interface unit for communicating with central controller . It also contains a CTI server which is connected to an automatic call distributor ACD . It should be noted that a switch or private branch exchange PBX may be used. ACD could also be a switch. A number of agent stations such as stations and are located in call center . Each agent station typically contains a telephone such as and and a computer such as computer and . The telephones are connected to ACD and the computers are connected to a data bus .

After central controller determines that a call should be routed to call center network control point forwards call to ACD or a switch or PBX . If a switch is used the call could be routed to a routing point in the switch wherein routing is controlled by external software. At the same time central controller instructs CTI server to route call to a selected agent station such as . Central controller may also supply customer information to computer . Alternatively call center may optionally contain a stat server a database and a router not shown . In this case routing inside call center is performed locally. CTI server interface stat server and database communicate with each other through bus . Call center contains a number of hardware queues e.g. ACD queues and or software queues maintained by the software in call center .

Call center system will work optimally when central controller contains a complete set of information on all telephone traffic in system . However it is possible that the communication link between one or more call centers and central controller be broken for a brief duration. In a conventional system central controller will no longer route calls to these detached call centers. One aspect of the present invention is the realization that the telephone traffic behavior of a call center can be statistically estimated using historic data. As a result it is possible for central controller to determine whether the detached call centers are busy. If it is determined that the detached call centers are not busy central controller continues to instruct network control point to route calls to these detached call centers.

One function of interface unit is to update central controller of the status of call center such as the number of agents who have left the call center the status of each agent etc. This information is stored in stat server of central controller . If communication link between call center and central controller becomes broken central controller can use the status information to determine whether calls should be routed to call center . Even if the link is not broken it is preferred to estimate the status as explained below in connection with .

There are many ways to estimate telephone traffic in a call center. An exemplary algorithm for such purpose is described below. The symbols used in the algorithm are defined first.

In the above algorithm the term AC AW corresponds to the number of agents that are currently devoted to call processing activity. The term CQ corresponds to the number of calls that are waiting to be processed because these calls are in the queue. Assuming that one agent handles one call at a time this term CQ AC AW could be interpreted as a the number of agents needed to process calls already in the call center and b the number of calls that are currently being processed or need to be processed. The term A AAW corresponds to the number of agents that are not in auxiliary work and are thus presumably devoted to call processing activities. The term T UT is the time interval from the last update time to the current time. Consequently T UT AHT corresponds to the number of calls that can be handled by each agent in the call center during this time period. Thus the term T UT min CQ AC AW A AAW AHT corresponds to probable number of calls being processed or need to be processed. As a result the term under the if clause corresponds to the case where all incoming calls have been processed in time interval T UT . That is the load is very light relative to the capability of this call center. Consequently the number of busy agents and the number of calls in the queue are equal to zero.

The term under the else if clause is invoked when not all calls have been processed. However the approximate number of unprocessed calls is less than the number of available agents. If this condition occurs some of the agents are currently answering calls. However there is no unanswered calls that need to be placed in the queue because there are agents available to answer the call.

When neither the conditions in the if or the else if clause are met some calls will be placed in the queue because all available agents are busy in answering calls.

Using the above statistical model central controller can determine the capability of the detached call center to process new calls. Other information may also be needed in determining where to route a call. One piece of information is the time when the oldest call in the queue arrive OC . For example a routing strategy may not route calls to a call center where the calls in its queue has a long OC. This parameter can be estimated statistically. As an example central controller may contains a plurality of containers CADD one for each call center for recording the time of arrival of all calls processed or to be processed by the call centers. The CADD is an internal queue created and updated by central controller for use by this statistical modeling. One way to determine OC is to trace back from the newest call in the CADD a number of calls equal to CQ i.e. the number of calls in the queue . Because CQ can be determined from the above statistical model OC can also be determined from this statistical model.

Based on the above algorithm it is possible to predict how many calls a call center can accept. Consequently central controller may route calls to a call center even when no instantaneous data related to the call center is available.

The above statistical model can be used in the case where status data of each call centers can only be sent to central controller at pre assigned times. In this case this statistical model is used to estimate call behavior between the times status data is sent.

Method and Apparatus for Determining and Using Multiple Object States in a Computer Telephony Integration System 

The present invention comprises novel call center method and system. The following description is presented to enable any person skilled in the art to make and use the invention. Description of specific applications is provided only as examples. Various modifications to the preferred embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

It has been found that the function performed by a standard switch is rather limited and cannot meet the requirements of a typical call center. For example it is desirable to provide information about a call to a workstation such as workstation available to each agent. However a switch cannot search process and route data to these workstations. Consequently a new technology called computer telephony integration CTI is needed to route a combination of voice and digital data to desired places.

As a way to implement CTI call center further contains a routing subsystem connected to a CTI server which is in turn connected to switch through a CTI link . The communication between switch and CTI server typically follows the X.25 protocol. CTI server provides an interface between routing subsystem and switch . Switch notifies CTI server when a call is received. CTI server sends the information to routing subsystem which selects an agent best qualified to answer the call in accordance with predetermined criteria. CTI server then notifies switch to direct the call to the telephone i.e. DN of the selected agent while routing subsystem directs data relating to the person placing the call to the workstation of the selected agent.

In one embodiment of the present invention routing subsystem contains a stat server a routing server and a database . They communicate with one another using a data communication network . Stat server collects and stores historic data relating to all calls activities of switches and information and activities of all agents in call center . Database contains information of customers agents telephone numbers and various aspects of call center . Routing server selects appropriate agents to handle calls using data in stat server and database . After the selection routing server sends a command to CTI server which in turn instructs switch to route incoming calls to the selected agents.

There may be other CTI related applications i.e. software modules which uses the resource of database and stat server so as to provide other services or information to the agents in the call center. In two applications and are shown. Examples of applications are Agent View and Call Center View marketed by Genesys Telecommunications Laboratories. These applications are connected to data communication network .

In a call center it is common for an agent to manage more than one telephone. The equipments used by an agent is usually set up in a convenient place such as a desk called agent place in the present application. shows two exemplary agent places and . Agent place contains a workstation and two telephones and . Similarly agent place contains a workstation and two telephones and . When an agent occupies an agent place he she logs on using either a telephone or a workstation therein. Before the agent leaves the agent place he she logs out using the telephone or workstation. Consequently call center is able to keep track of the current location of each agent.

Stat server communicates with CTI server routing server and applications via a set of application programming interface API commands. Stat server working with CTI server can monitor and store activities of switch . It also monitors and stores activities of various agents and agent places. In response to inquiry by routing server and applications regarding the status of an object of interest e.g. an agent stat server provides a report to routing server . In an embodiment where one stat server is used to manage several switches which may be located in one or more call centers stat server monitors and stores activities of all the switches all the agents and all the agent places served by these switches. A detailed description of a multiple call center architecture which may use the stat server of the present invention is disclosed in a copending patent application entitled System and Method for Operating a Plurality of Call Centers filed Jan. 13 1997 and assigned to the same assignee of the present application. This patent application is incorporated herein by reference.

It is observed that most call center entities e.g. telephones and agents could simultaneously have multiple states. For example an agent telephone is designed to handle several activities at the same time. Thus the agent may use the same telephone to talk to one customer put another person e.g. a co worker on hold and waiting for an incoming call. Under prior art systems this presents a reporting problem when the stat server reports the state of the telephone to other CTI applications because it is not clear which state out of several states should be reported.

The present invention is a method and system which take advantage of the multiple states. It realizes that different CTI applications need to use state related information differently. For example a regular routing routine would consider an agent busy if he she is talking on a telephone or using a workstation to enter data. However an application which handles high priority calls e.g. emergency calls or calls from valued customers would consider the same agent available as long as he she is logged on to the agent place. This is because the agent can stop working with the workstation or place a call on hold if there is an emergency phone call. Thus the present invention allows an application to define which of the several states they wish to be informed.

An embodiment of the present invention is now described. In this embodiment various entities in a call center are associated with software objects. The following are some examples of these objects 

 a Queues and Routing Points These are hardware circuits in switches and are represented as objects. Queue implements hardware controlled ACD mechanism. Routing point sometimes called control directory number CDN can be controlled by software applications such as a routing routine . b Agent DNs They are hardware ports in a switch and are represented as objects. Each DN is associated with one or more properties. For example some DNs can access another DN directly some DNs are associated with queues some DNs are limited to outgoing calls and some DNs have a period of unavailability after completion of a previous call. In a specific example some of the switches manufactured by Northern Telecom contain basically two kinds of DNs position and extension. Extension DNs can be accessed directly by a telephone and can initiate outgoing calls. Position DNs are associated with one or more queues. They can be accessed only through these queues and cannot initiate outgoing calls. c Other specific DNs They are DNs connected to specific devices such as voice mail systems interactive voice response units etc. These DNs are represented as objects. d Agent Places They are logical spaces each containing items associated with the space e.g. one or more DNs possibly attached to different switches and workstations . In a physical implementation these places could be desks. When an agent makes login to one item in a place he she becomes logically logged in for the whole place. Each place is represented as an object and associated with a PlaceID. e Agents Persons objects identified by an AgentID. Agents can move between places dynamically. The stat server has a special routine for dynamically keeping track of the locations of all the agents. For example an agent can work from 9 00 AM till 13 00 i.e. 1 00 PM at a first place makes a logout e.g. for lunch and then makes a login at a second place at . The agent location tracking routine maintains the information so that the routing server and other applications knows which DN to dial to reach the agent. Each agent may also have a home place which is a default value if the agent cannot be dynamically tracked. f Groups A number of agents in any combination. Group objects are identified by GroupIDs. There are at least two types of groups. The first type identified herein as SObjectGroupAgents contains a list of AgentIDs. In this case the stat server tracks all agent movements and collect statistics only for included agents. Examples are groups with particular skills. The second type identified herein as SObjectGroupPlaces contains a list of agent places PlaceIDs . Examples of places in the lists are training room main office second floor etc. In this case the stat server tracks events related to places included in the list because it does not matter who works in these places.

The agent DN objects and are also included in agent place objects. In this example agent place object includes DN objects and agent place object includes DN objects and and agent place object includes DN object . It should be noted that the DNs from two different switches can be associated with the same agent place.

Some of the agent place objects can be grouped together to form place group objects. In only one place group object is shown.

Some of the agent objects can be grouped into agent group objects. In only one agent group object is shown.

Stat server provides a set of APIs for its clients to obtain statistics for various objects such as objects associated with agents agent groups agent places place groups route points queues etc. Statistics could be current objects states representation e.g. current agent status current number of active calls in a group etc. or historical states representation. Historical representation are accumulated information for certain time intervals e.g. total number of calls total talk time average talk time etc. . Thus the clients have to specify the time interval of interest. Examples of time intervals are 

 a SGrowingWindow The start time is fixed e.g. 9 00 AM while the end time is sliding e.g. till now . For example the client may request the total number of calls between 9 00 AM and now.

 b SSlidingWindow The time interval is fixed while the start and end times are sliding. Example the average call length for the past hour.

Returning now to the description of objects each object has one or more states. In one embodiment of the present invention agent DN objects may have the states shown in Table 1. It should be noted that the number and nature of states are implementation details and thus can easily be changed by persons skilled in the art.

The above listed states correspond to actions that can be executed by an agent DN. As mentioned above an agent DN could be in a plurality of these states at the same time called herein the active states . In one embodiment of the present invention the stat server of the present invention reports to its clients an agent DN status that is equal to the active state having the highest priority. In the present invention the priority is set by the clients of the stat server. This is accomplished by the client sending a status priority table SPT to the stat server as part of the parameters in requesting information on the status of an agent DN. This table contains the same states shown in the listing of Table 1 such that these states are arranged in a priority order defined by that client. In reporting to the client the stat server reports a status corresponding to the active state of the agent DN having the highest priority as defined in the received SPT. It should be noted that the reported status could be the active state that corresponds to other priorities on the SPT. If the client requesting the information does not provide a SPT a default SPT is used. Further the client may provide a different SPT at separate requests for information.

One advantage of this aspect of the present invention is that each client can obtain information it deems to be the most pertinent. In the prior art system the stat server reports only one status for an agent DN to all the clients that request the information. In the present invention the stat server can report different status for the same agent DN to different clients depending on the SPT parameters sent by the clients. Because each client receives the information it wants the resource of the call center can be better utilized.

As pointed out above each agent may has access to two or more telephones i.e. agent DNs . In this case the client may define an agent SPT indicating the priority of the actions in both agent DNs.

As an example it is assumed that an agent has access to two agent DNs the first DN has a state of OfflineWorkType1 and the second DN has a state of WaitForNextCall. The status of the agent reported to the client is OfflineWorkType1 if it has a higher priority. As another example a client e.g. routing server of the stat server may consider the status of an agent to be WaitForNextCall when all the agent DNs associated with the agent have the WaitForNextCall state. This corresponds to the case when the agent is not actively performing any call center related activity e.g. answering a call or using the workstation and as a result all the agent DNs are not being used and are waiting for a call. This priority arrangement is achieved by putting WaitForNextCall as the action having the lowest priority in an agent SPT. However if there is a special or urgent call routing server may want to consider the status of the agent to be WaitForNextCall when there is at least one agent DN associated with the agent having the WaitForNextCall status. This corresponds to the case when the agent has access to at least one phone that is not being used. This priority setting is achieved by putting WaitForNextCall as the highest priority in the agent SPT.

In one embodiment of an agent SPT the priority of the states are listed sequentially and separated by a comma with the lowest priority listed first. The agent SPT with a lowest priority for WaitForNextCall would be WaitForNextCall . . . other states . On the other hand the agent SPT with a very high priority for WaitForNextCall would be . . . WaitForNextCall LoggedOut . In this case the highest priority is LoggedOut and the priority just below it is WaitForNextCall .

Agents can be arranged in groups. Group status is based on all included agent statuses. It is determined by a Group SPT which is similar to the Agent SPT and DN SPT. As an example a Group SPT of . . . WaitForNextCall means that the group will be in WaitForNextCall if there is at least one WaitForNextCall agent status.

Routing points and queues can also report different status to different clients in respond to different SPTs. The states of an exemplary routing point queue are shown in table 2.

In one embodiment of the present invention there are two main calls that allow clients to obtain statistics from the stat server. The first call is SGetStat. This call requests the stat server to return statistics of interest only once. The second call is SOpenStat. It means that the client is interested in receiving statistics on a continuous basis. The client can further set up various criteria for the stat server to notify the client and report statistics. For example the client can specify that notification takes place only when the new value is greater than the last reported value by a predefined percentage. Alternatively the client can specify that notification takes place at predefined time intervals.

One of the parameters of the SGetStat and SOpenStat calls relates to the SPT. In one embodiment of the present embodiment the parameters for each of these calls contain a pointer to a data structure having a number of optional fields. The SPT for agent DN agent group and routing point queue each occupies one of these optional fields. Thus an application can define the appropriate SPTs and incorporate them in the data structure. This data structure is used to invoke the SGetStat and SOpenStat calls.

In an embodiment in which multiple switches are monitored by the same stat server the above mentioned calls also contain a parameter allowing the client to indicate the switch of interest.

The present invention comprises a novel routing system for electronic mails and related methods. The following description is presented to enable any person skilled in the art to make and use the invention. Decryption of specific applications is provided only as examples. Various modifications to the preferred embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and cope of the invention. Thus the present invention is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

As an example it is assumed that one of the addresses associated with e mail server is support abc company.com . This is an address for customers of a company named ABC to send in questions regarding products and services provided by the company. It is anticipated that the subject matters of the e mails are diverse and the number of mails is large. For example the e mails may relate to all aspects of the products and services offered by ABC. Some of the e mails may contain technical questions of a product. Other e mails may report a bug in a software sold by ABC. A few e mails may contain suggestions on improving the products and services. If support persons of ABC are assigned to answer some of the e mails on a first come first serve basis it would be very difficult for them to do so because it is almost impossible for a single person to know everything about ABC.

One aspect of the present invention is a system for automatically routing the e mails to the most qualified and available support person. For example a support person may be an expert in one product of ABC. All e mails related to this product will be routed to this person automatically. Further the system can distribute the load so that every support person receives approximately the same number of e mails. As a result the problems of the prior art systems can be solved.

Note that the criteria for determining whether a support person is available is not limited to e mail activities. This is because the same support person may provide telephone and facsimile support to customer inquiries. Thus the availability of a support person may involve a combination of activities involving telephone facsimile e mail data processing etc.

Processing center contains a server that records all activity in the center. For example it contains records of who are present in the center a particular time and are available for service as well as records of all e mails that are pending and have been processed by center . Server is called herein as the stat server. It should be noted that many types of information can be reorder and the choice of information is determined on a case by case basis.

Processing center also contains a database that contains detailed information on each support person products and customers. Information of support persons includes the skill set e.g. product expertise written language ability and prior relationship with customers. Information of customers bases on the incoming e mail address includes the content of their previous e mails the products they bought their physical addresses obtained from product registration information etc.

Processing center also contains a router . This router selects the most qualified and available support person to respond to a particular e based on one or more algorithms or scripts . Various factors in a routing strategy will be described below.

In one embodiment of the present invention database router and stat server could be a database router and stat server commonly used in telephony call centers. The advantage of this embodiment is that database router and stat server software for telephony applications are well developed and widely available. The use of existing software or slightly modified versions could speed up product development time. In telephony applications a server is used to provide computer telephony integration CTI by controlling an automatic call distributor a telephony hardware device for controlling telephone communication between the public telephone networks and telephones inside a call center and communicating with a database router and stat server. This server is call herein the CTI server. One of the functions of the CTI server is allowing automatic call distributors of different vendors to be used with the same database router and stat server.

In this embodiment a CTI server and an e mail to CTI server adapter is preferably included. As explained above CTI server provides a common interface for communicating with database router and stat server via a digital communication network . Because these software products are based on telephony applications some of the attributes used therein may not be exactly the same as that used in e mail applications. For example the attribute of telephone number in telephony application is not used in e mail applications. Similarly the e mail attribute of sender s e mail address may not be recognizable in telephony applications. These two attributes have similar characteristics and can be used interchangeably provided that they are formatted and used properly. One of the functions of adapter is to provide conversion between e mail attributes and telephony attributes.

Adapter contains a formatter for formatting the relevant information into attributes that can be understood by CTI server . As an example the sender s e mail address could be formatted as a caller s telephone number which is a telephony attribute . The formatted attribute is sent to a data communication interface which communicates the attributes to CTI server via communication network .

Adapter also contains a deformatter that accepts data and commands from CTI server and translate them to a form understood by e mail server . As explained below router may send via CTI server commands to e mail server .

Processing center contains a number of computer terminals such as computers and managed by support persons. When a support person starts to work he she logs in so that stat server knows who is working in center and how to reach the support person.

Router obtains information to make selection decision from stat server and database . Once a decision is made router sends a command to e mail server to route the e mail to the selected computer terminal. The support person responds to the e mail and sends the reply to e mail server which delivers the reply to the sender via data network .

A flow chart showing the operation of e mail processing enter is shown in . In step e mail server receives an e mail. The e mail is forwarded to e mail to CTI server adapter . In step adapter extracts e mail attributes in accordance with pre configured rules embodied in extraction algorithm . It also sends status information and formulates requests to CTI server using appropriate extracted attributes. In step CTI server forwards the request and status information to router and stat server . In step router retrieves information from stat server and database so as to make routing decision. In step router instructs e mail server to route the e mail to the computer terminal used by a selected support person such as computer . Because the instructions from router may be coded in telephony related commands these instructions may need t pass through CTI router deformatter and e mail interface . Upon receiving the e mail the support person processes the e mail using computer . If there is a need to send a reply the support person writes the reply step and directs e mail server to deliver the reply to a recipient connected to data network step .

In addition to providing basic routing function router may also have a strategy to handle exception situations. For example if an incoming mail is not answered by the selected support person within a predetermined time interval e.g. three days the mail is re routed to another qualified and available support person. This strategy prevents mails from being dropped. As another example there may be times when the number of incoming mails exceeds the available resource to answer these mails i.e. overflow . Router could store these mails in a queue and direct e mail server to alert senders that it may take a little longer to receive a reply.

It should be noted that if router stat server and database are designed strictly for e mail applications there is not need to have CTI server formatter and deformatter . In this case router stat server and database can communicate with e mail server and information extractor directly.

In all of the embodiments and aspects of the invention described above specific example have been drawn principally from the technological area of conventional intelligent telephony networks other than what is now known as Internet protocol network telephony IPNT wherein computers simulate telephones through software microphones and speakers and telephony data between such equipped computers is transmitted over Internet and sometimes other data networks such as Intranets connections and directed by servers such as destination number servers DNS in the Internet. In the IPNT world IP addresses are used instead of telephone numbers and there are differences in the way data packets are formulated and transmitted. Moreover what may be termed routing is done by such as IP switches and hubs wherein destination addresses may be changed. These differences however are not limiting in embodiments of the present invention.

In many embodiments of the invention described the inventions are involved with new and unique ways to use machine intelligence for telephony functions particularly but not exclusively as these functions relate to call centers and intelligent routing of calls. In instances of the invention described as will be readily apparent to those with skill in the art the principles of the invention may also be applied to IPNT without undue experimentation.

As examples of IPNT application in those embodiments dealing with personal routing and personal routers the methods and apparatus described may also be adapted to IPNT so personal routing rules negotiation and the like may be provided for IPNT calls as well. In the aspects of the invention dealing with simulation of CTI applications and testing the applications may apply to IPNT telephony as well as to more conventional telephony systems. Other examples will be apparent to those with skill in the telephony arts.

It will be apparent to those with skill in the art that there are many alterations that may be made in the embodiments of the invention herein described without departing from the spirit and scope of the invention. Some of these have been described above

Many of the functional units of the system in embodiments of the invention may be implemented as code routines in computerized telephony equipment computer servers and individual workstations. It is well known that programmers are highly individualistic and may implement similar functionality by considerably different routines. Also the invention may be applied to widely varying hardware systems. Further hardware used to practice the invention may vary in many ways. There are similarly many other alterations in the embodiments described herein which will fall within the spirit and scope of the present invention in it s several aspects described. The invention is limited only by the breadth of the claims below.

