---

title: Call transfer using session initiation protocol (SIP)
abstract: A system is provided for providing communication event routing and transfer capability in a multi-site communication-center environment. The system utilizes a presence protocol application and a routing application for determining availability of an agent or system and for setting up the transfer from a point of transfer on a network to a destination of transfer on the same or connected network. In a preferred use the presence protocol application is shared by communication-center sites cooperating in the transfer and routing of events and the presence protocol enables at least one event-handling process normally performed by the routing application.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09042372&OS=09042372&RS=09042372
owner: GENESYS TELECOMMUNICATIONS LABORATORIES, INC.
number: 09042372
owner_city: Daly City
owner_country: US
publication_date: 20071030
---
The present invention is a continuation of patent application Ser. No. 11 257 896 filed Oct. 24 2005 which is a continuation of patent application Ser. No. 10 242 250 filed on Sep. 11 2002 and issued as U.S. Pat. No. 6 958 994 on Oct. 25 2005 which claims the benefit of Provisional Patent application No. 60 389 703 filed Jun. 17 2002. A document disclosure in the DD program number 496199 dated Jun. 19 2001 was filed in case 09 927 301.

The present invention is in the field of telephony communication and pertains more particularly to methods and apparatus for using session initiation protocol SIP in site to site communication event transfers.

In the field of telephony communication there have been many improvements in technology over the years that have contributed to more efficient use of telephone communication within hosted call center environments. Most of these improvements involve integrating the telephones and switching systems in such call centers with computer hardware and software adapted for among other things better routing of telephone calls faster delivery of telephone calls and associated information and improved service with regards to client satisfaction. Such computer enhanced telephony is known in the art as computer telephony integration CTI .

Generally speaking CTI implementations of various design and purpose are accomplished both within individual call centers and in some cases at the network level. For example processors running CTI software applications may be linked to telephone switches service control points SCP and network entry points within a public or private telephone network. At the call center level CTI enhanced processors data servers transaction servers and the like are linked to telephone switches and in some cases to similar CTI hardware at the network level often by a dedicated digital link. CTI and other hardware within a call center are commonly referred to as customer premises equipment CPE . It is the CTI processor and application software at such centers that provides computer enhancement to a call center.

In a CTI enhanced call center telephones at agent stations are connected to a central telephony switching apparatus such as an automatic call distributor ACD switch or a private branch exchange PBX . The agent stations may also be equipped with computer terminals such as personal computer video display unit s PC VDU s so that agents manning such stations may have access to stored data as well as being linked to incoming callers by telephone equipment. Such stations may be interconnected through the PC VDUs by a local area network LAN . One or more data or transaction servers may also be connected to the LAN that interconnects agent stations. The LAN is in turn connected to the CTI processor which is connected to the call switching apparatus of the call center.

When a call arrives at a call center whether or not the call has been pre processed at an SCP typically at least the telephone number of the calling line is made available to the receiving switch at the call center by the network provider. This service is available by most networks as caller ID information in one of several formats such as Automatic Number Identification Service ANIS . If the call center is computer enhanced CTI the phone number of the calling party may be used to access additional information from a customer information system CIS database at a server on the network that connects the agent workstations. In this manner information pertinent to a call may be provided to an agent often as a screen pop.

In recent years advances in computer technology telephony equipment and infrastructure have provided many opportunities for improving telephone service in publicly switched and private telephone intelligent networks. Similarly development of a separate information and data network known as the Internet together with advances in computer hardware and software have led to a new multi media telephone system known in the art by several names. In this new systemology telephone calls are simulated by multi media computer equipment and data such as audio data is transmitted over data networks as data packets. In this application the broad term used to describe such computer simulated telephony is Data Network Telephony DNT .

For purposes of nomenclature and definition the inventors wish to distinguish clearly between what might be called conventional telephony which is the telephone service enjoyed by nearly all citizens through local telephone companies and several long distance telephone network providers and what has been described herein as computer simulated telephony or DNT. The conventional system is familiar to nearly all and is often referred to in the art as connection oriented switched telephony COST . The COST designation will be used extensively herein. The computer simulated or DNT systems are familiar to those who use and understand computer systems. Perhaps the best example of DNT is telephone service provided over the Internet which will be referred to herein as Internet Protocol Network Telephony IPNT by far the most extensive but still a subset of DNT.

Both systems use signals transmitted over network links. In fact connection to data networks for DNT such as IPNT is typically accomplished over local telephone lines used to reach such as an Internet Service Provider ISP . The definitive difference is that COST telephony may be considered to be connection oriented telephony. In the COST system calls are placed and connected by a specific dedicated path and the connection path is maintained over the time of the call. Bandwidth is thus assured. Other calls and data do not share a connected channel path in a COST system. In a DNT system on the other hand the system is not dedicated or connection oriented. That is data including audio data is prepared sent and received as data packets. The data packets share network links and may travel by variable paths being reassembled into serial order after receipt. Therefore bandwidth is not guaranteed.

Under ideal operating circumstances a DNT network such as the Internet has all of the audio quality of conventional public and private intelligent telephone networks and many advantages accruing from the aspect of direct computer to computer linking. However DNT applications must share the bandwidth available on the network in which they are traveling. As a result real time voice communication may at times suffer dropout and delay. This is at least partially due to packet loss experienced during periods of less than needed bandwidth which may prevail under certain conditions such as congestion during peak periods of use and so on.

Recent improvements to available technologies associated with the transmission and reception of data packets during real time DNT communication have enabled companies to successfully add DNT principally IPNT capabilities to existing CTI enhanced call centers. Such improvements as described herein and known to the inventor include methods for guaranteeing available bandwidth or quality of service QoS for a transaction improved mechanisms for organizing coding compressing and carrying data more efficiently using less bandwidth and methods and apparatus for intelligently replacing lost data by using voice supplementation methods and enhanced buffering capabilities.

In typical call centers DNT is accomplished by Internet connection and IPNT calls. For this reason IPNT and the Internet will be used almost exclusively in examples to follow. It should be understood however that this usage is exemplary and not limiting.

In systems known to the inventors incoming IPNT calls are processed and routed within an IPNT capable call center in much the same way as COST calls are routed in a CTI enhanced center using similar or identical routing rules waiting queues and so on aside from the fact that there are two separate networks involved. Call centers having both CTI and IPNT capability utilize LAN connected agent stations with each station having a telephony switch connected headset or phone and a PC connected in most cases via LAN to the LAN over which IPNT calls may be routed. Therefore in most cases IPNT calls are routed to the agent s PC while conventional telephony calls are routed to the agent s conventional telephone or headset. However a method known to the inventor allows one headset to be used at an agent s station for handling both IPNT and COST calls. This is accomplished via connecting the agent s telephone to the sound card on the agent s PC VDU with an I O cable. In most prior art and current art systems separate lines and equipment must be implemented for each type of call weather COST or IPNT.

Due in part to added costs associated with additional equipment lines and data ports that are needed to add IPNT capability to a CTI enhanced call center companies are currently experimenting with various forms of integration between the older COST system and the newer IPNT system. For example by enhancing data servers interactive voice response units IVRs agent connecting networks and so on with the capability of understanding Internet protocol data arriving from either network may be integrated requiring less equipment and lines to facilitate processing storage and transfer of data. However telephony trunks and IPNT network lines representing the separate networks involved still provide for significant costs and maintenance.

In some current art implementations incoming data from the COST network and the Internet is caused to run side by side from the network level to a call center over a telephone connection T1 E1 acting as a telephone data bridge wherein a certain channels are reserved for COST connection and this portion is dedicated as is necessary in COST protocol connection oriented and the remainder is used for DNT such as IPNT calls and for perhaps other data transmission. Such a service is generally offered by a local phone company. This service eliminates the requirement for leasing numerous telephony trunks and data network connections. Routing and other equipment however must be implemented at both the call center level and network level significantly reducing any realized cost savings.

A significant disadvantage of such a bridge having dedicated equipment on each end is the dedicated nature of individual channels over the bridging link. Efficient use of bandwidth cannot be assured during variable traffic conditions that may prevail at certain times. For example dedicated channels assigned to IPNT traffic would not be utilized if there were not enough traffic to facilitate their use. Similarly if there was more COST traffic than the allotted number of COST channels could carry no additional channels could be made available.

In a yet more advanced system known in some call centers a central switch within the call center is enhanced with IP conversion capability and can communicate via LAN to connected IP phone sets and PC s eliminating the need for regular telephone wiring within a call center. However the service is still delivered via a telephone data bridge as described above. Therefore additional requirements for equipment and inefficiency regarding use of bandwidth are still factors.

In still other systems known to the inventor IPNT to COST conversion or COST to IPNT conversion is performed within the call center instead of via a network bridge. This is accomplished via a gateway connected to both an IPNT router and a central telephony switching apparatus. In the first case all calls are converted to and routed as COST calls over internal telephone wiring to switch connected headsets. In the second case all COST calls are converted to and routed as IPNT calls over a LAN to individual PC VDU s.

In all of the described prior art systems the concerted goal has been to integrate COST and IPNT data via converging at the network level or within the call center. The addition of dedicated hardware both at the network level and within the call center adds to the expense of providing such integrated data.

In a system known to the inventor and described with reference to Ser. No. 09 160 558 listed in the cross reference section of this specification an integrated router is provided within a call center. The integrated router monitors and controls both a telephony switch receiving and forwarding connection oriented switched telephony COST calls and a Data Network Telephony DNT processor receiving and forwarding DNT calls. The integrated router is enabled by software to consult a common data repository storing status of agents answering both types of calls within the center and routes all calls according to a single set of routing rules which can take a variety of forms. In one aspect telephone devices at agent stations are adapted to handle both COST and DNT calls.

It has occurred to the inventor that in addition to being able to unify all routed events within a communication center under a common set of rules it would be desirable to adapt established IP network protocols for use as routing tools within a communication center for the purpose of saving time and costs of developing proprietary protocols and expensive client applications using them.

One standard Internet based protocol that may be adapted for communication center use is the well known session initiation protocol SIP . Very basically SIP is an application layer control signaling protocol for creating modifying and terminating communication sessions with one or more participants. These sessions include Internet multimedia conferences Internet telephone calls and multimedia distribution. Members in a session can communicate via multicast or via a mesh of unicast relations or a combination of these.

A SIP session can include both persons and automated systems such as a media storage service. A SIP session can include both unicast and multicast sessions. A session initiator does not necessarily have to be a member of an initiated session to which SIP is used to initiate. SIP transparently supports name mapping and redirection services allowing the implementation of ISDN and Intelligent Network telephony subscriber services. These facilities also enable personal mobility.

In the parlance of telecommunications intelligent network services personal mobility is defined as the ability of end users to originate and receive calls and access subscribed telecommunication services on any terminal in any location and the ability of the network to identify end users as they move. Personal mobility is based on unique identification numbering and compliments terminal mobility which enables an end terminal to be moved from one sub net to another.

SIP is designed as part of the well known IETF multimedia data and control architecture which is currently incorporating protocols such as RSVP for reserving network resources the real time transport protocol RTP for transporting real time data and providing QoS feedback the real time streaming protocol RTSP for controlling delivery of streaming media the session announcement protocol SAP for advertising multimedia sessions via multicast and the session description protocol SDP for describing multimedia sessions.

It is known to the inventors that SIP can be used in conjunction with other call setup and signaling protocols. In this mode an end system uses SIP exchanges to determine the appropriate end system address and protocol from a given address that is protocol independent. For example SIP could be used to determine that the party can be reached via H.323 obtain the H.245 gateway and user address and then use H.225.0 to establish a call for example. In another example SIP might be used to determine that a call recipient is reachable via the PSTN and indicate the phone number to be called possibly suggesting an Internet to PSTN gateway to be used.

A software suite is known to the inventor for routing communication events over a data packet network using an IP session initiation and signaling protocol. The software suite is described with reference to U.S. patent application Ser. No. 09 927 301 listed in the cross reference section above.

The software suite comprises a server application for computing and serving routing determinations per request a session management application for initiating and managing routed and established session events a parsing application for parsing request data received under session initiation protocol and a conversion application for converting data received under session initiation protocol into a routing request. All received communication requests for routing are in the form of the session initiation protocol wherein they are parsed and converted into routing requests processed by the server application and routed to determined destinations. In practice events are established as session events conducted under the session initiation and management protocol.

The system above is used chiefly within a communication center and uses a proxy server to manage conversion between SIP protocol and T server routing protocol. It has occurred to the inventor that many organizations that host communication centers host multiple center sites both based in telephony and data networks. It would be desirable to enable seamless communication event transfers including final destination routing between two or more sites that are network connected using unmodified standard protocols including SIP and instant message IM based protocols.

What is therefore clearly needed is a routing system that can transfer communication events seamlessly among multiple communication sites including final agent level routing of those events using standard SIP and IM based protocols and preserving complex routing protocols for final agent level routing within the center site that is the destination for the transfer.

In a preferred embodiment of the invention a system for providing communication event routing and transfer capability in a multi site communication center environment is provided comprising a presence protocol application a routing application a point of transfer on a network and a destination of transfer on the same or connected network. The system is characterized in that the presence protocol application is shared by communication center sites cooperating in the transfer and routing of events and wherein the presence protocol performs at least one event handling process normally performed by the routing application.

In a preferred embodiment of the invention the presence protocol is Session Initiation Protocol. In another embodiment the presence protocol is Instant Messaging and Presence Protocol. In some cases the presence protocol includes Session Advertisement Protocol and Session Description Protocol. Also in some cases the routing protocol is T server protocol.

In some embodiments the point of transfer is a telephony switch. Also in some embodiments the destination of transfer is also a telephony switch. In some other embodiments the destination of transfer is an IP capable device in an agent workstation.

In some embodiments there is a communication server shared by at least two of the multiple communication center sites and the communication server may be hosted on one of the Internet an Ethernet or on a Virtual Private Network. In some of these embodiments the presence protocol is Session Initiation Protocol.

In another aspect of the invention a method for transferring a telephony communication event from one communication center site switch to another is provided comprising steps of a receiving an event at a first telephony switch at a first site b determining that the event requires transfer to a second identified telephony switch at the location of a second site c sending a request in the form of a presence protocol message to a processor controlling the switch at the second site d receiving at a processor controlling the switch at the first site a response in the form of a presence protocol message giving permission for the transfer and e executing the call transfer.

In some embodiments in step a the event is a COST telephone call and the switch is a CTI enabled telephony switch. Also in some embodiments in step b determination of transfer requirement is established through IVR interaction with the caller. Still further in step c the presence protocol may be Session Initiation Protocol. In other cases in step c the presence protocol may be Instant Messaging and Presence Protocol.

In some embodiments in steps c and d a request and response interaction also occurs using a routing protocol for exchanging information not handled in the presence protocol request response interaction. In some cases at least one event handling process is event notification of the event for transfer and in some cases at least one event handling process is the process of reporting availability of an agent representing the final destination for the transferred event.

In telecommunications network comprises a publicly switched telephone network PSTN the Internet network and a call center . PSTN network may be a private network rather than a public network and Internet may be another public or a private data network as are known in the art.

In this basic prior art example call center is equipped to handle both COST calls and IPNT calls. Both COST calls and IPNT calls are delivered to call center by separate network connections. For example a telephony switch in the PSTN may receive incoming telephone calls and rout them over a COST network trunk to a central switching apparatus located within call center . IPNT calls from Internet are routed via a data router over a data network connection to an IPNT router within call center . In this example network switch is meant to represent a wide variety of processing and switching equipment in a PSTN and router is exemplary of many routers and IP switches in the Internet as known in the art.

Call center further comprises four agent stations and . Each of these agent stations such as agent station for example comprises an agent s telephone adapted for COST telephone communication and an agent s PC VDU adapted for IPNT communication and additional data processing and viewing. Agent s telephones and along with agent s PC VDU and are in similar arrangement in agent stations and respectively. Agent s telephones such as agent s telephone are connected to COST switching apparatus via telephone wiring .

A LAN connects agent s PC VDU s to one another and to a CPE IPNT router . A client information system CIS server is connected to LAN and provides additional stored information about callers to each LAN connected agent. Router routes incoming IPNT calls to agent s PC VDU s that are also LAN connected as previously described. A data network connection connects data router to data router located in Internet . Specific Internet access and connectivity is not shown as such is well known in the art and may be accomplished in any one of several ways. The salient feature to be emphasized in this prior art example is that separate connections and equipment are necessary and implemented to be able to handle both COST and IPNT calls at the call center.

Each agent s PC VDU such as PC VDU has a connection via LAN and data network connection to Internet while the assigned agent is logged on to the system however this is not specifically required but rather preferred so that incoming IPNT calls may be routed efficiently. Dial up connecting rather than a continuous connection to Internet may sometimes be employed.

An agent operating at an agent station such as agent station may have COST calls arriving on agent s telephone while IPNT calls are arriving on agent s PC VDU . In examples prior to this example router would not have a connection to central switching apparatus . Having no such connection creates a cumbersome situation requiring agents to distribute their time as best they can between the two types of calls. Thus agent time is not utilized to maximum efficiency with respect to the total incoming calls possible from both networks.

In this embodiment however router is connected to an IPNT to COST gateway via data connection . Gateway is connected to central switch via CTI connection . Gateway is adapted to convert all incoming and outgoing IPNT calls to COST calls where they may be routed over wiring to agents incoming or over trunk to switch in cloud outgoing . In this way agents may use switch connected telephones such as telephone to answer both IPNT to COST converts and regular incoming COST calls. The agent s time is better utilized and additional network equipment comprising a network bridge and associated network connections are not required.

This prior art example however presents some problems and limitations. One problem is that traditional COST equipment such as routers switches and wiring may have to be significantly expanded to handle more traffic regarding the added call load received from cloud . Further the ability to predict possible call overload situations is significantly complicated because of the convergence of IPNT calls into the COST routing system. As IPNT calls are now received by agents as COST calls certain features inherent to IPNT applications will be lost such as multimedia enhancements and the like.

One advantage with this example is that calls originating as IPNT calls within call center may be sent as IPNT calls over data connection or as converted COST calls over trunk . Another advantage is that LAN is free to carry data other than IPNT audio packets.

Call center receives COST calls from cloud over trunk and IPNT calls from cloud over data connection as described with the prior art example of . However instead of having a central telephony switch such as switch of a COST to IPNT gateway is provided and adapted to convert COST calls to IPNT calls.

After converting incoming COST calls to IPNT calls these are routed via data connection to an IPNT switch . IPNT switch is adapted to distribute the resulting IPNT calls to selected agents over LAN . Regular IPNT calls are routed to LAN connected agents via router .

Agent s telephones are in this example adapted as IP phones and are each connected to LAN . Internal wiring and other COST related architecture is not required which is one distinct advantage of this prior art system.

A disadvantage of this system is that there is no provision to make outbound calls to the PSTN . Only further enhancement to gateway to convert IPNT calls to COST calls enables out bound dialing to PSTN from within call center . Under heavy call load situations a dual gateway such as would be the case with gateway may become congested and cause delay. Additional apparatus may be required to alleviate this problem. In some cases wherein there are concerted outbound campaigns taking place on a frequent basis it may be more prudent to maintain a COST switch and internal wiring within call center connected to either agent telephones maintaining dual capability or to add a second set of telephones dedicated for outbound campaigns. Moreover agents are reintroduced with a problem solved in the example of of having to deal with incoming calls to both IP phones and PC VDU s.

According to a preferred embodiment of the present invention call center receives COST and IPNT calls from their respective separate networks comprising telecommunication system . Call center is in this example enhanced with an integrated router IR capable of routing both COST calls and IPNT calls. Central switch is connected via CTI link to a processor running instances of a CTI application known to the inventors as T server and Stat server TS STAT . An intelligent peripheral in the form of an IVR is connected to processor via data link . Processors and IVR provide CTI enhancement to switch as well as an application programming interface API to IR via installed software.

It will be apparent to the skilled artisan that processor IVR and IR may be implemented in a single computing machine executing all of the necessary software but the functions have separated here for clarity in description.

A multimedia data server MIS is connected to LAN and is adapted to store and serve certain multimedia content as known in the art. Switch and Router are maintained as call arrival points for calls arriving from either PSTN or Internet adhering to the separate network architecture previously described.

IR performs in an innovative manner in that it not only controls central switch through interaction with processor and therefore routing of COST calls but also controls processor and the routing of IPNT calls. IR controls routing of both COST and IPNT calls whether such calls are incoming or outgoing.

An agent status table is a real time database containing agent availability information which is continually updated as operation of the call center proceeds. Table may reside in IR as shown or may reside on processor as part of the T Server software. Table keeps track of when agents log on or off to the system and which agents are busy on calls either COST or IPNT . It will be appreciated that any combination of rules set by the company hosting center may be in place such as priority routing routing based on skill statistical routing and so on in various combinations known to the inventors.

Integrated routing as provided by IR allows calls of both types COST IPNT to be distributed evenly among available agents without adding expensive call conversion equipment or effecting outbound dialing capabilities.

Yet another improvement in this example over prior art systems is known to the inventor and implemented at some or all agent stations such as stations . As briefly described with reference to the background section agent stations have PC connected telephones. An I O cable completes this interface via connection from a telephone receiver transceiver apparatus such as on telephone to a sound card installed on an associated PC such as PC VDU . Individual one s of headsets such as headsets a d are connected either to each telephone or each PC VDU and are adapted to allow an agent to engage both COST and IPNT calls using the same headset.

It will be apparent to one with skill in the art that the integrated routing system of the present invention may be utilized in any call center capable of receiving both COST and IPNT or other DNT communication. It will also be apparent to one with skill in the art that the present invention may implemented as part of a CTI software package or held separately and integrated with such a CTI implementation.

In another aspect of the present invention the inventor provides a mechanism for incorporating SIP protocol as a call management tool within a communication center. The methods and apparatus of the invention are described in enabling detail below.

PSTN can be another type of COST telephone network as may be known in the art such as a private telephone network. A local telephony switch LSW is provided within PSTN and adapted as a switch that is local to communication center . Switch may be an ACD type or PBX type telephony switch as well as other known types. It will be appreciated by the skilled artisan that there will be many other switches service control points and other telephony equipment connected within PSTN . In this simple example only switch is illustrated and deemed sufficient for the purpose of describing the present invention.

CTI equipment not shown such as a CTI processor including IVR capability and a Stat Server may be assumed to be present within PSTN and connected to LSW in cases of network level routing. In such a case a separate network would exist from the described equipment in the PSTN to similar equipment implemented within center .

Internet network comprises an Internet backbone extending there through and a backbone connected Internet server that is adapted in this case as an Internet access point for IPNT callers attempting to reach communication center . Server is adapted to serve HTML electronic documents or electronic documents presented in other mark up languages some of which depend on protocols used by connecting end devices. WML HDML and other well known protocols are exemplary of several that may be employed at server . Backbone represents all of the lines equipment and connection points making up the Internet network as a whole. Therefore there are no geographic limitations to the practice of the present invention.

Backbone is illustrated in this example as extending toward PSTN . In some embodiments calls may travel back and forth between PSTN and Internet through a bridge or gateway not illustrated in this example . Internet server is adapted as a customer access point to communication center as previously described. A user represented herein by a PC icon labeled is illustrated in this example as connected to Internet backbone by an Internet access path . Therefore user has accessibility when connected to Internet server for the purpose of establishing communication with communication center over backbone .

User may establish Internet access with Internet server using a variety of well known Internet access methods. Typically user would access server using a dial up modem technology through an Internet service provider ISP as is most common in the art. In other embodiments user may access via a cable modem connection a wireless satellite connection an integrated service digital network ISDN and so on. Although an ISP is not explicitly illustrated in this example one such may be assumed to be present and operable between user and network as is well known in the art. Actual access would take place through network in the case of dial up services.

Communication center represents a state of art center capable of integrating COST events with DNT events under a common set of routing rules. A central telephony switch SW is provided within communication center and adapted as a central office switch for routing COST communication events within the communication center and in some cases to remote agents. SW is connected to LSW within PSTN by at least one telephony trunk . Switch may be an ACD or PBX type switch as well as other known types as was described further above with reference to switch . Switch represents an incoming routing point for all incoming COST events into center .

Communication center has a LAN provided therein and adapted for TCP IP and other applicable Internet protocols. LAN is chiefly used in this example to provided network capability for connected agents automated systems and other equipment that is further described below.

In this example there are two illustrated workstations a and N within center that are connected to LAN for network communication. It will be appreciated that there will typically be many more than 2 workstations connected to LAN as noted by the A N designation in a communication center. Each workstation A N is at least adapted with a PC and a telephone in this embodiment. In workstation there is illustrated a PC connected to LAN and a PC connected IP phone . In workstation there is illustrated a LAN connected PC and a connected IP phone . There may be more equipment types provided in and operational in a workstation that are not illustrated in this embodiment including facsimile stations and so on. The inventor deems illustration of two main communication appliances namely a PC and a telephone as sufficient for the purpose of explaining the present invention.

It is noted herein that there are no COST wiring facilities implemented from switch to phones and . In this example both phones and are IP capable telephones that are connected to their respective PCs and . The connection is through the PC sound card enabling the IP phones to take calls through the PC. In this case all COST communication events at switch are converted to IPNT events and routed to LAN connected PCs.

A transaction server T Server is provided within communication center and connected to switch by a CTI link. T Server is also illustrated herein as LAN connected. T Server embodies and serves upon request all of the routing functions employed at center . A data server is provided within center and connected to LAN . Server serves any pertinent data regarding client and agent information as may be required to enhance routing function. A data repository is provided and accessible to server . Repository is adapted to hold any pertinent data that may be accessed and served by server upon request. Updates to such data may be made periodically through LAN .

Types of data stored in repository and served by server may include but is not limited to agent information such as log in status availability data skill data language data identification data address data and so on. Client information contained in repository and servable by server may include client history data client identification data contact information payment history data order status data and so on. Server functions in this example as a centralized information source for agents as well as for automated systems at work in the center. Information contained in repository may be continually updated as events arrive and are internally routed within center .

A proxy server is provided within center and illustrated as connected to LAN . Proxy server is adapted with a modified version of session initiation protocol SIP as is illustrated in this example by a software instance SW . SW is installed on and executable on server in accordance with events for internal routing within the center. Server has an Internet connection to Internet backbone by an Internet access pipeline . Server functions also as an Internet router IR as described further above with reference to IR of .

As an IR server performs all of the internal routing of events arriving thereto from Internet and from PSTN through switch . To this effect server is directly connected by a CTI link to switch . In one embodiment switch is adapted to convert COST events to IPNT ring events. In another embodiment server simply routes events from switch but connection for such events is physically made on conventional telephones and internal telephony wiring. In still another embodiment switch if adapted as an IP conversion switch may be directly connected to LAN . There are many possibilities.

User has an instance of software compatible with SIP protocol SW executable thereon that is adapted as a simple client application to SW in server . SW may be a browser plug in in one embodiment for example. In another embodiment SW may be a stand alone application. Another instance of software labeled SW is illustrated on PC user and adapted as a form filler FF application. FF may be assumed to be part of SW as one application in many embodiments or be connected to it in a direct or indirect manner. The inventor logically separates FF from SW for illustration of function only. In another embodiment the functions of SW and FF may be provided in and accessible from server within Internet .

The purpose of FF is to enable a user in this case user to communicate a text reason for a desired connection event to an agent or system of communication center . FF provides functionality that would otherwise be covered by an interactive voice response IVR system that may be assumed to be implemented either in PSTN and connected to switch or within center connected to switch .

User may access server and then be provided with applicable client software or he or she may already have the appropriate software installed as a resident program. Filling out an electronic form using FF and submitting the form while connected online with server causes a telephony event request to be initiated having an SIP header and the completed form as the body of the SIP message. The SIP event arrives at server where SW parses the message for content and separates the header information and content form data from the SIP message.

The parsed data is then re formatted into language that is understood by T server and sent as a routing request to the server. Record of the event remains at server until a response is received from T server concerning routing determination. T server executes any applicable routing routines using the re formatted SIP data and sends a routing result or recommendation back to server . In some embodiments T server consults with server for any information required for optimizing a best determination for routing the particular event.

Server receives a routing determination from sever and then routes the target event to an available agent or system based on the response. All SIP functionality built into SW can be leveraged to provide information that is useful for establishing a successful connection.

For events arriving at switch wherein there is no agent level routing performed at PSTN network level IVR interaction can provide the equivalent of FF of PC . SW is capable of parsing a textualized or digitized version of an IVR message and of generating an SIP message containing the information. As described above T server receives a routing request from server in the form of a SIP message. Server computes routing results according to included information and sends the results to server . Server then routes the event to an appropriate agent or system connected to LAN .

If events arriving at switch are to be passed directly to LAN through a dedicated LAN connection not shown then server simply routes notifications of pending ringing events. Alternatively server may receive the actual events digitized and may directly route them to appropriate agents or systems over LAN . Again all of the functionality of SIP messaging may be tapped wherein it may be useful as a routing variable. Such functions include bandwidth reservation handshake protocols media designations callback information presence information and so on.

The method and apparatus of the present invention allows integration of strict routing conventions and SIP functionality without requiring significant modification of or provision of special application program interfaces APIs to be distributed to key components of the system namely T server server and perhaps at switch .

One with skill in the art will recognize that there may be a variety of routing infrastructures having differing hardware components and connectivity that can be enhanced with SIP Routing capability according to embodiments of the present invention. Likewise the preferred method may be employed to directly route and forward actual events and for routing notification of pending events wherein subsequent call connection is a COST connection made between a terminal and a central switch of the center.

In the meantime at step the proxy server waits for the result response from the request sent at step . In step the requesting party or originator of the event remains in queue. At step the T server uses additional information provided by form filling to help granulate a routing determination to more narrowly define an appropriate routing destination for the event. This may involve access and consultation with a server database analogous to server connected to repository described with reference to . At this time repository may also be updated with new data from information provided with the original SIP request. At step the T server retrieves any required additional information from a database of information analogous to the repository server combination described above. This data may be passed to an appropriate agent with or ahead of the routed event.

At step the T server responds to the request of after processing and retrieving any additional data at step by sending the best possible routing information or result to the proxy server. The result may well be a final routing determination or command necessitating no further determination by the proxy. In another embodiment routing information may simply consist of a data record indicating all of the parameters of the route computation wherein some further computation to determine final destination is left for the proxy server.

At step the proxy sever of step routes any additional hard data to the intended recipient of the call in the form of a screen pop up or other well known convention. Simultaneously at step the processed event is routed by the proxy server to the same recipient. The recipient is most likely a live agent but may also be an automated robotic system.

In one embodiment the live connection is established and the session maintained within the proxy. In another embodiment only notification of an event is routed and actual physical connection made by another IP router dumb switch other than the proxy server. In the event of telephony events arriving through the COST network PSTN the SIP request sent to the proxy is generated at an enhanced central switch wherein the IVR interaction if any is translated into the form content of the SIP message. Therefore the client in in the case of COST events would be the central switch analogous to switch described with reference to . The active SIP session whether COST initiated or IPNT initiated is maintained in the proxy server or another designated server.

Using SIP data to manage internal routing enables all IP communication forms such as IP telephony Chat multiparty conferencing and so on to be routed and maintained as traditional telephony call events following strict intelligent routing regimens. In the case of multiparty conferencing many steps otherwise required for conferencing in various parties are eliminated. Each selected party would receive an identical routed event which when taken or picked up automatically initiates the party into the conference. Similarly other traditional steps associated with center telephony such as call holding call waiting call transfer etc. can be simplified using SIP parameters. Many individual characteristics of SIP capability can be leveraged for media identification reserving bandwidth end user identification protocol switching to improve transmission quality and so on.

The inventor provides a communication event transfer system and method that uses a standard network protocol for coordinating communication event transfers from one to another or more communication center sites. The method and apparatus of the invention is described below.

PSTN can be another type of COST telephone network as may be known in the art such as a private telephone network. Telephony equipment analogous to telephony carriers switches service control points and the like may be assumed present within PSTN as would be known in the art. Similarly CTI equipment not shown such as a CTI processor including IVR capability and a Stat Server may be assumed to be present within PSTN and appropriately connected to local telephony apparatus.

Internet network may be another type of data packet network as known in the art such as perhaps a corporate WAN Ethernet network or other similar networks. Network equipment such as gateways access points data routers backbone carriers and like equipment is assumed present as is generally known in the art.

A user station also termed user is illustrated in this example by an enclosed PC and telephone icon representing methods of communication. User accesses Internet with aid of a PC or other Internet capable device and accesses PSTN in a COST sense through typical telephone equipment. As is generally known in the art connection capability from user to Internet is typically accomplished through dial up methods using a modem based service such as an Internet service provider through PSTN . User uses state of art technology for communication including cross network communication through bridging of the two described networks as is known to be available in the art.

Communication center represents a center as known to the inventor capable of converting incoming COST events to DNT events under a common set of routing rules. In this sense communication center only routes IPNT events and is devoid of typical internal telephony wiring. This is not required to practice the present invention but serves as a convenience to agents and systems within the center.

A central telephony switch is provided within communication center and is adapted as a central switch for accepting COST communication events arriving through PSTN . Switch is a PBX type switch in this example but may also be an ACD type switch or some other known type of telephony switch. Switch connects to PSTN using at least one telephony trunk represented herein by double arrow. Switch represents an incoming routing point for all incoming COST events into center and also handles outgoing events.

An Internet router IR is illustrated within center and is adapted to communicate events to and from Internet . IR is connected to Internet by at least one Internet access line represented herein by double arrow. IR also accepts communication events in DNT form that are converted to that form by a CTI processor connected to switch by a CTI link . A data link is illustrated and adapted for connecting IR directly to processor . In this example CTI processor has an instance of T server software TS executable thereon. TS software enables all of the routing protocol used to route communication events within center . In this example CTI processor is further enhanced for converting COST events to DNT events and DNT events to COST events. Therefore CTI processor performs as a network bridge internal to center . In terms of total incoming events IR routs all events to final destinations within center .

Communication center has a local area network LAN adapted for TCP IP and other applicable Internet protocols. LAN is chiefly used in this example to provided network capability for connected agents automated systems and other equipment that is further described below. LAN has direct access to IR by way of a data line .

In this example there is a plurality of illustrated agent stations within center that are connected to LAN for purpose of network communication. It will be appreciated that there will typically be in actual practice many more than the number of agent stations illustrated in this example. It may be assumed that each agent station is at least adapted with a PC connected to LAN . In this embodiment an IP capable telephone is available as well within each agent station the phones connected through for example a sound card interface to each PC.

A customer information system CIS server is provided within center and connected to LAN . Server serves any pertinent data regarding client and agent information as may be required to enhance routing function. Server is typically connected to an internal or external data repository not shown adapted for holding system and client related data. Types of data accessible to server may include but are not limited to agent information such as log in status availability data skill data language data identification data address data and so on. Accessible client information may include client history data client identification data contact information payment history data order status data and so on. Server functions as a centralized information source for agents as well as for automated systems at work within center .

An application server is provided within center and is adapted to serve appropriate functional software applications upon request of other systems and or agents within center . Application server is connected to LAN by LAN connection and to CTI processor by way of a data link . Application server is adapted with a software instance of session initiation protocol SIP software SW .

SIP software may be a modified version of SIP as was described above with reference to SW of . In that case appropriate client versions of the software are distributed appropriately. In a preferred embodiment SW is a standalone version of SIP used for internal session initiation and control in conjunction with TS routing routines and for performing call transfer routines to external communication sites.

Processor is connected by a data network to similar CTI equipment maintained within PSTN and connected to one or more PSTN telephony switches. In this way instances of TS can communicate with other instances of TS operating at network level. For example if a call destined for center is processed at a local telephony switch within PSTN information about the caller including notification of the pending event can be passed ahead of the actual event to an agent or system within center . Likewise TS routing rules may be extended to network level switches and service points within PSTN in effect providing agent level routing capability into the network.

In practice communication events may arrive within center at telephony switch COST and at IR DNT . When an incoming event registers at the last switch within PSTN TS software in processor provides routing commands to the switch hosting the event before final routing. Processor accesses SIP control SW upon receiving notification over data network of the presence of the pending event. The COST event is routed according to prevailing routing rules to central switch within center . Data about the event arrives at processor over network and is passed on to the intended destination over link through IR over LAN to the target one of agent stations 

The event registered at switch is initiated and established as a session controlled event by SIP protocol from processor over data line through IR over LAN connection and LAN to the engaged agent or system. The incoming event at switch is a COST transaction however the event is initiated and controlled from the point of processor to the point of the engaged agent or system according to SIP protocol. In this case TS SIP parsing and conversion described with reference to above is not required.

Incoming events arriving at IR for internal routing are routed according to TS protocols and are conducted according to standard SIP protocol. Communication events are tracked within application server including generation of statistical data log history event handling disposition and so on. In another embodiment another server may be provided to log activity.

In this example of internal SIP based routing TS routine controls switch in terms of routing protocol and destination. However event initiation maintenance and event termination from the point of processor to any of the routing destinations is conducted according to SIP protocol. For example assume that internal telephony wiring exists within center and connects agent stations telephones to switch . In this case TS routine would provide routing rules and commands while SIP protocol would be used to set up and notify one of a target agent s PC terminals that an incoming telephone call is being routed to the agent. The agent subscribes to TS to receive data about the caller or event and receives notification of the call and perhaps a clickable link to the required data through SIP messaging and response interaction. In a preferred embodiment TS SIP and other protocols like IM type protocols can be extended between participating center sites.

A major difference in this example is a fact that both communication centers and share a same application server running among other center applications an instance of SIP SW . In this example network cloud represents both the Internet and the PSTN network. One with skill in the art will appreciate that the physical boundaries between the two networks are blurred in actual practice.

Application server may be hosted at the network level PSTN or Internet or may be hosted on a separate data network such as may be set up between cooperating instances of TS. In this case server is connected to processor within center by a data link and to processor within center by a data link . In this embodiment application server may be accessed from a point on either LAN or LAN following the appropriate paths established for each center. For example an agent operating one of stations may access server through link IR processor and link . An agent operating one of stations may access server through link IR processor and link .

In addition to a shared application server processors center and center are directly connected by a network link . Network link may be adapted to share a proprietary protocol TS or it may be adapted to communicate using a presence protocol such as instant message protocol. In some cases more than one protocol is simultaneously supported such as SIP IMPP and TS. Connections from respective center components to network remain identical to those described with reference to above. In this example a goal is to provide SIP control signaling to set up communication event transfers and session management from one communication center to another center. An SIP header and accompanying body will not normally be robust enough to carry all required data for establishing a CTI call event once it has been transferred. Therefore SIP control signaling is used for initiation including event notification establishing and terminating the session while TS is used for routing and hard data transfer.

In the case of an incoming event arriving at switch in center it may be determined that the best suited destination for the call is in fact an agent operating one of stations in center . Caller ID can be established for the purpose of coordinating between TS request response and SIP request response. ANI services can be leveraged as well as many other identification and matching techniques to ensure that SIP and TS function for one event are appropriately associated with the event.

Processor makes a determination to transfer the event to center in some cases to a predetermined final destination such as a target agent remote agent level routing . Processor sends notification of the event and requests routing availability information from processor concerning an available agent or system. This is accomplished in preferred embodiments of the invention using SIP protocol. Processor returns routing information to processor after confirming availability of the requested target destination. IMPP can be used to exchange this information instead of proprietary TS routine or SIP. At the same time routing determination is occurring the pending session is initiated through SIP exchange between processors and over the network of links and application server . Server coordinates and manages the information for the eventual session initiation and control during the active session using Application . The method and apparatus of the invention is not limited to use between two communication center sites. Many communication center sites may practice the invention.

For example assume a communication event telephone connection is routed to center switch . It may be determined that the calling party will be best assisted by joining an active SIP session maintained by communication server . In this case processor sends an SIP request to server and waits for a response. When routing is confirmed SIP initiation to connect commences between the calling party and server . The calling party may be routed through a telephony to Internet gateway at network level in order to make connection with server . Text to voice and voice to text rendering can be practiced in this case so that the calling party using a COST telephone may still participate. Voice to voice translation can also be provided. DNT sourced parties may communicate normally using a PC or other Internet capable devices having text and or voice input capability and a suitable display apparatus. Devices may be text based or visual audio based. SIP negotiates the parameters for connection. It is noted herein that direct SIP functionality or that of another presence protocol such as IMPP can be leveraged on all of the network paths where there is shared bandwidth which covers all paths from server to network gateways.

Communication server can handle all SIP request and response interactions between processors and . Also TS or other proprietary routing requests and commands can be in some cases attached to SIP messaging as enhanced documents and redirected to intended destinations for implementation. Any hard data and or reference links to data sources connected with an event can be propagated through the network comprising processors and application server over links and .

In the examples of and SIP is leveraged to initiate and establish a session between at least two parties. Communication events can be transferred between modular communication sites using SIP request and response messaging. Functions not supported directly by for example communication server may be passed along with the SIP header and body as enhanced attachments understood by the machine or system representing the last routing point of an event before connection is established. Wrapping call control parameters into SIP requests and responses enables systems and machines to provide the correct routing and system parameters required for specific media dependant devices although those devices may not normally be compatible with one another. Other SIP functions such as bandwidth reservation quality of service control data compression techniques and event handling parameters are preserved and applicable in a given event session.

At step a communication event arrives at a communication center representing a first site or site of more than one possible site. The event for purpose of discussion is assumed in this example to be a COST telephone call arriving at a communication center switch analogous to switch of . At step it is determined through interaction with the caller initiating the event or by some other method that resolution of the event would be best handled by another cooperating communication center site which is site in this example. This determination may be made as a result of IVR interaction however other methods are possible.

At step the processor responsible for handling the event sends an SIP request to site more particularly the CTI processor TS enhanced enabling the communication center switch located within site . SIP generation within the processor of site is enabled by an SIP control application running on a server accessible to both the processors of site and cooperating site . The shared server is analogous to application server of . The SIP request has at least a header and a body. The header contains caller identification information and event identification. The SIP body contains parameters concerning requested call initiation procedures and permission for transferring the event through in this case the PSTN network to the switch at site . Existing SIP and IMPP protocols are presence reporting capable. Therefore presence information tailored to current availability states of agents or systems within a communication center can be entirely handled using SIP or IMPP messaging.

At step the processor handling the event at site sends a proprietary TS routing request to confirm routing protocol for the event and to enable passing of any additional pertinent data gleaned from the caller to the event handling processor at site . The process of step occurs simultaneously with the process of step . The routing request can be trimmed of requirements for requesting agent availability information because that can be handled through SIP or other presence protocols. If additional complex protocols exist for routing such as skill level identification statistical routing information historical or predictive routing information then a TS request must be sent along with the SIP request.

Both the SIP request and the TS request are tagged with matching identification associated with the event pending transfer so that the event handling processor of site can match the requests to the same event. Standard call identification procedures can be applied. In one embodiment random identification codes are generated at the time of request generation. Any additional data about the caller sent in the TS request at step is also tagged with the appropriate identification.

It is noted herein that the network over which the SIP request is sent includes the shared application server in its path. The applications server coordinates and tracks the request response interaction as well as session states for any session resulting from the event. By contrast the TS request and data is sent over a separate network set up between the two active processors. This network may be a proprietary private network such as a virtual private network VPN or any other secure data network.

At step the event handling processor at site receives the requests sent in steps and . The requests are processed for appropriate responses. This may include consulting routing rules and transferring hard data from TS to agent desktop on the TS side. Each response is generated in a cooperative manner so that there are no conflicts. For example if the SIP response fails to permit transfer the TS response must also indicate that transfer is not possible. In this way no conflicting determinations exist saving bandwidth. The event handling processor within site sends the generated responses back to the event handling processor of site giving a green light for the transfer.

At step the event is successfully transferred from the central switch of the first site to the central switch of the second site and in some embodiments agent level routing to the telephone of the final internal destination at the second site. Some of the elements normally contained in a typical TS routing request are obfuscated by SIP enhancement as was described above. For example event transfer request and agent presence availability information can be handles chiefly in the SIP request response format described above.

The process of this example describes an event transfer of a COST event from one telephony switch to another telephony switch. Therefore SIP monitoring of state of session is not directly possible assuming a pure COST telephony hookup. However in a scenario wherein a gateway is used to bridge a cost connection to a data connection such as an IP phone SIP can directly monitor and control state of session between the agent device and the gateway through which the caller is bridged. Along the network portion of the connected session wherein there is shared bandwidth all of SIP functionality comes into play.

The method and apparatus of the present invention can be practiced internally within a communication center and externally between communications centers connected to a common network. The invention may also be practiced on virtual IPNT communication networks utilizing remote agents. All that is required in the case of a virtual center is a centralized routing point proxy server and the transaction server capabilities and routines required to provide intelligent routing among remotely connected agents.

The method and apparatus of the present invention should in light of the many applicable embodiments be afforded the broadest scope under examination. The method and apparatus of the present invention should be limited only by the claims that follow.

