---

title: Cross-PRN phase correction for GPS processing
abstract: Methods and systems are provided for accessing GPS signals in faded environments. Means are provided for predicting the nonlinear phase induced by the receiver's own clock, when there is at least one GPS satellite link strong enough to calculate a phase profile. In an embodiment, GPS signals are accessed in faded environments by increasing the sensitivity of a GPS receiver by increasing the processing gain of received GPS signals through increased integration time. Matching a near-baseband signal requires removing a nonlinear part of the phase which may arise from several sources, including: the phase drift of the GPS satellite's atomic clock, the phase drift due to the motion of the GPS receiver, the phase drift due to the motion of the GPS satellite, and the phase drift due to the GPS receiver's clock.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08063818&OS=08063818&RS=08063818
owner: The Johns Hopkins University
number: 08063818
owner_city: Baltimore
owner_country: US
publication_date: 20071107
---
This application claims the benefit of prior filed U.S. application No. 60 857 656 filed on Nov. 8 2006.

The invention was made with U.S. Government support under contract no. 2004 H009000 000. The U.S. Government has certain rights in the invention.

The present invention relates generally to GPS processing and more particularly to GPS processing of GPS positioning signals in faded environments.

There is a growing need for accessing GPS positioning signals in faded environments e.g. indoors below ground . The fades encountered can be more than 30 dB in some cases. The sensitivity of the GPS receiver must be increased commensurately to operate in these environments. Since high gain antennas cannot normally be used in these faded environments and lowering the noise figure can prove to be very expensive the processing gain must be increased by increasing the integration time as much as possible. This requires that the phase profile of the near baseband signal after GPS message and code wipe off will be matched. The linear part of the phase profile can be matched by trying multiple hypotheses for phase rate as with an FFT. With long coherent integration times however the nonlinear part of the phase profile will cause significant losses unless it is removed prior to inputting the signal to the FFT. The nonlinear part of the phase profile arises from several sources the phase drift of the GPS satellite atomic clock the phase drift due to the motion of the GPS satellite the phase draft due to the motion of the GPS receiver and the phase drift due to the GPS receiver s clock. The non linear phase caused by the phase drift of the GPS satellite s atomic clock is very small and does not become significant until the coherent integration time reaches about 10 seconds. For earth fixed receivers the nonlinear phase caused by the phase drift due to the motion of the GPS satellites is easy to remove given very approximate a prior receiver position information. Several kilometers are adequate for integration times over one second. The requirement for this a prior information can be eliminated by testing various hypotheses for receiver location. The nonlinear phase caused by phase drift due to the motion of the GPS receiver does not exist for receivers that are fixed or move at a constant velocity. There is usually no way to predict the nonlinear phase induced by the phase drift due to the GPS receiver s clock. The present invention addresses these concerns.

The present invention provides systems and methods for accessing GPS signals in faded environments. According to embodiments of the invention access to signals in faded environments is performed in a cost effective manner generally by increasing the sensitivity of a GPS receiver. In the described embodiments this is carried out in a GPS receiver by increasing the processing gain of received GPS signals through increased integration time. A preferred method for increasing the integration time is by increasing a coherent integration time to the maximum possible extent. This requires that the phase profile of a near baseband signal is matched after removal of GPS message and code wipe off. However to perform a matching of the near baseband signal it is first necessary to remove a nonlinear part of the phase which may arise from several sources. These several sources may include for example the phase drift of the GPS satellite s atomic clock the phase drift due to the motion of the GPS receiver the phase drift due to the motion of the GPS satellite and the phase drift due to the GPS receiver s clock. Subsequent to removing the nonlinear phase caused by the afore mentioned several sources a remaining part of the phase is assumed to be linear assuming a constant receiver velocity.

According to one aspect of the invention a method for accessing GPS signals in faded environments comprises the steps of receiving a multiplexed GPS signal at a receiver sampling said multiplexed GPS signal to produce a sampled multiplexed GPS data stream storing a copy of said sampled multiplexed GPS data stream as a stored data GPS stream identifying a constituent GPS signal in said sampled multiplexed GPS data stream having a signal strength sufficient for performing phase tracking and producing a clock error phase corrected data stream by phase tracking said identified constituent GPS signal.

The inventor has recognized that if the phase profile of at least one satellite can be estimated the nonlinear part resulting from the receiver s clock error can be extracted and removed from the near baseband signal for the other links before they are acquired.

In the following discussion numerous specific details are set forth to provide a thorough understanding of the present invention. However those skilled in the art will appreciate that the present invention may be practiced without such specific details. In other instances well known elements have been illustrated in schematic or block diagram form in order not to obscure the present invention in unnecessary detail. Additionally for the most part details concerning network communications electromagnetic signaling techniques and the like have been omitted inasmuch as such details are not considered necessary to obtain a complete understanding of the present invention and are considered to be within the understanding of persons of ordinary skill in the relevant art.

The present description illustrates the principles of the present disclosure. It will thus be appreciated that those skilled in the art will be able to devise various arrangements that although not explicitly described or shown herein embody the principles of the disclosure and are included within its spirit and scope.

All examples and conditional language recited herein are intended for pedagogical purposes to aid the reader in understanding the principles of the disclosure and the concepts contributed by the inventor to furthering the art and are to be construed as being without limitation to such specifically recited examples and conditions.

Moreover all statements herein reciting principles aspects and embodiments of the disclosure as well as specific examples thereof are intended to encompass both structural and functional equivalents thereof. Additionally it is intended that such equivalents include both currently known equivalents as well as equivalents developed in the future i.e. any elements developed that perform the same function regardless of structure.

The functions of the various elements shown in the figures may be provided through the use of dedicated hardware as well as hardware capable of executing software in association with appropriate software. When provided by a processor the functions may be provided by a single dedicated processor by a single shared processor or by a plurality of individual processors some of which may be shared. Moreover explicit use of the term processor or controller should not be construed to refer exclusively to hardware capable of executing software and may implicitly include without limitation digital signal processor DSP hardware read only memory ROM for storing software random access memory RAM and nonvolatile storage.

Other hardware conventional and or custom may also be included. Similarly any switches shown in the figures are conceptual only. Their function may be carried out through the operation of program logic through dedicated logic through the interaction of program control and dedicated logic or even manually the particular technique being selectable by the implementer as more specifically understood from the context.

In the claims hereof any element expressed as a means for performing a specified function is intended to encompass any way of performing that function including for example a a combination of circuit elements that performs that function or b software in any form including therefore firmware microcode or the like combined with appropriate circuitry for executing that software to perform the function. The disclosure as defined by such claims resides in the fact that the functionalities provided by the various recited means are combined and brought together in the manner which the claims call for. It is thus regarded that any means that can provide those functionalities are equivalent to those shown herein.

With continued reference to there is shown a plurality of GPS satellites S S with the range between each satellite and each GPS antenna not shown depicted by a dashed line. Incoming GPS signals also known as pseudo random noise PRN signals from a plurality of GPS satellites S S as a single multiplexed GPS signal is received at the GPS receiver s front end. The GPS receiver converts the multiplexed GPS signal to a digital signal via downconversion and an analog to digital converter not shown . The sampled signal is copied and stored for use at a later stage of processing. The original sampled signal is processed in a manner to be described below to produce a clock error phase corrected data stream by phase tracking a selected GPS signal contained within the multiplexed GPS signal. The selected signal being transmitted from one of the GPS satellites S S and selected on the basis of possessing sufficient signal strength for the purpose of performing phase tracking. It is understood that the techniques for design and construction of GPS antennas and RF front ends that possess the characteristics relevant to the present invention are well known to those of ordinary skill in the art.

Referring now to there is shown an illustration of a signal flow diagram for performing a Cross PRN Phase Correction e.g. a correction of GPS satellite signals PRNs where one GPS signal is used to support the tracking of other GPS signals in the GPS receiver of according to one embodiment. The flow diagram is generally divided into four regions labeled and . The respective region describes the signal flow associated with processing of a received GPS signal e.g. PRN signal for the purpose of estimating the phase profile of a strongest GPS signal to facilitate the acquisition of weaker received GPS signals.

With reference now to there is shown a top level flow chart describing a method for performing Cross PRN Phase Correction at a top level where each step of the top level flowchart corresponds to an associated processing region of the signal flow diagram of the GPS receiver of . For example step of the top level flowchart of corresponds to processing region of the signal flow diagram of . The flowchart of is described as follows.

At step A plurality of GPS signals are received from a corresponding plurality of GPS Satellites S S to generate a corresponding set of digital samples via A D converter as shown in .

Next at step Identify satellite with sufficient signal strength e.g. S and track its phase. Remove the non linear portion of the phase resulting from satellite accelerations from the tracked phase. Remove the non linear portion of the phase resulting from receiver accelerations if this information is available otherwise it is assumed the receiver has constant velocity. Also remove linear component of from tracked phase which corresponds to a frequency offset. The remaining phase function is a function of the receiver s clock drift.

Next at step Remove the identified non linear clock phase error from that GPS data to produce a receiver clock error phase corrected data stream.

Lastly at step Acquire the weaker satellite signals e.g. S S using the clock corrected GPS data from step and using standard long integration techniques including message bit wiping when necessary.

Referring now to there is shown the detailed processing steps associated with each of the general processing steps of the top level flowchart of .

At step A plurality of GPS signals are simultaneously received via an antenna of GPS receiver from a corresponding plurality of GPS satellites S S .

At step The plurality of received GPS signals are down converted and sampled to produce digitized samples of the near baseband complex envelope. In one embodiment down converting comprises the steps of a mixing stage a filtering stage followed by complex sampling and filtering with a sample rate of 4.2 MHz and 2 bit quantization a RAKON 5300B TCXO clock.

At step A version of the near baseband signal is stored in a memory for use at a later stage described below at step . Examples of memory include a Flash memory a Random Access Memory RAM and a read only memory ROM . In some embodiments upwards of 10 seconds of GPS data can be stored.

At step Track the phase of the satellite identified at step having sufficient signal strength. In some embodiments this step may further comprise a bit wiping operation when bits are present on a signal transmitted from the identified satellite.

At step A phase component of the tracked signal is removed from the phase output from step . The phase component is comprised of two parts 1 the non linear phase due to the relative acceleration between said GPS satellite and the receiver and 2 a linear phase offset that removes the impact of any frequency errors in the output from . Assuming that the satellites atomic clock is linear over this region the remaining residual phase function represents only the effect from the receiver clock.

At step In practical embodiments it may be desirable to smooth the result of step . In one embodiment smoothing is performed using a discrete Kalman filter with the Kalman filter having two states phase and frequency.

At step The phase error resulting from the local clock is removed from the GPS data stored from step . In one embodiment removing the phase error comprises two steps 1 interpolating the non linear phase estimate from step to coincide with the time points associated with that of the previously stored GPS data . 2 removing the phase values from the GPS data. An example of such a phase removal operation is given in the following equation x k e where k is the non linear phase estimate from step interpolated to the previously stored GPS data sample times and x k is the GPS data from .

Step is a more detailed step further describing general process step of pertaining to long integration. Long integration is well known in the art. One algorithm for performing long integration is described in Psiaki M. L. Block Acquisition of Weak GPS Signals in a Software Receiver Proceedings of ION GPS 2001 September 2001 incorporated by reference in its entirety herein. In accordance with methods and systems of the invention it is further contemplated to perform bit wiping prior to performing a long integration.

There have thus been provided new and improved methods and systems for accessing GPS signals in faded environments. In accordance with the present invention these methods and systems access GPS signals in faded environments by increasing the sensitivity of a GPS receiver. This is carried out in a GPS receiver by increasing the processing gain of received GPS signals through increased integration time. A preferred method for increasing the integration time as described above is by increasing a coherent integration time to the maximum possible extent. This requires that the phase profile of a near baseband signal is matched after removal of GPS message and code wipe off. Matching the near baseband signal requires the removal of a nonlinear part of the phase which may arise from several sources including the phase drift of the GPS satellite s atomic clock the phase drift due to the motion of the GPS receiver the phase drift due to the motion of the GPS satellite and the phase drift due to the GPS receiver s clock. Subsequent to removing the nonlinear part of the phase caused by the afore mentioned several sources a remaining part of the phase is assumed to be linear assuming a constant receiver velocity.

Although the above description contains much specificity these should not be construed as limiting the scope of the invention but as merely providing illustrations of some of the presently preferred embodiments of this invention.

Reference has been made mostly to the GPS signals but the techniques of present invention are equally applicable to other signals such as for example American GNSS signals Russian GLONASS and European GALILEO signals ground and space based augmentation signals and other components of the GNSS in general.

While the invention has been described with reference to an example embodiment it will be understood by those skilled in the art that a variety of modifications additions and deletions are within the scope of the invention as defined by the following claims.

