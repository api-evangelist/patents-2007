---

title: System and method of analyzing web addresses
abstract: A system and method are provided for identifying active content in websites on a network. One embodiment includes a method of classifying web addresses. One embodiment may include a method of generating a score indicative of the reputation, or likelihood that a web site associated with an uncategorized URL contains active or other targeted content based on an analysis of the URL. In certain embodiments, the score is determined solely from the URL string. Other embodiments include systems configured to perform such methods.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09654495&OS=09654495&RS=09654495
owner: Websense, LLC
number: 09654495
owner_city: Austin
owner_country: US
publication_date: 20070228
---
This application claims the benefit of and incorporates by reference in its entirety U.S. Provisional Application No. 60 868 305 filed Dec. 1 2006.

This application relates to data and application security. In particular this application discloses systems methods of collecting and mining data to predict the content or nature of a web site based on its web address.

Traditionally computer viruses and other malicious content were most often provided to client computers by insertion of an infected diskette or some other physical media into the computer. As the use of e mail and the Internet increased e mail attachments became a prevalent method for distributing virus code to computers. To infect the computer with these types of viruses having malicious content some affirmative action was typically required by the user such as opening an infected file attachment or downloading an infected file from a web site and launching it on their computer. Over time antivirus software makers developed increasingly effective programs designed to scan files and disinfect them before they had the opportunity to infect client computers. Thus computer hackers were forced to create more clever and innovative ways to infect computers with their malicious code.

In today s increasingly networked digital world distributed applications are being developed to provide more and more functionality to users in an open collaborative networking environment. While these applications are more powerful and sophisticated their increased functionality requires that network servers interact with client computers in a more integrated manner. For example where previous web applications primarily served HTML content to client browsers and received data back from the client via HTTP post commands many new web applications are configured to send various forms of targeted content such as active content to the client computer which cause applications to be launched within the enhanced features of newer web browsers. For example many web based applications now utilize Active X controls which must be downloaded to the client computer so they may be effectively utilized. Java applets JavaScript and VBScript commands also have the capability of modifying client computer files in certain instances.

The convenience that has arrived with these increases in functionality has not come without cost. Newer web applications and content are significantly more powerful than previous application environments. As a result they also provide opportunities for malicious code to be downloaded to client computers. In addition as the complexity of the operating system and web browsing applications increase it becomes more difficult to identify security vulnerabilities which may allow hackers to transfer malicious code to client computers. Although browser and operating system vendors generally issue software updates to remedy these vulnerabilities many users have not configured their computers to download these updates. Thus hackers have begun to write malicious code and applications which utilize these vulnerabilities to download themselves to users machines without relying on any particular activity of the user such as launching an infected file. One example of such an attack is the use of malicious code embedded into an active content object on a website. If the malicious code has been configured to exploit a vulnerability in the web browser a user may be infected or harmed by the malicious code as a result of a mere visit to that page as the targeted content in the page will be executed on the user s computer.

An attempt to address the problem of malicious code being embedded in active content is to utilize heightened security settings on the web browser. However in many corporate environments intranet or extranet applications are configured to send executable content to client computers. Setting browser settings to a high security level tends to impede or obstruct the effective use of these types of safe applications. Another attempt to address the issue is to block all executable content using a network firewall application. This brute force approach also is ineffective in many environments because selective access to certain types of content is necessary for software to correctly function.

The system method and devices of the invention each have several aspects no single one of which is solely responsible for its desirable attributes. Without limiting the scope of this invention as expressed by the claims which follow its more prominent features will now be discussed briefly. After considering this discussion and particularly after reading the section entitled Detailed Description of Certain Inventive Embodiments one will understand how the features of this invention provide advantages that include improved detection of web sites having targeted content.

One embodiment includes a method of controlling access to web content. The method comprises receiving a request for at least one uniform resource locator URL . The method further comprises generating an indicator of active content associated with the URL. The indicator is based on data associated with at least one component of the URL. The method further comprises determining whether to allow the request based at least partly on the at least indicator.

Another embodiment includes a system for controlling access to web content. The system comprises a gateway server module configured to receive a request for at least one uniform resource locator. The system further comprises a URL analysis module configured to generate an indicator of active content associated with the URL. The indicator is based on data associated with at least one component of the URL. The system further comprises a policy module configured to identify a policy associated with the URL. The system further comprises a content filtering module configured to determine whether to allow the request based at least partly on the at least indicator and the policy.

One embodiment includes a system for controlling access to web content. The system comprises means for receiving a request for at least one uniform resource locator. The system further comprises means for generating an indicator of active content associated with the URL. The indicator is based on data associated with at least one component of the URL. The system further comprises means for identifying a policy associated with the URL. The system further comprises means for determining whether to allow the request based at least partly on the at least indicator and the policy.

The following detailed description is directed to certain specific embodiments of the invention. However the invention can be embodied in a multitude of different ways as defined and covered by the claims. In this description reference is made to the drawings wherein like parts are designated with like numerals throughout.

Certain embodiments provide for systems and method of identifying and categorizing web content including potentially executable web content and malicious content that is found at locations identified by Uniform Resource Locators URLs . As used herein potentially executable web content generally refers to any type of content that includes instructions that are executed by a web browser or web client computer. Potentially executable web content may include for example applets executable code embedded in HTML or other hypertext documents including script languages such as JavaScript or VBScript executable code embedded in other documents such as Microsoft Word macros or stylesheets. Potentially executable web content may also refer to documents that execute code in another location such as another web page another computer or on the web browser computer itself. For example a HTML web page that includes an OBJECT element and thus can cause execution of ActiveX or other executable components may generally be considered potentially executable web content regardless of the location of the executable components. Malicious content may refer to content that is not executable but which is calculated to exploit a vulnerability on a client computer. However potentially executable web content may also be malicious content. For example image files have been used to exploit vulnerabilities in certain operating systems when those images are processed for display. Moreover malicious web content may also refer to interactive content such as phishing schemes in which a HTML form or other web content is designed to appear to be provided by another typically trusted web site such as a bank in order to deceive the user into providing credentials or other sensitive information to an unauthorized party.

Each of the workstations may be in electrical communication with a gateway server module . The gateway server module may reside at the edge of the network so that traffic sent to and from the Internet may pass through it on its way into or out of the network . The gateway server module may take the form of a software module that is installed on a server that stands as a gateway to a wider area network than the network to which the workstations are directly attached. Also connected to the Internet is a database management module . The database management module also may be a software module or one or more hardware appliances which resides on one or more computing devices. The database management module may reside on a machine that includes some sort of network connecting hardware such as a network interface card which allows the database management module to send and receive data and information to and from the Internet .

In the example system of one or more of the work stations may be in communication with one or more search engines via the Internet . The search engine is typically a web site which receives user requests for information and websites which are relevant to the parameters of the submitted user requests. Well known examples of search engines are Google Yahoo and Ask.com.

In the example system of one or more of the work stations may be in communication with one or more syndicated websites via the Internet . The syndicated website offers a web feed of content from the website. Typically the content from the syndicated website is accessed by web feed readers installed on client workstations .

Referring now to a more detailed view of the workstation is presented. The workstation may include a workstation module . The workstation module may take the form of software installed to run on the operating system of the workstation . Alternatively the workstation module could be an application running on another machine that is launched remotely by the workstation .

The workstation module may include various components. The workstation module may include an inventory of a local active content module which records all web content stored on the workstation . For example the local content inventory module may periodically inventory all local content. The inventoried data may be uploaded to the gateway server module for comparison to a categorized URL content database which is discussed below in more detail. The local content inventory module may determine whether new content is being introduced to the workstation by comparison to the inventoried local content contained therein.

The workstation module also may include one or more upload download modules and one or more URL request modules . The upload download modules may be used to send and receive data from the network through the gateway server module and to the Internet . The URL request module may receive a data request from either a user or some system process and send the request via the gateway server module to retrieve the file and or content associated with the request. The request may be a search engine request made to the search engine . In response to the search the search engine may return one website or a list of websites and URL links leading to those websites based on the search parameters. The request may also be a content request made to the syndicated website . In response to the request the syndicated website may return one URL link or a list of URL links to the requested content. For ease of explanation the term network request is used to include user requests for content via the search engine or requests sent via a web feed reader to the syndicated website . The system of monitors and or modifies the data returned in response to the network request to inhibit objectionable or malicious content from being available to the user.

Typically the functions of each of the upload download modules and the URL request modules are performed by software applications such as web browsers with Internet Explorer Mozilla Firefox Opera Safari being examples of browsing software well known in the art. These functions may also be performed by other types of software such as web feed readers instant messaging programs peer to peer file sharing applications digital media player applications e.g. iTunes RealPlayer Quicktime or some other applications.

Alternatively the functions of the modules may be divided among different software applications. For example an FTP application may perform the functions of the upload download module while a web browser performs the functions of sending requests to the search engine. A web feed reader application may send a request for content to the syndicated website . Other types of software may also perform the functions of the upload download module . Although these types of software are generally not desirable on a workstation software such as Spyware or Trojan Horses may make requests to send and receive data from the Internet.

The workstation module may be in communication with the gateway server module . The gateway server module may be used to analyze incoming and outgoing web traffic and to make various determinations about the impact the traffic may have on the workstations . Referring now to an example of the gateway server module is provided. The gateway server module is in two way communication with the workstation . It may receive file uploads and downloads and URL requests from the workstation module . The gateway server module is also in two way communication with the Internet . Thus requests originating within the workstations of the network may be required to pass through the gateway server module as they proceed to the Internet. In some embodiments the gateway server module may be integrated with some firewall hardware or software that protects the network from unauthorized intrusions from the Internet . In other embodiments the gateway server module may be a standalone hardware appliance or even a software module installed on a separate gateway server residing at the network gateway to the Internet .

As discussed above the gateway server module may receive URL requests and upload download data from the workstation by way of the workstation module . The gateway server module may include various components that perform various functions based on the data received.

One feature included in the gateway server module is the categorized URL content database . The URL database may be used to store information about URLs including data that is associated with the URLs. The categorized URL content database may be a relational database or it may be stored in some other form such as a flat file an object oriented database and may be accessed via an application programming interface API or some database management software DBMS . The URL database may generally be used to help determine whether URL requests sent by the URL request module will be permitted to be completed. In one embodiment the URLs stored in the URL database are categorized.

The gateway server module may also include a policy module . The policy module may used to implement network policies regarding how certain content will be handled by the gateway server module or by a firewall or some other security software installed within the network . In one embodiment the policy module may be configured to provide the system guidance on how to handle URL requests for categorized URLs. For example the gateway server module may be configured to disallow URL requests that are categorized as being Malicious or Spyware. In other embodiments the policy module may be used to determine how to handle URL requests that have not been categorized. In one embodiment the system may be configured to block all requests for URLs that are not in the categorized URL content database . The policy module may also be configured to allow certain requests of uncategorized URLs based on the user making the request or the time at which the request is made. This allows the system to avoid having a one size fits all configuration when such as configuration would not meet the business needs of the organization running the gateway server module .

The gateway server module may include a collection module . The collection module may be a software program routine or process that is used to collect data about URLs. In one embodiment when an internet request is received from the URL request module for content from the syndicated website the collection module may be configured to visit the website associated with the syndicated website and download data to the gateway server module for analysis by components of the gateway server module . The downloaded data may also be sent via the Internet for delivery to the database management module as will be discussed in further detail below .

In some embodiments the gateway server module may also include a logging database . The logging database may perform various functions. For example it may store records of certain types of occurrences within the network . In one embodiment the logging database may be configured to record each event in which an uncategorized URL is requested by a workstation . In some embodiments the logging database may also be configured to record the frequency with which a particular uncategorized URL is requested. This information may be useful in determining whether an uncategorized URL should be of particular importance or priority and should be categorized by the database management module ahead of earlier received data. In some embodiments uncategorized URLs may be stored separately in an uncategorized URL database .

For example some spyware may be written to request data from a particular URL. If many workstations within the network are infected with the spyware repeated requests to a particular URL may provide an indication that some anomaly is present within the network. The logging database may also be configured to record requests of categorized URL data. In some embodiments categorizing requests of categorized URLs may be helpful in determining whether a particular URL has been mischaracterized.

Referring now to an example of the logging database is discussed. The logging database includes four columns of data. The first column No. Page Requests is indicative of the number of times a particular URL has been requested by users within the network . The second column URL records the particular URL string that is being logged in the logging database . Thus when a URL is sent to the logging database the database may first be searched to determine whether the URL string is already in it. If not then the URL string may be added to the database. In some embodiments the collection module may be configured to visit the requested URL and gather data about the URL. The collection module may retrieve the page source of the requested URL and scan it for certain keywords that may indicate a type of content. For example if the page source includes javascript then the page may be identified as having JavaScript. While such content is not inherently dangerous a web page with JavaScript may have a greater chance of including malicious content designed to exploit how a browser application handles JavaScript function calls. In some embodiments this data may be stored in the logging database in JavaScript column . The logging database may also receive similar information from pages that include Active X content and store that content within Active X column . In other embodiments other types of active content may be detected and stored for java applets VBScript and the like.

Referring again to the gateway server module may further include an IT interface module . The interface module may be used to allow network administrators or other technical personnel within an organization to configure various features of the gateway server module . In certain embodiments the interface module allows the network administrator or some other network management type to configure the policy module .

The gateway server module may further comprise a URL analysis module . The URL analysis module is configured to analyze URLs based on the URL and data associated with the URL. Data associated with a URL may include reputation data. Examples of web reputation data include data associated with the URL host and the URL host nameserver. Additional examples of web reputation data are discussed below with reference to the URL analysis module .

The gateway server module may also include a content filtering module . The content filtering module may work in conjunction with the policy module and the categorized URL content database to filter portions of search results returned in response to a network request. In one embodiment the content filtering module may be configured to remove URL links and other content from a list of URLs returned in response to a user query sent to an Internet search engine . By way of example and not of limitation the content filtering module may be configured to recognize an outgoing search engine query. A page returned by the search engine to the client workstation may be intercepted by the gateway server module and analyzed by the content filtering module . The content filtering module may be configured to parse the returned page and identify URL links in the returned search results and embedded items of content such as images or active content.

Each identified URL link or item of content may be compared to the data in the URL content database to determine if the URL link has already been categorized. If it has been categorized the policy module is consulted for instructions on how to handle the content. For example the policy module may instruct the content filtering module to remove URL links that lead to web pages that are categorized as being Malicious or Spyware. In addition the content filtering module may also be configured to remove objectionable content from the returned search engine results based on the presence and categorization of the content in the URL content database . In one embodiment the content filtering module may be configured to filter content based on information provided by the URL analysis module .

Referring now to an example of a URL access policy database is provided. The URL access policy database may be used by the policy module to implement policies for accessing web based content by workstations within the network . In the embodiment shown the URL access policy database includes a table with four columns. The first column is a user column . The User column includes data about the users that are subject the policy defined in a given row of the table. The next column Category lists the category of content to which the policy defined by that row is applicable. The third column Always Block represents the behavior or policy that is implemented by the system when the user and category of requested content match the user and category as defined in that particular row. In one embodiment the Always Block field may be a Boolean type field in which the data may be set to either true or false. Thus in the first row shown in the data table the policy module is configured to always block requests for malicious content by user asmith. 

As noted above the policy module may also be configured to implement policies based on different times. In the embodiment provided in the fourth column Allowed Times provides this functionality. The second row of data provides an example of how time policies are implemented. The user is set to bnguyen and the category is gambling. The policy is not configured to always block gambling content for bnguyen as indicated by the field being left blank. However the time during which these URL requests are permitted is limited to from 6 PM to 8 AM. Thus adopting these types of policies allows network administrators to provide a certain degree of flexibility to workstations and users but to do so in a way that network traffic is not compromised during typical working hours.

In one embodiment the URL analysis module may be configured to examine requested URLs e.g. URLs not previously categorized and generate a score or other data indicative of whether the URL is likely to reference targeted e.g. active content. In one embodiment the URL analysis module may comprise a reputation scoring module such as an embodiment of the reputation scoring module of that generates a score or other data representative of a reputation of the URL.

When located within the gateway server module the reputation scoring module of the URL analysis module may directly analyze the reputation of the URL using local data and databases to determine a score with minimal latency. The reputation scoring module may communicate with one or more databases of the database management module see to obtain additional information about the URL or components of the URL for determining a score for the URL.

The URL analysis module need not include the reputation scoring module and instead may rely upon a remotely located reputation scoring module. For example a reputation scoring module may be located at the database management module as is illustrated in the embodiment of the database management module in . The URL analysis module communicates the requested URL to the database management module for scoring by the remotely located reputation scoring module . The database management module communicates the results of the analysis performed by the reputation scoring module back to the gateway sever module . The gateway server module may rely upon the results received from the database management module to determine under what conditions the user will be allowed access to the website associated with the requested URL. The gateway server module may further rely upon a predetermined policy associated with the user when determining whether access will be allowed. Advantageously a remotely located reputation scoring module may be shared by multiple gateway server modules . A remotely located scoring module may reduce the complexity of the software needed at the gateway server module .

In other embodiments the functionality of the reputation scoring module may be shared between the gateway server module and the database management module . Such an arrangement may provide benefits to the latency of the scoring process while still providing the benefit of shared access.

For example a higher reputation score may be indicative of the likelihood that the website associated with the URL does not include active content. URLs that are uncategorized might still have a high reputation score if the host internet protocol IP address of the URL is the same e.g. the hostname is merely an alias as a host IP for which categorized URLs are not associated with active or other targeted content. Conversely if the host IP address is the same as a host IP address that is associated with active or other targeted content the reputation score may be low. Of course depending on the embodiment different score ranges or different interpretations of scores e.g. high scores indicative of a bad URL reputation may be used.

It is to be recognized that data or a score indicative of the reputation of a URL may be based on one or more different data elements and analysis. Examples of ways of generating reputation scores are discussed below with reference to a reputation scoring module illustrated in . The URL analysis module may use one or more of the reputation scoring techniques described with reference to to generate a URL a score or other indicator of reputation.

A score indicative of a reputation may be generated for a URL requested by a user or for a URL requested by a proxy on behalf of the user. For example applications such as web feed readers or other types of content aggregators collect data on behalf of a user through a single aggregating URL. Well known examples of these types of applications include Google Reader http www.mynewsbot.com MyYahoo NewsGator and the like. These types of applications typically allow a user of the workstation to designate or subscribe to various external web sites that offer syndicated content. The web feed reader or aggregator visits each of the websites or URLs subscribed to by the user and gathers the syndicated content from the visited websites. Examples of known web feed protocols for gathering or aggregating syndicated content include RSS and ATOM. The syndicated content is often delivered to the aggregating website and displayed to the user under the aggregating protocol s URL. The aggregated content may be delivered to the aggregating website for example in the form of an XML package and includes URLs associated with the websites from where the content was gathered.

Unlike the website URLs the aggregating protocol s URL under which the content is displayed is not specific to the user or to the gathered content. For example content aggregated by yahoo s web feed reader is displayed under the URL http my.yahoo.com . Because the single aggregating URL such as http my.yahoo.com is not specific to the user or gathered content in one embodiment the reputation scoring module does not rely exclusively upon the aggregating URL to determine one or more reputation scores for the website URLs. In such an embodiment the reputation scoring module whether residing within or remote from the gateway server module preferably relies upon an analysis of the website URLs associated with the gathered content to generate reputation scores. In one embodiment the content filtering module provides the website URLs associated with the gathered content to the URL analysis module. Each reputation score may then be unique to each website URL and relied upon by the gateway server module to determine under what circumstances if any the user will be allowed to access the content associated with each scored website URL gathered by such types of web feed reader applications.

The gateway server module may apply this same process to a listing of URLs returned in response to a search engine request. The gateway server module analyzes each of the returned URLs to generate reputation scores. Each reputation score may then be unique to each listed URL and relied upon by the gateway server module to determine under what circumstances if any the user will be allowed to access the content associated with each scored URL listed by the search engine.

The gateway server module may also apply these technique to interactive websites and content. For example in developing the web into more of a communication platform several web properties are allowing interactive content uploads by end users. Examples include but are not limited to MySpace FaceBook GooglePages etc. The content on these sites is often based on active technologies such as JavaScript XML and Ajax. To analyze these types of pages and content the gateway server module may rely at least in part on the top level category of the domain in combination with the analysis by the reputation scoring module of the content and referenced links on the website.

The URL analysis module may provide its score to the policy module . The policy module can be configured to implement different policies depending on the score the user or any other applicable parameters. Thus in one embodiment the URL analysis module may generate a sufficiently high reputation score e.g. indicative of a good reputation or low likelihood of active or other targeted content for an uncategorized URL so that the policy module allows access to the uncategorized URL when the policy module would otherwise not allow access to the URL. Alternatively the policy module may be configured to block access to URLs with low scores e.g. indicative of poor reputation or higher likelihood of active or other targeted content where the applicable policy might otherwise allow access to the URL.

Referring now to the table of uncategorized URLs is provided described earlier in connection with . This table may be populated by URL requests from the workstation which request URLs that are not present in the categorized URL content database . As will be described in greater detail below the gateway server module may be configured to query the categorized URL content database to determine whether a requested URL should be blocked. If the requested URL is in the categorized database the policy module may determine whether to allow the request to proceed to the internet . If the requested URL is not found in the categorized URL content database however it may be added to the database of uncategorized URLs so that it may be sent to the database management module via the Internet and later analyzed and categorized and downloaded into the database of categorized URLs .

In one embodiment the database management module may include an upload download module . The upload download module may be a software or hardware component that allows the database management module to send and receive data from the Internet to any number of locations and may depending on the embodiment operate in a substantially similar manner as the upload download module on the gateway server module . In one embodiment the upload download module is configured to send newly categorized URLs to gateway server modules on the Internet for addition to their local categorized URL content databases .

The database management module may also include a database management module URL content database . The database management module URL content database may take the form of a data warehouse which stores URL strings and information about URLs that have been collected by a collection system which will be described in further detail below. The database management module URL content database may be a relational database that is indexed to provide quick and effective searches for data. In certain embodiments the URL content database may be a data warehousing application which spans numerous physical hardware components and storage media. The URL content database may include data such as URL strings the content associated with those strings information about how the content was gathered e.g. by a honey client by a customer submission etc. and possibly the date in which the URL was written into the URL content database .

The database management module may further include a training system . The training system may be a software hardware module which is used to define properties and definitions that may be used to categorize web based content. The database management module may further provide a scoring classification system which utilizes the definitions and properties created by the training system to provide a score or classification e.g. a categorization to web content so that the categorization may be delivered via the upload download module to gateway server modules .

With reference now to a more detailed view of the collection system is provided. The collection system may include a database management collection module which is coupled either directly or indirectly to a data mining module . The database management collection module may be used by the database management module to collect data for the URL content database about URLs that have not been categorized. The database management collection module may also be used to collect URLs for additional analysis by other system components. The database management collection module may be associated with one or more collection sources from which it may collect data about URLs. Collection sources may take various forms. In some embodiments the collection sources may include active and passive honeypots and honey clients data analysis of logging databases stored on the gateway server module to identify applications URLs and protocols for collection. The collection sources may also be webcrawling applications that search the Internet for particular keywords or search phrases within page content. The collection sources may also include URLs and IP addresses data mined from a DNS database to identify domains that are associated with known malicious IP addresses. In some embodiments URLs for categorization may be collected by receiving malicious code and malicious URL samples from other organizations who share this information. In yet other embodiments URLs may be collected via e mail modules configured to receive tips from the public at large much in the way that criminals are identified through criminal tip hotlines.

Referring now to a more detailed view of the database management collection module is provided. The database management collection module may include various subcomponents that allow it to effectively utilize each of the collection sources described above. The database management collection module may include a search phrase data module and an expression data module . The search phrase data module collects and provides search phrases that may be relevant to identifying inappropriate content. The expression data module may include various types of expressions such as regular expressions operands or some other expression. The search phrase data module and the expression data module each may include updateable record sets that may be used to define the search parameters for the web crawling collection source . The database management collection module may also include a priority module . The priority module may take the form of a software process running within the collection system or it may run as a separate process. The priority module may be used to prioritize the data collected by the database management collection module in order to have more potentially dangerous or suspect URLs or data receive close inspection prior to the likely harmless URLs. In one embodiment the priority module may assign priority based on the collection source from which the URL is received. For example if a URL is received from a customer report it may be designated with a higher priority. Similarly if the URL is received from a web crawler accessing a domain or IP address or subnet known to host malicious content in the past the URL may receive a high priority. Similarly a potentially dangerous website identified by a honey client discussed in further detail below may also receive a high priority. The database management collection module may also include a data selection module which may work with the priority module to determine whether identified URLs should be tagged as candidate URLs for categorization. In one embodiment the data selection URL may provide a user interface for receiving search parameters to further refine the prioritized data by searching for data based on priority and content.

As indicated above the collection module may also include a data download module . The data download module may be configured to identify URLs to visit and to download data and content from the visited URLs. The data download module may work in conjunction with various subsystems in the database management collection module to retrieve data for the URL content database . One such subsystem is the webcrawler module . The webcrawler module may be a software application configured to access websites on the Internet by accessing web pages and following hyperlinks that are included in those pages. The webcrawler module may be configured with several concurrent processes that allow the module to simultaneously crawl many websites and report the visited URLs back to the database management module URL content database as will be discussed in further detail below. The database management collection module may also include a honey client module . The honey client module is a software process configured to mimic the behavior of a web browser to visit websites in such a manner that is inviting to malicious code stored within the visited pages. The honey client module may visit the web sites and track the behavior of the websites and download the content back to the URL content database for further analysis.

The database management collection module may also include a third party supplier module which is configured to receive URLs and associated content from third parties. For example the third party module may be configured to provide a website which may be accessed by the general public. The module may be configured to receive an input URL string which may then be entered into the URL content database . In some embodiments the third party module may also be configured to receive e mails from private or public mailing lists and to identify any URL data embedded within the e mails for storage in the URL content database .

The database management collection module may also include a gateway server access module . The gateway server access module is a software component or program that may be configured to regularly access the logging database on the gateway server module to download upload all of the newly uncategorized web content identified by the logging database .

Referring back to the collection system may also include a data mining module . The data mining module may be used to obtain additional data about URLs stored in the database management module s URL content database . In many instances the information supplied by the collection sources to the database management collection module and URL content database is limited to nothing more than a URL string. Thus in order for the system to effectively categorize the content within that URL more data may be necessary. For example the actual page content may need to be examined in order to determine whether there is dangerous content embedded within the URL. The data mining module is used to collect this additional necessary data about the URLs and will be discussed in further detail below.

In one embodiment each control server may control passive honey miners . The control servers may extract or receive URLs from the URL database which need additional information in order to be fully analyzed or categorized. The control servers provide the URLs to the miners which in turn review the URLs and store the collected data. When a passive miner is finished with a particular URL it may request another URL from its control server . In some embodiments the miners may be configured to follow links on the URL content so that in addition to visiting URLs specified by the control server the miners may visit content that it linked to those URLs. In some embodiments the miners may be configured to mine to a specified depth with respect to each original URL. For example the miners may be configured to mine down through four layers of web content before requesting new URL data from the control server .

In other embodiments the control servers may be configured to control active honey miners . In contrast to the passive honey miners which only visit web sites and store the content presented on the sites the active honey miners may be configured to visit URLs and run or execute the content identified on the sites. In some embodiments the active honey miners include actual web browsing software that is configured to visit websites and access content on the websites via the browser software. The control server or the honey miners themselves may be configured to monitor the characteristics of the honey miners as they execute the content on the websites they visit. In one embodiment the control server will record the URLs that are visited by the honey miners as a result of executing an application or content on the websites visited. Thus active honey miners may provide a way to more accurately track system behavior and discover previously unidentified exploits. Because the active honey miners expose themselves to the dangers of executable content in some embodiments the active honey miners may be located within a sandbox environment which provides a tightly controlled set of resources for guest programs to run in in order to protect the other computers from damage that could be inflicted by malicious content. In some embodiments the sandbox may take the form of a virtual machine emulating an operating system. In other embodiments the sandbox may take the form of actual systems that are isolated from the network. Anomalous behavior may be detected by tracking in real time changes made to the file system on the sandbox machine. In some embodiments the code executed by the active honey miners may cause the machine on which they are running to become inoperable due to malicious code embedded in the webpage content. In order to address this issue the control server may control a replacement miner which may step in to complete the work of a honey miner which is damaged during the mining process.

Referring now to an example of a set of URL related data that has been collected by the collection system is provided. Although a particular example of collected data is provided one of skill in the art will appreciate that other data might be collected in addition to the data provided in this example. Included in the collected data is an IP address for the URL. The IP address may be used to identify websites that are hosting multiple domains of questionable content under the same IP address or on the same server. Thus if a URL having malicious content is identified as coming from a particular IP address the rest of the data in the URL content database may be mined for other URLs having the same IP address in order to select them and more carefully analyze them. The collected URL data may also include a URL as indicated by the second column in . In instances where the data is collected using a mining process such as the honey client process described above the URL may often include various pages from the same web domains as the miners may have been configured to crawl through the links in the websites. The collected data may also include the page content for a particular URL. Because the content of a URL may be in the form of graphics text applications and or other content in some embodiments the database storing this URL data may be configured to store the page content as a binary large object blob or application objects in the data record. However as some web pages contain text exclusively the page content may be stored as text as well. In some embodiments the collection routine may be configured to determine whether the URL contains executable content. In these instances the resultant data set of collected data may include an indication of whether the URL has executable content within its page code. This information may be later used in selecting data from the URL content database as candidate data for analysis.

For example a URL that is processed by the content analysis module may receive a malicious category. The content scoring module may then associate a score e.g. a low score with the URL that is indicative of the URL not being malicious. To resolve the content scoring module may provide the URL as a candidate URL to the active analysis module to identify further properties or a behavior score that can be used by the content scoring module to determine whether the malicious category is appropriate.

The properties database includes keywords regular expressions and other web page properties that can be used to categorize web pages. Properties may also be values associated with the web page such as HTTP request header data or other meta data associated with the web page. For example properties may includes keywords to be identified in the document such as regular expressions such as data . .txt e.g. the keyword data followed by an arbitrary length string followed by .txt or the content type of the data from the HTTP header. is an example of a properties database that includes the property and an additional field identifying the type of property e.g. a keyword or a regular expression. In the illustrative database a property ID field is used to provide a unique within the database identifier for each property. In other embodiments other suitable types of keywords may be used.

In one embodiment the content analysis module receives candidate URLs from the URL database that have been identified by the collection system . The content analysis module receives the content and other data associated such as the HTTP header with the URLs and identifies one or more of the properties in the properties database that are associated with the candidate web pages and stores data relating to those properties in the processed web page properties database . The content analysis module may receive the content of the candidate web pages from the URL database or it may download the data itself. In one embodiment the honey client module obtains and stores the content of each candidate web page in the URL database. In another embodiment the content analysis module downloads the content of the candidate web pages as part of processing the web page for properties.

In general the properties database stores the properties and sufficient information to identify the properties associated with a web page. For example for keyword or regular expression properties the properties database may store the keyword or regular expression. In contrast the processed web page properties database may store counts of the keyword or regular expression found to be associated with each web page by the content analysis module . For regular expressions depending on the embodiment either a count of matching expressions or the matching expressions themselves or both may be stored in the processed web page properties database . For example for a particular web page the processed web page properties database might store the value 3 referring to the number of times that the property appears in the page 0 for the number of times the property appears and data http www.example.url example.txt. for the regular expression property data . .txt. 

In one embodiment the static content classification module accesses web page properties database and compares the properties for one or more web pages with definitions from the definitions database . When a web page matches a particular definition the web page is identified with one or more categories associated with the definition. In one embodiment these categories are stored in the URL database in association with the URL. In one embodiment each definition is expressed in terms of one or more properties of the web page. In one embodiment definitions are expressed as first order logical operations relating one or more of the properties. In one embodiment terms of the definition are comprised of comparisons between web page properties or between properties and values including constant values . For example a definition might include an expression such as property 1 property 2 AND occurrences of property 3 5. In addition to comparisons terms may include other operations on web page properties such as mathematical string or any other suitable computational expression. For example a simple definition can be data .txt data xyx333.txt which matches any web page having as part of its content the string data xyx333.txt which matches the regular expression property data .txt . More complex definitions may comprise logical operations on the terms. Such logical operations may include AND OR NOT XOR IF THEN ELSE or regular expression matches on the properties. In one embodiment the definitions may also include or correspond to database query expressions such as standard SQL database comparison functions and logical operations. In one embodiment definitions may include executable code such as scripts or references to executable programs or scripts that at least partially determine a classification for a URL. illustrates an exemplary portion of a definitions database according to one embodiment. As used herein categories can refer to any type of classification. For example a category may be merely a classification that indicates that further processing or analysis be performed for the URL to identify a category for the URL.

In one embodiment the content scoring module further analyzes web pages and assigns a score to the web page associated with one or more categories. In one embodiment the score may be based on a weighted combination of the number of times that keywords are found in the web page. In one embodiment the weights are stored in the properties database in association with the corresponding property. In one embodiment the content scoring module communicates such URLs to the active analysis module for additional analysis.

In one embodiment the content scoring module bases the score at least partly on a reputation score generated by the reputation scoring module . In one embodiment the reputation scoring module may be configured to associate a score with a URL based on information about the URL including URL components such as the URL scheme e.g. http the host e.g. www.uspto.gov the path e.g. index.html the query e.g. the portion following a and the fragment the portion following a . The reputation scoring module may generate the scores based on information about the URL of the web page e.g. scoring criteria such as one or more of URL content strings Geo location data associated with the URL e.g. the URL host or host domain the name server that provides the IP address of the URL host or its domain the network or blocks of IP addresses associated with the host IP address or its domain active content previously identified with reference to the host the hosts domain or the URL path historical data associated with the IP address of the URL host creation date or expiration date associated with the registration of the URL host whether search engine results exist for the URL or the URL host certificate details associated with the URL e.g. for secure such as HTTPS access schemes meta tag categories associated with other URLs associated with the URL host e.g. such as in the URL database or the processed web page properties database categories associated with other URLs of the URL host e.g. in the URL database a fingerprint e.g. a digest or hash associated with the content of the URL for comparison to such data of previously categorized URLs and to generate reputation data depending on whether URLs with the same fingerprint had targeted content and scoring based on site host or domain access statistics e.g. generate higher reputation scores for frequently visited sites than for infrequently visited sites because frequently visited sites for other URLs that do not have targeted content are less likely to have targeted content in newly visited URLs . In one embodiment the reputation scoring module may generate a score that comprises a weighted average of one or more such criteria. It has been found that URLs having targeted content are more likely to include machine generated random or other strings that do not conform to word formation rules in order to avoid such content from being easily identified by the inclusion of known disreputable URL strings. Thus in one embodiment the reputation scoring module compares URL strings to dictionary words or to word formation rules and generates at least a partial score based on this comparison. In addition to scanning for keywords the URL string or substring may be compared to a word or more generally a concatenation of one or more words from a dictionary to help determine whether the URL string includes words or appears to be a random machine generated include sequences of escaped e.g. escaped characters or include long nonsense strings e.g. www.XXXXXXxxxxxxxxxxxyyyyyyyyyyyyyyzzzzzzzzzzzzzzzzzzzzzzzz.com . In one embodiment dictionaries for one or more languages may be used. Word formation rules may be any set of rules associated with words in a particular language. For example in one embodiment a simple word formation rule may identify strings of consonants or vowels that exceed a specified threshold e.g. four in length are unlikely to be a word. More sophisticated word formation rules may also be used that generate scores based on unlikely combinations of letters e.g. xqv in English in the URL string. For example in one embodiment a suitable information theoretic measure of information content such as information entropy may be calculated for one or more component of the URL the URL and or content of the URL. Because strings containing random information tend to have a higher entropy measure randomly generated data associated with a URL can be identified by scoring the URL based on entropy or by comparing the entropy or entropy relative to length of data associated with a URL URL components the URL string and or content of the URL to a threshold.

It has been found that certain combinations of the scoring criteria are particularly useful for identifying active or other target content because for example the set of criteria covers a number of different ways that targeted active content might be created to avoid detection. Thus in one example embodiment the URL score combines scoring criteria including an entropy score a score based on historical data associated with the URL search results associated with the URL and historical data associated with the IP address of the URL.

In one embodiment the reputation scoring module generates scores based on a database of internet addresses and or domain names. The reputation scoring module may assign scores to entire subnetworks e.g. all addresses matching 128.2. . may have a particular score . Such networks or subnetworks help identify a web site as being based in a particular country or with a particular service provider. This has been found to be useful in scoring because certain countries and service providers have been correlated with certain types of web content due to different laws or lax enforcement of laws. The scoring system of networks or subnetworks may be based on the relative number of URLs in particular networks or domains that have a particular category. For example if 95 of the URLs for a particular network in the URL database are classified as having malicious active content new URLs may be given a score indicative of the likelihood that other URLs referencing servers in the same network are also likely to have such targeted content.

In an embodiment the reputation scoring module generates an indicator of reputation such as a reputation based on information about the registrar of the site e.g. the domain name of a URL host . Such registrar information may include for example the identity of the registrar the registrant including address and contact information of the registrant when the registrar record was created when the registrar record was last updated when the registrar record expires and any other registrar data including data provided by the WHOIS protocol e.g. Internet Engineering Task Force IETF RFC 3912 .

The reputation scoring module may include a database of changes in registrar data of at least a portion of the URLs in the URL database . The frequency or recentness of changes to registrar data associated with a URL may be used to at least partly to generate the reputation score. The reputation score for a URL may be generated at least partly by comparing at least part of the registrar data associated with the URL with registrar data of previously categorized URLs.

Hosts of targeted content may attempt to confuse or hide their content from filters by using a multiplicity of host and domain names and by frequently changing IP addresses associated with domains. The reputation scoring module may generate reputation indicator data or scores based on a reputation of the name server which is common to the multiple hosts and domains associated with the name server. For example the reputation scoring module may include a database of nameservers servers that provide domain name system DNS services to translate Internet host names to IP addresses . Generally particular servers provide DNS services for a particular domain. Thus if the nameserver for a URL host is the nameserver for other hosts that have previously been categorized or identified with targeted content the reputation scoring module may utilize this information when generating a reputation score for the uncategorized URL. For example if the nameserver is associated with targeted content the reputation score of the uncategorized URL may be low. The reputation scoring module may also maintain a database of hosts to IP addresses and utilize the database to generate a score based on the frequency with which the IP address changes for a particular host or domain.

In one embodiment URLs with scores above a threshold are identified with a category e.g. malicious regardless of or in addition to the category identified by content analysis of the web page. In one embodiment multiple scores associated with different categories are assigned to each URL and the categories corresponding to each score above a given threshold are identified with the URL. In one embodiment multiple thresholds are employed. For example URLs having scores above one threshold value automatically are classified based on the score. In one embodiment URLs having scores that are below the first threshold but above a second threshold are communicated to a human analyst for classification.

One embodiment may include a scoring and categorization system such that illustrated in U.S. Pat. No. 6 606 659 entitled SYSTEM AND METHOD FOR CONTROLLING ACCESS TO INTERNET SITES which document is incorporated by reference in its entirety.

In one embodiment the active analysis module executes active content of a web page to identify its behavior properties. These properties may then be used to score and classify the web page. In one embodiment one or more of the static content classification module the reputation scoring module and the content scoring module identifies URLs for processing by the active analysis module . After receiving candidate URLs the active analysis module may provide a behavioral score or data associated with one or more behavior properties e.g. a property such as writes to registry to the content scoring module for further categorization.

A property identification module identifies properties of the web page and definitions based on those properties that categorize the web page. In one embodiment the properties identification module provides an interface for a human analyst to apply particular rules or definitions to a URL using the scoring and classification system . In addition in one embodiment the property identification module may provide an interface for the analyst to identify the URL as a candidate for the active analysis module of to perform behavioral analysis of the URL to receive additional data for classifying the URL back from the active analysis module . The property identification module may then provide this data to the analyst. In one embodiment the analyst analyzes URL data from the scoring and classification system including the active analysis module to help identify properties and definitions that properly classify the URL and where possible other URLs that refer to similarly classified content. In one embodiment property identification module provides these newly identified properties and definitions to a database update module that stores the new definitions and properties to the properties database and the definitions database .

A behavioral analysis module compares the monitored actions from the sandbox module with a list a database or rules that characterize the monitored actions. In one embodiment these characterizations define properties of the URL that are subsequently analyzed by the static content classification module of . In another embodiment an active scoring classification module may use scores associated with behavioral properties to determine a score for the URL. In one embodiment the score is a weighted score of these properties. This score may be used to classify the URL or be communicated to the content scoring module for classification. In another embodiment rules or definitions such as those from the definitions database are applied to the behavioral properties of the URL and in one embodiment the processed web page properties to identify one or more categories associated with the URL. In one embodiment the score of a URL may be at least partly based on identified categories of other URL references within the content of the URL. For example if the site is unclassified but all the identified categories for the reference e.g. using an HTML HREF element are malicious then the URL may be given a score indicative of the malicious content.

Depending on the embodiment the acts or events of the methods described herein can be performed in different sequences can be merged or can be left out all together e.g. not all acts or events are necessary for the practice of the method unless the text specifically and clearly states otherwise. In addition the methods described herein can include additional acts or events unless the text specifically and clearly states otherwise. Moreover unless clearly stated otherwise acts or events may be performed concurrently e.g. through interrupt processing or multiple processors rather than sequentially.

As discussed above in connection with in some embodiments the gateway server module may be configured to control access to certain URLs based on data stored in the categorized URL database . is a flowchart describing an embodiment in which the gateway server module handles a request from a workstation .

At block the workstation requests a URL from the Internet . This request is intercepted at the Internet gateway and forwarded to the gateway server module at block . At block the categorized URL database is queried to determine if the requested URL is stored in the database . If the requested URL is found as a record in the database the process moves on to block where it analyzes the URL record to determine whether the category of the URL is one that should be blocked for the workstation user. If the category is blocked the process skips to block and the request is blocked. If the category is not blocked however the request is allowed at block .

If the requested URL is not found as a record in the categorized URL database at block the system proceeds to block . At block the system determines how to handle the uncategorized content. In some embodiments the system may utilize the policy module to make this determination. If the gateway server module is configured to block requests for uncategorized content the process moves to block and the request is blocked. If on the other hand the module is configured to allow these types of uncategorized requests the process moves to block where the request is allowed to proceed to the Internet .

In some embodiments the request of URL data may result in new records being added to the logging database . These records may be later transferred to the database management module for further analysis. Referring now to another flowchart describing a process by which the gateway server module may handle a URL request is provided. At block the gateway server module receives a request for a URL. As noted above this request may come from a workstation . At block the URL is then compared against the categorized URL database and the system determines at block whether the requested URL is in the categorized URL database.

If the URL is already in the categorized URL database the process skips to block . If the requested URL is not found in the categorized URL database however the process moves to block where the URL is inserted into the uncategorized URL database . In some embodiments the logging database and the uncategorized URL database may be the same database. After inserting the URL into the database the method proceeds to block . At block the policy database is checked for instructions on how to handle the received URL. Once the policy module has been checked the logging database is updated to record that the URL has been requested at block . If the workstation is permitted to access the URL by the policy database the process moves to block and the URL request is sent to the Internet . If however the policy database does not allow the request the process skips to block and the request is blocked.

In some embodiments the gateway server module may perform collection activities to lessen the burden on the collecting system of the database management module . provides an example of a system in which the gateway server collection module is used to collect data about an uncategorized URL. At block the gateway server module receives a request for a URL. Next at block the requested URL is compared against the categorized URL database. If the system determines that the requested URL is in the URL database at block the process moves to block where the request is either forwarded to the Internet or blocked depending on how the URL is categorized.

If the requested URL is not in the categorized URL database the process moves to block where the URL is sent to the gateway server collection module . Next at block the collection module collects URL data about the requested URL. In some embodiments this data may be stored in the uncategorized URL database . Alternatively this data may simply be forwarded to the database management module via the Internet . Once the data has been collected and stored the process moves to block where the URL request is either allowed or blocked based on the policies indicated in the policy module .

As discussed previously uncategorized URL data may be sent from the gateway server module to the database management module for further analysis so that the URL may be categorized and added to the categorized URL database . However because the volume of uncategorized data is so large at times it may not be possible to categorize all of the received data without compromising accuracy or speed. As a result in some instances it may be desirable to identify candidate URLs within the uncategorized data that are most likely to present a threat to workstations and networks .

As discussed above one of the challenges to collecting and analyzing Internet data to determine whether it includes harmful active content is the sheer volume of data that must be collected and analyzed. In yet another embodiment the data mining module may be used to address these issues by collecting large volumes of relevant data to utilize system resources effectively and efficiently. Referring now to a more detailed block diagram of the data mining system is provided. The data mining system may take the form of a software module that runs a plurality of asynchronous processes to achieve maximum efficiency and output. The data mining system may include a plug in module which receives configuration parameters which provide instruction on how inputted data should be handled. In one embodiment the instructions received by the plug in module may take the form of an HTTP protocol plug in that provide parameters for the data mining system to receive URL data and analyze and supplement the data based on various HTTP related instructions implemented by the data mining system on the URL data. In another embodiment the plug in may be geared toward mining some other protocol such as FTP NNTP or some other data form.

The data mining system which may also be used to implement passive honey clients also include a pool of dispatchers . The dispatchers are individual asynchronous processing entities that receive task assignments based on the data input for analysis into the data mining system and the configuration data received by the plug in module . The pool is a collection of the dispatchers that is controlled by a driver . The driver is a managing mechanism for the pool. The driver may be configured to monitor the activity of the dispatchers in the pool to determine when to send additional data into the pool for mining and analysis. In one embodiment the driver may be configured to send new data units into the pool whenever any dispatchers are idle. In one embodiment the driver may be utilized as a control server for managing honeyclient miners as described above in connection with . The pool may deliver the data unit to the idle dispatcher . The dispatcher reads the plug in configuration and performs actions in accordance with plug in module .

In one embodiment the plug in module may receive an HTTP plug in. The HTTP plug in may be configured to receive input data in the form of URL strings about which the data mining system will obtain additional information such as the page content for the URL HTTP messages returned by the URL when accessed such as 4xx file not found or 5xx server error . The plug in may further specify a webcrawling mode in which the dispatches in addition to collecting page content also add URL links within the URL content to the URL data set to be analyzed.

Moving to a block the content analysis module identifies one or more properties associated with each of the identified web pages. Functions of block are described in more detail hereafter with reference to . Proceeding to a block the static content classification module identifies web pages with one or more categories based at least partly on properties. In one embodiment the static content classification module compares definitions from the definitions database with the properties of each web page to identify its properties. In one embodiment the categories include those indicative of whether the web page is associated with active content. In one embodiment the categories include those indicative of types of active content e.g. malicious phishing sites keyloggers viruses worms etc. associated with or referenced by the web page. In one embodiment the active content is included in the body of the web page. In one embodiment the active content is referenced in a link or ActiveX object element of the web page. In one embodiment active content includes interactive phishing sites that include content tending to mislead users into providing credentials or other sensitive private or personal information. In one embodiment the scoring module further scores and classifies the web pages. Moving to a block the categories associated with the web pages are stored in the URL database. In one embodiment the upload download module of distributes the new URL categories to one or more gateway server modules or workstations both of . In one embodiment one or more blocks of the method e.g. blocks may be performed either continuously as new URLs are received by the collections module . In one embodiment one or more blocks of the method e.g. blocks may be performed periodically.

Moving to a block the static content classification module compares the properties of the URLs in the web page properties database to the query to identify URLs matching the query. In one embodiment the static content classification module performs the comparison by executing the one or more identified database queries against the processed web page properties database . Next at a block the static content classification module compares any identified URLs with the definition to identify any of the identified URLs that match the definition. In one embodiment this comparison includes comparing the results of the database query using additional executable instructions such as a Perl script to identify matching URLs. Proceeding to a block the static content classification module categorizes the identified URLs based on the definition. In one embodiment each definition is associated with a single category. In another embodiment each definition is associated with several categories that are each identified with the URL. In yet another embodiment the definition may include logical expressions that identify one or more categories to identify with the URL. For example an if then else expression may identify different categories depending on the result of the if expression. In one embodiment the content scoring module further scores the URL. Based on the score the same different or additional categories may be identified with the URL. Next at a block the static content classification module stores the categories of each URL to a categorized web page database. In one embodiment the URL database includes the categorized web page database.

Methods of generating reputation scores are discussed above with reference to the URL analysis module and the reputation scoring module . It is to be recognized that depending on the embodiment reputation scoring may be performed either as a sole means of allowing access to requested URLs or in combination with URL policies and or URL categories. Moving to a block the gateway server module determines whether to allow access to the URL based at least partly on the reputation score.

Alternatively or additionally the reputation scoring module may provide the reputation score to the content scoring module which may determine a category of the requested URL at least partly based on the reputation score. The gateway server module may rely upon the determined category in combination with the score associated with the URL when determining whether to allow the user access to the website associated with the requested URL.

As used herein database refers to any collection of stored data stored on a medium accessible by a computer. For example a database may refer to flat data files or to a structured data file. Moreover it is to be recognized that the various illustrative databases described in connection with the embodiments disclosed herein may be implemented as databases that combine aspects of the various illustrative databases or the illustrative databases may be divided into multiple databases. For example one or more of the various illustrative databases may be embodied as tables in one or more relational databases. Embodiments may be implemented in relational databases including SQL databases such as mySQL object oriented databases object relational databases flat files or any other suitable data storage system.

Those of skill will recognize that the various illustrative logical blocks modules circuits and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware computer software or combinations of both. To clearly illustrate this interchangeability of hardware and software various illustrative components blocks modules circuits and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention.

The various illustrative logical blocks modules and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

The steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal. In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

In view of the above one will appreciate that embodiments of the invention overcome many of the longstanding problems in the art by providing an efficient means of processing the large numbers of URLs that are available on the Internet to identify categories for URLs particularly those that have active content. URLs having many types of active content may be difficult even for a human analyst to categorize because the relevant properties may be buried in executable code including scripts or in parameters to ActiveX components. The use of properties and definitions that can be efficiently processed allows ActiveX content to be effectively identified by an automatic process. Furthermore by storing the properties of web pages in a database for later querying large numbers of URLs can immediately be categorized based on these stored properties when a new definition of active content is identified.

While the above detailed description has shown described and pointed out novel features of the invention as applied to various embodiments it will be understood that various omissions substitutions and changes in the form and details of the device or process illustrated may be made by those skilled in the art without departing from the spirit of the invention. As will be recognized the present invention may be embodied within a form that does not provide all of the features and benefits set forth herein as some features may be used or practiced separately from others. The scope of the invention is indicated by the appended claims rather than by the foregoing description. All changes which come within the meaning and range of equivalency of the claims are to be embraced within their scope.

