---

title: Device-managing system, managing apparatus, information-processing apparatus, image-processing apparatus, and control method thereof
abstract: The managing apparatus () issues device-control information of the device to a user of the information processing apparatus. The information processing apparatus () determines whether or not the device-control information has been received. If the device-control information has not been received, device-control information prepared in advance is obtained. If the device-control information has not been received, a job for executing processing within the range of the obtained device-control information is sent to the device via a network. If the device-control information has been received, a job for executing processing within the range of the received device-control information is sent to the device. The device () processes the received job within the range of the obtained device-control information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08237947&OS=08237947&RS=08237947
owner: Canon Kabushiki Kaisha
number: 08237947
owner_city: Tokyo
owner_country: JP
publication_date: 20070323
---
The present invention relates to a device managing system having a device a managing apparatus that issues device control information for controlling the device and an information processing apparatus that generates jobs which are processed in the device according to the device control information.

In recent years copiers have gone beyond their function of copying originals and have multiple types of functions such as a function of printing print jobs from external clients and moreover a function of electrically sending scanned originals externally using an email or file transfer function. Such copiers are called MFPs multi function peripherals .

While MFPs have become more multifunctional problems have arisen involving information management such as an increased risk of information leakage due to scanned information being able to be sent externally. And although this has long been an issue since the cost of paper and toner that is consumed increases along with an increased number of sheets printed there is a need to restrict the number of sheets that can be printed by each user.

Addressing these issues is an important issue from a perspective of reducing the TCO total cost of ownership . When this issue is seen from a perspective of an administrator of the system or device it would seem that there is a need to centrally set for each user the functions that can be used and an upper limit number of sheets that can be used as well as to appropriately manage the amount of resources number of sheets of paper for example to be used by each user.

For example Japanese Patent No. 3385258 describes as a method for restricting functions a method in which print tokens functioning as print function restriction information are generated by a management server and function restrictions are achieved by distributing these in advance to printer.

However there is a problem with the above mentioned conventional technique in that print tokens cannot be obtained when a malfunction occurs in the server that generates or manages the print tokens and therefore printing cannot be carried out.

The present invention has been devised to address at least one of these issues. One aspect of the present invention provides an apparatus which maintains function restrictions relating to devices while improving convenience by appropriately allowing function usage even during occurrences of breakdowns.

One embodiment of the present invention provides a device management system comprising a management apparatus configured to issue device control information indicating usage restriction of a device an information processing apparatus that issues a job to be processed on the device within a scope of the device control information and the device for processing the job wherein the management apparatus comprises issuing means arranged to issue device control information of the device to the information processing apparatus wherein the information processing apparatus comprises receiving means arranged to receive device control information issued by the issuing means determination means arranged to determine whether or not the receiving means has received the device control information obtaining means arranged to obtain device control information prepared in advance in the case that a determination is made that the receiving means has not received the device control information and transmission means arranged to transmit to the device via a network a job for executing processing within the scope of the device control information obtained by the obtaining means in the case that the determination means determines that the receiving means has not received the device control information and transmits to the device a job for executing processing within the scope of the device control information received by the receiving means in the case that the determination means determines that the device control information has been received wherein the device comprises receiving means arranged to receive a job sent by the transmission means from the information processing apparatus and processing means arranged to process the job received by the receiving means within the scope of the device control information.

Another embodiment of the present invention provides an information processing apparatus for transmitting to a device a job associated with device control information which has been received from a management apparatus wherein the job is executed within a scope of the device control information indicating usage restriction of a device the information processing apparatus comprising receiving means arranged to receive the device control information from the management apparatus determination means arranged to determine whether or not the device control information has been received from the management apparatus obtaining means arranged for obtaining device control information prepared in advance in the case that the determination means determines that the device control information has not been received from the management apparatus and transmission means arranged to transmit to the device a job to be executed within the scope of the device control information obtained by the obtaining means in the case that the determination means determines that the device control information has not been received from the management apparatus and to transmit to the device a job to be executed within the scope of the device control information received by the receiving means in the case that the determination means determines that the device control information has been received from the management apparatus.

Still another embodiment of the present invention provides a management apparatus to which connected via a network are an information processing apparatus that generates a device job for processing on a device in accordance with device control information relating to usage restriction of the device and a device that carries out a process based on the device job and which management apparatus is arranged to generate the device control information comprising issuing means arranged to issue the device control information of the device to an information processing apparatus in response to a request from the information processing apparatus via the network and setting means arranged to set reuse allowability information indicating allowability of reuse of the device control information.

Yet another embodiment of the present invention provides an image processing apparatus configured to communicate with a management apparatus that issues device control information indicating usage restriction of a device and an information processing apparatus that generates a job to be processed on the device according to the device control information issued by the management apparatus comprising transmission means arranged to transmit device restriction information that has been prepared to the information processing apparatus receiving means arranged to receive a job which includes device restriction information sent by the transmission means from the information processing apparatus determination means that when the device control information contained in a job received by the receiving means permits reuse of the device control information determines the validity of the device control information based on restriction information indicating reuse conditions contained therein and processing means arranged to process the job based on a determination result of the determination means.

Still yet another embodiment of the present invention provides a control method for an information processing apparatus that sends to a device a job including device control information that has been received from a management apparatus and by which a process is executed within a scope of the device control information indicating usage restriction of a device comprising the steps of receiving the device control information from the management apparatus determining whether or not the device control information has been received from the management apparatus obtaining device control information prepared in advance in the case that it is determined in the determination step that the device control information has not been received from the management apparatus and transmitting to the device a job for executing processing within the scope of the device control information obtained in the obtaining step in the case that in the determination step that the device control information has not been received from the management apparatus and transmitting a job for executing processing within the scope of the device control information received in the receiving step in the case that it is determined in the determination step that the device control information has been received from the management apparatus.

Yet still another embodiment of the present invention provides a control method for a management apparatus to which is connected via a network to an information processing apparatus that generates a device job for processing on a device in accordance with device control information relating to usage restriction of the device and a device that carries out a process based on the device job and which management apparatus generates the device control information comprising the steps of issuing device control information of the device to the information processing apparatus in response to a request from the information processing apparatus via the network and setting reuse allowability information indicating allowability of reuse of the device control information.

Still yet another embodiment of the present invention provides a control method for an image processing apparatus which communicates with a management apparatus that issues device control information indicating usage restriction of a device and an information processing apparatus that generates a job to be processed on the device according to the device control information issued by the management apparatus comprising the steps of sending device restriction information that has been prepared to the information processing apparatus receiving a job which includes device restriction information sent in the sending step from the information processing apparatus determining when device control information contained in a job received in the receiving step permits reuse of the device control information the validity of the device control information based on restriction information indicating reuse conditions contained therein and processing the job based on a determination result of the determination step.

Further features of the present invention will be apparent from the following description of exemplary embodiments with reference to the attached drawings.

Preferred embodiments of the present invention will now be described in detail with reference to the drawings. It should be noted that the relative arrangement of the components the numerical expressions and numerical values set forth in these embodiments do not limit the scope of the present invention unless it is specifically stated otherwise.

Connected via a network in the printing control system in are a client PC a print ticket issuing server and a printer .

In the client PC numeral indicates an application that carries out various processes such as data generation and editing and has a role at a time of commencement of printing of sending data to be printed to a print job generating unit . Numeral indicates a user interface unit which provides an input interface operation windows and the like for inputting various print settings to the printer such as paper size double side instructions print resolution and print gradations and inputting instructions to commence printing. Numeral indicates a display unit which outputs display of various images such as a preview display of print data.

Numeral indicates a print ticket control unit. The print ticket control unit manages within the client PC print tickets that are obtained from the print ticket issuing server and that describe various printing conditions and printing restriction information or analyzes the print tickets or carries out print function restriction processing based on the contents of the print tickets. Within the print ticket control unit is configured a print ticket saving unit that saves obtained print tickets for further reuse and in the initial state of the present system saves default print tickets.

Also configured within the print ticket control unit are a print ticket analyzing unit which further analyzes the print tickets and extracts printing conditions and printing restriction information and a function restriction processing unit that carries out function restriction processing during printing based on an analysis result of the print ticket analyzing unit .

Numeral indicates the print job generating unit which receives print data specified from the application and generates a print job to be sent to the printer . Configured within the print job generating unit are a print data analyzing unit which analyzes print data that has been inputted from the application and a print data generating unit which generates PDL page description language data for the printer . Also configured within the print job generating unit is a print command control unit that obtains a printing status of the printer and performs control of all commands for sending and receiving PDL data to and from the printer .

It should be noted that print jobs generated by the print job generating unit include both a case where the print job is generated within the printer from the beginning and a case where a job inputted from an external source is selected and sent.

Numeral indicates a data transceiving unit which carries out sending and receiving of data via the network with the print ticket issuing server or the printer .

Numeral indicates the print ticket issuing server which carries out processing for issuing print tickets including printing restriction information at times of reuse based on print ticket issuance requests of each user from the client PC connected via the network . Also configured within the print ticket issuing server are a data transceiving unit for sending and receiving data to and from the client PC connected via the network and a printing condition management unit which manages printing conditions assigned to each user.

Examples of printing conditions include whether or not printing is permitted prohibited whether or not color printing is permitted prohibited whether or not single sided printing is permitted prohibited and whether or not to override printing so that multiple pages are reduced to fit into a single page. Furthermore it is also possible to set these printing conditions for each output destination such as the application and the printer .

Numeral indicates a process settings unit that functions in particular when a server malfunction occurs. When a malfunction occurs in the print ticket issuing server and print ticket issuance cannot be carried out the process settings unit specifies whether or not reuse of already issued print tickets is allowed and the reuse conditions when reuse is permitted.

Examples of settable reuse conditions include a value for a number of times reuse of a print ticket is to be permitted or a period in which reuse of the print ticket is valid or additional print log information to be held when printing based on reuse or print instruction information of appended information in a print page. It should be noted that instances where reuse is expressed in the first embodiment may be reworded replay. 

Numeral indicates a print ticket issuance processing unit which carries out processing for generating and issuing print tickets including printing restriction information at times of reuse for print ticket issuance requests from the client PC .

Numeral indicates the printer which carries out print processing in response to instructions from the client PC connected via the network or carries out responses and the like regarding the printing status and also carries out status checks and the like of the print ticket issuing server . Also configured within the printer is a data transceiving unit for sending and receiving data between the client PC and the print ticket issuing server which are connected via the network . Moreover configured within the printer is a print ticket processing unit for processing the print tickets received by the data transceiving unit .

The print ticket processing unit also carries out a process of determining whether or not a print ticket contained in print data is valid and a process of determining whether or not reuse is permitted in cases where the print tickets are being reused. Furthermore the print ticket processing unit carries out a process of checking whether or not the print ticket issuing server is in a state unable to issue print tickets or a process of holding print tickets.

Numeral indicates a printing apparatus control unit which analyzes data received by the data transceiving unit and converts a processing state of the printer into a command format to generate data to send to the client PC via the data transceiving unit . Numeral indicates a printing page data processing unit which analyzes the print data sent by the client PC until final print image generation based on a paper discharge code and also generates and accumulates print logs. Numeral indicates an output unit which carries out output control and printing output of print data generated by the printing page data processing unit .

Here the print tickets are achieved by device control information typified by an ACT access control token in which are recorded usage amounts for each unit period upper limit amounts and allowability of usage of functions. In other words an ACT is data that has a role in transmitting from the server to a device for example a printer access restriction information for users allowed to use the system. The ACT describes information relating to function restriction items for job execution by a user and upper limit values including an upper limit of number of sheets for printing.

Here for example an ACT including device control information and usage records is expressed using XML language. Meanings of the tags are indicated below.

It should be noted that the Quota portion to is information obtained from the printing condition management unit . Furthermore the Usage portion to is information obtained from the client PC .

Next a hardware configuration of an information processing apparatus for achieving the client PC and the print ticket issuing server respectively is described using .

In numeral indicates a CPU that is a central processing unit which carries out overall control of the computer device and arithmetic processing and the like. Numeral indicates a ROM that is a read only memory which is a storage area for various data such as system startup programs applications and parameters. Numeral indicates a RAM that is a random access memory which is a data storage area without usage restrictions. The RAM is an area into which an operating system OS applications device drivers and programs for communication control and the like are loaded and executed.

Numeral indicates an input control unit which receives input data through input devices such as a keyboard and pointing device for example a mouse for transfer to the CPU . Numeral is a display control unit which executes display control for a display device. It should be noted that examples of display devices are CRTs LCDs and the like.

Numeral indicates a storage unit. This is a so called external storage device which includes for example a floppy registered trademark disk device a hard disk device and an SRAM nonvolatile storage unit . The storage unit stores and accommodates programs and data which are referenced or loaded into the RAM as required during execution. Numeral indicates a communications unit which carries out network communications control and is able to communicate with other computers for example the client PC or the print ticket issuing server and peripheral devices for example the printer connected on the network of . Numeral indicates a system bus that connects between the aforementioned structural elements and achieves routes for sending and receiving data.

It should be noted that the printer of uses as an example a case of an MFP having a plurality of functions including a printing function a scanning function and a data transceiving function.

In numeral indicates a controller unit that controls the entire printer . Numeral indicates a CPU that is a central processing unit which carries out control and arithmetic processing and the like for the controller unit as part of an internal configuration of the controller . Numeral indicates a ROM that is a read only memory which is a storage area for various data such as system startup programs applications and parameters. Numeral indicates a RAM that is a random access memory which is a data storage area without usage restrictions. Numeral indicates a storage unit. This is a so called external storage device which includes for example a hard disk device and an SRAM or the like.

The RAM is an area into which an operating system OS and programs for communication control and engine control and the like are loaded and executed. Numeral indicates an input output engine unit which executes printing operations and image reading operations under the control of the controller . As a specific example the input output engine unit is configured having a printer engine for executing printing using a printing method such as a laser beam method and a scanner engine having a paper feeding mechanism such as ADF Auto Document Feeder .

Numeral indicates a communications unit which carries out network communications control and is able to communicate with the client PC and the print ticket issuing server on the network of . Numeral indicates a user operation input output unit which carries out interactive settings operations with the user. For example the user operation input output unit is configured from an input device such as a touch panel and various keys and buttons and a display device. Numeral indicates a system bus that connects between the aforementioned structural elements and achieves routes for sending and receiving data.

In the first embodiment a system of add ins is arranged that appends adds functions to a printer driver of the printer . This makes it possible to add various functions to the client PC . The add ins are constituted by a UI add in unit and a graphics add in unit and exchange between these units and the printer driver is carried out from their respective add in I F and via an add in API Application Programming Interface .

Configured within the UI add in unit are a print ticket obtaining unit which obtains centrally managed print tickets from the print ticket issuing server and a print ticket analyzing unit which analyzes print tickets that have been obtained and saves them in the print ticket saving unit . Also configured within the UI add in unit are a print settings information setting unit for setting print tickets in the driver information of the OS and an encryption engine unit for generating encrypted information to be used in falsification detection.

Here when instruction has been given for print commencement the UI add in unit obtains a print ticket from the print ticket saving unit and sets this in the driver information then sends the print ticket and encryption information to be used in falsification detection to the graphics add in unit . Furthermore when the print settings window created by the printer driver is closed the UI add in unit compares the settings information in that print settings window with the printing restriction information and displays a warning message if there is any discrepancy between these.

Configured within the graphics add in unit are a print settings information verifying unit which verifies driver information and a secure job converting unit which converts print job data into data enabling detection of falsification. Furthermore configured within the graphics add in unit is the encryption engine unit which generates encryption information necessary for falsification detection.

When instruction has been given for print commencement the graphics add in unit verifies whether or not the device control information is reflected in the driver information. Then the print ticket containing the device control information is added to the print job data sent from the printer driver . Next using the encryption information created by the encryption engine unit the print job data is converted by the secure job converting unit into data enabling detection of falsification.

Next description is given using concerning a processing flow of the printing control system during normal operation of the print ticket issuing server of the first embodiment.

In first 1 a client PC sends a print ticket request to the print ticket issuing server along with user information and output destination printer information.

Next 2 the print ticket issuing server carries out user authentication based on the user information and if the user is legitimate obtains printing condition information which is managed for each user inside the print ticket issuing server then generates a print ticket based on a combination of this with the output destination printer information. Then the print ticket issuing server sends the print ticket to the client PC .

Next 3 the client PC saves the obtained print ticket and generates a print job for sending to the printer according to the printing conditions described in the print ticket.

With the above described processing printing can be provided according to the printing condition information managed for each user by the print ticket issuing server .

Step S the print settings information setting unit sets a printing restriction value in the printer driver .

 1 When the user is not logged on to the domain pertaining to the print ticket issuing server a warning message is displayed and printing is canceled.

 2 When the device for output is not connected to a standard TCP IP a warning message is displayed and printing is canceled.

 3 When the present add in is not installed in a correct sequence with other add ins a warning message is displayed and printing is canceled.

Step S the UI add in unit obtains a device host name of the device that will perform printing. When a device host name cannot be obtained a warning message is displayed and printing is canceled.

Step S the print ticket obtaining unit obtains the latest print ticket from the print ticket issuing server .

When there is a failure in obtaining a print ticket a process to be described later is executed for the case of there being a failure in obtaining a print ticket.

Step S the print ticket analyzing unit analyzes the print ticket and obtains the printing restriction value. Also the following process is executed.

 1 When there is a failure in analyzing the print ticket a warning message is displayed and printing is canceled.

 2 When there is no usage authority for the selected device a warning message is displayed and printing is canceled.

Step S the UI add in unit compares the obtained printing restriction value and the printing restriction value that is saved in the registry maintained in the RAM . Then when a result of the comparison is that the printing restriction value has changed the latest printing restriction value is updated. Furthermore a warning message is displayed and printing is canceled.

When confirmation is specified using a print confirmation dialog at the UI add in unit the print confirmation dialog is displayed for yes or no to be selected. When yes is selected printing commences. When no is selected printing is canceled.

When confirmation is not specified using a print confirmation dialog at the UI add in unit processing proceeds without the print confirmation dialog being displayed.

 1 When there is an item in which a printing restriction value cannot be set and cancellation has been specified by an operation when a combined use prohibition setting has occurred a warning message is displayed and printing is canceled.

 2 When the logged on user name and the user name that is set in the print job do not match a warning message is displayed and printing is canceled.

 3 When overlay printing registration is specified a warning message is displayed and printing is canceled.

 4 When box storing is selected in the print settings while prohibited is specified for box storing a warning message is displayed and printing is canceled.

 5 When the printing restriction value has been exceeded due to selection of printing with a special layout a warning message is displayed and printing is canceled.

 6 When the printing restriction value has been exceeded in a state while poster printing has been selected a warning message is displayed and printing is canceled.

Next description is given using concerning a processing flow of the printing control system during a breakdown of the print ticket issuing server of the first embodiment.

In first 1 a client PC sends a print ticket request to the print ticket issuing server along with user information and output destination printer information.

Next 2 when a print ticket cannot be obtained due to a breakdown of some kind such as the print ticket issuing server being down the client PC generates a print job in the following manner and sends this to the printer . Specifically a print job is generated for sending to the printer according to a print ticket that was saved previously or immediately previously as well as exceptional printing conditions set within the print ticket. Alternatively a print ticket may be used that has been saved by an administrator in advance in the print ticket saving unit .

 3 Since a print ticket is being reused the printer confirms whether or not the print ticket issuing server is down. 4 If the printer confirms that the print ticket issuing server is down it informs the administrator of this if notification has not already been given to the administrator. The printer carries out printing in accordance with the printing restriction information recorded in the print ticket.

The above described processing is an operation of the entire printing control system including the client PC and the printer at the time of a breakdown of the print ticket issuing server .

In step S the data transceiving unit receives the print ticket issuance request and information of the user from the client PC . In step S user authentication is carried out on the person who requested print ticket issuance. With the authentication here whether or not the user has been authenticated is determined by receiving from the OS on the client PC information indicating that the user has logged onto the client PC and completed user authentication.

If user authentication is completed by this determination then in step S permission from the process settings unit for reuse of a print ticket already issued at the time of the occurrence of the breakdown of the server and reuse conditions exceptional printing conditions for when reuse is permitted are obtained. Next in step S printing conditions assigned to the user who requested print ticket issuance are obtained from the printing condition management unit .

Next in step S a print ticket containing printing condition information and information concerning the allowability of reusing the print ticket is generated by the print ticket issuing unit . Next in step S a process is carried out of issuing a print ticket to the client PC from where the print ticket request originated then processing finishes.

On the other hand when the determination in step S is that user authentication has failed an error process is executed in step S. This error process involves for example sending notification to the client PC from where the print ticket request originated to the effect that user authentication has failed and a print ticket cannot be issued.

Next description is given using concerning processing for print data generation which is a part of the processing operations of the print ticket control unit and the print job generating unit of the client PC .

When the instruction for print commencement is given by a user first in step S the print ticket obtaining unit requests a print ticket from the print ticket issuing server . When a print ticket cannot be obtained the procedure proceeds to step S.

In step S the print ticket analyzing unit determines whether or not the print ticket could not be obtained due to a user authentication error. If there is a user authentication error Yes in step S then in step S the add in unit displays a warning to the effect that the print job will be canceled. In step S the add in unit executes a job canceling process of canceling the print job and print processing finishes.

On the other hand if there is no user authentication error No in step S then it is determined that there is a breakdown in the print ticket issuing server and that processing for print ticket issuance cannot be performed. In this case in step S the print ticket analyzing unit obtains a print ticket that has been saved in the print ticket saving unit . Next in step S the print ticket analyzing unit analyzes the reuse conditions described in the print ticket.

In step S the print ticket analyzing unit makes a determination based on the analysis result as to whether or not the print ticket is usable. In particular if reuse is not permitted or if reuse is permitted but the reuse conditions do not apply the procedure proceeds to step S. On the other hand when the reuse conditions do apply the print ticket analyzing unit saves the print ticket to the print ticket saving unit and the procedure proceeds to step S.

In step S the printer driver generates a print job in accordance with the printing conditions described in the print ticket that is saved in the print ticket saving unit . The printing conditions described in the print ticket are added to the ordinary printing conditions and if the print instruction information has any additional information such as tints on the printing page the print job is generated in accordance with those instructions.

Next in step S the printer driver displays a warning indicating that there is exceptional printing based on reuse of a print ticket. Then in step S data is sent to the printer by the data transceiving unit and processing finishes.

On the other hand if a print ticket has been obtained in step S then in step S the printer driver generates a print job in accordance with the printing conditions described in the obtained print ticket. Then the print ticket obtained in step S is saved in the print ticket saving unit .

In step S print data is received via the data transceiving unit . In step S a print ticket added to print data is analyzed by the print ticket processing unit . Next in step S a determination is made by the print ticket processing unit as to whether or not the print ticket is to be reused. Here in determining whether or not the print ticket is to be reused first an ID that identifies the print ticket appended each time printing is carried out is stored and a collation is made with the stored ID of the print ticket. Then based on a collation result a determination is made as to whether or not the print ticket is to be reused.

It should be noted that print ticket IDs are managed by the print ticket issuing server and a unique ID is described in the print ticket each time a print ticket is issued.

When a determination is made in step S that the print ticket is to be reused Yes in step S the procedure proceeds to step S and the print ticket processing unit confirms whether or not a breakdown has occurred in the print ticket issuing server .

When no breakdown has occurred Yes in step S the procedure proceeds to step S and the print ticket processing unit cancels printing of the received print data. After this the procedure proceeds to step S.

On the other hand if a breakdown has occurred No in step S then a determination is made in step S as to whether or not this is the first time for this breakdown. If it is not the first time No in step S then the procedure proceeds to step S. If it is the first time Yes in step S then in step S the print ticket processing unit gives notification to a specified destination for notification for example the administrator s terminal of the administrator of the print ticket issuing server to the effect that a breakdown has occurred in the print ticket issuing server .

It should be noted that the determination in step S is made for example based on the presence absence of a flag that is set in the RAM and that indicates whether a breakdown has occurred for the first time.

Next in step S the print ticket processing unit confirms the reuse conditions of the print ticket. If a result of the confirmation is that the reuse conditions are not in agreement then the procedure proceeds to step S and printing of the received print data is canceled. After this the procedure proceeds to step S. On the other hand if these are in agreement then the procedure proceeds to step S.

It should be noted that one method of confirming the reuse conditions of the print ticket in step S is confirming whether a reuse permission is set in the print ticket and if there is a reuse prohibition set then the reuse conditions are deemed not satisfied.

Next in step S a print restriction process is carried out by the printing apparatus control unit in accordance with the printing conditions described in the print ticket. In step S a process of analyzing the print data is carried out by the printing page data processing unit . In step S image generation is carried out by the printing page data processing unit .

In step S printing output is carried out by the output unit . In step S a print log specified in the print ticket is generated and saved by the printing apparatus control unit and processing finishes. At this time when the print ticket has been reused regardless of there being no breakdown in the server the printing is canceled and a record of this is also left as a log.

On the other hand if a determination is made in step S that the print ticket is not being reused No in step S then in step S the flag indicating that the breakdown of the print ticket issuing server has occurred for the first time is cleared and the procedure proceeds to step S.

The above concerns a print processing operation of the printer . Furthermore print ticket validity is determined for the printer by determinations in step S step S and step S. This is because when the print ticket is being reused regardless of there being no breakdown in the server the print data appended to that print ticket is canceled as being improper usage. Furthermore this is because even if reuse is permitted if the reuse conditions are not met the print data appended to that print ticket is canceled.

As described above with the first embodiment even in circumstances where print tickets cannot be issued due to a breakdown such as the management server that issues device control information relating to device usage being down print processing is allowed based on print tickets that were saved prior to the breakdown. In this way a printing control system can be provided that is capable of carrying out print processing without lowering the security level.

In the first embodiment print tickets that had been saved were reused when print tickets could not be obtained but there is no limitation to this. In a second embodiment when print tickets cannot be obtained a process of generating print data is carried out in accordance with printing conditions described in print tickets that have been saved. Then after completion of print data generation obtaining of print tickets is once again carried out. Here a configuration may be used in which if obtaining of print tickets is achieved the newly obtained print tickets are added and the printer is made to carry out printing but if print tickets still cannot be obtained saved print tickets are reused.

Furthermore a configuration may be used in which print tickets are saved as part of a print log by the printer without storing print tickets on the client PC . In this case it is easily conceivable that a query is made from the client PC to the printer as to whether or not the print ticket attached to the last print job issued by the client PC is present and if it has been saved that print ticket is obtained from the printer and reused.

Furthermore although the above embodiments were described using an example of a case in which a plurality of information processing apparatuses client PC and print ticket management server and devices image processing apparatuses printer were operated in cooperation to achieve the embodiment there is no limitation to this. For example it is understood that the present invention may be embodied by combining the various structural elements for achieving these embodiments into a single information processing apparatus and achieving the effects of the present embodiments with this information processing apparatus and devices.

More specifically it is possible to use a system given an information processing apparatus an information processing apparatus having both the function of a server and the function of a client in which the various functions of the client PC and the print ticket management server are combined for the printer .

Furthermore the above embodiments were described using an example of a case in which a printing function of the printer was used but there is no limitation to this. That is embodiments can also be applied to other functions that can be used on the printer for example a scanning function a faxing function and a data transmission function .

Moreover each of the databases shown in is shown as an example configured within a PC but these may be configured within a network storage device connected on the network .

Furthermore a configuration may be used in which only job settings are sent as settings within a range of the device restriction information without sending the device control information.

With the present embodiment function restrictions relating to devices can be maintained while improving convenience by appropriately allowing function usage even during occurrences of breakdowns.

There may be provided an apparatus comprising a single device or to system constituted by a plurality of devices.

Furthermore embodiments can be implemented by supplying a software program which implements the functions of the foregoing embodiments directly or indirectly to a system or apparatus reading the supplied program code with a computer of the system or apparatus and then executing the program code. In this case so long as the system or apparatus has the functions of the program the mode of implementation need not rely upon a program.

Accordingly since the functions are implemented by computer the program code installed in the computer may also embody the present invention.

In this case so long as the system or apparatus has the functions of the program the program may be executed in any form such as an object code a program executed by an interpreter or script data supplied to an operating system.

Example of storage media that can be used for supplying the program are a floppy disk a hard disk an optical disk a magneto optical disk a CD ROM a CD R a CD RW a magnetic tape a non volatile type memory card a ROM and a DVD DVD ROM and a DVD R .

As for the method of supplying the program a client computer can be connected to a website on the Internet using a browser of the client computer and the computer program embodying the present invention or an automatically installable compressed file of the program can be downloaded to a recording medium such as a hard disk. Further the program can be supplied by dividing the program code constituting the program into a plurality of files and downloading the files from different websites. In other words a WWW World Wide Web server that downloads to multiple users the program files that implement the functions by computer may also embody the present invention.

It is also possible to encrypt and store a program embodying the present invention on a storage medium such as a CD ROM distribute the storage medium to users allow users who meet certain requirements to download decryption key information from a website via the Internet and allow these users to decrypt the encrypted program by using the key information whereby the program is installed in the user computer.

Besides the cases where the aforementioned functions according to the embodiments are implemented by executing the read program by computer an operating system or the like running on the computer may perform all or a part of the actual processing so that the functions of the foregoing embodiments can be implemented by this processing.

Furthermore after the program read from the storage medium is written to a function expansion board inserted into the computer or to a memory provided in a function expansion unit connected to the computer a CPU or the like mounted on the function expansion board or function expansion unit performs all or a part of the actual processing so that the functions of the foregoing embodiments can be implemented by this processing.

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

This application claims the benefit of Japanese Patent Application No. 2006 100391 filed on Mar. 31 2006 which is hereby incorporated by reference herein in its entirety.

