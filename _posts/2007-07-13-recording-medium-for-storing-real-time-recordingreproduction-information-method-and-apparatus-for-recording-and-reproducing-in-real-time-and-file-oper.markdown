---

title: Recording medium for storing real time recording/reproduction information, method and apparatus for recording and reproducing in real time, and file operating method using the same
abstract: A recording medium for storing real time recording/reproduction information, a real time recording and reproducing method and apparatus, and a file operating method using the information. Real time recording/reproduction information for ensuring real time recording/reproduction is stored in a file control information area, in each real time file, or in a separate file, and real time recording/reproduction attributes are assigned to the file. Thus, real time recorded files can be continuously reproduced without interruption. Also, there are methods of creating a file to which real time recording/reproduction attributes are assigned, extending a data area, and recording and reproducing the file to which real time recording/reproduction attributes are assigned.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08521012&OS=08521012&RS=08521012
owner: Samsung Electronics Co., Ltd.
number: 08521012
owner_city: Suwon-si
owner_country: KR
publication_date: 20070713
---
This application is a continuation of U.S. patent application Ser. No. 11 312 548 filed on Dec. 21 2005 now U.S. Pat. No. 7 283 729 currently pending which is a continuation of U.S. patent application Ser. No. 09 577 042 filed on May 24 2000 which issued as U.S. Pat. No. 7 068 918 which is a divisional of U.S. patent application Ser. No. 09 304 279 filed May 3 1999 which issued as U.S. Pat. No. 6 389 569 which claims the benefit of Korean Application Nos. 98 15769 filed May 1 1998 98 27308 filed Jul. 7 1998 98 30218 filed Jul. 27 1998 98 41764 filed Oct. 2 1998 and 98 55039 filed Dec. 15 1998 in the Korean Patent Office the disclosures of which are incorporated herein by reference.

The present invention relates to a system requiring recording and or reproduction in real time and more particularly to a recording medium for storing real time recording reproduction information a method and apparatus for recording and reproducing a real time file based on the real time recording reproduction information and a file operating method using the real time recording reproduction information.

In a computer or audio and or video A V apparatus constituted of a file system for an A V file required to be recorded reproduced in real time control information representing that the A V file is a real time recording reproduction file is not recorded in file control information. Thus it is impossible to reproduce in real time a file comprised of data blocks physically scattered on a recording medium even if they are logically successive.

Here a conventional file system as shown in is comprised of file control information having the length of a file information on the position of file data information on the possibility or impossibility of reading writing a file etc. and file data stored in positions designated by the file control information. When a file on a disc is read file control information is first read and file data in the positions designated by the read file control information is then read and reproduced. Such a method of allocating a block of a fixed size used in the conventional file system cannot guarantee real time reproduction of a file.

That is recording reproduction of the conventional file system is described by taking as an example the case in which two files occupy blocks on a disc as shown in . Here a file A requiring real time reproduction occupies blocks and of the disc and a file B a general file occupies blocks and of the disc.

In the first step block is read. In the second step block is searched for. In the third step block is read and played back. In the fourth step the block is searched for. In the fifth step blocks and are read and played back. In the conventional file system since information associated with real time recording reproduction is not recorded even when recording a file requiring real time recording reproduction a data arrangement for real time recording reproduction is not considered. Thus real time reproduction may not be achieved.

That is the file A for example a video file of requires real time reproduction but the conventional file system arranges data files without consideration of the requirement of real time reproduction thus causing a screen to be interrupted during playback. In order to record reproduce files in real time the sum of a seek time and a read time must be smaller than a playback time as shown in the following expression seek time read time

In order to prevent a screen from being interrupted a next block must be searched for during reading and reproducing a current block before the next block is read. However in an apparatus for driving a disc such as a compact disc CD and a digital versatile disc DVD the seek time is significantly longer than the read time. Therefore real time reproduction is impossible if the next block is not physically adjacent to the current block.

To solve the above problems it is an object of the present invention to provide a recording medium for storing real time recording reproduction information for real time files.

It is another object of the present invention to provide a method of recording real time recording reproduction information after real time files are arranged in a minimum contiguous storage block and of reproducing files in real time according to the real time recording reproduction information.

It is still another object of the present invention to provide a method of copying files in consideration of real time recording reproduction information adding the real time recording reproduction information of original files to copied files and reproducing the copied files in real time using real time recording reproduction information.

It is yet another object of the present invention to provide an apparatus for recording a recording reproduction bit rate as real time recording reproduction information for recording a plurality of recording reproduction bit rates as real time recording reproduction information when the recording reproduction bit rate varies for different data sections and for reproducing files in real time according to the real time recording reproduction information.

It is still yet another object of the present invention to provide a file operating method of generating a file in which real time recording reproduction information has been set expanding data regions recording and reproducing the file and performing other file operations.

Additional objects and advantages of the invention will be set forth in part in the description which follows and in part will be obvious from the description or may be learned by practice of the invention.

Accordingly to achieve the above and other objects of the present invention there is provided a recording medium in which real time files requiring real time recording reproduction are recorded wherein real time recording reproduction information for ensuring real time recording reproduction of the real time files is stored in a file control information area.

To further achieve the above and other objects of the present invention there is provided a recording and reproducing method comprising the steps of a arranging and recording real time files requiring real time recording reproduction on the basis of real time recording reproduction information for ensuring real time reproduction and recording the real time recording reproduction information and b reading and reproducing the real time file data using the real time recording reproduction information.

To still further achieve the above and other objects of the present invention there is provided a recording and reproducing apparatus for recording and or reproducing real time files on a disc using real time recording reproduction information for ensuring real time recording reproduction the apparatus comprising a codec for compressing and encoding an input bitstream according to a predetermined compression scheme and providing compressed data upon recording and decoding the compressed and encoded data upon reproduction a buffer for temporarily storing the compressed data at a recording bit rate using bit rate information included in the real time recording reproduction information and transmitting data written on the disc to the codec at a reproduction bit rate a signal processor for converting the data stored in the buffer into a signal suitable for recording and transmitting the converted signal together with real time recording reproduction information onto the disc upon recording and reproducing data read from the disc according to the real time recording reproduction information recorded on a predetermined area of the disc and a controller for controlling the driving of a servo mechanism including a spindle motor according to bit rate information of the real time recording reproduction information.

To still yet further achieve the above and other objects of the present invention there is provided a method of operating a file for a system capable of writing and rewriting real time files to which real time recording reproduction attribute information is assigned wherein the real time files are operated in correspondence with any one process among a real time file creation process area allocation process a recording process a reproduction process a deletion process and a closing process using the real time recording reproduction attribute information.

Preferred embodiments of a recording medium for storing real time recording reproduction information a real time recording and reproducing method and apparatus and a file operating method using the real time recording reproduction information will now be described referring to the attached drawings.

Alternatively the real time recording reproduction attribute information can be stored in a file identifier descriptor field a file type field or a flag field among an ICB TAG field in a file entry. The file entry can be called a file control information area or a file structure area.

As shown in real time recording reproduction attribute information for each file can be stored in a predetermined area information area in each file. For example in the case of a real time rewritable RTRW format real time recording reproduction attribute information can be stored in a data file named RTRW TS.VOB.

As shown in real time recording reproducing attribute information for each file can be stored in a separate file. As an example real time recording reproduction attribute information can be stored in an information file having an RTRW format named RTRW TS.IFO. As another example when the file system is the UDF system the real time recording reproduction attribute information can be stored in a volume structure area separate from a file structure area as shown in .

Therefore when real time recording reproduction attribute information is stored in the volume structure area or file structure area in the UDF system the real time recording reproduction attribute information is first interpreted upon mounting a volume or opening a file and data is then recorded reproduced in real time according to the interpreted information.

Real time recording reproduction file indication information e.g. identifier AV file representing that a file requires real time recording reproduction is included in the real time recording reproduction attribute information. Among information on the size of the minimum contiguous storage block satisfying the condition of expression 1 reproduction time information for ensuring minimum contiguous storage recording reproduction bit rate information and information on the contiguous recording reproduction type at least one can be stored in the real time recording reproduction attribute information. Here if there are three types of discs A B and C the contiguous recording reproduction type information can be predetermined as follows type 10.08 Mbps type 1.4 Mbps type 8 Mbps.

An attribute representing whether files are currently arranged so as to be recorded reproduced in real time i.e. an attribute representing the current real time recordable reproducible state of files is also included in the real time recording reproduction attribute information.

Real time recording reproduction bit rate information is stored in the real time recording reproduction attribute information. When the recording reproduction bit rate is changed in each section information associated with a plurality of bit rate values and sections e.g. position information can be stored in the real time recording reproduction attribute information. The maximum allowable value of the real time recording reproduction bit rate can be further stored in the real time recording reproduction attribute information. Here the control information of a spindle motor can be obtained by using the recording reproduction bit rate information.

In addition file defect management information file buffering information file allocation information etc. can be included in the real time recording reproduction attribute information. That is if file defect management information is stored in the real time recording reproduction attribute information replacement of a defective block with a spare area is not attempted when reading or writing fails and further reading or writing of the defective block is not attempted.

For example file allocation information such as non allocation of a defective block replaced by a spare area as a data block can be stored in the real time recording reproduction attribute information. File buffering information associated with the amount of data to be initially read from a track buffer and the amount of data to be recorded in the track buffer at a time can also be stored as the real time recording reproduction attribute information.

Instead of individually storing many real time recording reproduction attributes such as file defect management information file allocation information and file buffering information the conditions for controlling real time files are classified into types and the information of the classified types is recorded in a real time recording reproduction file attribute information area. In this way easy real time recording and reproduction can be achieved. For example the following types of information can be provided 

type A a data bit rate of 10 Mbps impossibility of allocation of a data block to a defective block replaced by a spare area and impossibility of reattempt of reading upon failure in reading and

type B a data bit rate of 8 Mbps possibility of allocating a data block to a defective block replaced by a spare area and impossibility of reattempting reading upon failure in reading.

Meanwhile referring to showing an example of real time files comprised of minimum contiguous storage blocks occupying blocks on a disc according to the present invention a file A is a file requiring real time reproduction. If a minimum contiguous storage block satisfying the condition of expression 1 is comprised of four blocks the file A is recorded in real time in units of four blocks. That is the real time file A occupies blocks and on a disc. A general file B occupies blocks and on the disc. The general file B not requiring real time reproduction has a minimum contiguous storage block comprised of one block and one or an arbitrary number of segments can be stored. This block generally corresponds to a sector of a disc.

In step blocks and are read. In step block is searched for during playback of the blocks and . In step blocks and are read. In step block is searched for during playback of the blocks and . In step blocks and are read and played back.

If no areas for contiguous blocks capable of satisfying the minimum contiguous storage block exist on a disc upon storage of a file requiring real time reproduction recording of the file is not possible. However if a warning message like Contiguous recording is not possible. Shall the minimum contiguous storage block be designated as one block and the file be stored in the designated block length is sent to a user and if the user requires storage the file can be stored in the minimum contiguous storage blocks comprised of one block. In this case the value of the initially designated minimum contiguous storage block is stored in the information associated with the minimum contiguous storage block length included in the real time recording reproduction attributes but information indicating that the arrangement of currently stored files makes real time recording reproduction impossible is stored in a current real time recordable reproducible state attribute. This is done so that a file to be copied can be contiguously treated as a real time recording reproduction file when the file is copied on different discs or the same disc.

In the present invention a driving apparatus such as a CD drive and a DVD drive having a seek time e.g. 150 ms significantly longer than a read time e.g. 1.43 ms which is expressed by seek time read time can also realize real time reproduction if it satisfies the condition of expression 1 seek time read time

Meanwhile the minimum contiguous storage block limits the allocation of a free block on a disc to satisfy a predetermined purpose. Here the free block means a non used area having no defective blocks or a rewritable area among user areas that can be used by a user.

If the minimum contiguous storage block is defined as 16 blocks arranged in an error correction code ECC block the allocation of a data block is not possible for less than 16 contiguous free blocks. Also the allocation of a data block is not possible for 16 contiguous free blocks ranging over two ECC blocks. Here the minimum contiguous storage block has the purpose of recording and reproducing a DVD RAM in an ECC unit.

When all real time data is stored on physically contiguous blocks on a disc no seeking occurs and thus recording reproduction is prevented from being interrupted. However since contiguous blocks do not infinitely exist a minimum contiguous storage block is calculated and stored as real time recording reproduction attributes of a file and real time data is recorded in the minimum contiguous storage block. In this way the interruption of a screen can be prevented.

If an MPEG playback bit rate Vb of 8 Mbps a seek time of 150 ms a read bit rate Va of 11 Mbps a block of 2048 bytes and data having ECC blocks each comprised of 16 blocks is recorded in a recording medium such as a disc the minimum contiguous storage block S can be obtained according to the condition of expression 1 as shown in the following expression 2 1 2048 8 seek time 1000 2 

From this expression the minimum contiguous storage block S is 261 blocks. When data is recorded in units of at least 261 blocks designated as the minimum contiguous storage block real time reproduction is possible. However 272 blocks corresponding to 17 contiguous ECC blocks can be designated as the minimum contiguous storage block. Here the predetermined purpose is to ensure recording reproduction when the maximum seek time is 150 ms.

With one ECC block comprised of 16 blocks designated as the minimum contiguous storage block and a limitation such as the seek time added as shown in expression 2 a free block allocation method for real time recording and reproduction is classified into steps and the steps can be arranged as shown in Table 1 

A V data is recorded and reproduced by arranging blocks satisfying a limitation on the minimum contiguous storage block whose number of blocks depends on each step so that the blocks can be physically connected to each other whereby real time recording and reproduction can be ensured. For example when there are three groups of blocks of the minimum contiguous storage block 16 blocks 272 blocks and 1088 blocks and the seek time is 150 ms the possibility of real time recording reproduction depends on the method of connecting the blocks.

That is when 272 blocks 1088 blocks and 16 blocks are sequentially arranged real time recording and reproduction is possible and when 16 blocks 272 blocks and 1088 blocks are sequentially arranged real time recording and reproduction is not possible.

Accordingly the minimum contiguous storage block can be effectively recorded and reproduced in real time using the allocation of blocks by steps and the block connecting method.

Meanwhile if the end portion of a file is not filled with as much data as in a minimum contiguous storage block as shown in even when the file is recorded according to the condition of the minimum contiguous storage block an attribute representing that data blocks for the unfilled area are allocated but not recorded is stored as real time recording reproduction information thus allowing real time playback upon additional recording.

That is referring to showing the one dimensional structure of a recording medium in which real time AV data stored in the minimum contiguous storage block is placed real time recording reproduction attribute information in addition to the length of a file information on the position of file data information on the possibility or impossibility of reading writing a file etc. is further stored in file control information positioned at a disk block . Two minimum contiguous storage blocks each comprised of 272 data blocks are allocated to first file data placed at a disk block m 272 data blocks for the minimum contiguous storage block are allocated to second file data positioned at a disk block n and 200 data blocks and 72 allocated unrecorded blocks are allocated to third file data positioned at a disk block o.

When a file for real time recording reproduction is copied on the same disc or different discs the data blocks of the file must be arranged on the disc using real time recording reproduction attribute information so that the file can be played back in real time. If the arrangement of the data blocks is not possible the data blocks are arranged on the same basis as the arrangement basis of general file blocks. Here the real time recording reproduction attribute information maintains the original attribute information but the impossibility of real time recording reproduction is set as a current real time recordable reproducible state attribute.

Also when an operating system OS detects defective blocks on a disc upon copying of a file data blocks to be copied must be arranged in consideration of the original real time recording reproduction attribute information and medium defect management information recorded in a secondary defect list SDL . For example when the minimum contiguous storage block is 40 blocks as shown in data blocks are arranged in consideration of a defective area of a disc to copy a file on as shown in . On the other hand when the OS does not detect defects recorded in the SDL data is allocated to blocks other than the defective block area in an application program for copying and in consideration of real time recording reproduction attribute information as shown in .

Thereafter a file is read in step S. It is determined whether real time recording reproduction information exists in the read file in step S. If the real time recording reproduction information exists in the read file playback of the file is set in consideration of the real time recording reproduction information in step S. If it is determined in step S or after step S that no real time recording reproduction information exists in the read file the read file is played back in consideration of whether the real time recording reproduction information has been set in step S.

Here when real time recording reproduction information exists in the volume structure area steps S and S may not be performed. Also when real time recording reproduction information exists in a file control information area steps S S and S may not be performed.

Upon recording a codec compresses and encodes an audio video A V signal from an external bitstream using a predetermined compression scheme and writes data compressed according to a recording reproduction bit rate Vb to a track buffer . An error correction encoder and decoder ECC error correct encodes the data written to the track buffer reads the error correction encoded data at a write read bit rate Va and applies the result to a pickup unit . Also the ECC applies real time recording reproduction information generated under the control of a controller to the pickup unit so that the information can be recorded on a volume structure area or a file control information area. The pickup unit converts the error correction encoded data into a radio frequency RF signal and records the RF signal on a disc . Here the recording rotating speed of a spindle motor for driving the disc is controlled according to a servo control signal from the controller .

Upon reproduction when real time recording reproduction information is stored in the file control information area or the volume structure area buffering information associated with the amount of data to be initially read from the track buffer file allocation information defect management information recording reproduction bit rate information etc. are read in advance and reading of file data is controlled on the basis of the read information. File data to be satisfied by the condition of the minimum contiguous storage block is read from the disc at a write read bit rate Va. The read file data is error correction decoded by the ECC via the pickup unit and written to the track buffer . The codec reads data written to the track buffer at the recording reproduction bit rate Vb decodes the read data and reproduces A V data.

When recording reproducing bit rate information exists in the real time recording reproduction information the controller obtains the control information of the spindle motor from the recording reproducing bit rate information provided from the pickup unit and the ECC and can drive not only the spindle motor but also a servo mechanism.

The RTRW system is comprised of an application layer for producing a command associated with A V data recording reproduction a Windows kernel for interpreting the produced command and a device driver having a file system the same as the file system of a DVD RAM device driver for requesting a corresponding function according to the command interpreted by the Windows kernel by transmitting a driver command to a drive . Here the Windows kernel and the device driver correspond to a file system layer and the Windows kernel can be called a kernel layer.

Upon reproduction a process for storing A V data from the DVD RAM disk in a computer main memory in real time and a process for reading the A V data stored in the main memory through an A V decoder are performed in a multitasking way.

For example the function of an RTRW system using a Windows kernel is divided into creation of a file to which real time recording reproduction attributes are provided allocation of a data area data recording data reproduction data deletion and file closing and these divided functions will now be described referring to .

In the first step a Windows kernel API application programming interface called to create a real time recording reproduction file is a create file. The application layer assigns a file attribute as FILE ATTRIBUTE RTRW to the create file to create the real time recording reproduction file and calls the Windows kernel as in the following example 

In the third step the DVD RAM device driver designates a FILE ATTRIBUTE RTRW attribute when the file generation function is ordered. When the FILE ATTRIBUTE RTRW attribute is designated file control information is stored in an extended attribute area of a file entry a stream directory ICB information control block area a file identifier descriptor area or a file type area or flag area of an ICB TAG field in a file entry. Here bit rate information can also be set when an A V file is created.

A method of allocating an allocated unrecorded area of a real time recording reproduction file is performed as follows.

In the first step a Windows kernel API called to allocate an allocated unrecorded area of a real time recording reproduction file is a set file pointer having a seek function. In order for the application layer to pre allocate a data area of a real time recording reproduction file in advance as an allocated unrecorded area as large as a minimum contiguous storage block the set file pointer calls the Windows kernel as in the following example 

Alternatively a data area necessary for real time recording reproduction can be pre allocated in advance as an allocated unrecorded state using the SetFileBitrate FileHandle bitrate . Here when the application layer knows a bit rate and an API for converting the bit rate into the number of blocks exists in the file system layer the number of blocks obtained by the API can be secured as the data area necessary for real time recording reproduction in an allocated unrecorded state using the SetFilePointer.

In the third step the DVD RAM device driver checks if real time recording reproduction attributes are assigned to a file upon ordering of the file seeking function and secures an allocated unrecorded data area as large as the length for seeking according to minimum contiguous storage conditions for example file defect management file allocation file buffering the magnitude of a minimum contiguous storage block and bit rate information specified in the assigned real time recording reproduction attributes as shown in . One pre allocated area or a plurality of areas are arranged in an ECC unit and can be allocated.

In the first step a Windows kernel API called to record the data of the real time recording reproduction file is a write file. The application layer calls a Windows kernel using a write file as in the following example to store real time data 

In the second step the Windows kernel calls the file recording function of the DVD RAM device driver .

In the third step the DVD RAM device driver checks if real time recording reproduction attributes are assigned to a file upon calling the file recording function. If the real time recording reproduction attributes are assigned A V data to be recorded is recorded in an allocated unrecorded area according to real time recording conditions. Upon recording when no allocated unrecorded area exists the magnitude of recorded data is reported to the application layer . The application layer pre allocates an allocated unrecorded area designated as the real time recording reproduction attributes to record the left over unrecorded data using a seek command SetFilePointer with reference to the amount of recorded data and again records the left over data.

That is as shown in A V data of 32 1024 bytes is recorded in an allocated unrecorded area of 8 1024 1024 bytes shown in and the residual area is still allocated as the allocated unrecorded area.

As shown in when the amount of data recorded in a variable written in the application layer is reported since the allocated unrecorded area is 32 1024 bytes short the file system layer automatically pre allocates an unallocated area using bit rate information designated through the SetFileBitrate. As shown in the residual data is recorded in the ECC block unit. When a defective block is generated during recording and an error is thus generated a block corresponding to the defective block is excluded from the allocated unrecorded area as shown in .

Here when the bit rates for sections can be distinguished from each other information associated with the bit rate for each section can be recorded in a file control information area. That is show an example of a plurality of bit rate values here V Vand V and information associated with sections stored as real time recording reproduction information in a file control information area when different bit rates are provided in different sections. show an example of one bit rate value here V stored as real time recording reproduction information in a file control information area when an identical bit rate is provided in the entire file data section.

In the first step a Windows kernel called to reproduce the data of a real time recording reproduction file is a read file. The application layer calls a Windows kernel using the read file as in the following example to reproduce real time data 

In the third step the DVD RAM device driver checks if real time recording reproduction attributes are assigned to the file when the file reading function is ordered. If the real time recording reproduction attributes are assigned A V data as long as the length for reproduction is reproduced from an A V data area according to real time reproduction conditions.

Here when a defect is generated in a block to be reproduced a read command indicating that allocated unrecorded file attributes are assigned but not read is transmitted from the DVD RAM device driver to the drive .

A real time recording command and a reproducing command provided by a command interface of the DVD RAM device driver must be used upon real time recording reproduction.

In the first step a DeletePartOfFile is called as the Windows kernel to delete part of the data of a real time recording reproduction file. In order to delete part of real time data the application layer calls the Windows kernel using the DeletePartOfFile as in the following example 

In the third step when partial deletion of the file is ordered the DVD RAM device driver checks if real time recording reproduction attributes are assigned to the file and deletes data from an A V data area according to real time conditions if the real time recording reproduction attributes have been assigned. Upon partial deletion of a file a file for managing a dummy file or an ECC padding space list is created under a root directory on a system file.

In the A V file space and the padding space of the ECC block ranging over the boundary of the deletion area have extent lengths. As shown in the A V file space of the ECC block ranging over the boundary of the deletion area has both an extent length and an information length but the padding space is managed as an allocation descriptor having an extent length and an information length of 0 in the AD list in an A V file entry. The A V file space not pertaining to the deletion area in the ECC block is also managed in the AD list in the AV file entry. In this case the padding space can be defined as an extended allocation descriptor of UDF.

In the first step a CloseHandle function is called as a Windows kernel to close a real time file. In order to close a real time recording reproduction file the application layer calls the window kernel using the CloseHandle function as in the following example 

In the third step when the file closing function is ordered the DVD RAM device driver updates file control information file entry etc. and disk information e.g. free area information etc. .

According to the present invention as described above real time recording reproduction attributes are assigned to a file and the file is recorded reproduced in a different way from a general file. In this way a real time recording reproduction file can be recorded reproduced in real time.

Also in the present invention files are divided into real time files and general files and defect management information file allocation information buffering information and the magnitude information of a minimum contiguous storage block provided in each step are assigned as real time recording reproduction information to the real time file upon recording reproduction. Thus real time recording reproduction can be effectively performed.

Furthermore in the present invention the control information of a spindle motor is obtained from real time recording reproduction information associated with a recording reproduction bit rate thus controlling the spindle motor.

Although a few preferred embodiments of the present invention have been shown and described it would be appreciated by those skilled in the art that changes may be made in this embodiment without departing from the principles and spirit of the invention the scope of which is defined in the claims and their equivalents.

