---

title: Reduced state trellis decoder using programmable trellis parameters
abstract: A programmable decoder includes at least one programming input for a plurality of programmable, reduced state trellis parameters. A programmable device is connected to the at least one programming input and implements a Reduced-State Sequence Estimation (RSSE) decoder comprising at least one reduced-state trellis structure based upon the plurality of programmable reduced-state trellis parameters, including one of at least the number of super-states, the number of full-states, the number of branches per super-state, a reverse super-state trellis table, a decoder super-state survivor as a full-state, a forward full-state table, a full-state to super-state mapping table, a decoder super-state path metric and decoder super-state traceback array.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07831893&OS=07831893&RS=07831893
owner: Harris Corporation
number: 07831893
owner_city: Melbourne
owner_country: US
publication_date: 20070120
---
The present invention relates to communication systems and more particularly this invention relates to trellis decoding used in communication systems.

An error correction and detection system used in communication systems detects errors due to noise or other signal impairments during transmission to enable error localization and error correction. Forward error correction FEC permits error control for data transmission and differs from standard error detection and correction systems because the receiver can correct errors without requesting a retransmission of data. The design of the code used in any FEC system determines the maximum fraction of errors that can be corrected in advance. As a result different FEC codes can be suitable for different conditions.

For example in many FEC schemes redundancy is added to transmitted data using a predetermined algorithm. Each of the redundant bits is a complex function of the original information bits. As a result the encoded output may or may not include the original information. Unmodified inputs at the output are systematic codes and those that are not are nonsystematic.

FEC schemes could be considered to average the noise because each data bit affects many transmitted symbols. Some symbols are corrupted more by noise than others and this allows the original data to be extracted from the other less corrupted received signals that depend on the same user data. As FEC codes approach the theoretical Shannon limit and stronger codes are used an FEC scheme works well above a minimum signal to noise ratio but typically fails when the signal is below that minimum ratio.

For higher modem data rates for example greater than 1 Mbps the computational complexity of FEC schemes can be prohibitive given the current state of commercially available digital signal processors DSPs and Field Programmable Gate Array FPGA technology.

The use of Forward Error Correction FEC and the Maximum Likelihood Decoder e.g. Viterbi Algorithm are described exhaustively in most standard communications texts including Digital Communications by John G. Proakis. Continuous Phase Modulation is described in detail in books such as Digital Phase Modulation by Anderson Aulin and Sundberg and Digital Communications by John G. Proakis.

In digital communications systems for example cellular and PCS personal communications systems computer communications systems and SATCOM satellite communications systems digital data is modulated by the modem onto a signal to be transmitted over a communications channel. Data is typically encoded before transmission to a receiver or to a storage device to protect the data from errors which may result from a noisy communications channel or a defect in the storage medium. An encoder manipulates data symbols in accordance with an error correction code and produces error correction symbols or a structured redundancy output sequence. When the code word is later received or retrieved it is decoded to reproduce the data symbols and errors in the data symbols are corrected if possible using the error correction symbols or the structured redundancy of code.

For the following discussion a convolutional codeword is defined as the n output bits that are generated based on an input of k input bits i.e. rate k n code . One method of decoding code words encoded using a convolutional code is maximum likelihood decoding. One kind of maximum likelihood decoder is commonly referred to as a Viterbi decoder. Conceptually a Viterbi decoder uses a decoding trellis which has a branch for each possible code word and connected paths of branches for each possible stream or sequence of code words. The decoder essentially finds a path through the trellis which is closest to or most like the received stream of code words. It then treats the code words on this most likely trellis path as the received code words and assigns data values to them to produce a best estimate of the transmitted data.

To determine the most likely path the decoder calculates for each received code word a set of branch metrics as numerical representation of the likelihood that the transmitted code word which may contain errors on reception is actually the code word which corresponds to a particular branch. In one such decoder the branch metrics are the Hamming distances between the received code word and the code words associated with the various branches.

Each branch in the decoding trellis leads from an initial state which represents the state that the registers are in prior to the formulation of the code word associated with the branch and leads to an end state which represents the state that the registers are in after the formulation of the code word. For a binary code there are 2possible states associated with each decoding level where K is the constraint length of the code. For example the code may have a constraint length of 3 i.e. there are 2 registers and there are thus 4 possible register states namely 00 01 10 11 in each decoding level. Since the code is a rate 1 n code i.e. binary code so k 1 there are two possible branches leading from each initial state namely a branch associated with a zero data bit and a branch associated with a one data bit. Each of these branches necessarily leads to a different end state. Thus for each of the 2states in a given decoding stage there are two branches leading to each of these states and each branch may represent the transmitted code word. Accordingly to decode the code word the decoder must determine two branch metrics for each of the 2possible end states or a total of 2 2 branch metrics. For convolutional codes there are only 2unique branch metric values.

Once the decoder calculates these branch metrics it next determines the metrics of the various paths leading to the end states. Accordingly the decoder adds to the branch metrics the appropriate path metrics which are the sums of the branches leading to the current starting states. The decoder then selects a most likely path leading to each of the end states and stores for later use the path metrics and information which identifies these most likely paths. These most likely paths which are also referred to as the surviving paths. The decoder does not retain information relating to the less likely or non surviving paths. In this way the decoder prunes these paths from the trellis and thereby eliminates for a next level of decoding a portion of the path metric calculations.

When a sufficient number of code words have been included in the trellis paths the most likely code word path is chosen from the surviving paths associated with the end states. The decoder selects as the most likely path the code word path which is closest to the received data i.e. the path with the smallest Hamming distance metric. The decoder then decodes the code words on the most likely path or traces back along the path to determine the associated data bits.

The Viterbi algorithm is used not only to decode convolutional codes but also to produce the maximum likelihood estimate of the transmitted sequence through a channel with intersymbol interference ISI and to decode trellis coded modulation TCM and other modulations with memory. The Viterbi decoder is typically divided into three functional parts. The first part is an add compare select ACS unit that is used to calculate the path metrics. The second part is the survivor memory control unit for survivor memory management which may store the survivor sequences as last part of the Viterbi decoder.

Continuous phase modulation CPM is being applied in communications due to its bandwidth efficiency and constant envelope characteristics. With CPM the modulated signal phase transitions are smoothed. For example with Binary Phase Shift Keying BPSK a logic one is transmitted as one phase of a modulated signal and a logic zero is transmitted as 180 degree phase shifted with a sharp transition i.e. instantaneous in phase. This sharp phase transition results in broadening of the transmitted spectrum. With CPM the phase of the transmitted signal makes smooth phase changes over the bits of the modulating digital signal. An example of CPM is Minimum Shift Keying MSK modulation.

Multi h continuous phase modulation multi h CPM is itself a broad class of modulated waveforms. The class includes signals with constant amplitude but varying phase. Multi h CPM differs from the single h format by using a set of H modulation indices in a cyclic manner. This results in the delayed merging of neighboring phase trellis paths and ultimately in improved error performance. A detailed description of multi h CPM waveforms is included in the book Digital Phase Modulation by Anderson Aulin and Sundberg Plenum Press New York 1986.

As described by articles in Svensson Reduced State Sequence Detection of Full Response Continuous Phase Modulation Electronics Letter May 10 1990 Vol. 26 No. 10 and Eyuboglu et al. Reduced State Sequence Estimation With Set Partitioning and Decision Feedback IEEE Transactions on Communications January 1988 Vol. 36 No. 1 and others some techniques reduce the complexity of the standard MLSE Maximum Likelihood Sequence Estimator decoders. For example in Eyuboglu a reduced state sequence estimator for linear intersymbol interference ISI channels uses a conventional Viterbi algorithm VI with decision feedback to search in a reduced state subset trellis which is constructed using set partitioning principles. The complexity of maximum likelihood sequence estimation MLSE due to the length of the channel memory and the size of the signal set is systematically reduced. An error probability analysis shows that a good performance complexity tradeoff can be obtained. In Svensson a reduced state sequence detector RSSD combines decision feedback with Viterbi decoding for M ary full response continuous phase modulation. The detector is analyzed with minimum Euclidean distances and by simulations of the symbol error probability. The M ary full response CPM schemes can be decoded by a decoder with only two states when the modulation index is relatively small 

The use of Forward Error Correction FEC and the maximum likelihood decoder Viterbi algorithm is described in most standard communications texts. Reduced state sequence estimation RSSE was an important development in MLSE decoder design in the 1980 s. The developers and manufacturers XILINX and Altera produce FPGA and VHSIC Hardware Description Language VHDL tools that allow users a few programmable Viterbi MLSE options. These are usually formed as convolutional codes with the ability to provide soft decision metrics. None of the current tools provide for a desired decision feedback or trellis structure manipulation required for reduced state sequence estimation. They also are not programmable for use with CPM signals and signals with memory. Also there exists a need in the industry for a reduced state generic programmable maximum likelihood decoder.

A programmable decoder includes at least one programming input for a plurality of programmable reduced state trellis parameters. A programmable device is connected to the at least one programming input and implements a Reduced State Sequence Estimation RSSE decoder comprising at least one reduced state trellis structure based upon the plurality of programmable reduced state trellis parameters.

In one aspect the decoder includes a demodulator for supporting demodulation of waveforms with memory and or having a forward error correction FEC code. This demodulator can support demodulation of continuous phase modulation CPM TCM ISI channels etc. The reduced state trellis structure could be formed as an Ungerboeck set partitioning structure or a two state or larger Svensson style structure.

In yet another aspect the plurality of programmable reduced state trellis parameters include at least one of a number of super states in each trellis a number of full states that have been combined to form any super states a number of branches per super state a number of trellis structure the number of branches per super state a reverse super state trellis table a decoder super state survivor as a full state a forward full state table a full state to super state mapping table a decoder super state path metric and decoder super state traceback array. The decoder could be formed as a decoder state structure that contains path metrics and a full decoder state used for decision feedback. The RSSE decoder could be formed as a forward trellis structure operative for indicating which full decoder state from a decision feedback is connected to a next full decoder state for any given bit. The programmable device is also formed as a field programmable gate array FPGA . The at least one trellis structure could be formed as at least one reverse state trellis structure.

In yet another aspect at least one output is connected to the programmable device for outputting decoded bits with multiple bits per output. The at least one output is operative for outputting a full traceback of all decoded bits for best path. At least one output can be connected to the programmable device for outputting a winning state for a current best path.

Different embodiments will now be described more fully hereinafter with reference to the accompanying drawings in which preferred embodiments are shown. Many different forms can be set forth and described embodiments should not be construed as limited to the embodiments set forth herein. Rather these embodiments are provided so that this disclosure will be thorough and complete and will fully convey the scope to those skilled in the art. Like numbers refer to like elements throughout.

The system and method in accordance with a non limiting example of the present invention provides a reduced state sequence estimation RSSE generic and programmable decoder that has input programmability for the number of super states in each trellis. Full states can be combined to form super states. There are a number of branches per super state and a number of trellis structures. The plurality of programmable super state trellis parameters preferably includes trellis connectivity information for trellis stages active and inactive super state for each trellis stage a trellis branch transition data value and a metric index for trellis branch transition and may include a number of trellis structures a number of trellis super states for each trellis structure and a number of branches for each trellis super state. The reverse state trellis structure connects each super state with a list of previous super states. The decoder super state structure contains path metrics and a winning full state used for decision feedback. A forward state trellis can define which full state from the decision feedback is connected to the next full state for any given bit. The output of the decoder includes decoded bits with multiple bits per output and a full traceback of all decoded bits for that path. The difference between the best and worst path metrics can be provided and the winning state for the current best path chosen. Also the trellis structure may include a reverse state trellis structure and or a forward state trellis structure.

Some existing communications devices have limited program space CPU computation speed and battery power. To meet these requirements a software based or FPGA based reduced state maximum likelihood decoder in accordance with non limiting examples of the present invention supports demodulation of waveforms with memory. It is also programmable and supports demodulation of Continuous Phase Modulation CPM and decoding of most FEC trellis codes. The reduced state decoder in accordance with non limiting examples of the present invention varies from most standard trellis decoders because of non limiting features that include 

1 The decoder state table has a winning full state memory in addition to maintaining the winning path metric and

2 The decoder has a forward trellis structure linked list that indicates how each full state in the decoder is connected to the next full state.

Although reduced state decoders are described in many publications the decoder in accordance with a non limiting example includes a one size fits all approach for the design of the decoder state table and the trellis structure. A single implemented FPGA DSP digital signal processor architecture can decode most trellis codes or memory based i.e. CPM modulation schemes 

The reduced state Viterbi detector has a reduced complexity of hardware and uses a reduced state trellis. The detector could consider a shortened impulse response and cancel intersymbol interference due to the tail of the impulse response for each state by using past survivor symbols in some non limiting examples. In an RSSE algorithm the number of states could be reduced by partitioning each element in a state vector into a given number of subsets and representing the subset vector as a reduced state trellis. The reduced state could be done on the basis of Ungerboeck s set partitioning principles such that the impulse response data are estimated according to the maximum likelihood sequence estimation MLSE method via the Viterbi algorithm. A transmit sequence can be estimated from possible data sequences taking into account the received sequence and estimated impulse response of a transmission system. RSSE can reduce the complexity of the MLSE by truncating channel memory or applying set partitioning to the signal alphabet. RSSE algorithms can search for the most likely data sequence in the reduced trellis by keeping only the best survivor or winning paths for each reduced state Several states can be merged and thus reduce the complexity of the MLSE. Each super state in a reduced state trellis can be formed by combining states of the original maximum likelihood trellis using the Ungerboeck like set partitioning principles. When a binary transmission is used the RSSE algorithm could become a state truncation technique where each super state in the reduced state trellis is formed by truncating the maximum likelihood state vector to a suitable length.

As noted above an Ungerboeck style set partitioning reduced state trellis structure for a h 8 states Continuous Phase Frequency Shift Keying CPFSK modulation is shown in . The full state labels are marked in brackets and new super state labels listed above each bracketed pair. This reduced state trellis structure is one half as complex as the original trellis structure without any reduction in Bit Error Rate BER performance.

A Svensson style 2 state approach for binary h CPFSK modulation is shown in . It has a similar trellis structure used for any h value CPFSK modulation and reduces the trellis complexity by a factor of four for h . The maximum likelihood sequence estimator as defined in the incorporated by reference Svensson reference has only two states for binary full response CPM and its trellis structure is shown in .

As illustrated a one valued bit causes a state transition and a zero valued bit does not. This can be implemented with little difficulty and can be adapted to any single h binary CPFSK modulation. As with the set partitioning approach decision feedback is used to maintain the winning phase state of each of the two super states. The decoder calculates the path metrics for the two valid paths from the chosen winning phase and picks a new winning path metric which is then saved in the super state based on the branch taken during the symbol. If the branch corresponds to a 0 valued bit then the new super state is the same as the old super state. If however the transition corresponds to a one valued bit then the path metric transitions to the other super state.

Referring now to an example of a communications system that can include various radios having the decoder used with the present invention is now set forth with respect to followed by a high level description of a reduced state generic and programmable trellis decoder and flowchart explaining the decoder.

An example of a radio that could be used with such system and method in accordance with non limiting examples of the present invention is a Falcon III radio manufactured and sold by Harris Corporation of Melbourne Fla. It should be understood that different radios can be used including software defined radios that can be typically implemented with relatively standard processor and hardware components and mesh network radios. One particular class of software radio is the Joint Tactical Radio JTR which includes relatively standard radio and processing hardware along with any appropriate waveform software modules to implement the communication waveforms a radio will use. JTR radios also use operating system software that conforms with the software communications architecture SCA specification see www.jtrs.saalt.mil which is hereby incorporated by reference in its entirety. The SCA is an open architecture framework that specifies how hardware and software components are to interoperate so that different manufacturers and developers can readily integrate the respective components into a single device.

The Joint Tactical Radio System JTRS Software Component Architecture SCA defines a set of interfaces and protocols often based on the Common Object Request Broker Architecture CORBA for implementing a Software Defined Radio SDR . In part JTRS and its SCA are used with a family of software re programmable radios. As such the SCA is a specific set of rules methods and design criteria for implementing software re programmable digital radios.

The JTRS SCA specification is published by the JTRS Joint Program Office JPO . The JTRS SCA has been structured to provide for portability of applications software between different JTRS SCA implementations leverage commercial standards to reduce development cost reduce development time of new waveforms through the ability to reuse design modules and build on evolving commercial frameworks and architectures.

The JTRS SCA is not a system specification as it is intended to be implementation independent but a set of rules that constrain the design of systems to achieve desired JTRS objectives. The software framework of the JTRS SCA defines the Operating Environment OE and specifies the services and interfaces that applications use from that environment. The SCA OE comprises a Core Framework CF a CORBA middleware and an Operating System OS based on the Portable Operating System Interface POSIX with associated board support packages. The JTRS SCA also provides a building block structure defined in the API Supplement for defining application programming interfaces APIs between application software components.

The JTRS SCA Core Framework CF is an architectural concept defining the essential core set of open software Interfaces and Profiles that provide for the deployment management interconnection and intercommunication of software application components in embedded distributed computing communication systems. Interfaces may be defined in the JTRS SCA Specification. However developers may implement some of them some may be implemented by non core applications i.e. waveforms etc. and some may be implemented by hardware device providers.

For purposes of description only a brief description of an example of a communications system that would benefit from the present invention is described relative to a non limiting example shown in . This high level block diagram of a communications system includes a base station segment and wireless message terminals that could be modified for use with the present invention. The base station segment includes a VHF radio and HF radio that communicate and transmit voice or data over a wireless link to a VHF net or HF net each which include a number of respective VHF radios and HF radios and personal computer workstations connected to the radios . Ad hoc communication networks are interoperative with the various components as illustrated. Thus it should be understood that the HF or VHF networks include HF and VHF net segments that are infrastructure less and operative as the ad hoc communications network. Although UHF radios and net segments are not illustrated these could be included.

The HF radio can include a demodulator circuit and appropriate convolutional encoder circuit block interleaver data randomizer circuit data and framing circuit modulation circuit matched filter circuit block or symbol equalizer circuit with an appropriate clamping device deinterleaver and decoder circuit modem and power adaptation circuit as non limiting examples. A vocoder circuit can incorporate the decode and encode functions and a conversion unit which could be a combination of the various circuits as described or a separate circuit. These and other circuits operate to perform any functions necessary for the present invention as well as other functions suggested by those skilled in the art. Other illustrated radios including all VHF mobile radios and transmitting and receiving stations can have similar functional circuits.

The base station segment includes a landline connection to a public switched telephone network PSTN which connects to a PABX . A satellite interface such as a satellite ground station connects to the PABX which connects to processors forming wireless gateways . These interconnect to the VHF radio or HF radio respectively. The processors are connected through a local area network to the PABX and e mail clients . The radios include appropriate signal generators and modulators.

An Ethernet TCP IP local area network could operate as a radio mail server. E mail messages could be sent over radio links and local air networks using STANAG 5066 as second generation protocols waveforms the disclosure which is hereby incorporated by reference in its entirety and of course preferably with the third generation interoperability standard STANAG 4538 the disclosure which is hereby incorporated by reference in its entirety. An interoperability standard FED STD 1052 the disclosure which is hereby incorporated by reference in its entirety could be used with legacy wireless devices. Examples of equipment that can be used in the present invention include different wireless gateway and radios manufactured by Harris Corporation of Melbourne Fla. This equipment could include RF5800 5022 7210 5710 5285 and PRC 117 and 138 series equipment and devices as non limiting examples.

These systems can be operable with RF 5710A high frequency HF modems and with the NATO standard known as STANAG 4539 the disclosure which is hereby incorporated by reference in its entirety which provides for transmission of long distance HF radio circuits at rates up to 9 600 bps. In addition to modem technology those systems can use wireless email products that use a suite of data link protocols designed and perfected for stressed tactical channels such as the STANAG 4538 or STANAG 5066 the disclosures which are hereby incorporated by reference in their entirety. It is also possible to use a fixed non adaptive data rate as high as 19 200 bps with a radio set to ISB mode and an HF modem set to a fixed data rate. It is possible to use code combining techniques and Automatic Repeat Request ARQ .

There now follows a description of an example of a reduced state generic and programmable trellis decoder in accordance with non limiting examples of the present invention. Referring initially to an embodiment of a data communications receiver such as a UHF satellite communications receiver including a reduced state generic programmable trellis decoder will be described. Encoded and modulated signals sent over a communications channel are received by the receiver . These modulated signals could be any signals with memory such as CPM ISI channels or trellis coded modulation TCM . A demodulator processes the incoming signal then sends the baseband demodulated signal to the programmable trellis decoder . The programmable trellis decoder processes the signal and then sends the decoded data and other related information to a destination over the channel . The components of the receiver e.g. the demodulator and the programmable trellis decoder are controlled by a processor .

The reduced state generic programmable trellis decoder uses the RSSE algorithm and methodology explained above and includes at least one programming input for a plurality of programmable trellis parameters. It should be understood that the reduced state decoder in accordance with a non limiting example of the present invention varies from a standard trellis decoder because the decoder state table has a winning full state memory in addition to maintaining the winning path metric. The decoder has a Forward Trellis structure as a linked list that indicates how each full state in the decoder is connected to the next full state. Thus a single implemented field programmable gate array and digital signal processing architecture can decode any trellis code ISI channel or memory based modulation i.e. CPM.

The reduced state sequence estimation programmable decoder can have an input programmability that includes the number of super states in each trellis stage number of trellis stages and which full states are combined to form the super states. It can also include input programmability for the number of branches per super state the number of trellis structures a reverse state trellis structure that connects each super state with a list of previous super states active and inactive states for each trellis stage a trellis branch transition data value and a metric index for trellis branch transition. The decoder super state structure can contain path metrics and a winning full state that is used for decision feedback. A forward state trellis can define which full state from the decision feedback i.e. survivor path is connected to the next full state for any given bit.

The output of the decoder could include decoded bits with multiple bits per output. The full trace back of all decoded bits for that path can be included. The output can include the difference between the best and worst path metrics and the winning state for the current best path.

The decoder could include an add compare select ACS unit to receive a sequence of trellis coded bits and calculate path metrics and output sequences based upon branch metrics associated with each branch of a trellis state diagram a survivor memory for storing the output sequences and a survivor memory control unit to control the survivor memory and output decoded bits of the stored output sequences as would be appreciated by those skilled in the art.

A programmable device is connected to the programming input and implements a programmable trellis decoder e.g. a continuous phase modulation CPM decoder having at least one trellis structure defined based upon the plurality of programmable trellis parameters. The programmable device may comprise a field programmable gate array FPGA for example.

An FPGA is a semiconductor device containing programmable logic components and programmable interconnects. The programmable logic components can be programmed to duplicate the functionality of basic logic gates such as AND OR XOR NOT or more complex combinatorial functions such as decoders or simple math functions. In most FPGA s these programmable logic components or logic blocks also include memory elements which may be simple flip flops or more complex blocks of memories.

A hierarchy of programmable interconnects allows the logic blocks of an FPGA to be interconnected as needed by the system designer somewhat like a one chip programmable breadboard. These logic blocks and interconnects can be programmed after the manufacturing process by the customer designer i.e. field programmable so that the FPGA can perform whatever logical function is needed.

FPGA s are generally slower than their application specific integrated circuit ASIC counterparts cannot handle as complex a design and draw more power. However they have several advantages such as a shorter time to market ability to reprogram in the field to fix bugs and lower non recurring engineering costs. Another alternative is complex programmable logic devices CPLD s .

To define the behavior of the FPGA the user may provide a hardware description language HDL or a schematic design in some non limiting examples. Common HDL s are VHDL and Verilog. Then using an electronic design automation tool a technology mapped netlist is generated. The netlist can then be fitted to the actual FPGA architecture using a process called place and route usually performed by place and route software. The user can validate the map place and route results via timing analysis simulation and other verification methodologies. Once the design and validation process is complete the binary file generated can be used to reconfigure the FPGA device. Such a binary file may be stored and or input to the programmable device via the control input block .

As a non limiting example the programmable trellis decoder may implement CPM and preferably multi h CPM. With CPM the phase of the transmitted signal makes smooth phase changes over the bits of the modulating digital signal. An example of CPM is minimum shift keying MSK modulation. Multi h continuous phase modulation multi h CPM is itself a broad class of modulated waveforms. The class includes signals with constant amplitude but varying phase. Multi h CPM differs from the single h format by using a set of H modulation indices in a cyclic manner. This results in delayed merging of neighboring phase trellis paths and ultimately in improved error performance.

One or more outputs of the programmable device are provided for outputting decoded bits with multiple bits per output and the full traceback of all decoded bits for a best path for outputting a difference between a best and worst path metric and or for outputting a winning state for a current best path.

The reduced state generic programmable trellis decoder provides the appropriate structure and flexibility in the decoder to handle all the abovementioned trellis schemes. The active and inactive states per trellis stage can be done by having a delta increment between states or an active inactive flag. Active inactive provides flexibility as there may be cases where there are no good delta increments between current and next active state. A different starting state for each trellis stage may be provided to avoid extra computations but active inactive state works here too. Metrics to be used as branch metrics are provided by user based on required trellis stage node identification and branch connection. Only metrics for active super states need to be computed. A different set of branch connections are included for each trellis stage via a reverse lookup table at the add compare select point.

An example for Node if trellis has 16 states there would be 16 states for each trellis stage . The repeat structure may be 4 trellis stages long and for each stage there would be active and inactive stages and reverse lookup tables. This type of structure would be required for a multi h CPM but this same structure could be used for less complicated trellis schemes by simply changing the connectivity of the trellis reverse look up table and the choice of active inactive states. Thus the approach leads to a generic trellis decoder which can handle many more trellis schemes than simple convolutional TCM decoders available currently.

As an example a multi h CPM waveform may be demodulated with the generic programmable trellis decoder . Multi h implies a different modulation index h for each CPM symbol. For the case of 2h there are two different values of h that change every other symbol. For example binary CPM with h 4 16 h 5 16. Even number symbols use modulation index h and odd number symbols use modulation index h. For h 4 16 the trellis backward connectivity is as follows data 0 negative frequency i.e. data 1 data 1 positive frequency 

To decode Stage start at state and increment states by two for next state i.e. only even states are active . For Stage only decode odd states. For Stage decode only odd states and for Stage decode only even states and then pattern repeats.

This is why the generic programmable trellis decoder provides the ability to have active states and inactive states for most general case or start state and delta state as a alternative embodiment . Also the backward trellis structure is needed to decode CPM properly.

So the initialization process of the generic programmable trellis decoder prior to use in demodulating waveform will now be summarized. The trellis structure includes Stage N Trellis Connectivity Active Inactive States Data Value causing Transition i.e. branch transition data value and Metric index for given trellis branch transition.

First the trellis structure e.g. for CPM or other is analyzed to determine active inactive states and connectivity. The connectivity information is written to decoder for as many trellis stages as is necessary before pattern repeats typically just one stage for convolutional codes two for 1h CPM and four for 2h CPM example above . Active inactive states or start state and delta state are written for each trellis stage of trellis decoder before pattern repeats . The data value that causes trellis branch transition is written to the trellis decoder structure. The metric index used for trellis branch transition is written to trellis decoder.

Trellis Branch Structure Stage . The backward trellis structure includes State from State via a 0 bit using branch metric index State from State via a 1 bit using branch metric index State from State via a 0 bit using branch metric index State from State via a 1 bit using branch metric index etc.

To begin demodulating data the branch metric array is written to trellis decoder this will be used by decoder using the metric index add compare select function is executed for each active state traceback function is executed to extract decoded information and output data is provided to user.

A method aspect of the invention is directed to a method of implementing a reduced state generic programmable trellis decoder such as a continuous phase modulation CPM decoder and will be discussed with reference to the flowchart of . The method begins at block and includes at block providing a programmable device such as an FPGA to implement the programmable trellis decoder and includes at least one trellis structure defined based upon a plurality of programmable trellis parameters. The method further includes programming the plurality of programmable trellis parameters via at least one programming input block .

As discussed above programming the plurality of programmable trellis parameters may include programming a number of trellis structures programming a number of trellis states for each trellis structure and programming a number of branches for each trellis state. The method may include at block providing at least one output connected to the programmable device for outputting decoded bits with multiple bits per output and the full traceback of all decoded bits for a best path a difference between a best and worst path metric and or a winning state for a current best path.

To meet various requirements an FPGA based maximum likelihood decoder has been designed which is reduced state and programmable and will support demodulation of CPM TCM and any FEC trellis code. It has been designed to support binary h 4 ary CPM.

The Continuous Phase Modulation CPM waveform defined in the MIL STD 188 181C Satellite Communications standard has a thirty two state trellis structure. The complexity of the maximum likelihood sequence estimator used to demodulate this signal is further increased because the CPM signal has two modulation indices h values that require that the decoder store two sets of path metrics one for each of the h values. Approaches are taken to reduce the complexity of the trellis structure of the CPM signal without significantly reducing the demodulation performance for the range of signal to noise ratio values required by the UHF Satellite Communications standard. As noted before the first state reduction method uses Ungerboeck style set partitioning. Another approach utilizes a completely different 4 state trellis structure with branch transitions defined that take advantage of the differential properties of the CPM modulation.

where T is the symbol period E is the energy per symbol f is the carrier frequency is the data symbol h is the modulation index and q is the phase pulse shape.

The UHF SATCOM standard provides for up to twelve different variations of full response quaternary multi h CPM modulation schemes with different symbol rates and modulation indices h values to control the receive complexity and transmit frequency spectra. All of the variants result in 32 phase states where only of the states are active at any given symbol period. In all cases there are two h values defined as the ratio p q where q is always 16 and p alternates between even and odd integer values.

There are two documented methods for reducing the number of states and the corresponding receiver complexity. The first method described by Eyuboglu combine states using the Euclidean distance as a metric set partitioning . The second method described by Svensson uses a tilted phase approach to CPM demodulation which automatically eliminates the inactive states in the trellis. Svensson further reduces states based on differential phase of each branch in the trellis.

As an illustration of the set partitioning approach the h binary CPFSK 1REC CPM trellis structure is drawn in .

The h CPFSK modulation has 8 full states. When the phase constellation is drawn with the phase positions labeled with each state it becomes apparent that a trellis structure that creates super states by combining full states and and and along with and would provide the best distance for the reduced state trellis.

This CPM trellis structure already has two special properties. The first is that at each symbol a valid starting state must either be odd or even with the assumption that the first starting state is the zero state. This is accomplished at the transmitter by starting the transmission at a phase value of zero degrees. The second property of this full state trellis is that the decoder can skip the calculation of path metrics for odd or even states at the decoding of every other symbol. Thus the optimal CPM decoder is already reduced to the point that it only calculates updates path metrics for half of the states during each decoder cycle.

Referring again to the reduced state trellis structure is illustrated. The full state labels are marked in brackets with the new super state labels listed above each bracketed pair.

When constructing the reduced state trellis each full state remains connected as it was in the original trellis. For this specific trellis the characteristic properties of alternating the start state at each symbol decode cycle remains an important parameter of the decoder. A decode cycle is defined as the calculation of a full state of branch metrics from an input symbol and the update of the path metrics for all of the active states in the trellis structure.

Another enhancement required for reduced state sequence detection is the decision feedback step in the decoder. Along with path metric and traceback bits the decoder should retain the winning full state at each super state. Since it is assumed at the beginning that the decoder starts at super state zero the decoder state will also assume that the starting full state is zero and not four. In general the decoder super state can be initialized to the first full state in the list for each of the reduced states i.e. and by initializing the path metric properly.

When the decoder calculates the path metric for super state one it will compare the zero to one transition using the corresponding calculated branch metric to the metric for a state two to state one transition. The decoder will then save the full state value of one as the winning state for the next decoder cycle in other words it retains the phase of the survivor path . The next super state calculated at this decoder cycle will be seven skipping the even invalid super states . Again since zero is the winning full state from the initial decoder cycle the transition from zero to seven the only valid full state to the two to three transition since two was initialized in the previous decoder cycle . The best path metric is chosen and the winning full state is saved along with the calculated path metric and the traceback bits in the decoder state.

As shown in the bit error rate performance degrades quickly as the number of super states is reduced from the full state value of 32 states to 8 super states. Four states are active per symbol.

The reduced state maximum likelihood sequence estimator defined in Svennson has only four states. The trellis structure is shown in .

As shown in this diagram a one two or three valued bit causes a state transition and a zero valued bit does not. Note that every state is connected to every other state which is not shown on the diagram to simplify the illustration.

Using this method the inactive states are automatically deleted from the path metric computations. This is a simple structure to implement and can be adapted to any CPFSK modulation. As with the set partitioning approach decision feedback is used to maintain the winning phase state for each of the super states. The decoder then calculates the path metrics for the four valid paths from the chosen winning phase and picks a new winning path metric which is then saved in the super state based on the branch taken during the symbol. If the branch corresponds to a 0 valued bit then the new super state is the same as the old super state. If however the transition corresponds to a one two or three valued bit then the accumulated path metric is saved to that other super state.

The resulting bit error rate performance is shown in . The BER is slightly degraded by use of the reduced state technique.

The Continuous Phase Modulation schemes in the MILSTD 188 181C require complex maximum likelihood decoders which can be reduced in complexity using either of the two algorithms discussed above. The tilted phase approach has been shown to have the best bit error rate performance while proving to be the most computationally efficient. The current MIL STD allows for 3 dB implementation loss for the h 4 16 5 16 option which could allow for a receiver to implement the reduced complexity scheme and still meet the specification.

There now follows a more detailed description of examples of reduced state techniques operable with a programmable trellis or maximum likelihood decoder as described before and used for hybrid CPM modulation in accordance with non limiting examples of the present invention.

Hybrid Continuous Phase Modulation HCPM is a variant of Continuous Phase Modulation that uses either additional Amplitude or Phase pulses to create a higher order modulation. For standard CPM an increase in the modulation order results in the increase of the symbol alphabet and a corresponding increase in the transmit bandwidth and exponential increase in the complexity of the decoder trellis structure. Hybrid CPM however achieves higher order modulation by adding parallel branches to the base CPM trellis structure thus reducing the receiver complexity. The goal of the text that follows is to demonstrate that the techniques devised to reduce the demodulator complexity of standard modulation types like TCM and CPM can also be successfully applied to Hybrid CPM. As an example the text provides an analysis of the power and spectral efficiency of the two hybrid CPM waveforms and gives specific examples of the application of reduced state techniques. Both set partitioning and reduced state sequence estimation with decision feedback techniques are analyzed and compared. The results will demonstrate that reduced state sequence estimation can be coupled with Hybrid CPM demodulation without any loss in bit error rate performance.

where T is the symbol period E is the energy per symbol f is the carrier frequency Ai t qi t and ai are all dependant on the transmitted data and hi is the modulation index. Unlike classic CPM modulation hybrid CPM extends the symbol alphabet contained in i with a set of additional amplitude or phase Ai t or qi t pulses. For constant envelope HCPM qi t is the phase pulse shape that contains part of the modulated bits. And for non constant envelope hybrid CPM Ai t is the amplitude pulse shape that contains part of the modulated bits. In both cases the net result is more bits per symbol.

With rectangular linear pulse shaping the CPM waveform is denoted as 1REC CPM or CPFSK. To this full response signal different amplitude pulse shapes can be applied to each CPM phase trajectory to create a non constant envelope signal. For optimal performance each amplitude pulse should have good cross correlation properties and would ideally be orthogonal. A sample set of orthogonal and antipodal signals would include multiples of sinusoid signals as shown in Table 1.

Other CPM based amplitude pulse schemes have been described in the literature as a method of reducing the bandwidth of the transmit signal. Multi amplitude CPM has been defined as a method to increase the modulation order of the CPM signal by allowing same phase constellation points to have two or more amplitude positions. Multi amplitude CPM reduces the distance between adjacent CPM constellation points and has a narrow transmit spectrum. As a result of the decreased Euclidean distance the power efficiency of multi amplitude CPM is impaired by the increase in constellation density. Unlike multi amplitude CPM modulation hybrid CPM has a the same transmit constellation as the original CPM signal and has a corresponding increase in bandwidth as a function of each additional bit added to the modulated signal. As compared to multi amplitude CPM the power efficiency is unaffected by increase in modulation order. Multi Amplitude CPM is more comparable to PSK or QAM modulation schemes and unlike HCPM because those modulation types also increase in constellation density as a function of the order of the modulation and suffer a corresponding loss in power efficiency.

The constant envelope hybrid CPM modulation utilizes the phase pulse of the CPM signal to generate a higher level modulation. Other constant envelope pulse based modulation schemes have been described in the literature. Multi pulse CPM for example is a generalized method that describes different phase pulse shapes for each transmitted bit designed to provide better Euclidean distance for a given spectral mask. Unlike multi pulse CPM the constant envelope hybrid CPM increases the modulation order using both the standard base CPM i modulation index and different phase pulses qi t for the remainder of bits per symbol being sent. The resulting signal has the same decoder trellis structure as the base CPM waveform. The additional parallel branches generated by the HCPM signal are designed in a manner that intentionally prevents an increase in trellis complexity only the branch metric computation is affected .

For constant envelope Hybrid CPM the phase pulse shape qi t is tailored to meet spectral or power efficiency requirements and each pulse is designed to generate a transmit symbol which is as orthogonal as possible to other symbols in the transmit alphabet to increase the distance properties of the branch metric computation at the decoder. An example of the possible phase pulse shape combinations can best be demonstrated with a diagram .

Each possible shape is piece wise linear for duration of the symbol. This family of phase pulse shapes adds two bits to the CPM modulation. An h binary CPFSK 1 REC CPM has a full state trellis structure as shown in .

The reduced state sequence detection algorithm defines two steps to the modification of the optimal maximum likelihood decoder such as described above and set forth in the incorporated by reference Svennson and Eyuboglu articles. The first step is a set partitioning approach to the selection of state combination. When the phase constellation is drawn with the phase positions labeled with each state as shown in showing a h CPFSK constellation. It becomes apparent that a trellis structure that creates super states by combining full states and and and along with and would provide the best distance for the reduced state trellis.

This CPM trellis structure already has two special properties. First at each symbol a valid starting state can be either odd or even with the assumption that the first starting state is the zero state. This can be accomplished at the transmitter by starting the transmission at a phase value of zero degrees. Second the decoder can skip the calculation of path metrics for odd or even states at the decoding of every other symbol. The optimal CPM decoder is already reduced to the point that it only calculates updates path metrics for half of the states during each decoder cycle.

Referring again to the reduced state trellis structure is shown. As noted before the full state labels are marked in brackets with the new super state labels listed above each bracketed pair.

When constructing the reduced state trellis each full state remains connected as it was in the initial trellis. For this specific trellis the characteristic properties of alternating the start state at each symbol decode cycle remains an important parameter of the decoder. A decode cycle is defined as the calculation of a full state of branch metrics from an input symbol and the update of the path metrics for all of the active states in the trellis structure.

A second important enhancement required for reduced state sequence detection is the decision feedback step in the decoder. Along with path metric and trace back bits the decoder retains the winning full state at each super state. Since it is assumed at the beginning that the decoder starts at super state zero the decoder state will also assume that the starting full state is zero and not four. In general the decoder super state can be initialized to the first full state in the list for each of the reduced states i.e. and by initializing the path metric properly.

When the decoder calculates the path metric for super state one it will compare the zero to one transition using the corresponding calculated branch metric to the metric for a state two to state one transition. The decoder saves the full state value of one as the winning state for the next decoder cycle. The next super state calculated at this decoder cycle will be seven skipping the even invalid super states . Again since zero is the winning full state from the initial decoder cycle the transition from zero to seven the only valid full state to the two to three since two was initialized in the previous decoder cycle and the winning full state saved along with the calculated path metric and the trace back bits in the decoder state.

Hybrid CPM Modulation adds parallel branches to each transition in the trellis structure. The maximum likelihood decoder must determine at each symbol which parallel branch has the best distance the best numerical branch metric value and uses that value for the current state to state transition. Standard CPM complexity increases with the modulation level and h value. Hybrid CPM does not add states or transition branches to the trellis structure. The complexity of the Hybrid CPM modulation has a proportional increase based on the number of branch metrics required for each bit added to the modulation level.

Another characteristic feature of hybrid CPM is the ability to tailor the transmit spectrum to meet channel requirements. As shown in the example in Table 1 above a single bit can be added to the CPFSK modulation using a sine wave amplitude shape. If two bits are added a full sine wave amplitude pulse is added to the existing sine wave to form four antipodal pulse shapes. The resulting spectra are shown in .

Each spectrum has been normalized to the bit rate rather than the symbol rate to demonstrate that the characteristic bandwidth of the CPFSK signal has been preserved. In fact the bandwidth is increased by the number of bits per symbol in the Hybrid CPM waveform. The resulting 90 bandwidth values are 0.68 2.1 and 3.4 times the symbol rate for the CPFSK Hybrid CPM with 1 AM Bit and Hybrid CPM with 2 AM Bits respectively.

The amplitude pulse shaped Hybrid CPM has the spectral properties as shown in . As with the phase pulse shaping the amplitude pulse shapes add spectral content to the signal. Each spectrum shown in has been normalized to the bit rate of the modulation. Without normalization the resulting 90 bandwidth is 0.68 1.5 and 3.4 times the symbol rate.

An intuitive expectation of a waveform that increases bandwidth as a function of modulation level is that the distance property of the signal must be increasing and the corresponding power efficiency is improved. This is equivalent to a PSK signal that has been spread by an orthogonal code. The resulting signal bandwidth increases by the code rate and the power efficiency is the same as a standard PSK modulation. In the case of pulse shapes chosen as examples some provide more or less bandwidth expansion and correspondingly more or less Eb No improvement. As shown in the amplitude pulse shaped Hybrid CPM has different performance levels for each pulse shape.

The abbreviation RS is used to represent the reduced state version of each of the Hybrid CPM examples. As shown in the higher throughput 3 bits per symbol Hybrid CPM modulation has better power efficiency than the 2 bits per symbol version. It has been verified that by selecting the wider bandwidth i.e. full sine wave amplitude pulse shapes the Eb No performance was improved for the 2 bit per symbol Hybrid CPM.

The power efficiency of the 3 bit per symbol Hybrid CPM signal matches the standard h CPFSK modulation. Those skilled in the art understand that it is possible to increase the modulation level of the CPFSK signal. The decoder complexity can increase with the modulation level. The number of states in the CPM trellis can be the same for the multi level as for the binary modulation but each state has an increasing number of branches as the order of the modulation increases. The decoder calculates the metric for each of these transition branches as the sum of the branch metric and the path metric of its associated state. If the transition branch is not chosen this is a wasted operation. In the case of the parallel branches used by Hybrid CPM the decoder simply compares branch metrics of the two parallel paths without the addition of the path metric. Depending on the number of states and modulation order the extra addition of the path metric increases the relative complexity of the standard CPM modulation relative to the Hybrid CPM modulation.

The phase pulse shaped Hybrid CPM modulation bit error rate curves are shown in . As with the amplitude pulse shaping the phase pulse shaping performance is variable. The 3 bit per symbol modulation outperforms the 2 bit per symbol version. Again the difference is in the choice of phase pulse shapes. If the higher valued pulse shaping was chosen for the 2 bit per symbol Hybrid CPM the power efficiency would be improved.

The resulting bit error rate curve for the 2 state reduced state h CPFSK and HCPM with amplitude shaping is shown in .

The bit error rate curve for the 2 state reduced state h CPFSK with HCPM with phase pulse shaping is shown in .

For increased modulation order 4 ary 8 ary etc. . The reduced state trellis structure increases proportionally. For HCPM however the trellis structure of the original CPM signal is maintained. The trellis structure has parallel branches which do not modify the decision feedback or path metric storage. The best parallel path is chosen for each branch and then used as the branch metric for that super state.

It is clear from the power efficiency performance curves that the pairing of reduced state sequence detection with Hybrid CPM modulation effectively extends the range of usefulness of the waveform. Increasing the throughput of a CPM signal with the addition of the orthogonal amplitude or phase modulation does not increase the decoder complexity as much as adding more transition branches to each node. With the addition of reduced state sequence detection additional power efficiency performance can be obtained without the corresponding increase in decoder complexity through the use of a base CPM trellis structure with a larger number of full states.

Each possible pulse shape is piece wise linear for the duration of the symbol. This family of phase pulse shapes adds 2 bits to the CPM modulation.

As an illustration of both types of hybrid CPM modulation a common base trellis structure was selected. An h binary CPFSK 1REC CPM has a full state trellis structure with eight states as shown in showing a h CPFSK trellis.

This application is related to copending application entitled GENERIC REDUCED STATE MAXIMUM LIKELIHOOD DECODER which is filed on the same date by the same assignee and inventors the disclosure which is hereby incorporated by reference.

Many modifications and other embodiments of the invention will come to the mind of one skilled in the art having the benefit of the teachings presented in the foregoing descriptions and the associated drawings. Therefore it is understood that the invention is not to be limited to the specific embodiments disclosed and that modifications and embodiments are intended to be included within the scope of the appended claims.

