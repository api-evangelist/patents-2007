---

title: Multi-network cryptographic device
abstract: A Personal Computer Memory Card International Association (PCMCIA) card is disclosed. The PCMCIA card may include a cryptographic module, a communications interface, and a processor. The cryptographic module may perform Type 1 encryption of data received from a computer into which the card is inserted. The cryptographic module may support High Assurance Internet Protocol Encryption (HAIPE). The communications interface may provide connectivity to a network adapter. The communications interface may include a Universal Serial Bus (USB) interface. The processor may detect whether a network adapter is coupled to the communications interface, identify a device driver that corresponds to the network adapter, and employ the device driver to provide operative communication between the cryptographic module and the network adapter. The PCMCIA card may contain a datastore that maintains a plurality device drivers. For example, the plurality of device drivers support any one of IEEE 802.x, Ethernet, V.90, or RS-232 network protocols.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08032763&OS=08032763&RS=08032763
owner: L3 Communications Corporation
number: 08032763
owner_city: New York
owner_country: US
publication_date: 20070713
---
This non provisional application for patent claims priority to U.S. provisional patent application No. 60 899 957 entitled Method for Utilizing COTS Devices with Cryptographic Equipment filed on Feb. 7 2007 which is herein incorporated by reference in its entirety.

The present invention was supported by the National Security Agency under Contract Numbers MDA 904 02 C 1152 and CCEP 056 04. The government may have certain rights in the invention.

Information systems that deal in sensitive information may require high levels of security. When users of a secure information system are co located with that system the users may connect directly to the system in a secure environment. On the other hand when the users are remote to secure information systems it may be necessary to establish a secure encrypted communications channel between the user and information system. For example a U.S. government employee may wish to connect to a classified information system via a laptop computer and a public access network such as a Wi Fi hotspot. Establishing such a connection may require a high level of security between the computer and the information system to protect the classified data as it traverses the non secure public network.

To establish the secure encrypted communication channel between the user and the information system over a public network the user may employ a Type 1 device. Type 1 products are devices or systems that are certified by the National Security Agency for use in cryptographically securing classified U.S. government information. Generally Type 1 designation may be reserved for products that have been analyzed and tested for cryptographic security tamper resistance mission security and the like. The Type 1 device may be placed between the user s computer and the non secure public network over which the user wishes to establish a secure communication channel. The Type 1 device may include the cryptographic algorithms required to establish a secure connection over the public network.

Often the user may not know ahead of time which public networks and which physical access options may be available. For example the user may be staying in a hotel that offers public Internet access but the user may not know ahead of time whether that access is available via wireless local area network WLAN Ethernet dial up modem or the like. To be assured of connectivity the user may have to provide many different Type 1 products one for each physical access option that is likely to be available. Also because Type 1 encryption may be processing intensive the form factor of each Type 1 device may be bulky heavy and require external power sources. Thus there is a need for a Type 1 encryption device that is compact and supports access to multiple networks.

A Personal Computer Memory Card International Association PCMCIA card is disclosed. The PCMCIA card may include a cryptographic module a communications interface and a processor. The PCMCIA card may have a PCMCIA Type II form factor.

The cryptographic module may perform Type 1 encryption of data received from a computer into which the card is inserted. The cryptographic module may support High Assurance Internet Protocol Encryption HAIPE .

The communications interface may provide connectivity to a network adapter. The communications interface may include a Universal Serial Bus USB interface. The USB interface may include a mini USB port. The communications interface may provide power to the network adapter.

The processor may detect whether a network adapter is coupled to the communications interface. The processor may identify a device driver that corresponds to the network adapter. The processor may employ the device driver to provide operative communication between the cryptographic module and the network adapter. If a corresponding device driver is not found the USB interface may switch off power to the network adapter.

The PCMCIA card may contain a datastore that maintains a plurality of device drivers. The plurality of device drivers may support a plurality of network protocols. For example the plurality of device drivers may support any one of Institute of Electrical and Electronics Engineers IEEE 802.x Ethernet V.90 or RS 232 network protocols.

The cryptographic device may connect to the computer . The cryptographic device may include a cryptographic module and a plurality of network adapters . The form factor of the cryptographic device may be suitable for connecting to the computer . For example the form factor may be a PCMCIA form factor. The cryptographic device may be a Type II PCMCIA card.

The cryptographic device may include a tactical enclosure. For example the cryptographic device may conform to military environmental specifications such as NEMA4 IP 67 MIL STD 810F MIL STD 461E SAE and the like. The cryptographic device may be powered by the computer .

The cryptographic device may be a host based encryptor capable of securely transmitting and receiving voice data and Internet Protocol IP datagrams. The cryptographic device may support circuit switched voice data and fax connections from the secure gateway . The cryptographic module may establish a secure communication channel between the computer and the secure gateway .

The cryptographic module may support encrypting data sent from the computer to the secure gateway and decrypting data sent from the secure gateway to the computer . The cryptographic module may include any system subsystem circuit processor or computing component that provides cryptographic functionality. Cryptographic functionality may include key generation key exchange encrypting data decrypting data and the like. For example the cryptographic module may support Type 1 encryption. Type 1 encryption may include any classified or controlled cryptographic algorithm endorsed by the National Security Agency NSA for securing classified and sensitive U.S. Government information. The Type 1 designation may refer to products that contain approved NSA algorithms. For example Type 1 algorithms may include Accordian Firefly Medley Saville Walburn and the like. The cryptographic module may provide NSA Type 1 High Grade High Assurance while protecting classified information up to the Top Secret Sensitive Compartmented Information TS SCI level.

The cryptographic module may support secure communication protocols to facilitate the secure connection between the cryptographic module and the secure gateway . For example the cryptographic module may support High Assurance Internet Protocol HAIPE . Also for example the cryptographic module may support The Secure Communications Interoperability Protocol SCIP Future Narrow Band Digital Terminal FNBDT Internet Protocol Security IPSec and the like.

Likewise the secure gateway may support complementary cryptographic algorithms and complementary secure communication protocols to enable secure communication between the cryptographic device and the secure gateway . For example the secure gateway may terminate a Virtual Private Network VPN connection to enable the computer to access and information system protected by the secure gateway . For example the secure gateway may be a RedEagle KG 240 245 in line network encryptor L3 Communication Systems New York N.Y. .

To establish an Internet Protocol IP connection a user at the computer may use host software to access the cryptographic device with a pass phrase. The cryptographic device may establish a Security Association SA with the secure gateway . Identification and authentication information may be exchanged to establish an encrypted session. Once the SA is established continuous encryption decryption and data integrity services may be provided by the cryptographic device until the session is terminated.

To establish a circuit switched connection the user at the computer may use host software to access the cryptographic device with a pass phrase. The user may dial or speed dial the desired remote phone number and the cryptographic device may negotiate a secure SCIP connection with the secure gateway . The cryptographic device may establish a secure connection with another cryptographic device . If negotiation is successful the user may be prompted to accept the connection.

The cryptographic module may communicate with a plurality of network adapters . The network adapters may connect the cryptographic module to a plurality of access networks. The access networks may include IP networks. The network adapters may include any hardware suitable for providing connectivity with an access network . For example the plurality of network adapters may include a wireless network adapter an Ethernet network adapter a data modem network adapter and the RS 232 network adapter and the like.

The wireless network adapter may include the hardware and software suitable for communicating over a wireless access network . The wireless network adapter may support IEEE 802.11x wireless protocols such as 802.11a 802.11b 802.11g 802.11n and the like. The wireless network adapter may support mobile communications protocols such as Cellular Digital Packet Data CDPD Global System for Mobile Communications GSM General Packet Radio Service GPRS Wideband Code Division Multiple Access W CDMA Worldwide Interoperability for Microwave Access WiMax and the like.

The Ethernet network adapter may include the hardware and firmware suitable for communicating over an Ethernet access network . For example the Ethernet network adapter may support Fast Ethernet Gigabit Ethernet 10 Gigabit Ethernet 1000 Gigabit Ethernet and the like. The Ethernet network adapter may support any suitable physical connector and medium. For example the Ethernet network adapter may support 10Base2 10Base T 10Base TX and the like. The Ethernet network adapter may include a T568A B wired 8P8C modular connector.

The data modem network adapter may include the hardware suitable for connecting and communicating data over the public switched telephone network. The data modem may conform to V.x standards such as V.32 V.34 V.70 V.90 V.92 and the like.

The RS 232 network adapter may include the hardware suitable for connecting and communicating data over a serial connection. The RS 232 network adapter may include a 3 wire and 5 wire RS 232. For example the RS 232 adapter may include DB 25 DE 9 EIA TIA 561 pinouts. The RS 232 network adapter may connect to a complementary RS 232 device for communication to the secure gateway . The plurality of network adapters may include RS 422 and RS 485 network adapters 

The plurality of network adapters may be housed commonly with the cryptographic module . The user may select or indicate which of the plurality of network adapters is to be employed for secure communications. The plurality of network adapters may be contained in individual housings separate to that of the cryptographic module . Each may connect to the cryptographic module via a communications interface See . For example the communications interface may be a USB interface. Some network adapters may be housed commonly with the cryptographic module and some may be external to the housing of the cryptographic module .

Each network adapter may have an associated device driver. The device driver may be any software computer executable code or instructions that enables the cryptographic device to interact with the respective network adapter . The driver may provide an Application Programming Interface API for communicating with and controlling the respective network adapter . Each respective driver may include code specific to the communications protocols supported by the respective network adapter . For example the driver that supports the wireless adapter may include code that provides infrastructure ad hoc modes of operation standard authentication such as Open System Wired Equivalent Privacy WEP Wi Fi Protected Access WPA and the like frame management reassembly fragmentation of wireless data frames and the like

The operating system of the computer may communicate with the cryptographic module of the cryptographic device . The operating system of the computer may include a device driver associated with the cryptographic device . The device driver of the cryptographic device may support configuration and operation of the cryptographic module .

The cryptographic module may define a demarcation between a secure side and a non secure side . The cryptographic module may encrypt plain text data sent from the secure side to cipher text data sent to the non secure side . Likewise the cryptographic module may decrypt cipher text data sent from the non secure side to plain text data sent to the secure side . The cryptographic module may prevent unencrypted data from passing from the secure side to the non secure side .

In a classified environment the secure side may be known as the red side and the non secure side may be known as the black side. The red designation may apply to systems devices areas circuits components equipment and the like in which unencrypted national security information is being processed. The black designation may apply to systems devices areas circuits components equipment and the like in which national security information is either encrypted or not processed.

The cryptographic device may include a processor in communication with the cryptographic module . The processor may include any system subsystem or component for digital computing. For example the processor may include a microprocessor Application Specific Integrated Circuit ASIC Digital Signal Processor DSP and the like. The processor may be an Advanced RISC Machine ARM processor. The processor may operate a Real Time Operating System RTOS . The processor may provide IP processing IP fragmented packet reassembly SCIP setup and operation wireless network configuration network adapter management and the like. The processor in conjunction with the RTOS may provide Point to Point Protocol PPP and Dynamic Host Control Protocol DHCP client functionality.

The processor may provide operative communication between the cryptographic module and the network adapter . For example data communicated between the cryptographic module and the network adapter may flow directly via the processor . Also for example data communicated between the cryptographic module and the network adapter may flow via a bus directly between the cryptographic module and the network adapter with the bus controlled by the processor .

The cryptographic device may include a datastore in communication with the processor . The datastore may be any component system or subsystem suitable for storing data. The datastore may be volatile memory such as random access memory RAM . The datastore may be nonvolatile memory such as read only memory ROM flash memory magnetic storage and the like.

The datastore may include a plurality of device drivers. Each device driver may correspond to a network adapter . Each device driver may enable the processor and RTOS to employ the respective network adapter . The device driver may be executable code suitable for execution by the processor .

The datastore may contain data that identifies each device driver. For example the datastore may include a lookup table that cross references identification information to each device driver. Also for example the datastore may include executable code that logically identifies each device driver according to identification information.

The cryptographic device may include a communications interface in communication with the processor . The communications interface may enable data communications between the processor and the network adapter . The communications interface may be a logical or physical interface. For example the communications interface may be a USB interface. The USB interface may support any version such as 1.0 1.1 and 2.0. The communications interface may include a USB host controller and a root hub. The communications interface may provide a communications bus that provides a data link between the processor and the network adapter 

The communications interface may include any physical connector suitable for transferring data. For example the connector may include USB type A and type B form connectors. Also for example the connector may include mini USB and micro USB form connectors. When the network adapter is engaged the communications interface may provide power to the network adapter . The processor may indicate to the communications interface to discontinue providing power. For example if an incorrect device is engaged to the communication interface the processor may indicate to the communications interface to discontinue providing power.

At the processor may identify a device driver that corresponds to the network adapter . The communications interface and the network adapter may initialize via a start up handshaking protocol. The network adapter may provide data that uniquely identifies the network adapter to the processor . For example the network adapter may communicate device descriptors configuration descriptors interface descriptors endpoint descriptors and string descriptors consistent with the USB interface. Also for example the device descriptor may include a vendor ID a product ID and a device release number that may be used to identify the network adapter 

The processor may use this information to identify the device driver that corresponds to the network adapter . For example the processor may logically map the identifying information to a specific device driver. If the identification information does not map to any stored device driver the processor may indicate to the communications interface to discontinue powering the network adapter 

At the processor may employ the corresponding device driver to provide operative communication between the cryptographic module and the network adapter . The device driver may include executable code that the processor may execute to control the flow and format of data between the network adapter and the cryptographic module . The device driver may provide the functionality required to format data according to a network protocol associated with the network adapter . The device driver may provide call set up and tear down logic for circuit switched network adapters 

As shown in the PCMCIA card may be packaged with a plurality of selectable USB network adapters . Each network adapter and the PCMCIA card may be packaged together in a carrying case . Each network adapter may be separately housed and may be connected to a PCMCIA card via the Type A USB connector and or the mini USB connector . Each network adapter may include a complementary USB connector.

The plurality of network adapters may include an 802.11b g wireless adapter an Ethernet network adapter an analog modem and a RS 232 adapter . The 802.11b g wireless adapter may be compatible with the IEEE 802.11b and 802.11g standards. The Ethernet network adapter may be compatible with the IEEE 802.3 standard and 10BASE T cabling. The analog modem may be compatible with the International Telecommunication Union ITU V.90 interoperability standard. The RS 232 adapter may be a serial device compatible with the RS 232 serial interface standard.

Each network adapter may be selected by inserting the respective USB connector of the network adapter into the complementary USB connector of the PCMCIA card . The PCMCIA card may be inserted into the PCMCIA slot in the computer . Once inserted into the computer the PCMCIA card with the connected network adapter may provide the Type 1 cryptography and data connectivity features to the computer .

