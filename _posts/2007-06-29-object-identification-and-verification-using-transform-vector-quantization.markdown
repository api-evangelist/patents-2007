---

title: Object identification and verification using transform vector quantization
abstract: An identification system uses mappings of known objects to codebooks representing those objects to identify an object represented by multiple input representations or to verify that an input representation corresponds to an input known object. To identify the object, the identification system generates an input feature vector for each input representation. The identification system then accumulates for each known object the distances between the codebook of that object and each of the input feature vectors. The distance between a codebook and a feature vector may be the minimum of the distances between the code vectors of the codebook and the feature vector. The identification system then selects the object with the smallest accumulated distance as being the object represented by the multiple input representations.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07991199&OS=07991199&RS=07991199
owner: Microsoft Corporation
number: 07991199
owner_city: Redmond
owner_country: US
publication_date: 20070629
---
The present application is related to U.S. patent application Ser. No. 11 771 794 entitled SPEAKER RECOGNITION VIA VOICE SAMPLE BASED ON MULTIPLE NEAREST NEIGHBOR CLASSIFIERS which is being filed concurrently and which is hereby incorporated by reference in its entirety.

Many applications rely on the ability to identify an object from a representation of the object or to verify whether a representation of an object corresponds to an object as purported. These applications may include authentication systems image based search engines identity systems and so on. An authentication system attempts to verify that a person who purports to be a certain person is really that certain person. An image based search engine may try to locate duplicate or similar images to an input image. For example a user who wants to know information about a flower may provide a picture of the flower to the search engine. The search engine may search a database that maps images of flowers to their names. When an image matching the picture is found the search engine may provide the corresponding name to the user. As another example a medical service provider may want to verify that a diagnosis based on a certain image e.g. x ray is consistent with a data store of previous diagnoses based on images. An identity system attempts to identify the person in an image or video or the person from whom a voice sampling was obtained.

An authentication system may authenticate a user using voice recognition techniques face recognition techniques or other biometric recognition technique. When using voice recognition an authentication system compares a previous sampling of a person s voice to a current sampling of a person s voice to determine whether the person who supplied the current sampling is the same person who supplied the previous sampling. Similarly when using face recognition an authentication system compares a previous image of a person s face to a current image of a person s face to determine whether previous image and the current image are of the same person. If the persons are the same then the authentication system verifies that the person who provided the current voice sampling or the person in the current image is the same person who provided the previous voice sampling or who is in the previous image.

Many face recognition techniques have been proposed that attempt to recognize the person whose face is in an image even when the faces have different poses. For example one pose may be a typical portrait pose and another pose may be with the face turned 45 degrees. Holistic face recognition techniques such as the principal component analysis PCA based Eigenface technique perform well for image sets where pose variation is minimal but perform poorly when there is a wide range of pose variations. Such techniques may not even perform well with minimal pose variation if there is a wide variation in facial expressions. The facial expression may include smiling grimacing surprised sad and so on. Some face recognition techniques improve their performance by attempting to normalize the variations in poses. Other face recognition techniques improve their performance by using a video of the face or sequence of images of the face rather than a single image. However such techniques are complex both computationally and in storage requirements.

Many voice recognition techniques that attempt to identify the speaker of a voice sampling have also been proposed. Some voice recognition systems are text independent in the sense that a person can say any sequence of words both when training the recognition system and when providing a voice sampling for recognition. Since a text independent voice recognition system does not have the corresponding text it bases its models on a division of the samplings into utterances. Since utterances from different speakers who say different things may sound similar it can be difficult for a text independent voice recognition system to correctly identify a speaker. Although text dependent speaker recognition systems have the advantage of knowing what words the speaker is speaking such systems typically require larger amounts of training data and are more complex that text independent speaker recognition systems.

An identification system uses mappings of known objects e.g. persons to codebooks representing those objects to identify target object represented by multiple target representations e.g. images . To identify the target object the identification system generates a target feature vector for each input representation. The identification system then accumulates for each known object the distances between the codebook of that object and each of the target feature vectors. The distance between a codebook and a feature vector may be the minimum of the distances between the code vectors of the codebook and the feature vector. The identification system then selects the object with the smallest accumulated distance as being the object represented by the multiple input representations.

The identification system may also use the mappings of known objects to codebooks representing those objects to verify that a target representation corresponds to a target object. The identification system generates a target feature vector for the target representation. The identification system then sets a target distance to the distance between the target feature vector and the codebook for the target object. The identification system then calculates for each other known object the distance between the codebook for that object and the target feature vector. The identification system then determines whether the target distance and the minimum of the distances for the other objects a non target distance satisfies a verification criterion. If so the identification system indicates that the target object can be verified as corresponding to the target representation.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

A method and system for identifying an object from multiple representations of the object is provided. For example an identification system may identify a person from multiple images or voice samples of that person. In one embodiment an identification system identifies objects based on a collection of representations of known objects. To facilitate the identification of objects the identification system generates a mapping for each known object from that object to a codebook derived from the representation of the object. When faces are being recognized the collection may contain multiple images of each known person at different profiles. The image with different profiles may be collected using multiple cameras or a single camera with the person at different poses. To generate a codebook for an object the identification system generates a feature vector representing each representation of that object. A feature vector contains features e.g. 15 features that collectively represent the object. The identification system then generates a codebook for the object which is a compressed representation of the feature vectors for that object. For example if there are 50 images of each person the identification system would generate 50 feature vectors for each person where each feature vector may 15 dimensions or features. A codebook in contrast may have 10 code vectors with 15 dimensions or features each. A codebook can be considered to be a unique signature of the object.

The identification system uses the mappings of known objects to identify the object corresponding to multiple input representations. For example the identification system when presented with multiple images of a person identifies the person from the mappings. To identify the object the identification system generates an input feature vector for each input representation. The identification system then accumulates for each known object the distances between the codebook of the object and each of the input feature vectors. The distance between a codebook and a feature vector is the minimum of the distances between the code vectors of the codebook and the feature vector. For example to calculate the distance between the codebook of a person and an input feature vector for an input image the identification system calculates the distance between each code vector of the codebook and the input feature vector and selects the minimum of those distances. To accumulate the distances for a person the identification system calculates the distance between the codebook for the person and each of the input vectors and adds those distances together. The identification system then selects the object with the smallest accumulated distance. If the accumulated distance of that selected object satisfies an identification criterion then the identification system identifies that object as corresponding to the input representations. For example the identification system identifies the person with the smallest accumulated distance and determines whether that accumulated distance satisfies the identification criterion. The identification criterion may be a threshold difference between the smallest accumulated distance and the second smallest accumulated distance. In this way the identification system can identify an object from multiple input representations of the object with greater accuracy and less complexity than prior systems.

In one embodiment the identification system verifies that an input representation corresponds to an input object. For example the identification system may verify that an input image of an input person John Doe really does correspond to that input person. As described above the identification system may have a mapping from known objects to codebooks representing those known objects. The identification system generates an input feature vector for the input representation. For example the identification system generates an input feature vector from an input image. The identification system then sets a target distance to the distance between the input feature vector and the codebook for the input object. For example the identification system retrieves the codebook for the input person John Doe and calculates the distance between the input feature vector and the codebook of that target person. The identification system then calculates for each other object the distance between the codebook for that object and the input feature vector. The identification system then determines whether the target distance and the minimum of the distances for the other objects a non target distance satisfies a verification criterion. If so the identification system indicates that the input object can be verified as corresponding to the input representation. For example the verification criterion may be whether the ratio of the target distance and the non target distance is less than a threshold ratio. In this way the identification system can verify that an input representation corresponds to an input object with greater accuracy and less complexity than prior systems.

In one embodiment the identification system generates a codebook for face recognition from sequences of images of a person. The images can be still images or frames of a video. The images may be represented as X X . . . X where M is the number of images. The identification system initially preprocesses the images to generate normalized images. To preprocess the images of a person the identification system identifies the region of interest of each image that contains the face. The identification may use various well known techniques for locating faces within an image. The identification may track the fact contours and use vertical and horizontal projections to bound the region of interest. The identification system then converts the images to gray scale images. The identification system then normalizes the size of the region of interest of each image. For example the image size may be normalized to 136 pixels by 120 pixels. The result will be normalized images I I . . . I. The identification system may also perform a histogram equalization on the normalized image.

The identification system then generates a feature vector for each of the normalized images. To generate the feature vector for an image the identification system applies a 2 D discrete cosine transform DCT to the normalized image to generate a transform matrix. The identification system then selects the coefficients from the upper left of the transform matrix as the features of the feature vector for the image. For example the identification system may select of square sub matrix of the transform matrix. Since the upper left coefficient of the transform matrix is a DC coefficient the identification system excludes that coefficient from the feature vector which tends to filter out illumination variations. If the sub matrix is an m by m matrix the feature vector will have K features where K m 1 . For example if m is 4 then a feature vector will have 15 features. The identification system may use other techniques to generate the feature vectors of the images include wavelets principal component analysis linear discriment analysis independent component analysis Garber transforms and so on.

The identification system then generates the codebook for each person from the feature vectors of that person. The identification system uses a vector quantization technique such as the LBG algorithm developed by Linde Buzo and Gray or a K Means clustering algorithm. The identification system represents the code book of a as person as follows CB C C . . . C where i represents person i N represents the number of code vectors of the codebook and each Cis an K dimensional code vector.

The identification system identify a person from a single image or from multiple images e.g. a video or verify whether the person in an image is the person as purported. To identify a person from a single input image X the identification generates an input feature vector F from the input image. The identification system then calculates the distance between each code vector of each person s codebook and the input feature vector. The distance is represented as follows where Drepresents the distance between the input feature vector and code vector j of the codebook for person i. The distance Dbetween the input feature vector and the code for person i is the smallest of the distances D. The identification system identifies the person in the input image as being the person who has the smallest of the distances D.

To identify a person from multiple input images X X . . . X the identification system generates an feature vector F F . . . For each input image. The identification system accumulates for each person the distances between each of the input feature vectors and that person s codebook represented as follows 

where represents the confidence measure. If the confidence measure is greater than an identification threshold Tfor person j then the identification system identifies the person in the input images as being person j. The identification system may calculate the identification threshold Tfor person j by generating a histogram of the confidence measures for person j from the collection of persons and images and then setting the identification threshold Tbased on the mean value of the histogram e.g. a small percentage of the mean value . The identification system may generate the histogram for the person j by calculating the minimum distance between each feature vector derived from an image of person j and the codebooks of the other persons. One skilled in the art will appreciate that the identification threshold can be calculated in different ways and that other identification criteria may be used. For example the identification criterion may be based on difference between the smallest accumulated distance and an average of the other accumulated distances.

To verify that an input person k is the person in an input image X the identification system generates the input feature vector F from the input image. The identification system then calculates the distance Dbetween the feature vector F and the codebook for each person i. The identification system then determines whether distance Dsatisfies a verification criterion. To determine whether Dsatisfies the verification criterion the identification system calculates a confidence measure representing that the input person k is the person in the input image X. The confidence measure may be represented by the following equation 

If the confidence measure is less than a verification threshold then the identification system verifies that the input person is the person in the input image. Otherwise the identification system indicates that it cannot make such a verification. The identification system may establish the verification threshold based on analysis of the images in the collection. One skilled in the art will appreciate that other verification criteria may be user. For example the identification system may use a verification criterion that is based on a ratio of the squares of the distances.

The computing devices on which the identification system may be implemented may include a central processing unit memory input devices e.g. keyboard and pointing devices output devices e.g. display devices and storage devices e.g. disk drives . The memory and storage devices are computer readable media that may contain instructions that implement the identification system. In addition the data structures and message structures may be stored or transmitted via a data transmission medium such as a signal on a communications link. Various communications links may be used such as the Internet a local area network a wide area network or a point to point dial up connection to connect the identification system to other devices e.g. web servers and user computing devices .

The identification system may be used in various operating environments that include personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems programmable consumer electronics network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and the like.

The identification system may be described in the general context of computer executable instructions such as program modules executed by one or more computers or other devices. Generally program modules include routines programs objects components data structures and so on that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. For example the creation of the object codebook store can be performed on a computing system different from the computing system that performs the identification and verification using the object codebook store.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims. Accordingly the invention is not limited except as by the appended claims.

