---

title: Media key-transformation obfuscation in advanced access content system
abstract: A modified media key used to decrypt protected media content stored on an optical disc, such as an HD-DVD or Blu-ray disc, is created through application of a transformation using a constant value which is programmatically generated by procedural code that runs on a player. The transformation is obfuscated through application of a random value to the constant value through a logical XOR operation. The programmatically-generated constant, called Soft Key Conversion Data (“SKCD”) is used by a security layer to derive the modified media key, called a Soft Media Key. At the player, a conventionally calculated media key is used to decrypt the first title, while the Soft Media Key is used to decrypt subsequent titles. Optionally, the SKCD may be updated one or more times so that the Soft Media Key is repeatedly transformed and respectively applied, for example, on a title-by-title basis, or to groups of subsequent titles.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08023653&OS=08023653&RS=08023653
owner: Microsoft Corporation
number: 08023653
owner_city: Redmond
owner_country: US
publication_date: 20071009
---
The Advanced Access Content System AACS is a specification for protecting prerecorded and recordable media content stored on the next generation of optical media used for DVD Digital Versatile Disc including HD DVD and Blu ray . Such optical media are typically configured for consumer use with PCs personal computers and other consumer electronic devices that include high definition media players. The AACS specification is maintained by AACS Licensing Administrator LLC AACSLA .

AACS provides several mechanisms to manage usage of stored media content which may include movies games television programming and the like. Digital copying is securely prevented by the encoding of the content with a 128 bit AES Advanced Encryption Standard key code. HD DVD and Blu ray players use their own device key from which they are able to calculate the correct AES key code called a Media Key for each disc through use of a Media Key Block MKB and typically Key Conversion Data KCD that are stored on the data carrier e.g. an optical disc . Use of the MKB enables AACS to implement a key revocation model by which device keys on specific players that have been compromised for example through circumvention of the content protection can be revoked.

In addition the copy protection methodology used by AACS supports some Digital Rights Management DRM functionality to provide users with the freedom to consume disc contents legally on other devices such as media servers or portable equipment. The number and type of devices and the timeframe in which they can be used can be defined in the AACS system by the owner of the contents during the media authoring process.

While AACS is performing satisfactorily in many applications some vulnerability to attack is believed to exist which could compromise the integrity of the protection for the media content. For example if the base line content protection under AACS is broken HD DVD and Blu ray discs can be decrypted without authorization. Once attackers understand the process and secrets behind the AACS content protection methodology they can write a program that automates the process to allow illegal decryption by users that have minimal technical skill.

As a result of such vulnerability content providers have expressed interest in a form of content protection that can be applied on a per title basis which varies from title to title on a DVD disc in order to make it at least somewhat more difficult for an attacker to create an automated program for illegal decryption of the recorded content.

This Background is provided to introduce a brief context for the Summary and Detailed Description that follow. This Background is not intended to be an aid in determining the scope of the claimed subject matter nor be viewed as limiting the claimed subject matter to implementations that solve any or all of the disadvantages or problems presented above.

A modified media key used to decrypt protected media content stored on an optical disc such as an HD DVD or Blu ray disc is created through application of a transformation that uses a constant value which is programmatically generated by procedural code that runs in an application layer that is created during runtime of the optical disc on a player. The transformation is obfuscated through application of a random value to the constant value through a logical XOR operation. The programmatically generated constant called Soft Key Conversion Data or SKCD is used by a security layer to derive the modified media key called a Soft Media Key. The first title associated with particular media content on the optical disc is encrypted using the current AACS process. At the player a conventionally calculated AACS Media Key is used to decrypt the first title while the modified media key i.e. the Soft Media Key is used to decrypt subsequent titles. Optionally the SKCD may be updated one or more times so that the Soft Media Key is repeatedly transformed and respectively applied for example on a title by title basis or to groups of subsequent titles.

In an illustrative example an API application programming interface is utilized to expose methods for setting the constant value and invoking generation of the random value to the code in the application layer. However to avoid any potential vulnerability to exploitation or attacks mounted through the application layer neither the Media Key nor Soft Media Key are themselves exposed to the application layer.

The present arrangement for generating the Soft Media Key using key transform obfuscation advantageously provides a title specific obstacle in the path of attackers seeking to circumvent content protection by varying the decryption process from title to title on disc in an unpredictable way. For example such obstacle may be used to hinder attackers while the normal AACS key revocation process is underway.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

A content owner who requires protection provided by AACS typically provides one or more pieces of media content in the form of titles and associated usage rules . Titles as used here refers to a group of titles in a title set that typically defines a particular piece of media content such as movie release television program etc. Titles typically include such content as copyright notices language choices trailers as well as the main feature i.e. the movie or programming itself . Each title may be represented by one or more physical files referred to as content objects or video objects on a given DVD. Titles here is further used to refer collectively to titles and objects in either HD DVD or Blu ray formats.

The titles and usage rules are provided to a licensed replicator . The licensed replicator is responsible for encrypting prerecorded media content onto an optical disc typically for commercial distribution.

AACSLA provides a Media Key Block MKB and a corresponding secret Media Key to the licensed replicator . The MKB enables the licensed players using their own set of secret Device Keys which are issued by the AACSLA to derive the same Media key which is used unlock the encrypted prerecorded media content on the optical disc .

If a set of Device Keys is compromised which could threaten the integrity of the protection under the AACS paradigm an updated MKB can be released from the licensing authority that will cause the particular licensed player which has the compromised set of Device Keys to calculate a different Media Key from the other licensed players . Such updated MKB will thereby cause the compromised Device Keys to be revoked.

As shown in a variety of different media players are shown as the licensed players . These include game console a standalone DVD player and desktop PC . Each is configured in this illustrative example to render next generation DVD content e.g. content formatted on HD DVD and or Blu ray in accordance with AACS. However these are merely illustrative as other consumer electronic devices with next generation DVD AACS capability may also be utilized in some settings.

The licensed replicator also selects a secret unpredictable i.e. random identifier to protect the encrypted titles . This identifier known as the Volume Identifier is used to protect against bit copying of the encrypted titles and is thus stored on the optical disc in a way that cannot be duplicated by consumer optical disc recorders.

For each piece of protected media content on optical disc as indicated by blocks and the licensed replicator calculates a cryptographic hash of the Media Key Volume Identifier and usage rules . The licensed replicator uses the resulting hash value to encrypt the Title Key as indicated by block . The encrypted Title Key usage rules Volume Identifier and MKB are stored on the optical disc along with the encrypted titles .

The Device Keys provided to the licensed player are kept confidential. The Device Keys may be unique per each licensed player or used commonly by multiple licensed players . During runtime a licensed player reads the MKB from the optical disc and uses the Device Keys to process the MKB at block to calculate the Media Key . Note that some types of licensed players use Key Conversion Data KCD that is provided by the licensed replicator and stored on the optical disc as shown. In these cases the result of the MKB processing is a Media Key Precursor . To obtain the actual Media Key the Media Key Precursor is processed with the KCD using the following 1 where Kis the Media Key Kis the Media Key Precursor and the function AES G is the well known AES based One Way Function. The Media Key Precursor processing is shown at block in If the Device Keys have not been revoked then the calculated Media Key will be the same as used by the licensed replicator . The licensed player then calculates a cryptographic hash of the calculated Media Key Volume Identifier and usage rules as indicated by blocks and . The resulting hash value is used to decrypt as indicated by block the Title Key . The resulting Title Key is used to decrypt the encrypted titles so that the titles making up the prerecorded media content may be rendered by the licensed player in an authorized manner under AACS.

The present arrangement for media key transform obfuscation uses the existing AACS methodology described above to encrypt for the first title i.e. root title for a particular piece of media content. At the licensed player the Media Key is calculated normally and utilized to decrypt the first title. The Media key is then transformed using a programmatically generated constant called a Soft Key Conversion Data or SKCD The programmatically generated SKCD value is further protected by a random value or nonce that is XORed i.e. through application of the logical exclusive or function to the SKCD value. This can provide additional protection for example against simple bus sniffing on the licensed player by a hacker seeking to identify the Media Key.

As shown in the application layer supports procedural code that is arranged to invoke several methods that are exposed through an API application programming interface that provides the interface to the security layer . In this illustrative example procedural code is associated with the first title in a piece of media content on the optical disc so that it loads and runs once a DVD session is underway.

The API methods include setSKCD SKCD which enables the programmatically generated SKCD constant value to be passed to the security layer . The SKCD constant value is processed by application of the XOR logical function to a random nonce. The nonce is generated by the security layer through the second method exposed by the API getSKCDNonce . While the media keys both the conventional AACS Media Key K and its present derivation K may be manipulated through procedural code code utilization of the API ensures that neither media key is ever directly exposed to the code or known by the code. This prevents the media keys from being compromised through operation of any kind of malicious code that may be running in the application layer .

The security layer applies a transformation to the Media Key K calculated as described in the text accompanying by using AES G One Way function to thereby derive a modified media key called a Soft Media Key K Nonce 2 

Thus as illustratively shown in the first title is protected and decrypted conventionally with the Media Key K. The Media Key Kis transformed to Kand the transformed media key is applied to the subsequent second title . It is then transformed again to Kand applied to the subsequent third title . However it is emphasized that the particular number of transformations utilized can vary. For example as shown in the SKCD constant may be updated so that the media key is transformed and applied to each subsequent title on a title by title basis up to the total number of titles N on the optical disc .

Alternatively instead of transforming and applying the media key on a title by title basis the key may be applied to more than one subsequent title i.e. to a group of titles at a time before being transformed again and applied to the next subsequent title or group of titles. shows for example a third illustrative decryption sequence that a content owner e.g. content owner in may optionally utilize in alternative implementations. In this example the first title is protected and decrypted conventionally with the Media Key K. The Media Key Kis transformed to a Soft Media Key Kand the transformed key is applied to each of the titles in a group comprising the subsequent second and third titles and the . The media key is transformed to Kand the transformed media key is applied singly to the next subsequent title . The next transformed media key Kis applied to each of the titles in a group of titles comprising the subsequent fifth and sixth titles and respectively. Then Kis applied singly to Ntitle . It is noted that the sequence shown in is merely illustrative and the particular size of the title groups and pattern by which the different transformed media keys are applied can vary to meet the requirements of specific scenarios.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

