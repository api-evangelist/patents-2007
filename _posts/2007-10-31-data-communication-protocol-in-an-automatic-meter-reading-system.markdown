---

title: Data communication protocol in an automatic meter reading system
abstract: Automatic meter reading (AMR) systems and methods in which readers communicate with endpoints interfaced to utility meters. In operation, the reader and the endpoint communicate with one another via radio frequency (RF) communication according to a communication protocol. Aspects of the invention are directed to packetization, command and control, and messaging arrangements.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08164479&OS=08164479&RS=08164479
owner: Itron, Inc.
number: 08164479
owner_city: Liberty Lake
owner_country: US
publication_date: 20071031
---
The present Application is a Divisional of U.S. patent application Ser. No. 10 915 706 filed Aug. 10 2004 now U.S. Pat. No. 7 336 200 and entitled DATA COMMUNICATION PROTOCOL IN AN AUTOMATIC METER READING SYSTEM which claims priority to U.S. Provisional Patent Application No. 60 500 550 filed on Sep. 5 2003 and entitled DATA COMMUNICATION PROTOCOL IN AN AUTOMATIC METER READING SYSTEM each of which is incorporated by reference herein in its entirety.

This application is related to commonly assigned U.S. Provisional Application No. 60 500 507 filed on Sep. 5 2003 entitled SYSTEM AND METHOD FOR DETECTION OF SPECIFIC ON AIR DATA RATE U.S. Provisional Application No. 60 500 515 filed Sep. 5 2003 entitled SYSTEM AND METHOD FOR MOBILE DEMAND RESET U.S. Provisional Application No. 60 500 504 filed Sep. 5 2003 entitled SYSTEM AND METHOD FOR OPTIMIZING CONTIGUOUS CHANNEL OPERATION WITH CELLULAR REUSE U.S. Provisional Application No. 60 500 479 filed Sep. 5 2003 entitled SYNCHRONOUS DATA RECOVERY SYSTEM U.S. Provisional Application No. 60 500 550 filed Sep. 5 2003 entitled DATA COMMUNICATION PROTOCOL IN AN AUTOMATIC METER READING SYSTEM U.S. patent application Ser. No. 10 655 760 filed on Sep. 5 2003 entitled SYNCHRONIZING AND CONTROLLING SOFTWARE DOWNLOADS SUCH AS FOR COMPONENTS OF A UTILITY METER READING SYSTEM and U.S. patent application Ser. No. 10 655 759 filed on Sep. 5 2003 entitled FIELD DATA COLLECTION AND PROCESSING SYSTEM SUCH AS FOR ELECTRIC GAS AND WATER UTILITY DATA each of which is incorporated by reference herein in its entirety.

The present invention relates to automatic meter reading systems and more particularly to the communication protocol used for communications between endpoints and readers of the automatic meter reading system.

Current automatic meter reading AMR systems are significantly limited in the information that can be obtained from the meter. Generally the AMR system comprises a reader and an endpoint that is interfaced to a meter. In a typical system the endpoint obtains the consumption reading from the meter and then bubbles up every few seconds to send that consumption reading via RF signal to the reader. Alternatively the endpoint receives a wake up tone from the reader that prompts the endpoint to send the consumption reading to the reader.

All that is obtained from this configuration is a single consumption reading from the meter and that reading is based on what meter register the endpoint was programmed with initially at the factory.

As such there is a need for an AMR system that enables the user of the system to have more access to and more control over the information that the meter and endpoint can provide.

One aspect of the invention is directed to an automatic meter reading AMR system that includes a reader and an endpoint interfaced to a utility meter. In operation the reader and the endpoint communicate with one another via radio frequency RF communication according to a communication protocol. The communication protocol includes a transport layer that provides slot assignments timing and packetization for all data transferred between the reader and the endpoint. The packetization defines packets to include the following fields a preamble field a preface following the preamble field that includes at least a message type field an endpoint type field following the message type field a message field following the endpoint type field and a validation field.

In an AMR system comprising a reader and an endpoint interfaced to a utility meter according to another aspect of the invention in operation the reader transmits a command and control frame to the endpoint via radio frequency RF communication. The command and control frame includes a system ID that indicates a specific AMR system with which the endpoint is associated a frame ID that indicates a position in a wake up sequence of the reader and a cell ID that indicates at least one subset of the specific AMR system.

In a further aspect of the invention a RF communication sent by an AMR system reader to an endpoint occurs through the use of at least one packet that includes a message type field and a message field. The message type field indicates a command type of a first command to be carried out that is selected from a predetermined set of commands. The message field indicates specific data associated with the first command.

According to another aspect of the invention in an AMR system comprising a reader and an endpoint interfaced to a utility meter the endpoint and reader communicate with one another via a RF communication. The RF communication occurs through the use of at least one packet that includes a message type field and a message content field that is distinct from the message type field. The message type field indicates a message type indicator of a first message to be conveyed that is selected from a predetermined set of messages and wherein the message content field indicates specific data associated with the first message.

Another aspect of the invention is directed to a method of communicating between the endpoint and the reader. At least one of the reader and the endpoint transmits a packetized RF communication that includes a first packet. In the first packet a message type field and a message content field that is distinct from the message type field are provided. In the message type field a message type is indicated for a first message to be conveyed that is selected from a predetermined set of messages. In the message content field specific data associated with the first message is indicated.

The present invention is a data communication protocol for automatic meter reading AMR systems. The protocol is designed to be flexible and expandable enabling both one way and two way meter reading in both fixed and mobile meter reading systems.

In an AMR system as depicted in that is utilized with the present invention the components generally include a plurality of telemetry devices including but not limited to electric meters gas meters and water meters . Each of the meters may be either electrically or battery powered. The system further includes a plurality of endpoints wherein each corresponds and interfaces to a meter. Each of the endpoints preferably incorporates a radio receiver transmitter e.g. the Itron Inc. ERT. The system additionally includes one or more readers that may be fixed or mobile depicts 1 a mobile hand held reader such as that used in the Itron Off site meter reading system 2 a mobile vehicle equipped reader such as that used in the Itron Mobile AMR system 3 a fixed radio communication network such as the Itron Fixed Network AMR system that utilizes the additional components of cell central control units CCUs and network control nodes NCNs and 4 a fixed micro network system such as the Itron MicroNetwork AMR system that utilizes both radio communication through concentrators and telephone communications through PSTN. Of course other types of readers may be used without departing from the spirit or scope of the invention. Further included in AMR system is a head end host processor . The host processor incorporates software that manages the collection of metering data and facilitates the transfer of that data to a utility or supplier billing system .

The AMR system and the data protocol is usable in both one way meter reading and in two way meter reading. The one way meter reading system enables the reader to listen to messages sent asynchronously from the endpoint while the two way meter reading system enables the reader to communicate with and command the endpoint while also enabling the endpoint to respond to the reader.

The present communication protocol will be described with reference to the 1430 MHz band that may be utilized within North America however it should be understood that any other radio frequency band may be used as suitable without departing from the spirit or scope of the invention. The present communication protocol will also be described with reference to the Open Systems Interconnection OSI protocol stack of the International Standards Organization which includes 1 the physical layer 2 the data link layer 3 the network layer 4 the transport layer 5 the session layer 6 the presentation layer and 7 the application layer.

The physical layer describes the physical characteristics of the communication. This layer conveys the bit stream through the network at the electrical and mechanical level. It provides the hardware means of sending and receiving data on a carrier. The physical layer specifications for the reader may be found in wherein 1 the operational modes 2 the frequency band 3 the channel bandwidth 4 the modulation scheme 5 the deviation 6 the encoding 7 the bit rate 8 the frequency stability 9 the minimum reception sensitivity 10 the transmission power 11 the preamble length and 12 the transmission modes are provided.

The physical layer specification for the endpoint in a two way AMR system at a first data rate and a second data rate are found in the tables of and respectively. The specifications provided include 1 the operational modes 2 the frequency band 3 the channel bandwidth 4 the modulation scheme 5 the deviation 6 the encoding 7 the bit rate 8 the frequency stability 9 the minimum reception sensitivity 10 the minimum preamble length and 11 the factory default frequency. The physical layer specification for the endpoint in a one way AMR system is provided similarly in the table of . However it should be understood that any other physical layer specifications may be used as suitable without departing from the spirit or scope of the invention.

The data link layer specifies how packets are transported over the physical layer including the framing i.e. the bit patterns that mark the start and end of packets. This layer provides synchronization for the physical level. It furnishes transmission protocol knowledge and management. In the present data communication protocol all outbound data transmissions i.e. all communications from the reader s central radio to endpoint are Manchester encoded with the guaranteed transition mid bit and each data bit encoded as aa bar . See for the Manchester Encoding Structure . Inbound transmissions from the endpoint are either transmitted as Manchester encoded data identical to outbound transmissions or are transmitted as NRZ non return to zero data. Selection is based on the value of the MCH flag in the command and control frame.

The data link layer provides a countdown timer. The countdown timer uses Sequence Inversion Keying to represent timer bits. Each system is assigned a 10 bit pseudo noise PN sequence for valid sequences see Table 1 below . That sequence in the data stream represents a timer bit value 0 and the inverse of that sequence in the data stream represents a timer bit value 1. Timer values are composed of 10 timer bits or 100 data bits. The countdown timer begins at 1023 or 1111111111 binary and counts sequentially to zero encoding all timer bits as either the system PN sequence or its inverse. The total counter time in seconds is 102400 r where r is the bit rate in bits per second. provides an example of a Sequence Inversion Keyed Countdown Timer.

The network layer specifies how packets get from the source network to the destination network. This layer handles the routing of the data sending it in the right direction to the right destination on outgoing transmissions and receiving incoming transmissions at the packet level . The network layer does routing and forwarding. In the present data communication protocol the network layer functionality is only implemented in electric endpoints i.e. it is not used for battery powered endpoints or in any endpoint that acts as translator or repeater. This layer controls the hopping functions that need to occur between a reader and any endpoint in order to transfer data. This hopping protocol is currently used within the Itron AMR systems and is therefore not described in detail herein.

The transport layer is used to solve problems like reliability did the data reach the destination and ensure that data arrives in the correct order. This layer manages the end to end control for example determining whether all packets have arrived and error checking. It ensures complete data transfer. In the present data communication protocol slotting control is handled in the transport layer. This includes slot assignments timing and any necessary packetization. details the packet structure. The message message type and flags are received from the presentation layer and broken into appropriately sized packets. Each packet is prefaced with the endpoint ID flags message type endpoint type and packet length. The packet length reflects the number of bytes in the message itself exclusive of header information. In the case where more than 254 bytes are required in a packet the value of the length field is set to 0xFF and the actual length of the message structure is placed in bytes high byte and low byte with the message bytes to follow. All packets must have a whole number of bytes in the message.

The packet number byte when used as part of the message is configured as below in Table 2 wherein the first four bits comprise the total number of packets in this message and the last four bits comprise the packet number.

The flags byte is configured as below in Table 3. The first two bits are reserved while the second two bits provides the encoder number for multi encoder units wherein 00 encoder 01 encoder 10 encoder and 11 encoder . The fifth bit signifies the status of a pending event wherein 0 no pending event and 1 a pending event. The sixth bit comprises the security bit wherein 0 security disabled and 1 security enable. The seventh bit comprises the relay bit wherein 0 message from originating endpoint and 1 message via relay. The eighth bit comprises the resend bit wherein 0 first attempt at packet transmission and 1 resend attempt.

Some endpoints in the system have the option of sending out an infrequent several times a day fixed format message at a higher power level for use in 1 way fixed network applications. The message has its own structure as defined in . The custom packet is then BCH 255 139 15 encoded prior to transmission. The encoding polynomial is 0x461407132060175561570722730247453567445. For multi encoder endpoints this packet is generated and sent for each individual encoder. The flags for the high power pulse data packet structure are configured as shown in Table 4 below. The first four bits are reserved while the fifth and sixth bits provide the encoder number wherein 00 encoder 01 encoder 10 encoder and 11 encoder . The seventh bit comprises the relay bit wherein 0 message from originating endpoint and 1 message via relay. The eighth bit comprises the error code indicating that a critical endpoint error has occurred.

The session layer sets up coordinates and terminates conversations exchanges and dialogs between the applications at each end. It deals with session and connection coordination. In the present data communication protocol the session layer generally comprises the command and control frame that is sent from the reader to the endpoint.

The command and control frame is used to issue command to two way endpoints either individually or in groups. It also serves to realign the endpoint real time clock. diagrams the two way communication command and control frame. As shown the command and control frame transmission is preceded by a 24 bit preamble as indicated by the three P fields within the frame. The first 16 bits are preferably an alternating pattern AAAAh and are used for clock recovery. The last 8 bits are used for frame and timing synchronization.

Field 0 of the command and control frame comprises the system identification ID . Each system is issued an 8 bit ID value which is stored in the endpoint to distinguish different systems within geographic proximity. The endpoints are designed to respond to commands from their own system or to commands that address them specifically by ID number proper security password and have a 0x00 in field 0 . The system ID functions nearly identically to the cell ID described below. However the system ID is universal while the cell ID is local i.e. a single system will have multiple cells each having the same system ID but a different cell ID.

Field 1 of the command control frame comprises the frame ID. Each reader within the system is assigned a frame ID to use based on its position in the wake up sequence. The position in the wakeup sequence is directly related to the frequency reuse pattern that is used in a given system. Table 1 described earlier correlates the frame ID to the channel which is correlated to the cell reuse ratio.

Field 2 of the command and control frame comprises the cell ID. Each cell is issued an 8 bit ID value which is stored in the endpoint to distinguish different systems within geographic proximity.

Fields 3 through 6 of the command and control frame is the RTC which is defined as UTC time coordinated universal time which is a 32 bit value representing the number of seconds since midnight 00 00 00 on Jan. 1 1970 GMT.

Field 7 is the command flags field wherein the first three bits define a slot length according to Table 5.

Field 8 of the command and control frame is the command flags field wherein the first four bits are reserved. The fifth and sixth bits defined the encoder number wherein 00 Encoder 01 Encoder 10 Encoder and 11 Encoder . The final seventh and eighth bits define the transmit mode wherein 00 transmit mode e.g. mobile response required 01 transmit mode e.g. fixed network response required and 10 11 are reserved. Also see section V below.

Field 9 of the command and control frame comprises the slot offset. Slot offset defines the number of slots between packets in multi packet messages. For example if the endpoint has an initial slot number of 50 and the slot offset is 120 a three packet message would be transmitted in slots and .

Fields 10 and 11 of the command and control frame define the first unsolicited message. Specifically they define the slot number where the unsolicited messages UMs are to begin. Any UMs generated during the cell read would be reported in a pseudo randomly selected slot after the slot defined here. If the value of this field is 0x0000 no UMs are sent from the endpoint.

Fields 12 through 15 of the command and control frame provide the endpoint IDs for those endpoints that the reader is desiring to communicate with.

Fields 16 and 17 are the security fields and are described further in relation to the presentation layer.

Field 18 defines the command set. The commands are divided into two groups 1 universal and 2 type specific. Universal commands are numbered 0 63 and are applicable to all the system endpoints. Type specific commands are numbered 64 255 and vary depending on the lower nibble of the command set field in accordance with Table 6 below.

Fields 19 through 21 of the command and control frame define the command and command body. Specifically the eight command bits of field 19 indicate the command type wherein the numbers 0 63 are universal commands and 64 255 are the type specific commands. Fields 20 and 21 provide sixteen bits wherein any data needed to carry out the command type is provided. The tables in indicate the command types and command bodies that are possible with the system of the present invention. Referring to the universal commands it can be seen that the present system is capable of but not limited to 1 reporting a status 2 changing a system number to a new system number 3 changing a group number to a new group number 4 changing a system slot number to a new system slot number 5 changing the cell ID to a new cell ID 6 reporting slot numbers 7 resending identified packets of data 8 setting the receiver bubble up period 9 setting the bubble up channel 10 setting the bubble up time 11 configuring the transmission power 12 setting the channel frequency etc.

Referring to the type specific commands numerous other commands are available including but not limited to 1 reporting consumption data 2 reporting time of use TOU data 3 reporting logged data 4 reporting temperature 5 reporting tamper data 6 setting configuration flags 7 initializing consumption 8 reporting an event summary 9 performing an endpoint diagnostic check 10 reporting memory contents etc.

Fields 22 and 23 of the command and control frame designate the response frequency for the endpoint. The response frequency is configured as 16 bit flags identifying valid response frequencies for the endpoint. For example if the response frequency has a value of 0x00C1 bits and are set the endpoint may respond on channel channel or channel .

Field 25 indicates the length of the extended control frame in bytes. A value of 0 indicates that no extended frame is present.

Fields 26 and 27 of the command and control frame provides the cyclic redundancy check CRC . Specifically fields 26 and 27 provide a 16 bit CRC. The CRC is preferably a polynomial defined as 0x1021. The CRC initialization value is 0x0000. CRC processing is performed most significant bit MSB first and the final checksum is not inverted.

For simplicity one way devices may opt to use the programming frame shown in . The command and command body bytes are similar to that described above with reference to the two way devices. The byte for number of commands provides the total number of commands to follow in this frame with a maximum value of 8. The command flags are diagrammed in Table 7 below. The first two bits indicate the transmit mode wherein 00 transmit mode 01 transmit mode and 10 11 are reserved. The third bit designates the data logging wherein 0 data logging is disabled and 1 data logging is enabled. The fourth bit designates the forward error correction wherein 0 disable forward error correction on response and 1 enable forward error correction on response. The fifth and sixth bits designate the mode set wherein 00 stock mode 01 test mode 10 reserved mode and 11 normal mode. The seventh and eighth bits are reserved.

Certain of the commands provided in the command and control frame are described in detail below. For instance Command which is the set channel frequency. Each of the system endpoints support up to 16 channels which are set individually. They may or may not be contiguous channels. The channel numbering differs based on frequency band. For example in the present implementation of the invention the 1427 1432 MHz band is divided into 6.25 kHz frequency channels with frequency channel centered at 1427.000 MHz frequency channel centered at 1427.00625 MHz etc. If endpoint channel is programmed to a value of 480 that endpoint receiver will always operate at 1427.000 0.00625 480 1430.000 MHz. This may be extended to other frequency bands. For example the 433 435 MHz band is divided into 25 KHz frequency channels with the frequency channel centered at 433.000 MHz frequency channel centered at 433.025 MHz and so on.

The configuration flag commands i.e. commands and are used for setting individual flags in the endpoints. Each flag command includes an 8 bit flag mask and an 8 bit flag as shown below the configuration flags command body 

The present data communication protocol provides at least two commands for use in system testing and analysis. The first command is command i.e. Generate UM unsolicited message . This command automatically generates an unsolicited message in all endpoints addressed by the command and control frame. It generates the lowest numbered UM supported by the endpoint. The second command is command i.e. Enter Screaming Viking Mode. Screaming Viking Mode is a constant transmission mode to be used for test only. When this command is received the endpoint repetitively transmits its ID for the number of minutes declared in the command. If a value of 0 is sent the mode is active for 15 seconds.

Commands and of the data communication protocol are implemented as extensions to the command and control frame. The extension commands immediately follow the command and control frame in the same transmit session. Command is the multiple ungrouped endpoint command. In the case where the system needs to command a group of specific endpoints and vector them to specific slots command is issued. The central radio then issues commands to these endpoints as shown in . This command can be used to address a maximum of 16 distinct endpoints. The packet length reflects the number of endpoints addressed by the message. Note that the command may not be used for any command that requires the security password. The structure of command provides for an 8 byte preamble having the value of 0xAAAA AAAA AAAA AA96 the length the endpoint IDs and the command bodies for each of the endpoints and a response byte for each of the endpoints. The response byte is diagrammed in Table 12 below 

Command i.e. the vector and listen frame is issued in the instance where the central radio or reader need to download an arbitrary block of data to the endpoint. The endpoint upon receiving this command receives a data frame as defined in . This command is valid only when the endpoints are individually addressed i.e. TGT 11 . The data is endpoint type specific. Note that the vector and listen frame has an 8 byte preamble with a value of 0xAAAA AAAA AAAA AA96. Further note that the packet length reflects the number of bytes in the message itself exclusive of header information and that the CRCs computed over all bytes in the message body.

Command the multiple command to individual endpoint command is used in the case where the central radio or reader need to download a series of commands to one specific endpoint. The endpoint upon receiving this command receives a data frame as defined in . This command is only valid when the endpoints are individually addressed i.e. TGT 11 . Up to 24 commands may be issued to an endpoint using this structure. Note that the packet length reflects the number of commands to be issued within this structure.

Command the Extended Frame Mobile Read command uses the multiple ungrouped endpoint command structure with a Slotted ALOHA period between the extended frame and the queried response slots. All endpoints which recognize the command respond. If the endpoint is among those addressed by the extended frame it responds as commanded being offset by 16 slots. If the endpoint is not specifically addressed it responds in the Slotted ALOHA section with its programmed default message.

The presentation layer which is usually part of an operating system converts incoming and outgoing data from one presentation format to another and it is sometimes called the syntax layer. In the present data communication protocol the presentation layer handles data security and any necessary data compression and decompression.

The data security is preferably a simple two level protocol which may be enabled or disabled by the customer. Level 1 provides simple encryption for the transfer of normal data while level 2 provides write security to the endpoint to prevent unauthorized users from changing endpoint parameters.

Level 1 is intended for use on ordinary data being transmitted from the endpoint to the head end. All data is encrypted with a simple 8 bit XOR mask. The level 1 security enables flag and encryption mask and are editable by a level 2 parameter write. The factory default for the XOR mask is the bottom 8 bits of the serial number. Level 1 security is applied only to the message itself and not to the EPID flags or message type. Level 1 security may be disabled by setting the mask value to 0.

Level 2 security is intended for use on any head end commands to change endpoint parameters. It includes modification of operational security and reprogramming parameters. Level 2 functionality is independent and can be applied with or without Level 1 functions enabled. Each endpoint has a 16 bit password. This password is originally defined at install and can be edited by a valid Level 2 command. Any write command must include the current password to be considered valid by the endpoint. For added security the Level 1 encryption mask may be applied to the password if Level 1 functionality is active. There is no compression performed on packet data.

The application layer is the layer at which communication partners are identified quality of service is identified user authentication and privacy are considered and any constraints on data syntax are identified. This layer is not the application itself although some applications may perform application layer functions. In the present data communication protocol an endpoint application layer is used in conjunction with the application programming interface API . When data is requested by the presentation layer via the API the application layer performs its processing and returns the requested message as a single block along with one 8 bit value. The value represents the message type.

The two way AMR system of the present invention at 1430 MHz is designed to operate most efficiently in five contiguous RF channels. This allows the use of a cheaper wider receiver section in the endpoint while still maintaining the FCC mandated 50 KHz maximum transmit spectrum. The transmit spectrum in all devices endpoints and readers must maintain a 50 KHz or less occupied bandwidth during transmit. The receiver in the reader must also have a good selectivity on the channel of interest. The endpoint receiver is allowed to accept a wider receive bandwidth primarily to reduce the cost of the endpoint.

Refer to to observe the 250 KHz of spectrum allocated to the system. As shown the spectrum is divided in to five 50 KHz channels. The center channel i.e. channel is designated as the control channel for the system . All endpoints listen on this channel. As such if the readers are quasi synchronized in their outbound transmissions the center channel approach allows the endpoints to use a wider receive bandwidth while avoiding the interference that would normally be a problem synchronization is described in further detail below . The diagram of illustrates the bandwidth differences graphically. Since the reader has good selectivity the endpoints can respond on a different channel in each cell simultaneously allowing the maximum data throughput in the system cell re use is described in further detail below .

By utilizing an appropriate RF ASIC the architecture can be reduced to three contiguous channels with the reaming two or more channels scattered throughout the band to ease spectrum allocation requirements. With a reduction in the interference protection to the end point a completely separated channel model could be used in an alternative configuration. However in the separate channel model the endpoint requires additional base band filtering and is still slightly more susceptible to adjacent channel interference on the control channel especially if operating in the high power portion of the band. The separate channel option also allows multiple control channels in the system when mobile operation is used with multiple outbound channels. When using the separate channel model channels and of a 5 channel block are used for control signals.

To alleviate cell to cell interference in a system with a single control channel the readers must be synchronized in time so that the control frames which are described in further detail below do not overlap. The addition of dead time in between sequential control frames allow for the receivers to be quasi synchronized instead of in perfect lock step. In the preferred embodiment quasi synchronized means that the receivers are within 0.5 seconds of each other which can easily by achieved via protocols such as NTP network time protocol . Other quasi synchronization times may be used without departing from the spirit or scope of the invention. As such a GPS or other high accuracy time base is not required within the readers.

Within the AMR system each reader is assigned a frame ID to use based on its position in a wakeup sequence. The position in the wakeup sequence is directly related to the frequency reuse pattern used in a given system. The timings in the diagram of are provided as an example of a staged wakeup sequence for three cell reuse. As shown the timings are for an endpoint to endpoint clock accuracy of 0.5 seconds if the value obtainable is only 1 second then the dead time must be increased to 5 and the nominal frame time to 22.5 seconds. All other timings remain the same. If GPS is available in the reader the dead time can be reduced and the time frame timing can be shortened. In any case the minimum dead time is preferably 0.5 seconds.

As shown in the first wake up sequence is initiated at time T 0. For the first 18.5 seconds get wakeup SIK countdown timer next 0.25 seconds command and control frame and last 2.5 second is dead time. The remaining time in the timeline is the hold off time for response slots which is the frame number the nominal frame time or 2 20 40 seconds of hold off time. At T 20 the second wake up sequence is initiated. Similarly the first 18.5 seconds get wakeup SIK countdown timer next 0.25 seconds command and control frame and the last 2.5 seconds is dead time. The hold off time for response slots in this instance is again the frame number the nominal frame time which is 1 20 20 seconds off hold off time. At T 40 the third wake up sequence is initiated. For the first 18.5 seconds get wakeup SIK countdown time the next 0.25 seconds command and control frame and the last 2.5 seconds is dead time. The hold off time for response is calculated as follows frame number nominal frame time or 0 20 0 seconds hold off time meaning the endpoints have 2.5 seconds before the beginning of slot in this cell.

As mentioned the example of is for a three cell reuse pattern. However the example can be easily extended to higher cellular reuse ratios by adding more frames as appropriate. In the 1430 MHz system the maximum recommended cellular reuse is 5. This leads to a hold off time of 100 seconds in the first cell transmitted which is short enough for the endpoint to maintain accurate timing with regard to slot timings.

Unless otherwise specified by the system the frame ID is preferably tied to the cellular frequency used based on Table 13 below 

To maximize throughput in the system a cellular reuse scheme is employed in the 1430 MHz band. The reuse ratio is preferably a 3 4 5 7 or 9 cell pattern. Smaller patterns are preferred from a delay perspective however the final choice is preferably made during the RF planning and installation of actual systems in the field. The 7 and 9 patterns are preferably used in the virtual cell model. The reuse patterns are provided in and depicting three cell ABC four cell ABCD and five cell reuse patterns ABCDE respectively.

When operating in the mobile or hand held mode the 2.5 seconds of dead time does not apply. Rather slot 0 occurs at the end of the command and control frame plus 25 milliseconds. Note that due to time required to read the attached meter and or bring the charge pump to full operation the endpoint may or may not respond in slot 0 even if told to respond immediately.

In programming mode the hand held control may reduce its sensitivity by as much as 30 dB to avoid overload conditions at close programming distances. The hand held and endpoint must work with programming distances as close as 0.5 meters and as far as 300 meters when in the mobile mode of operation with a line of site propagation path.

In mobile operation the wake up sequence the command control data and the receive portions of a standard read cycle are continuously repeated as the mobile moves through the system. The timing is preferably in the range of a one to five second cycle. The diagram depicted in gives a general over view of the mobile operation over the five channels.

The command control frame preferably contains a group call read that solicits a consumptive type reading from all of the endpoints that can hear the mobile and that have the correct system ID. The endpoint responds to the group call in a random slot on a random channel. The random channel is chosen from the list of available channels that is provided in the command control frame. The random slot is one of the 50 ms slots in the Slotted ALOHA portion of the frame. Slotted ALOHA is a random access scheme just like regular ALOHA except that the transmissions are required to begin and end within the predefined timeslot. The timeslots are marked from the end of the command control frame just like in the fixed network .

When the reader hears a response from a given endpoint it knows that it is within range and can request a specific response from the endpoint in the next command control frame. The command control frame is expected to contain both a standard command frame and an extended control frame to allow for the mobile to access the most endpoints possible in a single pass. When the mobile requests a response from the end point it will tell it the channel and time slot that it is supposed to respond on. This is to minimize the chances of a collision on the longer messages that can be delivered in the MDP type of responses. During the mobile cycle battery endpoints may be required to bubble up their receivers up at a higher rate than normal or synchronize to the first command control frame to improve mobile performance.

If the van is moving at a maximum of 30 miles per hour it will travel 440 feet in 10 seconds. The van will also have a communications radius of approximately 500 feet give a 1400 MHz system operating at a data rate of 22.6 Kchips second with the expected power levels and receiver sensitivities e.g. 14 dBm endpoint TX power 110 dBM RX sensitivity in the van 20 dB margin endpoint at 5 . The margin is included because the MDP data packet is much longer than the current SCM type messages and is not repeated unless an error occurs. To achieve a low re try rate it is desirable to bring the BER down to 0.01 . To do this under normal situations would require an additional 20 dB of margin however a diversity setup on the van receivers can be used to achieve the same results. This requires two antennas on the van placed five to six feet apart along with an additional receiver demodulator chain per channel. For SCM data that is repeated multiple times the system can operate at a much lower margin and still achieve excellent read reliability in the van. A coverage radius of about 1200 feet is obtained for the system when collecting standard consumptive data.

The diagram of shows the coverage rings for low margin SCM messages and for the 20 dB margin IDR messages for the present system in comparison with the current 0 dB margin SCM messages from the ERT.

With the current mobile protocol each endpoint is on average in the range of the van for approximately 12 to 25 seconds. This is an appropriate amount of time to wake up the endpoint identify who it is request an MDP mobile data packet 250 bytes of raw data maximum to be sent receive the MDP and potentially retry the request and receive portions of the process if necessary.

In the basic system there are five channels at a maximum 75 utilization for MDP responses. This gives an effective data rate of 42375 BPS or 5296 bytes per second or 21 blocks per second. Since the system is looking at a single block per meter the system can support 21 new meters per second. The mobile then has a nominal range of 500 feet. This gives the system of about 175 meters in range at any given time even in the densest specified systems. If the van is moving at 30 mph the system gets 44 feet of new meters per second. In performing a geometric approximation the result is about 12 new meters per second. So the system can handle new meters per second but can only get in the range of 10 to 12 meters per second. This allows for a full set of retries in a dense system. This assumes the low 11.36363 KBPS data rate and the full 250 byte MDP for smaller packets and with the higher data rate option the situation is even better.

In order to optimize the batter efficiency range and overall system robustness for endpoints that must operate in both a mobile and fixed network scenario without reprogramming the following methodology is preferably used. The outbound transmission from the reader includes a flag that states the response mode of the endpoint. When the response mode flag is set to mobile the endpoint responds at a lower power e.g. 14 dBm and in a dynamically randomized slot determined as described above. When the endpoint sees the fixed network flag set it responds in its assigned slot at high power e.g. 30 dBm . The advantage provided by this scenario is that in the mobile case the reader is not burdened with slot dynamic allocation of multiple which can be computationally intensive and consume additional air time to successfully communicate to all the in range endpoints. It also allows the endpoint to conserver power and reduce interference. This leads to the ability to transmit more data with less retries. In the fixed network case the high power mode enables the system to get maximum range from the device reducing infrastructure costs while interference is mitigated by assigned slots. The slots are efficiently assigned in the fixed network case because of the pseudo static nature of the system. Note that prior art systems enabled only static programming of the endpoint to operate in one mode or the other. As such the previous methodology did not allow for mixed mode operation without reprogramming the endpoint. Thus the present invention presents the combination of low power operation and dynamic slot assignment for mobile operation with the high power slotted operation for the fixed network all controlled by a flag in the outbound wakeup data. Refer to field 8 bits and of the command control frame that define the transmit response mode.

The present invention may be embodied in other specific forms without departing from the spirit of the essential attributes thereof therefore the illustrated embodiment should be considered in all respects as illustrative and not restrictive reference being made to the appended claims rather than to the foregoing description to indicate the scope of the invention.

