---

title: Multiplexing and transmission of multiple data streams in a wireless multi-carrier communication system
abstract: Techniques for multiplexing and transmitting multiple data streams are described. Transmission of the multiple data streams occurs in “super-frames”. Each super-frame has a predetermined time duration and is further divided into multiple (e.g., four) frames. Each data block for each data stream is outer encoded to generate a corresponding code block. Each code block is partitioned into multiple subblocks, and each data packet in each code block is inner encoded and modulated to generate modulation symbols for the packet. The multiple subblocks for each code block are transmitted in the multiple frames of the same super-frame, one subblock per frame. Each data stream is allocated a number of transmission units in each super-frame and is assigned specific transmission units to achieve efficient packing. A wireless device can select and receive individual data streams.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08509051&OS=08509051&RS=08509051
owner: QUALCOMM Incorporated
number: 08509051
owner_city: San Diego
owner_country: US
publication_date: 20071031
---
The present Application for patent claims priority to Provisional Application No. 60 951 950 entitled MULTIPLEXING AND TRANSMISSION OF MULTIPLE DATA STREAMS IN A WIRELESS MULTI CARRIER COMMUNICATION SYSTEM filed Jul. 25 2007 and assigned to the assignee hereof and hereby expressly incorporated by reference herein.

The present Application for patent is a continuation in part of patent application Ser. No. 11 751 631 entitled MULTIPLEXING AND TRANSMISSION OF MULTIPLE DATA STREAMS IN A WIRELESS MULTI CARRIER COMMUNICATION SYSTEM filed May 21 2007 pending which is a continuation of patent application Ser. No. 10 932 586 entitled MULTIPLEXING AND TRANSMISSION OF MULTIPLE DATA STREAMS IN A WIRELESS MULTI CARRIER COMMUNICATION SYSTEM filed Sep. 1 2004 issued as U.S. Pat. No. 7 221 680 which claims priority to Provisional Application No. 60 499 741 entitled METHOD FOR MULTIPLEXING AND TRANSMITTING MULTIPLE MULTIMEDIA STREAMS TO MOBILE TERMINALS OVER TERRESTRIAL RADIO LINKS filed Sep. 2 2003 and Provisional Application No. 60 559 740 entitled MULTIPLEXING AND TRANSMISSION OF MULTIPLE DATA STREAMS IN A WIRELESS MULTI CARRIER COMMUNICATION SYSTEM filed Apr. 5 2004 all of which are assigned to the assignee hereof and hereby expressly incorporated by reference herein.

Application Ser. No. 11 834 671 entitled SYSTEMS AND METHODS FOR GENERALIZED SLOT TO INTERLACE MAPPING filed Aug. 6 2007 assigned to the assignee hereof and expressly incorporated by reference herein.

The present disclosure relates generally to communication and more specifically to techniques for multiplexing and transmitting multiple data streams in a wireless multi carrier communication system.

A multi carrier communication system utilizes multiple carriers for data transmission. These multiple carriers may be provided by orthogonal frequency division multiplexing OFDM some other multi carrier modulation techniques or some other construct. OFDM effectively partitions the overall system bandwidth into multiple orthogonal subbands. These subbands are also referred to as tones carriers subcarriers bins and frequency channels. With OFDM each subband is associated with a respective subcarrier that may be modulated with data.

A base station in a multi carrier system may simultaneously transmit multiple data streams for broadcast multicast and or unicast services. A data stream is a stream of data that may be of independent reception interest to a wireless device. A broadcast transmission is sent to all wireless devices within a designated coverage area a multicast transmission is sent to a group of wireless devices and a unicast transmission is sent to a specific wireless device. For example a base station may broadcast a number of data streams for multimedia e.g. television programs via a terrestrial radio link for reception by wireless devices. This system may employ a conventional multiplexing and transmission scheme such as for example Digital Video Broadcasting Terrestrial DVB T or Integrated Services Digital Broadcasting Terrestrial ISDB T . Such a scheme would first multiplex all of the data streams to be transmitted onto a single high rate composite stream and then process e.g. encode modulate and up convert the composite stream to generate a modulated signal for broadcast via the radio link.

A wireless device within the coverage area of the base station may be interested in receiving only one or few specific data streams among the multiple data streams carried by the composite stream. The wireless device would need to process e.g. down convert demodulate and decode a received signal to obtain a high rate decoded data stream and then demultiplex this stream to obtain the one or few specific data streams of interest. This type of processing may not be a problem for receiver units intended to be powered on all the time such as those used in homes. However many wireless devices are portable and powered by internal batteries. Continuous demodulation and decoding of the high rate composite stream to recover just one or few data streams of interest consumes significant amounts of power. This can greatly shorten the ON time for the wireless devices which is undesirable.

There is therefore a need in the art for techniques to transmit multiple data streams in a multi carrier system such that they can be received by wireless devices with minimal power consumption. Furthermore there is a need to efficiently transmit data streams within OFDM systems with various amounts of subbands i.e. FFT sizes thereby providing flexibility for a wide range of radio frequencies and network deployments

Techniques for multiplexing and transmitting multiple data streams in a manner to facilitate power efficient and robust reception of individual data streams by wireless devices are described herein. Each data stream is processed separately based on a coding and modulation scheme e.g. an outer code an inner code and a modulation scheme selected for that stream to generate a corresponding data symbol stream. This allows the data streams to be individually recovered by the wireless devices. Each data stream is also allocated certain amount of resources for transmission of that stream. The allocated resources are given in transmission units on a time frequency plane where each transmission unit corresponds to one subband in one symbol period and may be used to transmit one data symbol. The data symbols for each data stream are mapped directly onto the transmission units allocated to the stream. This allows the wireless devices to recover each data stream independently without having to process the other data streams being transmitted simultaneously.

In an aspect transmission of the multiple data streams occurs in super frames with each super frame having predetermined time duration e.g. on the order of a second or few seconds . Each super frame is further divided into multiple e.g. two four or some other number of frames. For each data stream each data block is processed e.g. outer encoded to generate a corresponding code block. Each code block is partitioned into multiple subblocks and each subblock is further processed e.g. inner encoded and modulated to generate a corresponding subblock of modulation symbols. Each code block is transmitted in one super frame and the multiple subblocks for the code block are transmitted in the multiple frames of the super frame one subblock per frame. The partitioning of each code block into multiple subblocks the transmission of these subblocks over multiple frames and the use of block coding across the subblocks of the code block provide robust reception performance in slowly time varying fading channels.

Each data stream may be allocated a variable number of transmission units in each super frame depending on the stream s payload in the super frame the availability of transmission units in the super frame and possibly other factors. Each data stream is also assigned specific transmission units within each super frame using an assignment scheme that attempts to 1 pack the transmission units for all data streams as efficiently as possible 2 reduce the transmission time for each data stream 3 provide adequate time diversity and 4 minimize the amount of signaling to indicate the specific transmission units assigned to each data stream. Overhead signaling for various parameters of the data streams e.g. the coding and modulation scheme used for each data stream the specific transmission units assigned to each data stream and so on may be transmitted prior to each super frame and may also be embedded within the data payload of each data stream. This allows a wireless device to determine the time frequency location of each desired data stream in the upcoming super frame. The wireless device may power on only when the desired data stream is transmitted using the embedded overhead signaling and thereby minimize power consumption.

In addition aspects of the present disclosure are capable of operation using FFT sizes of for example 1K 2K and 8K to complement the existing 4K FFT size. Different FFT sizes could be used in different RF frequency bands in order to support different cell sizes Doppler frequency requirements. It is noted however that the aforementioned FFT sizes are merely illustrative examples of various OFDM systems and the present disclosure is not limited to only 1K 2K 4K and 8K FFT sizes. It is noted however that the aforementioned FFT sizes are merely illustrative examples of various OFDM systems and the present disclosure is not limited to only 1K 2K 4K and 8K FFT sizes.

The word exemplary is used herein to mean serving as an example instance or illustration. Any aspect or design described herein as exemplary is not necessarily to be construed as preferred or advantageous over other aspects or designs.

The multiplexing and transmission techniques described herein may be used for various wireless multi carrier communication systems. These techniques may also be used for broadcast multicast and unicast services. For clarity these techniques are described for an exemplary multi carrier broadcast system.

Each base station may broadcast multiple data streams simultaneously to wireless devices within its coverage area. These data streams may be for multimedia content such as video audio tele text data video audio clips and so on. For example a single multimedia e.g. television program may be sent in three separate data streams for video audio and data. A single multimedia program may also have multiple audio data streams e.g. for different languages. For simplicity each data stream is sent on a separate physical layer channel PLC . There is thus a one to one relationship between data streams and PLCs. A PLC may also be called a data channel a traffic channel or some other terminology.

The data stream for each PLC is encoded and modulated based on a coding and modulation scheme selected for that PLC. In general a coding and modulation scheme comprises all of the different types of encoding and modulation to be performed on a data stream. For example a coding and modulation scheme may comprise a particular coding scheme and a particular modulation scheme. The coding scheme may comprise error detection coding e.g. a cyclic redundancy check CRC forward error correction coding and so on or a combination thereof. The coding scheme may also indicate a particular code rate of a base code. In an aspect that is described below the data stream for each PLC is encoded with a concatenated code comprised of an outer coder and an inner code and is further modulated based on a modulation scheme. As used herein a mode refers to a combination of an inner code rate and a modulation scheme.

Each data block may be encoded and modulated in various manners. An exemplary concatenated coding scheme is described below. To simplify the allocation and assignment of resources to the PLCs each code block may be divided into four equal sized subblocks that are then transmitted in the same portion or location of the four frames in one super frame. In this case the allocation of a super frame to the PLCs is equivalent to the allocation of a frame to the PLCs. Hence resources can be allocated to the PLCs once every super frame.

Each PLC may be transmitted in a continuous or non continuous manner depending on the nature of the data stream being carried by that PLC. Thus a PLC may or may not be transmitted in any given super frame. For each super frame an active PLC is a PLC that is being transmitted in that super frame. Each active PLC may carry one or multiple data blocks in the super frame.

Referring back to each super frame is preceded by a pilot and overhead section . In an aspect section includes 1 one or more pilot OFDM symbols used by the wireless devices for frame synchronization frequency acquisition timing acquisition channel estimation and so on and 2 one or more overhead OFDM symbols used to carry overhead signaling information for the associated e.g. immediately following super frame. The overhead information indicates for example the specific PLCs being transmitted in the associated super frame the specific portion of the super frame used to send the data block s for each PLC the outer code rate and mode used for each PLC and so on. The overhead OFDM symbol s carries overhead signaling for all PLCs sent in the super frame. The transmission of the pilot and overhead information in a time division multiplexed TDM manner allows the wireless devices to process this section with minimal ON time. In addition overhead information pertaining to each PLC s transmission in the next super frame may be embedded in one of the PLC s transmitted data blocks in the current super frame. The embedded overhead information allows the wireless device to recover the PLC s transmission in the next super frame without having to check the overhead OFDM symbol s sent in that super frame. Thus the wireless devices may initially use the overhead OFDM symbols to determine the time frequency location of each desired data stream and may subsequently power on only during the time that the desired data stream is transmitted using the embedded overhead signaling. These signaling techniques may provide significant savings in power consumption and allow the wireless devices to receive content using standard batteries. Since the outer code rate and mode used for each PLC typically do not vary on a super frame basis the outer code rate and mode may be sent on a separate control channel and do need not be sent in every super frame.

With OFDM one modulation symbol may be sent on each subband in each symbol period i.e. each transmission unit. Of the Ntotal subbands Nsubbands may be used for data transmission and are referred to as data subbands Nsubbands may be used for pilot and are referred to as pilot subbands and the remaining Nsubbands may be used as guard subbands i.e. no data or pilot transmission where N N N N. The number of usable subbands is equal to the number of data and pilot subbands or N N NIn an aspect broadcast system utilizes an OFDM structure having 4096 total subbands N 4096 3500 data subbands N 3500 500 pilot subbands N 500 and 96 guard subbands N 96 . Other OFDM structures with different number of data pilot usable and total subbands may also be used. In each OFDM symbol period Ndata symbols may be sent on the Ndata subbands Npilot symbols may be sent on the Npilot subbands and Nguard symbols are sent on the Nguard subbands. As used herein a data symbol is a modulation symbol for data a pilot symbol is a modulation symbol for pilot and a guard symbol is a signal value of zero. The pilot symbols are known a priori by the wireless devices. The Ndata symbols in each OFDM symbol may be for one or multiple PLCs.

In general any number of PLCs may be transmitted in each super frame. For a given super frame each active PLC may carry one or multiple data blocks. In one aspect a specific mode and a specific outer code rate is used for each active PLC and all data blocks for the PLC are encoded and modulated in accordance with this outer code rate and mode to generate corresponding code blocks and subblocks of modulation symbols respectively. In another aspect each data block may be encoded and modulated in accordance with a specific outer code rate and mode to generate a corresponding code block and subblocks of modulation symbols respectively. In any case each code block contains a specific number of data symbols which is determined by the mode used for that code block.

Each active PLC in a given super frame is allocated a specific amount of resources to transmit that PLC in the super frame. The amount of resources allocated to each active PLC is dependent on 1 the number of code blocks to be sent on the PLC in the super frame 2 the number of data symbols in each code block and 3 the number of code blocks along with the number of data symbols per code block to be sent on other PLCs. Resources may be allocated in various manners. Two exemplary allocation schemes are described below.

If consecutive OFDM symbols are assigned to each active PLC then the burst TDM can minimize the transmission time for the PLCs. However the short transmission time for each PLC also results in less time diversity. Since an entire OFDM symbol is allocated to one PLC the granularity of the resource allocation i.e. the smallest unit that may be allocated to a PLC for each frame is one OFDM symbol. The number of information bits that may be sent in one OFDM symbol is dependent on the mode used to process the information bits. For the burst TDM scheme the granularity of the allocation is then dependent on mode. The granularity is larger for higher order modes that are capable of carrying more information bits per data symbol. In general a larger granularity adversely impacts packing efficiency which refers to the percentage of the frame that is actually used to carry data. If an active PLC does not require the data carrying capacity of an entire OFDM symbol then the excess capacity is wasted and reduces packing efficiency.

Since the payload of each PLC may be distributed over time as well as frequency the burst TDM FDM scheme may increase the transmission time for the PLC. However this also provides more time diversity. The transmission time for each PLC may be reduced by allocating more subbands to the PLC. For the burst TDM FDM scheme the granularity of the resource allocation may be selected based on a tradeoff between packing efficiency and overhead signaling. In general smaller granularity results in better packing efficiency but also requires more overhead signaling to indicate the resources allocated to each PLC. The inverse is generally true with larger granularity. The description below assumes the use of the burst TDM FDM scheme.

In an aspect the Nusable subbands are divided into Ngroups of usable subbands. One of the Ngroups may then contain the pilot subbands. For the remaining groups the number of data subbands in one group determines the granularity of the resource allocation. The Nusable subbands may be arranged into the Ngroups in various manners. In one subband grouping scheme each group contains Nconsecutive usable subbands where N N N. In another subband grouping scheme each group contains Nusable subbands that are pseudo randomly distributed across the Nusable subbands. In yet another subband grouping scheme each group contains Nusable subbands that are uniformly spaced across the Nusable subbands.

The interlaced subband structure provides various advantages. First better frequency diversity is achieved since each group includes usable subbands from across the entire system bandwidth. Second a wireless device may recover data symbols sent on each subband group by performing a partial e.g. 512 point fast Fourier transform FFT instead of a full e.g. 4096 point FFT which may reduce the power consumed by the wireless device. Techniques for performing a partial FFT are described in commonly assigned U.S. patent application Ser. No. 10 775 719 entitled Subband Based Demodulator for an OFDM based Communication System filed Feb. 9 2004. The following description assumes the use of the interlaced subband structure shown in .

Each PLC may be allocated resources on a super frame by super frame basis. The amount of resources to allocate to each PLC in each super frame is dependent on the payload of the PLC for that super frame. A PLC may carry a fixed rate data stream or a variable rate data stream. In an aspect the same mode is used for each PLC even if the data rate of the data stream carried by that PLC changes. This ensures that the coverage area for the data stream remains approximately constant regardless of data rate so that reception performance is not dependent on data rate. The variable rate nature of a data stream is handled by varying the amount of resources allocated to the PLC in each super frame.

Each active PLC is allocated resources from the time frequency plane as shown in . The allocated resources for each active PLC may be given in units of transmission slots or simply slots . A slot corresponds to one group of e.g. 500 data subbands or equivalently one group of modulation symbols in one symbol period. Nslots are available in each symbol period and may be assigned slot indices through N. Each slot index may be mapped to one subband group in each symbol period based on a slot to interlace mapping scheme. One or more slot indices may be used for an FDM pilot and the remaining slot indices may be used for the PLCs. The slot to interlace mapping may be such that the subband groups or interlaces used for the FDM pilot have varying distances to the subband groups used for each slot index. This allows all slot indices used for the PLCs to achieve similar performance.

Although forgoing aspects have assumed an FFT size of 4K it is noted that aspects of the present disclosure are capable of multiplexing and transmitting multiple data streams in OFDM systems of various FFT sizes. For an OFDM system with a 4K FFT size a group of 500 modulation symbols forming a slot is mapped into one interlace.

It is noted however that a slot is fixed across different FFT sizes. Moreover the size of an interlace is the number of active subbands and a slot gets mapped into either a fractional or a multiple including one interlaces based on the FFT size. The interlace s assigned to a slot may reside in multiple OFDM symbol periods. For example for a 2K FFT size a slot i.e. 500 modulation symbols maps into 2 interlaces over 2 consecutive 2K OFDM symbols. Similarly for a 1K FFT size a slot maps into 4 interlaces over 4 consecutive 1K OFDM symbols. Further as an example the number of useable subbands for 1K 2K 4K and 8K FFT sizes respectively would be 1000 2000 4000 and 8000 since said useable subbands would not include for example guard subbands. That is an FFT size of 1K contains 1024 subbands where 24 of the subbands may be used as guard subbands for example. The number of guard subbands may for example increase proportionally with FFT size.

It follows that for an 8K FFT size a slot maps into half of an interlace over half of an 8K OFDM symbol. It is noted that regardless of the FFT size a MAC time unit comprises 8 slots. The following table shows the relationships between FFT sizes of 1K 2K 4K and 8K and their respective number of OFDM symbols per MAC time unit number of subbands per interlace and number of interlaces per slot 

Thus relying on the relationships between MAC time units and OFDM symbols and the relationships between slots and interlaces it follows that aspects of the present disclosure are capable of MAC layer multiplexing over MAC time units and slots regardless of the FFT size of the OFDM system. The physical layer maps MAC time units and Slots to OFDM symbols and interlaces respectively for various FFT sizes.

Although the examples above refer only to 1K 2K 4K and 8K FFT sizes the present disclosure is not limited to these particular FFT sizes and other FFT sizes could be implemented without departing from the scope of the claimed invention.

Each active PLC is allocated at least one slot in a super frame. Each active PLC is also assigned specific slot s in the super frame. The allocation process provides each active PLC with the amount or quantity of resources whereas the assignment process provides each active PLC with the specific resources within the super frame. For clarity allocation and assignment may be viewed as separate processes. In practice allocation and assignment are typically performed jointly since allocation may be affected by assignment and vice versa. In any case the assignment may be performed in a manner to achieve the following goals 

Some of the goals listed above conflict with one another. For example goals 1 and 2 conflict and goals 1 and 4 conflict. A resource allocation assignment scheme attempts to achieve a balance between conflicting goals and may allow for flexibility in the setting of priority.

Each active PLC in a super frame is allocated a certain number of slots based on the payload of the PLC. Different PLCs may be allocated different numbers of slots. The specific slots to assign to each active PLC may be determined in various manners. Some exemplary slot assignment schemes are described below.

To minimize transmission time an active PLC may be assigned as many subband groups as possible while conforming to the maximum bit rate. The maximum number of information bits that may be sent in one OFDM symbol may be encoded and modulated with different modes to obtain different numbers of data symbols which then require different numbers of data subbands for transmission. The maximum number of data subbands that may be used for each PLC may thus be dependent on the mode used for the PLC.

In an aspect the rectangular pattern for each active PLC includes contiguous subband groups in indices and contiguous symbol periods. This type of assignment reduces the amount of overhead signaling needed to specify the rectangular pattern and further makes the slot assignments for the PLCs more compact which then simplifies the packing of the PLCs within a frame. The frequency dimension of the rectangular pattern may be specified by the starting subband group and the total number of subband groups for the rectangular pattern. The time dimension of the rectangular pattern may be specified by the starting symbol period and the total number of symbol periods for the rectangular pattern. The rectangular pattern for each PLC may thus be specified with four parameters.

For the example shown in PLC is assigned 8 slots in a 2 4 rectangular pattern PLC is assigned 12 slots in a 4 3 rectangular pattern and PLC is assigned 6 slots in a 1 6 rectangular pattern . The remaining slots in the frame may be assigned to other active PLCs. As shown in different rectangular patterns may be used for different active PLCs. To improve packing efficiency the active PLCs may be assigned slots in a frame one PLC at a time and in a sequential order determined by the number of slots allocated to each PLC. For example slots in the frame may be assigned first to the PLC with the largest number of allocated slots then to the PLC with the next largest number of allocated slots and so on and then finally to the PLC with the smallest number of allocated slots. The slots may also be assigned based on other factors such as for example the priority of the PLCs the relationship among the PLCs and so on.

The active PLCs for each strip are assigned slots in the strip. The slots may be assigned to the PLCs in a specific order e.g. using a vertical zigzag pattern. This zigzag pattern selects slots from low to high subband group indices for one symbol period at a time and from symbol periods to N. For the example shown in strip includes subband groups through . PLC is assigned a segment containing 10 slots from subband group in symbol period through subband group in symbol period . PLC is assigned a segment containing 4 slots from subband group in symbol period through subband group in symbol period . PLC is assigned a segment containing 6 slots from subband group in symbol period through subband group in symbol period . The remaining slots in strip may be assigned to other active PLCs mapped to this strip.

The second slot assignment scheme effectively maps all of the slots in a two dimensional 2 D strip onto a one dimensional 1 D strip and then performs 2 D slot assignment using one dimension. Each active PLC is assigned a segment within the strip. The assigned segment may be specified by two parameters the start of the segment which may be given by the starting subband and symbol period and the length of the segment. An additional parameter is used to indicate the specific strip to which the PLC is mapped. In general the segment assigned to each active PLC may include any number of slots. However less overhead signaling is required to identify the assigned segments if the segment sizes are constrained to be in multiple e.g. 2 or 4 slots.

The second slot assignment scheme can assign slots to active PLCs in a simple manner. Also tight packing may be achieved for each strip since the slots within the strip may be consecutively assigned to the PLCs. The vertical dimensions of the Nstrips may be defined to match the profile of all active PLCs in the super frame so that 1 as many PLCs as possible are sent using the largest number of data subbands allowed for the PLCs and 2 the Nstrips are packed as fully as possible.

For simplicity show the assignment of slots to individual PLCs. For some services multiple PLCs may be jointly decoded by wireless devices and are referred to as joint PLCs. This may be the case for example if multiple PLCs are used for the video and audio components of a single multimedia program and are jointly decoded to recover the program. The joint PLCs may be allocated the same or different number of slots in each super frame depending on their payloads. To minimize the ON time the joint PLCs may be assigned slots in consecutive symbol periods so that the wireless devices do not need to wake up multiple times within a frame to receive these PLCs.

In a second aspect the joint PLCs are assigned slots in rectangular patterns that are stacked vertically. For the example shown in PLC is allocated 8 slots in a 2 4 rectangular pattern and PLC is allocated 6 slots in a 2 3 rectangular pattern which is located directly above pattern . The total number of subband groups used for the joint PLCs may be such that these joint PLCs collectively conform to the maximum bit rate. For the second aspect the wireless devices may store the received data symbols for the joint PLCs in separate buffers until they are ready for decoding. The second aspect may reduce the ON time for the joint PLCs relative to the first aspect.

In general any number of PLCs may be jointly decoded. The rectangular patterns for the joint PLCs may span the same or different numbers of subband groups which may be constrained by the maximum bit rate. The rectangular patterns may also span the same or different numbers of symbol periods. The rectangular patterns for some sets of joint PLCs may be stacked horizontally while the rectangular patterns for other sets of joint PLCs may be stacked vertically.

Joint PLCs may also be assigned zigzag segments. In one aspect the multiple PLCs to be jointly decoded are assigned consecutive segments in the same strip. In another aspect the multiple PLCs are assigned segments in different strips and the segments overlap in time as much as possible in order to reduce the ON time to recover these PLCs.

In general each data stream may be encoded in various manners. In an aspect each data stream is encoded with a concatenated code comprised of an outer code and an inner code. The outer code may be a block code such as a Reed Solomon RS code or some other code. The inner code may be a Turbo code e.g. a parallel concatenated convolutional code PCCC or a serially concatenated convolutional code SCCC a convolutional code a low density parity check LDPC code or some other code.

In an aspect each data stream may be transmitted with or without layered coding where the term coding in this context refers to channel encoding rather than source encoding at a transmitter. A data stream may be comprised of two substreams which are called a base stream and an enhancement stream. In one aspect the base stream may carry information sent to all wireless devices within the coverage area of the base station. The enhancement stream may carry additional information sent to wireless devices observing better channel conditions. With layered coding the base stream is encoded and modulated in accordance with a first mode to generate a first modulation symbol stream and the enhancement stream is encoded and modulated in accordance with a second mode to generate a second modulation symbol stream. The first and second modes may be the same or different. The two modulation symbol streams are then combined to obtain one data symbol stream.

Table 1 shows an exemplary set of eight modes that may be supported by the system. Let m denote the mode where m 1 2 . . . 8. Each mode is associated with a specific modulation scheme e.g. QPSK or 16 QAM and a specific inner code rate R m e.g. or . The first five modes are for regular coding with only the base stream and the last three modes are for layered coding with the base and enhancement streams. For simplicity the same modulation scheme and inner code rate are used for both the base and enhancement streams for each layered coding mode.

Table 1 also shows various transmission parameters for each mode. The fourth column of Table 1 indicates the number of slots needed to transmit one packet for each mode which assumes a packet size of approximately 1000 information bits and 500 data subbands per slot. The fifth column indicates the number of slots needed to transmit one subblock of four packets for each mode. Different numbers of subband groups may be used for a PLC for all of the modes. The use of more subband groups results in shorter transmission time but also provides less time diversity.

As an example for mode one data block with K data packets may be encoded to generate 16 coded packets. Each data packet contains 1000 information bits. Since mode uses code rate R 1 each coded packet contains 3000 code bits and may be transmitted on 1500 data subbands or three subband groups using QPSK which can carry two code bits per data symbol. The four coded packets for each subblock may be sent in 12 slots. Each subblock may be transmitted in a rectangular pattern of e.g. dimension 4 3 3 4 2 6 or 1 12 where the first value P in dimension P Q is for the number of subband groups and the second value Q is for the number of symbol periods for the rectangular pattern.

Table 1 shows an exemplary design which is provided to show various parameters that may impact subband allocation and assignment. In general the system may support any number of modes and each mode may correspond to a different coding and modulation scheme. For example each mode may correspond to a different combination of modulation scheme and inner code rate. To simplify the design of the wireless devices the system may utilize a single inner code e.g. with a base code rate of or and different code rates may be achieved by puncturing or deleting some of the code bits generated by the inner code. However the system may also utilize multiple inner codes. The maximum allowable number of subband groups for each mode may be different and possibly based on the maximum bit rate.

In general one or multiple data blocks may be sent on an active PLC in each super frame. The number of data blocks to be sent per super frame is dependent on the data rate of the data stream being sent on the PLC. The number of slots N to allocate to the PLC per frame is equal to the number of data blocks N being sent on the PLC in the super frame times the number of slots required for one subblock or N N N m where N m is dependent on the mode used for the PLC. If the PLC carries a large number of data blocks in one super frame for a high rate data stream then it is desirable to use as many subband groups as possible in order to minimize the transmission time for the PLC. For example if the PLC carries 16 data blocks in one super frame then the transmission time per frame using mode is 192 16 12 symbol periods using one subband group which is 65 of the frame duration and only 48 192 4 symbol periods using four subband groups which is 16.25 of the frame duration . The transmission time for the PLC may thus be substantially shortened by using more subband groups.

In one aspect the four packets in one subblock are transmitted in a vertical zigzag pattern within a rectangular pattern as shown in . This aspect reduces buffering requirements since each packet is transmitted in as few symbol periods as possible and there is only one partial packet in any given symbol period. In another aspect the four packets are transmitted in a horizontal zigzag pattern . This aspect provides more time diversity since each packet is transmitted over as many symbol periods as possible. However the maximum bit rate may restrict the number of subband groups that may be used or additional buffering may be needed since up to two packets may be received in full in the same symbol period using the horizontal zigzag pattern.

In a first aspect which is shown in the packets are sent in the rectangular pattern by cycling through the six code blocks. For each cycle through the six code blocks one packet is selected from each code block and the six packets for the six code blocks are sent using the vertical zigzag pattern. The six packets for the code blocks are sent in a box the six packets for the code blocks are sent in a box the six packets for the code blocks are sent in a box and the six packets for the code blocks are sent in a box . The j th packet for the i th code block is labeled as Bi Pj in .

The first aspect provides more time diversity across each code block since the four packets for the code block are sent over more symbol periods. Packets sent in one symbol period are likely to suffer from correlated erasures. For example a deep fade during a symbol period may cause all packets sent in that symbol period to be decoded in error. By sending packets from different code blocks in the same symbol period the correlated packet erasures will be distributed over multiple code blocks. This enhances the ability of the block decoder to correct these erasures. The first aspect also spaces the four packets for each code block as far apart in time as possible which improves time diversity across the code block. For example the four packets for code block are sent in symbol periods and and are spaced apart by three symbol periods. The first aspect also reduces buffering requirements since each packet is sent over as few symbol periods as possible.

In a second aspect which is not shown in the figures the packets are selected by cycling through the Ncode blocks similar to the first aspect but the Npackets for each cycle are sent using the horizontal zigzag pattern within box . This aspect may provide more time diversity across each packet. In a third aspect the four packets for one code block are sent first the four packets for another code block are sent next and so on. This aspect allows for early recovery of some code blocks. Multiple code blocks may thus be sent on a PLC in various manners.

As noted above multiple PLCs may be intended to be jointly decoded. Each of the joint PLCs may carry any number of code blocks per super frame depending on the data rate of the data stream being sent on the PLC. The total number of subband groups to use for the joint PLCs may be limited by the maximum bit rate.

The examples shown in may be extended to cover any number of joint PLCs any number of code blocks for each PLC and any mode for each PLC. Slots may be assigned to the joint PLCs such that the total transmission time for these PLCs is minimized while conforming to the maximum bit rate.

For the outer coding scheme shown in the first K packets of each code block are for data and the last N K packets are for parity bits. Since each packet includes a CRC value a wireless device can determine whether each packet is decoded correctly or in error by re computing the CRC value using the received information bits of the packet and comparing the recomputed CRC value to the received CRC value. For each code block if the first K packets are decoded correctly then the wireless device does not need to process the last N K packets. For example if N 16 K 12 and the last four packets of a code block are sent in the fourth frame then the wireless device does not need to wake up in the last frame if the 12 data packets sent in the first three frames are decoded correctly. Furthermore any combination of up to N K incorrectly inner decoded packets may be corrected by the Reed Solomon decoder.

For clarity the description above is based on a concatenated coding scheme comprised of an outer code and an inner code and for the parameters given in Table 1. Other coding schemes may also be used for the system. Furthermore the same or different parameters may be used for the system. The subband allocation and assignment may be performed using the techniques described herein and in accordance with the specific coding scheme and parameters applicable to the system.

Initially the active PLCs for the current super frame are identified block . For each active PLC at least one data block is processed in accordance with the outer code and rate selected for the PLC to obtain at least one code block one code block for each data block block . Each active PLC is allocated a specific number of transmission units based on the PLC s payload for the current super frame block . In general the transmission units in the current super frame may be allocated to the active PLCs with any level of granularity. For example the transmission units may be allocated to the active PLCs in slots with each slot containing 500 transmission units. Specific transmission units in each frame of the current super frame are then assigned to each active PLC block . Block determines the resource quantity allocated for each active PLC. Block provides the specific resource allocation for each active PLC and may be performed based on an assignment scheme. For example the scheme that assigns rectangular patterns or the scheme that assign zigzag segments within strips may be used for block . The allocation and assignment of transmission units may also be performed jointly since the allocation may be dependent on the packing efficiency achieved by the assignment.

Each code block for each active PLC is partitioned into multiple subblocks one subblock for each frame block . Each packet in each subblock is then encoded by the inner code and mapped to modulation symbols block . The inner code rate and modulation scheme used for each PLC is determined by the mode selected for that PLC. The multiple subblocks for each code block are then sent in the multiple frames of the current super frame to achieve time diversity. For each frame of the current super frame the data symbols in the subblock s to be sent in that frame for each active PLC are mapped onto the transmission units assigned to the PLC block . A composite symbol stream is then formed with 1 the multiplexed data symbols for all of the active PLCs and 2 pilot overhead and guard symbols block . The composite symbol stream is further processed e.g. OFDM modulated and conditioned and broadcast to wireless devices in the system.

The multiplexing and transmission techniques described herein allow the multiple data streams sent in each super frame to be independently recoverable by a wireless device. A given data stream of interest may be recovered by 1 performing OFDM demodulation on all subbands or just the subbands used for the data stream 2 demultiplexing the detected data symbols for the data stream and 3 decoding the detected data symbols for the data stream. The other data streams need not be completely or partially decoded in order to receive the desired data stream. Depending on the allocation and assignment scheme selected for use the wireless device may perform partial demodulation and or partial decoding of another data stream in order to recover the data stream of interest. For example if multiple data streams share the same OFDM symbol then the demodulation of a selected data stream may result in partial demodulation of an unselected data stream.

Channelizer multiplexes the data symbols in the Ndata symbol streams onto their assigned transmission units. Channelizer also provides pilot symbols on the pilot subbands and guard symbols on the guard subbands. Channelizer further multiplexes pilot symbols and overhead symbols in the pilot and overhead section preceding each super frame see . Channelizer provides a composite symbol stream denoted as s that carries data overhead pilot and guard symbols on the proper subbands and symbol periods. An OFDM modulator performs OFDM modulation on the composite symbol stream and provides a stream of OFDM symbols to a transmitter unit TMTR . Transmitter unit conditions e.g. converts to analog filters amplifies and frequency upconverts the OFDM symbol stream and generates a modulated signal that then is transmitted from an antenna .

A controller obtains an indication of e.g. user selection for one or more specific data streams PLCs to be recovered. Controller then determines the resource allocation and assignment for each selected PLC. If wireless device is acquiring the signal for the first time e.g. initial acquisition then the signaling information is obtained from the overhead OFDM symbols decoded by a receive RX data processor . If wireless device is successfully receiving data blocks in super frames then the signaling information may be obtained through the embedded overhead signaling that is part of at least one data block sent in each super frame. This embedded overhead signaling indicates the allocation and assignment of the corresponding data stream PLC in the next super frame. Controller provides a MUX RX control to dechannelizer . Dechannelizer performs demultiplexing of the detected data or overhead symbols for each symbol period based on the MUX RX control and provides one or more detected data symbol streams or a detected overhead symbol stream respectively to RX data processor . In the case of the overhead OFDM symbols RX data processor processes the detected overhead symbol stream in accordance with the mode used for overhead signaling and provides the decoded overhead signaling to controller . For the data symbol stream s RX data processor processes each detected data symbol stream of interest in accordance with the mode used for that stream and provides a corresponding decoded data stream to a data sink . In general the processing at wireless device is complementary to the processing at base station

Controllers and direct the operation at base station and wireless device respectively. Memory units and provide storage for program codes and data used by controllers and respectively. Controller and or a scheduler allocate resources to the active PLCs and further assign transmission units to each active PLC.

Within base stream processor an outer encoder encodes each data block of base stream data in accordance with e.g. a Reed Solomon code to generate an RS code block. An RS code block consists of N outer coded packets. Encoder also appends a CRC value to each outer coded packet. This CRC value may be used by a wireless device for error detection i.e. to determine whether the packet is decoded correctly or in error . An outer interleaver partitions each code block into subblocks interleaves i.e. reorders the packets among the different subblocks that are transmitted in each frame and buffers the subblocks transmitted in the different frames of a super frame. An inner encoder then encodes each outer coded packet of a subblock in accordance with e.g. a Turbo code to generate an inner coded packet. An inner bit interleaver interleaves the bits within each inner coded packet to generate a corresponding interleaved packet. The encoding by the outer encoder and inner encoder increases the reliability of the transmission for the base stream. The interleaving by outer interleaver and inner interleaver provides time and frequency diversity respectively for the base stream transmission. A scrambler randomizes the bits in each encoded and bit interleaved packet with a PN sequence and provides scrambled bits to mapping unit .

Enhancement stream processor similarly performs processing on the enhancement stream if any for the PLC. Processor may use the same inner code outer code and modulation scheme as those used for processor or different ones. Processor provides scrambled bits for the enhancement stream to mapping unit .

Mapping unit receives the scrambled bits for the base and enhancement streams a gain Gfor the base stream and a gain Gfor the enhancement stream. The gains Gand Gdetermine the amount of transmit power to use for the base and enhancement streams respectively. Different coverage areas may be achieved for the base and enhancement streams by transmitting these streams at different power levels. Mapping unit maps the received scrambled bits to data symbols based on a selected mapping scheme and the gains Gand G. The symbol mapping may be achieved by 1 grouping sets of B scrambled bits to form B bit binary values where B 1 and 2 mapping each B bit binary value to a data symbol which is a complex value for a point in a signal constellation for the selected modulation scheme. If layered coding is not used then each data symbol corresponds to a point in a signal constellation such as M PSK or M QAM where M 2. If layered coding is used then each data symbol corresponds to a point in a complex signal constellation which may or may not be formed by the superposition of two scaled signal constellations. For the aspect described above the base and enhancement streams carry the same number of code blocks for each super frame. The code blocks for the base and enhancement streams may be transmitted simultaneously as shown in or transmitted using TDM and or FDM.

Referring back to channelizer is implemented with a multiplexer that receives the Ndata symbol streams the overhead symbol stream pilot symbols and guard symbols. Multiplexer provides the data symbols overhead symbols pilot symbols and guard symbols onto the proper subbands and symbol periods based on a MUX TX control from controller and outputs the composite symbol stream s. In assigning modulation symbols to the subband groups a further level of symbol interleaving can be performed by assigning modulation symbols in a pseudo random fashion to the subbands within each subband group. To simplify the assignment of subbands the PLCs may be assigned slots as described above. The slots may then be mapped to different subband groups e.g. in a pseudo random fashion from one symbol period to the next. This slot to subband group mapping ensures that the modulation symbols associated with a specific slot index have different distances from the pilot subbands for different symbol periods which may improve performance.

OFDM modulator includes an inverse fast Fourier transform IFFT unit and a cyclic prefix generator . For each symbol period IFFT unit transforms each set of Nsymbols for the Ntotal subbands to the time domain with an N point IFFT to obtain a transformed symbol that contains Ntime domain chips. To combat intersymbol interference ISI which is caused by frequency selective fading cyclic prefix generator repeats a portion of each transformed symbol to form a corresponding OFDM symbol. The repeated portion is often called a cyclic prefix or guard interval. Cyclic prefix generator provides a stream of data chips denoted as c for the composite symbol stream S.

The multiplexing and transmission techniques described herein may be implemented by various means. For example these techniques may be implemented in hardware software or a combination thereof. For a hardware implementation the processing units used to perform multiplexing and or transmission at a base station may be implemented within one or more application specific integrated circuits ASICs digital signal processors DSPs digital signal processing devices DSPDs programmable logic devices PLDs field programmable gate arrays FPGAs processors controllers micro controllers microprocessors other electronic units designed to perform the functions described herein or a combination thereof. The processing units used to perform the complementary processing at a wireless device may also be implemented within one or more ASICs DSPs and so on.

For a software implementation the techniques described herein may be implemented with modules e.g. procedures functions and so on that perform the functions described herein. The software codes may be stored in a memory unit e.g. memory unit or in and executed by a processor e.g. controller or . The memory unit may be implemented within the processor or external to the processor in which case it can be communicatively coupled to the processor via various means as is known in the art.

The previous description of the disclosed aspects is provided to enable any person skilled in the art to make or use the present disclosure. Various modifications to these aspects will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other aspects without departing from the scope of the disclosure. Thus the present disclosure is not intended to be limited to the aspects shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.

