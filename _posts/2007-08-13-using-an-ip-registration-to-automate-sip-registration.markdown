---

title: Using an IP registration to automate SIP registration
abstract: In one embodiment, a network device receives an Internet protocol (IP) registration request, such as a mobile IP registration request, from an access terminal. The network device may be a home agent that is configured to register the access terminal for IP services at the network layer. In addition to registering the access terminal at the network layer, the network device may facilitate registration at another layer, such as the application layer. In one example, registration information for the access terminal for an application layer registration, such as information needed to register for a session initiation protocol (SIP) services, is determined. The network device then facilitates registration at the application layer automatically using the registration information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08233401&OS=08233401&RS=08233401
owner: Cisco Technology, Inc.
number: 08233401
owner_city: San Jose
owner_country: US
publication_date: 20070813
---
In the voice over Internet protocol VoIP architecture the start up process may include many steps. For example when an access terminal powers on it must connect to the radio network obtain IP and mobile IP registration and then perform application layer registrations. This start up process may be time consuming and is particularly problematic during an avalanche re start which is when a network outage causes a large number of access terminals to lose connectivity and re start around the same time. When the network heals the access terminals simultaneously discover this and begin the reconnection process. This causes a flood of re starts that can cause problems and congestion on the network.

In one embodiment a network device receives an Internet protocol IP registration request such as a mobile IP registration request from an access terminal. The network device may be a home agent that is configured to register the access terminal for IP services at the network layer. In addition to registering the access terminal at the network layer the network device may facilitate registration at another layer such as the application layer. In one example registration information for the access terminal for an application layer registration such as information needed to register for session initiation protocol SIP services is determined. The network device then facilitates registration at the application layer using the network layer registration information.

The network device facilitates the registration automatically upon receiving the IP registration request from the access terminal. For example the network device may access a database to bind a username for the access terminal to the registration information. In one example the username may be bound to an IP address and port. Also the network device may communicate with an application layer device to cause registration. For example the application layer device may construct and send a SIP REGISTER message to start the registration process for the access terminal. Also the application layer device may access the database to bind the registration information to the username. Accordingly the access terminal does not need to separately register at the application layer once the IP registration is performed. Rather the network device may facilitate this registration.

The system may include a home network and or a foreign network . Home network may be a physical or virtual network that may have a network prefix matching that of a home address for access terminal . Foreign network may be a visited network in which access terminal has roamed and has attached to.

Access terminal may be a mobile device such as a cellular phone personal e mail device personal digital assistant PDA IP phone etc. In one embodiment access terminal may be an integrated device which may be a single device that provides data services and voice services for the same user. For example a service provider assigns a single user to access terminal which can provide both voice and data services to the user. The voice and data services may require separate registrations.

A home agent may be a network device such as a router that is found in home network . Home agent may also be referred to as Gateway GPRS Support Node GGSN or may be other suitable network devices to enable IP registration with or without support for mobility . Home agent is configured to send packets to access terminal . In one embodiment access terminal may register with home network while it is in the range of home network . Also access terminal may roam to foreign network and attach to foreign agent . Foreign agent may be a network device such as a router that provides routing services to access terminal while it is attached to foreign network . Access terminal needs to register with home network when it attaches to foreign agent . After registering home agent and foreign agent may facilitate routing of packets to access terminal when it is attached to foreign network . Although a mobile IP infrastructure is described with foreign network it will be understood that particular embodiments may also be used when access terminal is not roaming in foreign network .

Particular embodiments recognize that registration may need to occur at many layers in a network. Rather than repeating the process independently registration at one layer is used to bootstrap registration at another. For example when mobile IP registration occurs information determined during that process is used to automatically perform registration at the application layer. This reduces network load by eliminating additional messages and processing. It also improves start up time for access terminals . This may be especially important during an avalanche re start where multiple access terminals are attempting to re establish a connection with home network .

In one embodiment when access terminal attaches to home network home agent may facilitate an IP registration such as a mobile IP registration to access IP services e.g. data services . Home agent may determine an IP address for access terminal . Also a port may also be determined. The IP address and port may be used for communications to from access terminal .

When access terminal registers with home agent home agent may facilitate registration for access terminal at another layer such as the application layer. For example home agent may cause a SIP registration for SIP services such as media services on behalf of access terminal . This may be performed automatically when access terminal performs an IP registration at the network layer. There may be rules that specify when the automatic registration should be performed at the application layer. For example if a user is not connected to an application layer service then the automatic registration may be performed. Also some users may want to be automatically registered for the application layer service. Further information in the network layer registration may indicate that registration at the application layer is needed.

To automatically perform the registration at a different layer information determined in the IP registration may be used to automatically register access terminal at the application layer. For example the IP address allocated to access terminal and a port may be used in the application layer registration. The application layer registration generally needs to have an IP address and port bound to a username. The username is obtained as part of the IP registration either directly from access terminal or indirectly through some other entity or function and may be subject to authentication. Other information such as the full path and capabilities may also be determined which will be described in more detail below.

Home agent may facilitate the application layer registration in different ways. For example home agent may store registration bindings for access terminal in an application layer database . In one example during application layer registration a username for a user of access terminal needs to be bound to the IP address and port in database . SIP services may use database to determine if access terminal is registered to receive services. Accordingly if the registration information is bound in application layer database then SIP services may access the information to provide the services to access terminal . Methods other than binding the registration information to the username may be used to automatically register access terminal . For example flags may be set to register access terminal or other information may be stored in database to register access terminal at the application layer.

In another example home agent may contact a policy server to facilitate the registration. Policy server may be a network device that may be configured to authorize the IP registration. When policy server is contacted during the IP registration policy server may also perform the application layer registration. For example policy server may access database and bind the IP address and port to the username. Further policy server may contact an application layer entity which may be any module or device that can perform the application layer registration such as a serving control session control function S CSCF proxy application manager or any other SIP entity configured to perform registrations. For example as will be described in more detail below policy server may construct a SIP REGISTER message using the registration information and send it to application layer entity . The registration process may then proceed between policy server and application layer entity . One advantage of having policy server send the REGISTER message is that it is trusted by application layer entity . This is because policy server and application layer entity may already be in a trusted relationship from being in home network . Home Agent has already authenticated the user at the network layer thus challenge response messages or other authentication messages do not need to be sent at the application layer as would be the case if a non trusted entity is attempting to register. Thus application layer registration can be automated because home agent obtains authenticated or otherwise trustworthy identity information at the network layer during IP registration. This identity information is then associated with an IP address and application specific port to facilitate registration at the application layer.

Accordingly an automated registration at the application layer is provided when access terminal registers at the network layer. The application layer registration uses information determined in the network layer registration to perform the application layer registration. This reduces messaging between access terminal and other network entities in home network and thus may reduce congestion on the network.

The automated application layer registration will now be described in more detail. shows a more detailed example of the system shown in . Home agent may include an IP registrar and an application layer registrar . IP registrar may receive an IP registration request from access terminal . The IP registration request may be received from access terminal and or foreign agent . For example access terminal may be found within home network or may be roaming and attached to foreign network . IP registrar may be configured to determine an identity of access terminal . For example access terminal may provide the identity when it is authenticated. The identity may be telephone number username or other information.

An IP address determiner may determine an IP address for access terminal . The IP address may be determined in any way. In one example if access terminal is in home network the home address allocated to access terminal may be used. IP address determiner may know the identity of access terminal and thus can determine what IP address has been allocated to it. Also if access terminal has roamed to foreign network then the foreign care of address may also be noted.

Port determiner may then determine a port for access terminal . In one example a default port may be used such as a default port for mobile IP communications may be assigned to access terminal .

An application layer registrar to facilitate application layer registration. For example application layer registrar includes a database information determiner that may determine information that needs to be bound to a username for access terminal in database . For example the IP address and port may be determined using the identity of access terminal . The IP address may have been assigned during registration. The port may be application specific. For example different default ports may be used for different applications. Then the identity may be used to determine a username or address of record AoR . Accordingly application layer registrar may facilitate application layer registration for home agent .

A database accessor may then access database . The access may be through an application programming interface API or any other methods. Information needed to register access terminal is then stored in database . For example a binding between the username and port IP address is entered into database .

In another example of registering access terminal during the IP registration IP registrar may contact policy server to perform the IP registration. Although policy server is described as being contacted it will be understood that home agent may also perform the functions of policy server . Policy server may be configured to authorize registration of access terminal at the network layer. Once policy server authorizes the IP registration policy server may facilitate the application layer registration. For example a registration message determiner may construct a SIP REGISTER message using the information it learned during the IP registration. Registration message determiner may determine the IP address port and any other information that is needed for a SIP REGISTER message. The IP address allocated to the user can be used to construct a Contact header field e.g. SIP IP address and the identity of access terminal can be used to derive the AoR.

A registration facilitator then communicates the SIP REGISTER message to application layer entity . Because policy server may be a trusted entity to application layer entity and trusted home agent authenticated implicitly or explicitly access terminal the REGISTER message may not be challenged.

In another embodiment registration facilitator may facilitate registration of access terminal by storing the necessary information directly into database . This may be performed as described above with respect to home agent .

As discussed above other information may be needed for the application layer registration. For example the REGISTER message may also have additional functions other than providing the IP address and port of access terminal . For example it may be used to establish a full path for inbound and outbound messaging to and from access terminal . The path and service route header fields in a SIP REGISTER message may provide this information. Also the REGISTER message may provide capabilities of access terminal to the network and any other network devices such as IP multimedia subsystem IMS entities. In one example the assigned application layer entities such as the CSCFs may be provided during access authentication or IP registration. This provides the service route that access terminal would otherwise provide through its REGISTER message. The path may be determined by home agent on its own when the P and S CSCFs are in home network . Also the capabilities of access terminal may be known to a service provider as part of the device provisioning and these parameters may be entered into database ahead of time and activated when access terminal registers. The path and capabilities may also be determined in other ways.

During application layer registration security parameters may be set up at the application layer. In one example a security registrar may be used to set up the security association. The IP registration may be used to convey security parameters to application layer entity . These security parameters may also be conveyed to access terminal during the IP registration. This allows access terminal and application layer entity to substantiate the security association without additional explicit signaling. Alternatively access terminal may use dynamic transport layer security DTLS or transport layer security TLS procedures to establish a secure connection but omit the SIP REGISTER at the end of the procedure. The identity of access terminal may be determined from the source IP address of access terminal that may be verified by return routability during the TLS handshake. A secure tunnel such as an IPsec tunnel may be established without the parameters being exchanged using a SIP REGISTER exchange between access terminal and application layer entity . Also other methods may be used to set up the security association between access terminal and application layer entity .

Step then determines registration information for the application layer. For example the IP address and port previously determined are used to associate the user with for the application in question. Also the path for messaging with access terminal security association information and other information needed for registration may be determined.

Step then facilitates registration at the application layer for access terminal . This registration may be facilitated in many ways. In one embodiment shows an example of facilitating registration at the application layer using policy server . Step determines registration information. For example policy server may receive the registration information from home agent .

Step then determines information for a REGISTER message. For example information needed for a SIP REGISTER message such as the IP address port and the identity of access terminal are determined. This information may then be inserted in the REGISTER message.

Step then sends the REGISTER message to application layer entity . Further messaging as needed may be performed to register access terminal .

In another embodiment shows another example of registering access terminal . Step determines registration information. For example the registration information may be determined by home agent and or policy server .

Step then accesses database . For example home agent or policy server may access database through an API.

Step then stores a binding of the registration information with a username for access terminal . For example the username is bound to the IP address and port that was determined for access terminal . Also any other information that is needed may be bound to the username such as capability parameters the full path for inbound and outbound messaging etc.

Particular embodiments provide many advantages. For example network load and processing may be reduced by eliminating messaging with access terminal . This may be important during an avalanche restart. Also startup time for access terminals may be reduced.

Although the description has been described with respect to particular embodiments thereof these particular embodiments are merely illustrative and not restrictive. Although mobile IP is discussed it will be understood that the automated registrations may be performed on any layers.

Any suitable programming language can be used to implement the routines of particular embodiments including C C Java assembly language etc. Different programming techniques can be employed such as procedural or object oriented. The routines can execute on a single processing device or multiple processors. Although the steps operations or computations may be presented in a specific order this order may be changed in different particular embodiments. In some particular embodiments multiple steps shown as sequential in this specification can be performed at the same time. The sequence of operations described herein can be interrupted suspended or otherwise controlled by another process such as an operating system kernel etc. The routines can operate in an operating system environment or as stand alone routines occupying all or a substantial part of the system processing. Functions can be performed in hardware software or a combination of both. Unless otherwise stated functions may also be performed manually in whole or in part.

In the description herein numerous specific details are provided such as examples of components and or methods to provide a thorough understanding of particular embodiments. One skilled in the relevant art will recognize however that a particular embodiment can be practiced without one or more of the specific details or with other apparatus systems assemblies methods components materials parts and or the like. In other instances well known structures materials or operations are not specifically shown or described in detail to avoid obscuring aspects of particular embodiments.

A computer readable medium for purposes of particular embodiments may be any medium that can contain store communicate propagate or transport the program for use by or in connection with the instruction execution system apparatus system or device. The computer readable medium can be by way of example only but not by limitation an electronic magnetic optical electromagnetic infrared or semiconductor system apparatus system device propagation medium or computer memory.

Particular embodiments can be implemented in the form of control logic in software or hardware or a combination of both. The control logic when executed by one or more processors may be operable to perform that what is described in particular embodiments.

A processor or process includes any human hardware and or software system mechanism or component that processes data signals or other information. A processor can include a system with a general purpose central processing unit multiple processing units dedicated circuitry for achieving functionality or other systems. Processing need not be limited to a geographic location or have temporal limitations. For example a processor can perform its functions in real time offline in a batch mode etc. Portions of processing can be performed at different times and at different locations by different or the same processing systems.

Reference throughout this specification to one embodiment an embodiment a specific embodiment or particular embodiment means that a particular feature structure or characteristic described in connection with the particular embodiment is included in at least one embodiment and not necessarily in all particular embodiments. Thus respective appearances of the phrases in a particular embodiment in an embodiment or in a specific embodiment in various places throughout this specification are not necessarily referring to the same embodiment. Furthermore the particular features structures or characteristics of any specific embodiment may be combined in any suitable manner with one or more other particular embodiments. It is to be understood that other variations and modifications of the particular embodiments described and illustrated herein are possible in light of the teachings herein and are to be considered as part of the spirit and scope.

Particular embodiments may be implemented by using a programmed general purpose digital computer by using application specific integrated circuits programmable logic devices field programmable gate arrays optical chemical biological quantum or nanoengineered systems components and mechanisms may be used. In general the functions of particular embodiments can be achieved by any means as is known in the art. Distributed networked systems components and or circuits can be used. Communication or transfer of data may be wired wireless or by any other means.

It will also be appreciated that one or more of the elements depicted in the drawings figures can also be implemented in a more separated or integrated manner or even removed or rendered as inoperable in certain cases as is useful in accordance with a particular application. It is also within the spirit and scope to implement a program or code that can be stored in a machine readable medium to permit a computer to perform any of the methods described above.

Additionally any signal arrows in the drawings Figures should be considered only as exemplary and not limiting unless otherwise specifically noted. Furthermore the term or as used herein is generally intended to mean and or unless otherwise indicated. Combinations of components or steps will also be considered as being noted where terminology is foreseen as rendering the ability to separate or combine is unclear.

As used in the description herein and throughout the claims that follow a an and the includes plural references unless the context clearly dictates otherwise. Also as used in the description herein and throughout the claims that follow the meaning of in includes in and on unless the context clearly dictates otherwise.

The foregoing description of illustrated particular embodiments including what is described in the Abstract is not intended to be exhaustive or to limit the invention to the precise forms disclosed herein. While specific particular embodiments of and examples for the invention are described herein for illustrative purposes only various equivalent modifications are possible within the spirit and scope as those skilled in the relevant art will recognize and appreciate. As indicated these modifications may be made to the present invention in light of the foregoing description of illustrated particular embodiments and are to be included within the spirit and scope.

Thus while the present invention has been described herein with reference to particular embodiments thereof a latitude of modification various changes and substitutions are intended in the foregoing disclosures and it will be appreciated that in some instances some features of particular embodiments will be employed without a corresponding use of other features without departing from the scope and spirit as set forth. Therefore many modifications may be made to adapt a particular situation or material to the essential scope and spirit. It is intended that the invention not be limited to the particular terms used in following claims and or to the particular embodiment disclosed as the best mode contemplated for carrying out this invention but that the invention will include any and all particular embodiments and equivalents falling within the scope of the appended claims.

