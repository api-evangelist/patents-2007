---

title: Constrained line search optimization for discriminative training of HMMS
abstract: An exemplary method for optimizing a continuous density hidden Markov model (CDHMM) includes imposing a constraint for discriminative training, approximating an objective function as a smooth function of CDHMM parameters and performing a constrained line search on the smoothed function to optimize values of the CDHMM parameters. Various other methods, devices and systems are disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08239332&OS=08239332&RS=08239332
owner: Microsoft Corporation
number: 08239332
owner_city: Redmond
owner_country: US
publication_date: 20071120
---
In the past few decades discriminative training DT has been a very active research topic in the field of automatic speech recognition ASR . Many DT methods have been proposed to estimate Gaussian mixture continuous density hidden continuous density Markov models CDHMMs in a variety of speech recognition tasks ranging from small vocabulary isolated word recognition to large vocabulary continuous speech recognition tasks. Generally speaking DT of CDHMMs is a typical optimization problem that starts with formulation of an objective function according to certain estimation criterion. Some popular DT criteria widely used in speech recognition include maximum mutual information MMI minimum error estimation MCE minimum word or phone error MWE or MPE minimum divergence MD and so on. Once the objective function is formulated an effective optimization method must be used to minimize or maximize the objective function with respect to its CDHMM parameters.

With respect to optimization in speech recognition several different methods have been used to optimize the derived objective function including the GPD generalized probabilistic descent algorithm based on the first order gradient descent method and the approximate second order Quickprop method and the extended Baum Welch EBW algorithm based on growth transformation and so on.

The GPD and Quickprop methods are mainly used for optimizing the MCE derived objective function even though they are general optimization methods which can be used for any types of differentiable objective functions. On the other hand the EBW method has been initially proposed to maximize a rational objective function and later extended to Gaussian mixture CDHMMs for the MMI and MPE or MWE objective functions. Recently the EBW method has also been generalized to optimize the MCE objective function as well as the MD objective function.

The EBW method has been widely accepted for DT because it is relatively easy to be implemented on word graphs for large scale ASR tasks and it has been demonstrated that the EBW algorithm performs well in many tasks. Essentially all of these optimization methods attempt to search for a nearby locally optimal point of the objective function from an initial point according to both a search direction and a step size. Normally the search direction is locally computed based on the first order derivative such as gradient and the step size must be empirically determined in practice. As the result the performance of these optimization methods highly depends on the location of the initial point and the property of objective functions. If the derived objective function is highly nonlinear jagged and non convex in nature it is extremely difficult to optimize it effectively with any simple optimization algorithm which is one of the major difficulties of DT of HMMs for speech recognition.

As described herein various exemplary techniques can be used to optimize CDHMM parameters for applications such as speech recognition or more generally pattern recognition.

An exemplary method for optimizing a continuous density hidden Markov model CDHMM includes imposing a constraint for discriminative training approximating an objective function as a smooth function of CDHMM parameters and performing a constrained line search on the smoothed function to optimize values of the CDHMM parameters. Various other methods devices and systems are disclosed.

An exemplary optimization method is referred to as a constrained line search CLS for discriminative training DT of Gaussian mixture continuous density hidden Markov models CDHMM .

In the conventional approach an optimization block minimizes or maximizes the formulated objective function with respect to a set of CDHMM parameters see e.g. Background section . In this approach a specification block specifies an initial point an iteration block determines a search direction and a step size to move away from the initial point and a location block finds a locally optimal point.

In the exemplary approach an imposition block imposes a constraint for discriminative training DT based on Kullback Leibler divergence KLD between models e.g. parameter values for an initial model and parameter values for an updated model . The imposition block essentially casts discriminative training DT of the CDHMM as a constrained maximization problem where the constraint guarantees that an equalized updating process occurs across all parameters in a model set. Next an approximation block approximates the objective function as a smooth function of CDHMM parameters. As described in more detail below based upon reasonable approximations closed form solutions can be obtained for CDHMM parameters. To find a locally optimal point representative of CDHMM parameter values a search block performs a constrained line search CLS on the smoothed function of the CDHMM parameters. As explained below given a line search and some approximation assumptions manageable closed form solutions can be derived for CDHMMs. The exemplary method can be used to optimize all model parameters in Gaussian mixture CDHMMs including mean vectors covariance matrices mixture weights.

Trial results are presented for several benchmark speech recognition tasks including TIDIGITS Resource Management RM and Switchboard. Results indicate that the exemplary training method significantly outperforms the popular conventional EBW extended Baum Welch method in all tasks in terms of recognition performance and convergence behavior.

As mentioned an exemplary optimization method is referred to as a CLS for DT of Gaussian mixture CDHMMs. As a general optimization method under a unified framework such an exemplary CLS method is capable of optimizing most DT objective functions which are derived from one or more popular DT criteria in speech recognition such as MMI MCE MPE or MWE and so on. In a particular aspect a manageable closed form optimization formula can be derived to efficiently update all parameters of Gaussian mixture CDHMMs including mean vectors covariance matrices and mixture weights.

In the method the imposed constraint is based upon the nature that all the statistics are only reliable in a neighborhood of the original model. Under this constraint the objective function can be approximated as a smooth function of CDHMM parameters and the sole critical point if it exists can be easily obtained by vanishing its derivative to zero. This is the role of the decision block of the method which is followed by a CLS to solve the constrained optimization problem.

As shown with respect to the blocks subject to the KLD constraint the line search is performed either along the line joining the initial model and the critical point of the smoothed objective function if the critical point exists the block or along the gradient direction at the initial point if the critical point does not exist the block .

According to the method a closed form solution can be derived to solve a KLD constrained optimization as long as formulation or approximation of the KLD constraint occurs in an appropriate way. Constrained optimization relies on the fact that statistics in DT only remain reliably when models stay close to their original points. Unlike in Maximum Likelihood ML training it is hard to find an auxiliary function along with which the original objective is guaranteed to increase. Hence the exemplary method constrains distortion of models by KLD which is a statistically sound distribution similarity measure.

Through use of a CLS some degree of control is introduced for updating every model to be equalized and an entire training process can be more stable and effective.

As described with respect to the trials an exemplary method has been used to optimize the MMI as well as other DT objectives in several speech recognition tasks including the connected digit string recognition using TIDIGITS database the resource management RM task and a large vocabulary recognition in the Switchboard task. Results show that an exemplary line search method can significantly outperform the conventional EBW method in all evaluated ASR tasks in terms of final recognition performance and convergence behavior.

Various exemplary techniques are described in more detail below generally as follows a technique to formulate the discriminative training as a KLD based constrained optimization problem under a unified framework a constrained line search technique to solve a constrained optimization problem for DT application of techniques to CDHMMs and various associated algorithms. Formulation of KLD Constraint

DT criteria for a speech recognition model may assume that an acoustic model set is composed of many individual Gaussian mixture CDHMMs each of which is represented as A B where . . . is the initial state distribution and N is the number of states in the HMM A ais the transition matrix and B is the state output distribution set composed of Gaussian mixture distributions for all state i b x x where B 1 k K with K standing for the number of Gaussian mixture components in each state and x represents a multivariate Gaussian distribution with mean vector and covariance matrix .

For any training utterance X and its transcription W consider how to compute an acoustic model score p X W based on the composite HMM of W. Suppose X X X . . . X let s s s . . . s be any possible unobserved state sequence and l l l . . . l be the associated sequence of the unobserved mixture component labels. Thus p X W is computed as Equation 1 Eq. 1 

Assume the whole training set consists of R different training utterances X X . . . Xalong with their corresponding transcriptions denoted as W W . . . W. For a unified view to represent various discriminative training criteria the objective functions of CDHMMs derived from various discriminative training criteria can be formulated as the following form as Equation 2 Eq. 2 

For constrained optimization for discriminative training substitution of Eq. 1 into Eq. 2 yields a general DT objective function F . In this example the function is a highly complicated nonlinear function which is extremely difficult to optimize directly. An exemplary approach to smooth this function can make the following assumptions i assume that all competing hypothesis spaces remain unchanged during optimization ii use a sufficiently small scaling factor 

To solve the constrained optimization problem cast above an exemplary approach uses a constrained line search CLS algorithm. The algorithm decomposes an optimization procedure into two steps. A first step involves determining an appropriate search direction to provide a direction to search for an optimal point. In a second step searching occurs along the direction for an optimal linear inter extrapolation factor which aims to maximize the objective function subject to the KLD constraint.

For purposes of explanation any model parameter may be denoted and its corresponding initial value in a current iteration denoted . In the first step the best search direction is selected. Assuming the objective function F is differentiable the critical point if it exists can be obtained by vanishing F to zero. Furthermore if is not a saddle point it is reasonable to choose the line joining the critical point and the original point i.e. to as the search direction. Otherwise when the critical point is a saddle point or if the critical point does not exist the following approach adopts the gradient F F as the search direction. The search direction can be selected according to Equation 4 Eq. 4 

In the second step the constrained optimization problem in Eq. 3 can be reformulated as Equation 5 Eq. 5 a constrained search problem in a scalar space 

In general such a constrained line search problem should be solved iteratively. However according to an exemplary technique if the constraint possesses the following quadratic form of Equation 6 Eq. 6 

where is a positive definite matrix then the constrained line search problem can be solved directly. For conciseness of this explanation Q is introduced to express a quadratic form.

In the instance a solution can be obtained by finding the crossing point of the line space and the boundary of the trust region or equivalently solving D d with respect to . By substituting Eq. 6 into this Equation 7 Eq. 7 results where roots can be represented as 

An analysis of all the cases and boundary conditions provides a closed form solution for CLS with quadratic constraint. and present graphics representing four cases Case and .

A general solution for CLS with quadratic constraints has been explained. This exemplary approach can be applied to provide a solution to parameters of Gaussian Mixture CDHMMs. Such an approach solves two problems First how to decompose constraints to update mean covariance and Gaussian weights separately and then reasonably approximate the constraints by quadratic forms and second how to obtain the critical points and corresponding conditions for example as listed in Table .

It is reasonable to apply the KLD constraint to the Gaussian mixture model of each state. For the istate it can be written as D b b 

where the transpose of vector wdenotes discrete distribution composed of all the Gaussian kernel weights in the istate and where the vector eincludes .

For KLD between two discrete distributions or two Gaussians the Equation 9 Eq. 9 represents closed form solutions 

Based upon a basic assumption of CLS the model parameters cannot run far away from their initial point. Given this assumption the Taylor series approximation is applied to derive quadratic constraints for variances and weights. Consider an example that assumes a covariance matrix that is diagonal. To guarantee the covariance is positive definite alternatively update the following vector logarithm domain log . . . log . Based upon the second order Taylor series approximation e y 1 y 2 and denoting y log provides Equation 11 Eq. 11 

Accordingly all the constraints possess the form in Eq. 6 and general solutions can be applied directly for means variances and Gaussian weights.

An exemplary technique determines a search direction for parameters of Gaussian mixture CDHMMs. According to this technique critical points are derived based upon the general DT framework of Eq. 2 then concrete forms of the search directions for mean variance and Gaussian weights are given.

According to the general assumptions in DT the derivative of the objective function of Eq. 2 can be derived with respect to any model parameter and it can be represented as 

To verify the effectiveness of an exemplary CLS optimization method trials were performed on several benchmark speech recognition tasks including connected digit string recognition using the TIDIGITS database continuous speech recognition using the Resource Management RM database and large vocabulary continuous speech recognition using the Switchboard both the mini train set and full h5train00 training set database. Trial setups are summarized in Table of . In the trials the trial exemplary CLS method was compared to a conventional EBW method for the criterion of MMI and other criteria with higher error resolution such as MPE and MD. For all trials using EBW kernel dependent smoothing factor was set to twice of the corresponding denominator occupancy. When applying EBW to MPE training I smoothing was used with a factor set to 100 in each iteration. Some of the trial recognition results are summarized in Table of . Additional results are summarized in Table of .

The computing device shown in is only one example of a computer environment and is not intended to suggest any limitation as to the scope of use or functionality of the computer and network architectures. Neither should the computer environment be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the example computer environment.

With reference to an exemplary system for implementing an exemplary optimization technique for speech recognition or other tasks that may rely on CDHMMs. In a very basic configuration computing device typically includes at least one processing unit and system memory . Depending on the exact configuration and type of computing device system memory may be volatile such as RAM non volatile such as ROM flash memory etc. or some combination of the two. System memory typically includes an operating system one or more program modules and may include program data . This basic configuration is illustrated in by those components within dashed line .

The operating system may include a component based framework that supports components including properties and events objects inheritance polymorphism reflection and provides an object oriented component based application programming interface API such as that of the .NET Framework manufactured by Microsoft Corporation Redmond Wash.

Computing device may have additional features or functionality. For example computing device may also include additional data storage devices removable and or non removable such as for example magnetic disks optical disks or tape. Such additional storage is illustrated in by removable storage and non removable storage . Computer storage media may include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. System memory removable storage and non removable storage are all examples of computer storage media. Thus computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computing device . Any such computer storage media may be part of device . Computing device may also have input device s such as keyboard mouse pen voice input device touch input device etc. Output device s such as a display speakers printer etc. may also be included. These devices are well know in the art and need not be discussed at length here.

Computing device may also contain communication connections that allow the device to communicate with other computing devices such as over a network. Communication connection s is one example of communication media. Communication media may typically be embodied by computer readable instructions data structures program modules or other data storage structure. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. The term computer readable media as used herein includes both storage media and communication media.

Various modules and techniques may be described herein in the general context of computer executable instructions such as program modules executed by one or more computers or other devices. Generally program modules include routines programs objects components data structures etc. for performing particular tasks or implement particular abstract data types. These program modules and the like may be executed as native code or may be downloaded and executed such as in a virtual machine or other just in time compilation execution environment. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments.

An implementation of these modules and techniques may be stored on or transmitted across some form of computer readable media. Computer readable media can be any available media that can be accessed by a computer. By way of example and not limitation computer readable media may comprise computer storage media and communications media. 

An exemplary computing device may include a processor a user input mechanism e.g. a mouse a stylus a scroll pad etc. a speaker a display and control logic implemented at least in part by the processor to implement one or more of the various exemplary methods described herein for speech recognition. For speech recognition such a device may be a cellular telephone or generally a handheld computer.

One skilled in the relevant art may recognize however that the techniques described herein may be practiced without one or more of the specific details or with other methods resources materials etc. In other instances well known structures resources or operations have not been shown or described in detail merely to avoid obscuring aspects of various exemplary techniques. While various examples and applications have been illustrated and described it is to be understood that the techniques are not limited to the precise configuration and resources described above. Various modifications changes and variations apparent to those skilled in the art may be made in the arrangement operation and details of the methods systems etc. disclosed herein without departing from their practical scope.

