---

title: Method and apparatus for restoring a table in a database
abstract: A method and apparatus for restoring table data using one or more restoration commands, where the one or more restoration commands are generated at the time a backup of a database comprising the table data is created. The disclosed restoring of table data comprises identifying table data after completion of a backup process on the database and generating one or more commands for restoring the table data where the one or more restoration commands are generated prior to a request to restore the table data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08874519&OS=08874519&RS=08874519
owner: Symantec Corporation
number: 08874519
owner_city: Mountain View
owner_country: US
publication_date: 20071218
---
Embodiments of the present invention generally relate to database systems and more particularly to a method and apparatus for restoring a table in a database.

A Structured Query Language SQL is commonly used to process and store data in a database e.g. a relational database . Numerous versions or extensions of SQL are available such as Transact SQL T SQL . Various types of SQL commands e.g. insert delete update and the like are used to interact with a management system of the database. Such SQL commands may be embedded within a program and executed as needed. For example an Application Programming Interface API comprising functions and objects implemented in SQL including T SQL are utilized to operate and control the database.

The database comprises one or more tables where each table includes one or more rows of table data. Occasionally a user of a database may accidentally lose delete or incorrectly modify a single table in the database. In other instances the single table is lost due to a minor flaw or error within the database. In either case the single table must be efficiently restored in order to prevent delays and or decreases in productivity of the user.

Currently restoring the single table from the database is an inefficient and cumbersome process because the entire database must be restored before the single table can be restored. Additionally the restoration process is initiated after the user informs the database administrator that the single table has been accidentally deleted lost or modified incorrectly. Before the re insertion process can be executed the database administrator must create a program that locates strips and formats all of the table data in a backup image. At this point the program generates a restore script using Transact SQL T SQL insert commands to restore the table data from the single table. The restore script uses the T SQL insert command to reinsert the table data into the database row by row.

Accordingly the generation of the restore script for the single table is reactive but not proactive. In other words the database administrator must wait for the user to request restoration of the single table before generating the restore script. Overall a considerable amount of time and resources is used to generate the restore script after the request from the user.

Therefore there is a need in the art for a method and apparatus for efficiently restoring a table in a database.

Embodiments of the present disclosure generally comprise a method and apparatus for restoring a table in a database. In one embodiment a method for restoring table data comprises identifying table data after completion of a backup process and generating at least one command for restoring the identified table data where the at least one command is generated prior to a request to restore the identified table data. Embodiments of the invention further include an apparatus for performing the foregoing method.

While the invention is described herein by way of example using several embodiments and illustrative drawings those skilled in the art will recognize that the invention is not limited to the embodiments of drawing or drawings described. It should be understood that the drawings and detailed description thereto are not intended to limit the invention to the particular form disclosed but on the contrary the invention is to cover all modification equivalents and alternatives falling within the spirit and scope of the present invention as defined by the appended claims. The headings used herein are for organizational purposes only and are not meant to be used to limit the scope of the description or the claims. As used throughout this application the word may is used in a permissive sense i.e. meaning having the potential to rather than the mandatory sense i.e. meaning must . Similarly the words include including and includes mean including but not limited to.

The database generally stores data for the client computer in the form of a plurality of tables where each table includes one or more rows of table data . The plurality of tables may be organized in accordance with a schema where the schema defines the relationships between two or more tables. For example a first table comprising name data and address data is related to a second table comprising the name data and phone data because both tables use the name data as an index to other data in the tables.

The network comprises a communication system that connects a computer system by wire cable fiber optic and or wireless links facilitated by various types of well known network elements such as hubs switches routers and the like. The network may employ various well known protocols to communicate information amongst the network resources. For example the network may be part of the Internet or intranet using various communications infrastructure such as Ethernet WiFi WiMax General Packet Radio Service GPRS and the like.

The DBMS comprises a Central Processing Unit CPU various support circuits and a memory . The DBMS generally includes software designed to manage data stored within the database . The CPU may comprise one or more commercially available microprocessors or microcontrollers that facilitate data processing and storage. Various support circuits facilitate operation of the CPU and may include clock circuits power supplies input output circuits and or the like. The memory includes a read only memory random access memory disk drive storage optical storage removable storage and the like. The memory includes various data such as a backup image . The memory includes various software packages such as a backup module and a restore module . Generally the backup image is a data repository where data from the plurality of tables of the database that has been backed up is stored and maintained. The backup image comprises table data stored by the backup module during execution of a backup process on the database . The memory also includes various scripts associated with the database such as a restore script . The restore script comprises a plurality of commands generated by the restore module .

The backup module initiates the execution of the backup process on the database . The backup process creates a copy of the table data in the database for storage in the backup image so that these additional copies may be used to restore the original table data after a data loss event. The data loss event includes destruction and or corruption of the table data caused by an error within the database . For example the user may delete or lose the table data e.g. by accident . In another example the user incorrectly modified the table data within the database and cannot return the table data back to a version devoid of the incorrect modifications.

The restore module is configured to restore the table data and or return the database to a state before the request to restore e.g. the occurrence of the data loss event . The restore module generates the plurality of commands e.g. T SQL commands for reinserting the table data into the database which may have been corrupted or accidentally lost deleted or modified by the user. In one embodiment each of the plurality commands is an INSERT command e.g. a T SQL INSERT command where the INSERT command includes row data of the table data . For example a T SQL command generated by the restore module may be formatted into the following command INSERT Table Name column1 column2 VALUES Row Data1 Row Data2 where Row Data1 and Row Data2 correspond to two separate columns of one row within the table data in the backup image .

In operation the backup module is executed and the table data in the database is stored in the backup image . In one embodiment after completion of the backup process the restore module identifies the table data in the backup image and generates one or more T SQL insert commands e.g. the plurality of commands for reinserting the table data into the database . The T SQL insert commands are executed upon a request to restore the table data . In one embodiment the DBMS automatically detects the request and executes the T SQL insert commands. In another embodiment the DBMS detects the data loss event e.g. error in the database executes the one or more T SQL commands will be executed and restores the table data . As discussed below the restore script comprising the one or more T SQL insert commands will be generated by the restore module after completion of the backup process according to various embodiments of the present invention.

At step the portion of the table data is parsed. In one embodiment the row of the table is separated into one or more columns of row data in accordance with the columns associated with the table data . At step the parsed portion of the table data e.g. the row parsed into one or more columns is formatted into one or more T SQL commands for reinserting the table data . In one embodiment a T SQL command is defined to insert each column of the row data into a corresponding column of the table data in the database. For example the format of the T SQL command may resemble the following INSERT TABLE NAME column1 column2 VALUES Row Data1 Row Data2 . At step a script is generated and stored which includes the one or more T SQL commands. The stored script awaits executions when a need arises to restore the table data. As such embodiments of the invention proactively produce restoration scripts when a backup process is executed. At step the method ends.

While the foregoing is directed to embodiments of the present invention other and further embodiments of the invention may be devised without departing from the basic scope thereof and the scope thereof is determined by the claims that follow.

