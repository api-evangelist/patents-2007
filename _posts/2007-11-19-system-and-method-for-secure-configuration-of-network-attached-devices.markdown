---

title: System and method for secure configuration of network attached devices
abstract: A system and method for supplying, to a provider of the device, requirements for information to be stored on a device, obtaining device data for provisioning the device on a network, storing device configuration information on storage associated with the network, receiving a service request from a user of the device, detecting attachment of the device to the network, authenticating the device utilizing a device identifier and shared credentials to enable the device to be configured without storing a network address for configuration in the device, providing network information to the device, and providing configuration information to the device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09178857&OS=09178857&RS=09178857
owner: VERIZON PATENT AND LICENSING INC.
number: 09178857
owner_city: Basking Ridge
owner_country: US
publication_date: 20071119
---
Devices which connect to a managed network are manufactured containing network specific information in order to obtain configuration and service upon connection to the network. Network information contained in a device may be utilized to gain unauthorized access to one or more network resources or services. Network information provided on a device by a manufacturer such as a Universal Resource Locator URL of a configuration server may be used to obtain improper access to a managed network. Additionally providing a fixed Universal Resource Locator or other fixed network information to configure a device is inflexible and does not enable a managed network to easily change the address of a network resource such as a configuration server if security or reliability require such a change. This limits the ability of a device to connect to a range of networks and provide a range of services.

An exemplary embodiment of the present invention provides a system for secure configuration of one or more network associated devices. The system may enable a service provider or other operator of a managed network to securely authenticate and configure one or more network attached devices.

Referring to system for secure configuration of network attached devices in accordance with an exemplary embodiment is illustrated. Secure configuration system illustrates an exemplary system for secure configuration of network attached devices. It is noted that secure configuration system is a simplified view of a network and may include additional elements that are not depicted. As illustrated managed network may be a local area network LAN a wide area network WAN the Internet cellular networks satellite networks or other networks that permit transmission and or reception of data to and or from network associated devices and network elements. For example managed network may permit transmission and or reception of data to and or from mobile device and computer . Authentication and authorization server may be communicatively coupled to managed network . Authentication and authorization server may authenticate and authorize requested connections from one or more devices attaching to managed network . Devices may attach to a network via a wireless connection or a wired connection. Devices attached to a network may be directly connected or may connect across a local LAN such as a home network via a gateway such as a broadband gateway to a managed network. Configuration server may be communicatively coupled to managed network and may contain configuration information for one or more network attached devices supported by an operator of managed network . Provisioning server may be communicatively coupled to managed network and may receive network data device data service requests and or other data and may facilitate the secure attachment of a device to managed network . DHCP Server may provide one or more dynamic host configuration protocol DHCP services such as Internet Protocol IP configuration services to network attached devices across managed network . User information database may receive store and provide information associated with one or more users of managed network and one or more network services associated with the users. User information database may be communicatively coupled to managed network . Provisioning database may be communicatively coupled to managed network . Provisioning database may store and retrieve information related to one or more functions of provisioning server . Configuration database may store and receive device configuration information and other data related to one or more functions of configuration server . Mobile device may be communicatively coupled to managed network . Mobile device may be a cellular phone a mobile phone a Wireless Fidelity WiFi phone a satellite phone a smart phone a Personal Digital Assistant PDA a computer or other devices capable of receiving and transmitting data to managed network . Authenticators and may be routers radio access points or other network access server devices and may be communicatively coupled to managed network . Computer may access managed network via authenticator or . Radio access point may be a wireless access point a cellular tower a microwave tower or other access point and may be communicatively coupled to managed network . Mobile device may access managed network via authenticator

The various components of secure configuration system as shown in may be further duplicated combined and or integrated to support various applications and platforms. Additional elements may also be implemented in the systems described above to support various applications.

In one or more embodiments managed network may utilize one or more protocols of attached network devices such as mobile device or computer . Managed network may translate to or from other protocols to one or more protocols of attached network devices. Network attached devices may transmit and or receive data to and or from managed network representing authentication and configuration data. The authentication and configuration data may be transmitted and or received utilizing a standard telecommunications protocol or a standard networking protocol. For example one embodiment may utilize Extensible Authentication Protocol EAP Request For Comments RFC 3748 Extensible Authentication Protocol for Authentication and Key Agreement EAP AKA Request For Comments RFC 4187 or Extensible Authentication Protocol Transport Layer Security EAP TLS Request For Comments RFC 2716 . In other embodiments the authentication and configuration data may be transmitted and or received utilizing the Remote Authentication Dial In User Service RADIUS protocol the DIAMETER protocols or other authentication authorization and accounting AAA protocols. Additionally Dynamic Host Configuration Protocol DHCP other Transmission Control Protocol Internet TCP IP Protocols or other protocols suitable for transmitting and receiving authentication and configuration data may be utilized. Data may be transmitted and received wirelessly may utilize cabled network or telecom connections such as an Ethernet RJ45 Category 5 Ethernet connection a fiber connection a traditional phone wireline connection a cable connection or other wired network connection. Network attached devices may use standard wireless protocols including IEEE 802.11a 802.11b and 802.11g. Network attached devices may also be connected to managed network via protocols for a wired connection such as IEEE Ethernet 802.3.

Network elements such as authentication and authorization server configuration server provisioning server and DHCP server may be one or more servers or server like devices such as an application server or a network server. Network elements may include one or more processors not shown for recording transmitting receiving and or storing data. Although network elements are depicted as individual servers it should be appreciated that the contents of a network element may be combined into fewer or greater numbers of servers or server like devices and may be connected to one or more data storage systems. For example authentication and authorization server may be connected to one or more servers containing subscription information user equipment information account information or authentication information. Furthermore the server may be local remote or a combination thereof to authentication and authorization server . Additionally portions of authorization server functionality may be implemented on a network element such as authenticators and

Network elements may provide application programming interfaces APIs interface tables remote procedure calls RPCs web services Extensible Markup Language XML based interfaces Simple Object Access Protocol SOAP based interfaces and other interfaces for sending or receiving event information.

Provisioning server may be a server an application server a network server or other network element capable of accepting network and service data from a network operator device data from one or more device providers and or service requests from one or more devices associated with users of managed network . Provisioning server may receive transmit and process data required to provide service features and options to one or more users of managed network such as network parameters and values related to one or more services. Provisioning server may also receive transmit and process data related to addresses for network elements. A network operator service provider or other administrative user of managed network may enter such network and or service related data. Provisioning server may store and retrieve data from provisioning database user information database and or configuration database . Provisioning database user information database and or configuration database may be combined or there may be multiple instances or implementations of such databases. One or more additional databases may be utilized by provisioning server .

Provisioning server may also be utilized by a device manufacturer or a provider or vendor of devices which are to be attached to managed network or another third party user who is known and trusted by an operator of managed network . The device provider who may be the same as a network operator or service provider may provide information to provisioning server about one or more devices to be attached to managed network . For example provisioning server may receive information about a device to be attached to the network including a unique device identifier the model the model number the device features the device capabilities such as Compressor Decompressors CODECs utilized by the device and other device related information which may be used to provide one or more services to the device. Provisioning server may utilize this information to form one or more network policies for the device such as a policy for managing the bandwidth of a home network through which that device may be connecting. Provisioning server may receive information regarding an encryption key or other data for cryptographic methods contained on a device such as an encryption key specified by the device manufacturer or contained in the device s digital certificate. Such an encryption key may enable provisioning server to establish a shared secret with the device.

Provisioning server may also receive from a provider of a device such as mobile device information about DHCP support provided by the device and or DHCP requirements of the device. DHCP information may include options sub options and syntax of DHCP supported or required by the device. DHCP information may be utilized by provisioning server to provide device configuration information to the device. For example provisioning server may utilize information about the DHCP capabilities of a device to provide one or more Universal Resource Locators URLs to the device to access configuration files and network resources on managed network . Provisioning server may also utilize DHCP information about a network attached device to provide support for other services such as enhanced 911 E911 support for a mobile phone. Provisioning server may utilize DHCP information about a network attached device to enable a configuration server such as configuration server to establish a secure connection from a device to a configuration server. Secure connections may be established utilizing Secure Sockets Layer SSL Transport Layer Security TSL or other cryptographic or secure protocols.

A customer may provide service request or order information which may be received by a network operator a service provider and or a trusted third party. The service request or order information may include the type of service or features ordered or other service details. This information may be received by provisioning server . The customer a trusted third party an installer or a service provider installing equipment may provide a unique device identifier associated with the device which may be a Medium Access Control MAC address an Organizationally Unique Identifier and a serial number OUI Serial an International Mobile Subscriber Identity a username or other identifier.

Authenticator may represent customer premise equipment CPE such as a Digital Subscriber Line DSL router a cable modem a Wireless Fidelity WiFi access point a residential gateway a router or other network element capable of supporting authentication services. In some embodiments authenticators and may contain multiple functions such as network address translation DHCP authentication and authorization and other functionalities. Authenticator may detect when a network attached device such as computer has been connected to the network. Authenticator may receive a device identifier such as the Medium Access Control MAC address of the device. Authenticator may then forward the device identifier to authentication and authorization server . Authenticator may forward responses to authentication and authorization server from a network attached device seeking to be authenticated in response to a request for authentication. Authenticator may then allow or deny the transmission of data between the network attached device and the network. Authenticators such as authenticator and may deny the transmission of data by dropping packets from unauthenticated devices.

Authentication and authorization server may be a server an application server a network server or other network element capable of authenticating and authorizing requested connections from one or more devices attaching to managed network . Authentication and authorization server may receive authentication information from an authenticator such as authenticators and . Authentication and authorization server may utilize authentication information to query one or more databases such as user information database and or provisioning database . Authentication and authorization server may communicate with one or more databases utilizing the RADIUS protocol the DIAMETER protocol or other authentication authorization and accounting protocols. Authentication and authorization server may receive credentials from one or more databases which may include a shared secret key and may request credentials from one or more network attached devices seeking to authenticate. Credentials provided by a network attached device may include a device identifier a digital certificate or other security mechanism. In some embodiments authentication may utilize Ethernet layer 2 communications. In one or more embodiments authentication may utilize Extensible Authentication Protocol EAP Request For Comments RFC 3748 Extensible Authentication Protocol for Authentication and Key Agreement EAP AKA Request For Comments RFC 4187 Extensible Authentication Protocol Transport Layer Security EAP TLS Request For Comments RFC 2716 or other Extensible Authentication Protocol standards. Once credentials are received authentication and authorization server may attempt to authenticate and authorize the network attached device. If authorization and or authentication fails then network connectivity may be denied to the network attached device. If authentication and or authorization succeeds the network attached device may receive network and configuration information.

Configuration server may be a server an application server a network server or other network element capable of providing configuration information for one or more network attached devices supported by an operator of managed network . Configuration server may provide one or more files for configuring network attachable devices supported by an operator of managed network . Configuration server may be accessed by an URL a fully qualified domain name an IP address or another network address provided to a device by DHCP Server or another network entity. Configuration server may connect to one or more devices using Secure Sockets Layer SSL Transport Layer Security TSL or other cryptographic or secure protocols.

DHCP server may provide IP configuration services to one or more devices attached to managed network . The association of a device identifier such as a MAC address with user service information and or hardware and software configuration of the device may be stored in one or more databases such as provisioning database or configuration database . DHCP server may receive this information from provisioning server or from another network element and may utilize this information to determine what DHCP support a device provides what configuration information a device requires and other service specific and device specific configuration details. DHCP server may provide information to a device on the parameters and options required by a service. DHCP server may also provide network addresses such as Universal Resource Locators URLs of one or more configuration servers such as configuration server to the device. DHCP provided configuration information may include host name an IP address a lease time a subnet mask a default gateway a Network Time Protocol Server address a Domain Name Server address a broadcast address a Domain Name and other information that may be used to configure the network attached device such as computer .

At block a network operator a service provider or a trusted third party may provide one or more requirements to manufacturers providers or vendors of devices in order to access a managed network such as managed network and to become configured for service. The one or more requirements may include a cryptographic key an encryption key a digital certificate and other security features which may be specified by a managed network operator or service provider. The one or more requirements may include a unique device identifier such as a MAC address or other unique device identifiers. Requirements for device contained information may be reduced by the ability to authenticate a device based on a unique device identifier and an encryption key. This may improve network security by reducing network information provided on devices. This may additionally reduce manufacturing costs and may improve device configuration and authentication flexibility.

At block a managed network operator or service provider may obtain device data for provisioning. A manufacturer of a device vendor of a device or a trusted third party may be given access to a provisioning system such as one provided by provisioning server . The manufacturer or other party may then enter device data obtained for provisioning the device on a network which may include one or more of an unique device identifier an encryption key a device manufacturer a device model number a device class the hardware capabilities of the device the software capabilities of the device DHCP support enabled by the device and authentication protocol requirements of the device.

At block a service provider or an operator of a managed network may make device configuration information available on the network based on device information received from a vendor or manufacturer of the device service information known to the service provider or network operator and other factors. The device configuration information may be stored in one or more network databases such as provisioning database configuration database and other databases. The device configuration information may be accessible to one or more network elements such as authentication and authorization server configuration server DHCP server and provisioning server .

At block a service request may be received from a user. A service request may be an order for service to an operator of a managed network or a service provider. A service request may enable a provisioning system such as provisioning server to obtain information about the type of service and service options ordered by the user from a service provider associated with the network.

At block a device may be provided to a user. A device may be distributed by an operator of a managed network such as an installer who may distribute a device to a customer. A device may also be sold leased given or otherwise distributed to a user by a vendor a manufacturer a reseller or a third party. For example a user may buy a mobile phone from a service provider that may be configured or burned in by the service provider with an encryption key. A device may also be configured or manufactured with a unique device identifier. In another example a device such as a set top box STB or a broadband gateway may be distributed leased or sold to a user and may be distributed leased or sold as part of a service plan.

At block a network element on a managed network may detect the attachment of a device. For example authenticator which may be a device previously authenticated and trusted by the network may detect the attachment of computer . Authenticator may represent a broadband gateway or other customer premise equipment. Authenticator may represent a network element within a radio access network which may be a device previously authenticated and trusted by the network and which may detect the attachment of mobile device . Communication between a device and an authenticator may utilize a layer two or data link layer protocol such as Ethernet. Communication may utilize Extensible Authentication Protocol EAP Request For Comments RFC 3748 Extensible Authentication Protocol for Authentication and Key Agreement EAP AKA Request For Comments RFC 4187 or Extensible Authentication Protocol Transport Layer Security EAP TLS Request For Comments RFC 2716 or other EAP related protocols. An authenticator such as authenticator or may prevent transmission of Ethernet frames or other communication of a device to network entities on managed network until the device is authenticated and authorized. Authentication at a lower network layer such as layer two may provide increased security.

At block the device may be authenticated and or authorized. As described in more detail in reference to an authenticator may detect network access by a device and may begin an authentication process. The authentication process may utilize a device identifier and an encryption key provided by the device and may use these credentials to authenticate the device. The authentication process may utilize an authentication server such as authorization and authentication server and may utilize previously provided information such as the device identifier which may be stored in one or more networked databases. In some embodiments authorization may include verifying one or more details related to a service request prior to authentication. In some embodiments authentication may occur prior to any authorization processing.

At block the method may determine whether the device is authenticated and or authorized. If authenticated and or authorized the method may proceed to block . If authentication and or authorization is denied the method may end at block and the device may not be sent data. Data sent by the device may be discarded.

At block the information and or restrictions may be provided to a device prior to its addressing and configuration. For example bandwidth available to a device may be limited based on a device type or service type. Other transmission characteristics permitted for device may be managed. Additionally network traffic of a device may be directed to a network element prior to addressing and configuration of the device.

At block network traffic of a device may be directed to a network element for verifying antivirus information an operating system version an operating system patch level a device status or other device information. Other device hardware and software checks may be performed prior to addressing and configuration of the device.

At block a device may be provided with network address and configuration information. Network information to the device includes providing at least one of a host name an IP address a lease time a subnet mask a default gateway a Network Time Protocol Server address a Domain Name Server address a broadcast address a Domain Name and other information that can be used to configure the network attached device. Device configuration files may also be provided. Such network information may be provided by a DHCP server such as DHCP server using information which may be associated with the device identifier and stored in databases. DHCP server may use information associated with the device identifier and may provide address and protocol information for communication with a configuration server . Configuration information may be provided by a configuration server such as configuration server which may have been obtained at block .

The steps of method may occur in varying order. The prior description of method is an exemplary embodiment and is not intended to limit the order or number of steps in the method. For example a device may be provided to a user prior to a service request being received from a user. In some embodiments certain authorization steps may occur prior to authentication. In other embodiments authentication may occur prior to any authorization steps.

At block a network element on a managed network such as managed network may detect the attachment of a device such as computer to the network. Detection of a device attached to a managed network may occur at an authenticator device such as authenticator or . Detection and authentication may be performed by an authenticator which may be a trusted network device which has previously been authenticated by a managed network. For example this may enable the authentication to occur close to the location of the attached device such as at a customer premise a branch office a local store or other location. Authentication at this level may prevent the transmission of Ethernet traffic by an attached device across a managed network until the device is authenticated. Additionally an authenticator device may be located at a service provider or network operator centralized location. In one or more embodiments detection may occur at a centralized network element such as authorization and authentication server . In some embodiments detection may cause a previously authenticated device which may detect the attachment to message one or more network elements for authentication of the unauthenticated device.

At block an authenticator such as authenticator or may request identification such as a device identifier from the attached device. The device identifier request may be received by the attached device. In one or more embodiments the device may offer a unique device identifier upon attachment of the device to the network.

At block a device identifier may be provided by the attached device. The device identifier may be a Medium Access Control MAC address an Organizationally Unique Identifier and a serial number OUI Serial an International Mobile Subscriber Identity a username or other identifier.

At block an authenticator such as authenticator or may query an authentication and authorization server such as authentication and authorization server . In one or more embodiments an authenticator such as authenticator or may perform one or more functions of authentication and authorization server .

At block authentication and authorization server and or authenticator or may query provisioning database user information database or other databases or servers to verify that a device identifier is known. The device identifier may be used to retrieve credentials or other information such as service or device information associated with the device identifier. In one or more embodiments the authentication and authorization of the device may be determined by rules using credentials and network operator policy information. For example if a device attempts to authenticate in an invalid location a location for which service is not authorized network operator policy may deny service requests without attempting to authenticate the device. In another example a device may be denied access based on account information such as a delinquent account balance. Additionally one or more policies enforced by authentication and authorization server may enable a network to ensure a device s location and may facilitate E911 services. If the device identifier is not known or does not exist or cannot otherwise be verified by authentication and authorization server and or authenticator or the method may end at block . If the device identifier is known or otherwise verified the method may continue at block .

Authentication communication may utilize Extensible Authentication Protocol EAP Request For Comments RFC 3748 or other EAP related protocols may be utilized. Authentication communication may utilize Extensible Authentication Protocol for Authentication and Key Agreement EAP AKA Request For Comments RFC 4187 for shared secrets. Other types of key management may be used. For example digital certificates may be utilized and communication between an authentication server and an attached device may utilize Extensible Authentication Protocol Transport Layer Security EAP TLS Request For Comments RFC 2716 .

At block authentication and authorization server and or authenticator or may request authentication information from the attached device using such protocols. The response may be generated by the device and may use an algorithm indicated in the protocol. The response may be generated using cryptographic or heuristic methods. The device may use the algorithm to compute the response to the authorization server and may utilize a device identifier a cryptographic key encryption key and other device contained information.

At block authentication and authorization server and or authenticator or may receive a response from the attached device.

At block authentication and authorization server and or authenticator or may validate the credentials using the information received from an attached device. The authentication and authorization server may compute credentials using the same algorithm and information as the device. If the authentication and authorization server computed value matches the value in the device response then the credentials may be deemed valid. If credentials are validated by authentication and authorization server and or authenticator or method may continue at block . If no response is received from a device method may continue at block . If a response is received but the credentials are not validated method may also continue at block .

At block authentication and authorization server and or authenticator or may utilize one or more authorization rules or authorization policies to determine if a device is authorized to obtain one or more services or access to a network. Authorization for access for a device may depend on one or more factors including an identity of a device a type of device a service type requested by the device a location of the device the network to which the device is attached a time of the request an account status of an account associated with the device a network status or other policy or rule specified factors. If the device is authorized the method may continue at block . If the device is not authorized method may continue at block .

At block authentication and authorization server and or authenticator or may allow a network connection between an attached device and managed network . The device may subsequently receive addressing and configuration information using information stored in databases for this device identifier such as customer service network and device associated information.

At block authentication and authorization server and or authenticator or may deny a network connection to one or more devices for which authentication has failed. In one or more embodiments error messages or other information may be provided to the one or more devices.

At block authentication and authorization of the device may trigger the system to locate a server for IP addressing and DHCP configuration. At block the IP network addressing domain may be determined from the subscriber data associated with the device and may be used to determine the DHCP server which may respond to queries from the device for IP configuration. Subscriber data may have been obtained for example in block of method and may have been associated with the device and stored in network accessible databases.

The process of method which may authenticate and or authorize the device may assure that the MAC address of the device is a trusted address. The MAC address may be used to identify the device in order to securely use the DHCP protocol for communication with and or configuration of the device.

At block a DHCP server may be provided with the MAC address for the device which may be associated with its unique device identifier. The DHCP server may be provided with the network information for the device including at least one of a host name an IP address a lease time a subnet mask a default gateway a Network Time Protocol Server address a Domain Name Server address a broadcast address a Domain Name and other information that can be used to configure the network attached device. The DHCP server may be preconfigured with one or more portions of the information.

At block the DHCP server may be provided with protocol requirements and an address or addresses which may enable the device to communicate with one or more configuration servers.

At block the device may request information from the DHCP server. At block the DHCP server may send information to the device. The device and server may communicate until the required data is exchanged. Information provided by one or more DHCP servers may be modified to support a type of device requesting service a type of service requested user subscription information load balancing redundancy or reliability concerns or for other purposes. For example a DHCP server may provide from one pool of network addresses to a device if the device is requesting telecommunications services from a second pool of addresses to a device if it is requesting video services or from a third pool of addresses if a device is requesting data services. The flexibility of the DHCP based configuration process may enable a service provider to more easily adapt to network loads outages support of new devices support of new services and other needs.

At block the device may use one or more addresses provided by the DHCP server to locate and contact one or more configuration servers.

At block the device may communicate with one more configuration servers to obtain data to enable the device to deliver one or more services to a customer.

In the preceding specification various preferred embodiments have been described with reference to the accompanying drawings. It will however be evident that various modifications and changes may be made thereto and additional embodiments may be implemented without departing from the broader scope of the invention as set forth in the claims that follow. The specification and drawings are accordingly to be regarded in an illustrative rather than restrictive sense.

