---

title: System and method for blind estimation of multiple carrier frequency offsets and separation of user signals in wireless communications systems
abstract: A system and method for blind estimation of carrier frequency offsets (CFOs) and separation of user signals in wireless communications systems are provided. Blind estimation of CFOs (i.e., without knowledge of the conditions of the transmitter or the transmission medium/channel) is carried out in order to improve reception quality by a wireless communications device. A received RF signal is over-sampled by a pre-defined over-sampling factor, and polyphase components are extracted from the over-sampled signal. The polyphase components are used to construct a virtual receiver output matrix, e.g., a model of the received signal and its associated output matrix. System response conditions are blindly estimated by applying a blind system estimation algorithm to the virtual receiver output matrix. A plurality of CFO estimates are obtained from the estimated system response conditions, and can be used by an equalizer to adjust receiver parameters in accordance with the CFO estimates so as to maximize reception quality and to extract multiple user signals from the received signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07929937&OS=07929937&RS=07929937
owner: The Trustees of Princeton University
number: 07929937
owner_city: Princeton
owner_country: US
publication_date: 20071024
---
The present invention was made with government support under National Science Foundation Grant Nos. ANI 03 38807 CNS 06 25637 and CNS 04 35052 and Office of Naval Research Grant No. ONR N 00014 07 1 0500. Accordingly the Government has certain rights to the present invention.

The present invention relates to wireless communications systems and more particularly to a system and method for blind estimation of multiple carrier frequency offsets and separation of user signals in wireless communications systems.

In wireless communications systems carrier frequency offsets CFOs represent a severe problem which can make data transmission highly unreliable. CFOs are often caused by two different factors namely carrier frequency mismatches between local oscillators transmit and or receive of transceiver equipment and Doppler shifts caused by moving transceiver equipment e.g. mobile cellular telephones . Carrier frequency mismatches occur when transmitter and receiver local oscillators experience drifts from their nominal frequencies resulting in an offset. In multiple antenna systems each transmitter and receiver typically requires its own radio frequency intermediate frequency RF IF chain resulting in each transmitter receiver pair having its own CFO and associated mismatch parameter. This multiple frequency offset can occur in wireless sensor networks as well as in multi user and multi antenna communications systems where multiple transceivers positioned spatially apart from each other are provided and do not share RF IF chains.

In mobile wireless systems Doppler shift of the received signal spectrum arises from relative motion between two transceivers e.g. motion of a cellular telephone with respect to a base station . This shift depends on the carrier frequency the velocity of the mobile terminal and the angle of arrival of the received signal. Often multiple access wireless systems e.g. systems with multiple user signals propagated over a shared communications channel such as in CDMA systems are used in demanding propagation environments with rich scattering and large angle spread. As a result each channel branch introduces its own Doppler shift which requires compensation.

Uncompensated CFOs cause undesired channel variations rotation of the received symbol constellations and interference in adjacent channels. Compensation of CFOs is particularly important in multi user and multi antenna systems where susceptibility to such problems is high. In such systems the received signals represent co channel signals that are mixed because of unknown channel conditions present in the transmission environment.

CFO compensation and signal separation processes are typically performed using training signals. However such systems are impractical in systems with multiple transceiver pairs because of the need to provide a separate training signal for each transmitter receiver pair which is costly and time consuming and reduces the effective data rates. Additionally a multi antenna system is usually required in order to compensate for multiple CFOs and to separate multiple user signals which results in increased hardware costs. Other techniques for compensating for CFOs include decision feedback via a phase locked loop PLL which uses knowledge of the transmitted constellation to adaptively track both the frequency and phase offset between the equalized signal and the known signal constellation blind estimation of CFO and recovery of symbols using second order cyclic statistics of an over sampled received signal and pilot based CFO estimation. However such systems are impractical for CFO compensation and user separation in multi user systems and particularly multi user systems which utilize a single receive antenna.

Accordingly what would be desirable but has not yet been provided is a system and method for blind estimation of multiple carrier frequency offsets and separation of user signals in wireless communications systems which addresses the foregoing limitations of existing wireless systems.

The present invention relates to a system and method for blind estimation of carrier frequency offsets CFOs and separation of user signals in wireless communications systems. The present invention can be implemented as software installed in and executable by a wireless communications device e.g. a cellular telephone a wireless network transceiver a multiple input multiple output MIMO transceiver etc. having a radio frequency RF receiver and one or more receive antennas. The present invention allows for the blind estimation of CFOs i.e. without knowledge of the conditions of the transmitter or the transmission medium channel in order to improve reception quality by a wireless communications device.

A received RF signal is over sampled by the present invention by a pre defined over sampling factor. Polyphase components are then extracted from the over sampled signal. The polyphase components are used to construct a virtual receiver output matrix e.g. a model of the received signal and its associated output matrix. System response conditions are blindly estimated by applying a blind system estimation algorithm to the virtual receiver output matrix. A plurality of CFO estimates are then obtained from the estimated system response conditions and can be used by an equalizer operatively associated with the receiver to adjust receiver parameters so as to maximize reception quality and to extract multiple user signals from the received signal.

The present invention provides a system and method for blind estimation of carrier frequency offsets CFOs and separation of user signals in wireless communications systems. Blind estimation of CFOs is provided i.e. without knowledge of the conditions of the transmitter or the transmission medium channel in order to improve reception quality by a wireless communications device. A received RF signal is over sampled by the present invention by a pre defined over sampling factor and polyphase components are then extracted from the over sampled signal. The polyphase components are used to construct a virtual receiver output matrix e.g. a model of the received signal and its associated output matrix. System response conditions are blindly estimated by applying a blind system estimation algorithm to the virtual receiver output matrix. A plurality of CFO estimates are then obtained from the estimated system response conditions and can be used by an equalizer operatively associated with the receiver to adjust receiver parameters in accordance with the CFO estimates so as to maximize reception quality and to extract multiple user signals from the received signal.

Beginning in step a received radio signal y t is over sampled by an over sampling factor P. The received signal y t represents a continuous time base band signal which can be expressed mathematically as follows 

In order to guarantee that all users pulses overlap at the sampling times the over sampling period should satisfy the condition T P k 1 . . . K which means that the over sampling factor P is upper bounded by T min . . . . If t 1T mT m 1 . . . P 1 denotes the sampling times then the over sampled signal can be expressed as

In steps and P polyphase components are extracted from the over sampled signal. The signal y i i 0 1 . . . of Equation 2 is referred to as the m th polyphase component of y i i 0 1 . . . In step a virtual receiver output matrix is created using the extracted polyphase components. Defining y i y i . . . y i A a a tall matrix of dimension P K tilde over s i s i e . . . s i e and

In step the overall system response is estimated by applying a blind system estimation algorithm to the virtual receiver output matrix created in step . The following assumptions are made in order to estimate the system response 

Under Assumption A2 the rotated input signals tilde over s . are easily verified as also being zero mean i.i.d. and with nonzero kurtosis. Also the tilde over s i s are mutually independent for different k s. Assumption A3 guarantees that the virtual MIMO channel matrix A in Equation 5 has full rank with probability one. If the delays of the users are randomly distributed in the interval 0 T P then each row of the channel matrix can be viewed as having been drawn randomly from a continuous distribution. Thus the channel matrix has full rank with probability one.

In step CFO estimates are calculated using the system response estimate created in step . Any suitable blind source separation algorithm can be applied to the results of Equation 5 to obtain AP 6 Subsequently using any suitable type of equalizer such as a least squares equalizer tilde over i y i e Ptilde over s i or other suitable equalizer an estimate of the user signals can be derived in the form of tilde over circumflex over 7 

If a least squares equalizer is used Equation 7 can be derived by denoting as the k th diagonal element of Arg .

At this point any single CFO estimation method could be applied to tilde over i to compensate for f. An estimate off can be obtained based on the channel matrix estimate. The phase of the channel matrix equals

The de coupled signals tilde over i in Equation 7 are shuffled in the same manner as the estimated CFOs. As a result the estimated CFOs can be used to compensate for the effect of CFO in the de coupled signals in Equation 8 and to obtain estimates of the input signals as i ePs i .

Optionally compensation for residual errors in the estimated CFOs can be obtained by applying a phase locked loop PLL to the recovered signals i in i s i eso as to further mitigate the effect of residuary CFO . For quadrature amplitude modulation 4QAM signals as long as P 

The processing shown in thus allows for the blind estimation of multiple CFOs from a single received signal using one or more receive antennas. This allows for compensation of CFOs without knowledge of the transmitting constellation so as to improve reception performance. The processing of also allows for the separation of individual user signals channels from a single received signal.

The present invention was tested using software simulations wherein the channel coefficients k 1 . . . K are zero mean Gaussian random variables. The waveform p . is the Hamming window. The continuous CFOs were randomly chosen in the range 1 2T 1 2T . The delays T k 1 . . . K were chosen to be uniformly distributed in the range of 0 T P . The input signals were 4QAM signals and the estimation results were averaged over 300 independent channels with 20 Monte Carlo runs for each channel. The blind source separation algorithm used was the JADE method which is available via the Internet at the website http www.tsi.enst.fr cardoso guidesepsou.html.

The performances of known pilots based CFO compensation methods pilots and the present invention blind were tested using different data lengths and signal to noise ratios SNRs were set to 30 dB. For the pilots method each user transmitted a pilot signal of length 32 and the pilots were random sequences uncorrelated between different users. As shown in the mean squares error MSE for the CFO estimator discussed above in connection with Equation 9 is illustrated for different values of the over sampling factor P. The MSE is calculated based on

As shown in computer simulations of bit error rates BER for CFO estimates generated by the present invention versus known pilots based techniques are shown for different values i.e. 2 and 4 of the over sampling factor P. For both the present invention and the pilots based techniques the BER is calculated based on the recovered signals after processing by a PLL. As can be seen the BER performance improves by increasing the over sampling factor P. As a result the present invention is suitable for improving performance in long and short data lengths.

To evaluate the large sample performance of the present invention Cramer Rao lower bounds were established and computer simulations were performed on the present invention. The Cramer Rao lower bound gives a lower bound on variance that any unbiased estimator may attain. Using central limit theory arguments the received signals y can be approximated as complex Gaussian signals with zero mean and the covariance matrix is given by 10 The covariance matrix is valid under Assumptions A1 and A2 above. The Gaussian assumption of the received signal is reasonable since the received signal is a linear mixture of i.i.d. signals.

Let 11 where f f . . . d is the vector of unknown CFOs and . . . is the vector of random delays. The CFOs are represented by f while and are nuisance parameters. Under Assumptions A1 A3 above and the Gaussian approximation the Fisher Information Matrix FIM for the parameter vector is given by

It is noted that the use of a PLL although not required improves symbol recovery. To make sure that the PLL does not have symmetrical ambiguities there must be a guarantee that P umlaut over F F T for 4QAM transmissions. Thus on average the minimum tolerable MSE for the CFO is on the order of 10. From the computer simulations discussed above it can be seen that the CFO compensation achieved by the present invention is sufficient for practical systems and commonly used modulation schemes.

Having thus described the invention in detail it is to be understood that the foregoing description is not intended to limit the spirit or scope thereof. What is desired to be protected is set forth in the following claims.

