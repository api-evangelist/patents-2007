---

title: Method and apparatus for cone beam CT dynamic imaging
abstract: A cone-beam scanning system scans along a half circle. The reconstruction uses a weighting function which decreases for rows farther from the scan plane to take the redundancy of the projection data into account. Another embodiment uses a circle plus sparse helical scan geometry. Image data can be taken in real time.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07643605&OS=07643605&RS=07643605
owner: University of Rochester
number: 07643605
owner_city: Rochester
owner_country: US
publication_date: 20070227
---
The present application claims the benefit of U.S. Provisional Patent Application No. 60 776 666 filed Feb. 27 2006 whose disclosure is hereby incorporated by reference in its entirety into the present disclosure.

The work leading up to the present invention was supported by NIH Grants 8 R01 EB002775 R01 9 HL078181 and 4 R33 CA94300. The government has certain rights in the invention.

The present invention is directed to imaging and more specifically to a half scan imaging technique using a weighting function to increase temporal resolution.

The use of the half scan method in cone beam CT has been a hot topic in recent years owing to the resultant improvement in temporal resolution. There are currently several different types of cone beam half scan schemes such as FDK based cone beam filtered backprojection based CBFBP and Grangeat based. Each scheme uses planar scanning trajectories circular or non circular to conduct the half scan scheme. Theoretically a circular half scan can acquire approximately the same information in the radon domain as a circular full scan in terms of the first derivative radial data as long as the reconstructed object is within a certain size based on the derivation of the Grangeat formula. Even in the circular half scanning range redundancy still exists. The Grangeat type half scan GHS maps the spatial projection data into the first derivative radial data and weights them in the radon domain. After adding missing data through linear interpolation extrapolation in the shadow zone of the radon domain where a circular scan can t access a 3 D radon inverse formula is used to get the reconstructed image.

Current FDK type half scan FDKHSFW schemes for cone beam CT use Parker s or other weighting coefficients based on fan beam geometry where same weighting coefficients are applied to all detector rows. The CBFBP algorithm manipulates the redundant projection data in the radon domain does the half scan reconstruction in the structure of filtered backprojection FBP and achieves almost the same performance as FDKHSFW. The Grangeat type half scan scheme outperforms the FDK type half scan scheme in the correction of the off scanning plane attenuation coefficient drop when the shadow zone is filled with the linear interpolated data. However the spatial resolution of the reconstructed images from GHS is inferior to that of FDKHSFW because data interpolation is less involved in FDK than in GHS. Furthermore GHS cannot handle the truncated data in the longitudinal direction. The CBFBP related half scan and FDKHSFW showed obvious attenuation coefficient drop artifacts in the position of the reconstructed image farthest away from Z 0 where Z is the rotation axis. This artifact is undesirable in practice.

To achieve the above and other objects the present invention is directed to a FDK half scan scheme with a new weighting function that fits the cone beam geometry FDKHSCW where the weighting function is cone beam geometry dependent. The FDK half scan algorithm with the new cone beam weighting function is described. A computer simulation has been conducted and the FDKHSCW has been evaluated in comparison to FDKFS and FDKHSFW.

A new cone beam weighting scheme has been heuristically proposed for the FDK based circular half scan reconstruction FDKHSCW to correct the density drop artifact to a certain degree along the rotation axis inherited with original FDK algorithm for large cone angle. Computer simulation on the Shepp Logan phantom with and without noise showed an improvement when using the FDKHSCW over FDKFS and FDKHSFW in terms of the attenuation coefficient drop when the cone angle is large while maintaining the same visual image quality. FDKHSCW needs additional cone beam weighting before filtering and only uses a scanning range of 180 2 where is the starting projection angle of the x ray and is half of the full fan angle both of them are defined in the scanning plane. As soon as the starting angle is determined each projection image can be processed cone beam weighting for half scan pixel weighting inherited by FDK and filtering . So it will take less time to reconstruct an object in comparison to the full scan scheme a very desirable feature in practice. Here the half scan is defined as 180 plus cone angle of the scan geometry. In addition the half scan scheme provides a flexibility to choose any starting point for reconstruction as long as the scanning range is guaranteed another preferable feature for cone beam CT dynamic imaging. If a full circle scan is performed to increase temporal resolution of the system and cone beam CT reconstruction a multiple of half scan reconstructions can be performed from the full circle scan by choosing the different starting point. Therefore it is another objective of the invention that using the half scan algorithm to reconstruct a multiple of half scan reconstructions from a circle or multiple circle scan projection images of an object to increase temporal resolution for cone beam CT dynamic imaging scan.

Based on the idea proposed by Silver M. D. Silver A method for including redundant data in computed tomography 27 773 774 2000 we can even conduct an extended half scan scheme by making the scanning range larger than 180 2 applying this new cone beam weighting function for better noise characteristic.

The circular cone beam half scan weighting scheme works better for low contrast objects. We can see from our simulation on Shepp Logan phantom that the largest compensation is within 0.03 in terms of attenuation coefficient. We expect that FDKHSCW can show improvement in terms of intensity drop in high contrast phantoms like a Defrise disk phantom. Yet it is more promising with low contrast phantoms.

Other proposed modified FDK methods called T FDK and FDK SLANT also corrected the attenuation coefficient drop to some extent along the rotation axis inherited in FDK with a larger cone angle. There is a difference between these methods and FDKHSCW. Although the results of these methods showed similar correction to FDKHSCW FDK SLANT and T FDK need to be parallel rebinned from cone beam data. That means the filtering portion would not start until the whole set of data acquisition and parallel resorting procedures are completed and then followed by backprojection for image reconstruction. FDKHSCW possess the advantage that once a 2 D projection data is acquired the filtering portion can start and be immediately followed by backprojection. As long as the gantry speed and readout rate is high enough this scheme can provide almost real time monitoring when continuous dynamic imaging is conducted. Wang G. Wang X ray micro CT with a displaced detector array 29 1634 1636 2002 developed a weighting scheme for cone beam full circular scan reconstruction on a displaced detector array without rebinning the projection data for reconstruction. As for the redundant area our scheme can be applied to this algorithm by adjusting the weighting conditions in the scanning range.

Recently a new circular 3 D weighting reconstruction algorithm was proposed to reduce cone beam artifacts based on the investigation on the data inconsistency between a direct ray and its conjugate rays. The basic idea is to have filtered projection data multiplied by correction coefficients that are cone beam geometrically dependent during the backprojection. But the artifact it corrects is not what FDKHSCW tries to correct here namely attenuation coefficient drop. However the two schemes can be combined.

In conclusion by incorporating a new cone beam weighting scheme a new FDK based heuristic half scan approximate algorithm for circular trajectory has been proposed based on a flat panel detector and the numerical simulation demonstrated its feasibility.

Because both the scanning and the processing of the data can be accomplished in less time imaging can be accomplished much faster. Thus scanning in four dimensions three dimensions of space and one of time becomes possible.

Related systems and methods are disclosed in the following U.S. patents U.S. Pat. No. 6 987 831 Apparatus and method for cone beam volume computed tomography breast imaging U.S. Pat. No. 6 618 466 Apparatus and method for x ray scatter reduction and correction for fan beam CT and cone beam volume CT U.S. Pat. No. 6 504 892 System and method for cone beam volume computed tomography using circle plus multiple arc orbit U.S. Pat. No. 6 480 565 Apparatus and method for cone beam volume computed tomography breast imaging U.S. Pat. No. 6 477 221 System and method for fast parallel cone beam reconstruction using one or more microprocessors U.S. Pat. No. 6 298 110 Cone beam volume CT angiography imaging system and method U.S. Pat. No. 6 075 836 Method of and system for intravenous volume tomographic digital angiography imaging and U.S. Pat. No. 5 999 587 Method of and system for cone beam tomography reconstruction whose disclosures are all incorporated by reference in their entireties into the present disclosure. The techniques disclosed in those patents can be used in conjunction with the techniques disclosed herein.

Preferred embodiments of the invention will be set forth in detail with reference to the drawings in which like reference numerals refer to like elements or steps throughout.

The FDK algorithm expands upon the fan beam algorithm by summing the contribution to the object of all the tilted fan beams. The reconstruction is based on filtering and back projecting a single fan beam within the cone. Based on the cone beam geometry in which shows the relative locations of the cone beam emitter or other x ray source and the plane of the flat panel detector the formula of the FDK is 

The sign denotes the convolution so the distance from the x ray source to the origin n m integer value where n 0 and m 0 corresponds to the central ray passing through the origin the projection angle defined in the scanning plane p the virtual detector sampling interval along the t axis the virtual detector sampling interval along the Z axis R np m the actual discrete 2 D projection data h np the discrete one dimensional ramp filter impulse response along the t axis.

The cone beam half scan scheme is also the extension of the fan beam half scan combined with the FDK in which the weighting coefficients calculated from the scanning plane geometry are applied to all projection rows as follow 

This is the FDKHSFW scheme where is half the full fan angle of the central scanning plane along the t axis. The off scanning plane projection data are still treated as they have the same redundancy. np is the discrete weighting coefficient calculated based on the scanning plane geometry and can be represented by Parker s weighting function or any other weighting function as long as it can make a smooth transition between the doubly and singly sampled regions to avoid discontinuities at the borders of these regions. Undoubtedly FDKHSFW holds all the properties that the FDK full scan scheme does.

For cone beam projection data off the scanning plane however it is impossible to obtain completely doubly sampled projections for a single circular orbit acquisition even if projections are sampled over 360 . In other words the projection redundancy becomes less and less when projection rows get further away from the scanning plane. If the FDK algorithm had been directly applied to un weighted half scan projection data the reconstructed images would unavoidably have artifacts. One way to handle the weighting on the less redundancy projection row data away from scanning plane is proposed as follows 

 is the cone weighting angle and is defined between the two lines O S and OY when the cone shaped curve plane O SY is flattened. is dependent on the position of the row projection data in the Z direction rotation axis . is half of the titled fan angle that is adopted from G. T. Gullberg and G. L. Zeng A cone beam filter backprojection reconstruction algorithm for cardiac single photon emission computed tomography 11 91 101 1992 . Notice that when m is zero this weighting function is actually the Parker s weighting function for fan beam.

Please note that the projection data must be weighted prior to being filtered. Since FDKHSFW is the commonly acknowledged scheme for half scan reconstruction the requirement for FDKHSCW is that it should produce no more artifacts than FDKHSFW.

Further investigation of half scan cone beam weighting will now be disclosed. In a circular fan beam half scan there are two redundant regions in the scanning plane in terms of the projection angle . shows that the projecting ray data acquired in region I will have a conjugate ray data in region II. In these two regions the projection ray data is wholly or partly redundant. If half of the full fan angle is degrees the half scan range in terms of projection angle defined in the scanning plane is from 0 to 180 2 . The first and second redundant region is from 0 to 4 and from 180 2 to 180 2 respectively. In the traditional FDK cone beam half scan scheme all the row projection data are weighted by the same set of coefficients defined in the scanning plane because the row projection data away from the scanning plane are expected to have the same redundancy as those in the scanning plane.

The proposal of the circular cone beam half scan weighting scheme is based on the idea that the weighting coefficients should be different for projection data in different rows and for the row projection data furthest away from the scanning plane it should be weighted less. As of this date we have not seen any literature discussing this issue. We found that if we use

In order to make computer simulation closer to the practical CBCT configuration geometric parameters are set in terms of physical length millimeter rather than normalized units. The distances from the X ray source to the iso center of the reconstruction and to the detector are 780 mm and 1109 mm respectively. The full fan and cone angle are 30 degrees. The detector area is 595 595 mmand has a 512 by 512 matrix size. The voxel size is 0.816 mm. Cartesian coordinate X Y Z is used to define the object where Z is the rotation axis. The sampling rate of projection angle is 0.8 with the total number of projection images of 450 for full scan and 262 for half scan. The low contrast Shepp Logan phantom was used see Ref. 7 for geometrical parameters all of its geometrical parameters are multiplied by 200 to simulate the physical length millimeter of the phantom.

Based on the scanning geometrical parameters defined above weighting coefficient distribution associated with FDKHSFW and FDKHSCW are compared by picking up 46 in the redundant region I and 192 in the redundant region II. show respectively FDKHSFW 46 FDKHSCW 46 FDKHSFW 192 and FDKHSCW 192 .

In order to test the performance of this new scheme over the quantum noise that is commonly encountered in practical CBCT data acquisition we generated quantum noise contaminated data. X ray with 100 kVp was selected which corresponds to an effective photon fluence of 2.9972 10photons cm mR. The exposure level per projection was set to 4 mR the total exposure levels for FDKFS and FDKHSCW are 1800 mR and 1048 mR respectively.

A variation of the first preferred embodiment will be presented. In terms of the Radon domain as shows the dotted points in the circle zones represent the radon value of the object acquired in a circular scan while the shaded area in the circle zone represents the missing radon points set which cannot be acquired through a circular scan. As argued by Hu in a circular scan FDK uses only the redundant points inside the object circle and on the dotted arc boundaries but does not use the non redundant points on the solid arc boundaries within the object circle. Thus the following correction term is used 

A second preferred embodiment which is particularly applicable to breast imaging will now be disclosed.

Based on the geometric parameters of current CBBCT we designed a new scanning scheme for CBBCT. As show the position of the x ray source is at z 0 cm during the circular scan. After the circular scan the x ray source and detector lower down simultaneously while they are still rotating. When the x ray source gets to the point where z 10 it starts to shoot and keeps shooting between the interval l till it finishes eight shoots in this helical scan. For each shoot during the helical scan the x ray source still maintains the same collimation as it does in circular scan. This scheme is called sparse spiral scan. In practice to efficiently implement sparse spiral scan the system is required to comprises a slip ring on the gantry frame for providing the connection to the electrical power to the on gantry components and the communication between the two dimensional detector and the computer system and a motor to move the gantry or the support of the object on which the object rests up or down along the rotation axis 

The projection angles associated with helical line scan are illustrated by . There are eight shoot points during helical scan which cover the angular range of 4 and the movement in Z direction is from 48 mm to 128 mm with the increment interval of 10 mm based on the size of the simulated breast phantom.

Some of the radon data points acquired from this additional scanning trajectory still can be acquired through the circular scan this is what is called redundancy sampling points in radon domain and can be efficiently eliminated by the redundant window function RWF and the geometric setup of the collimator as during the HL scanning can avoid the redundant sampling radon points between those shooting points on this helical line. Since the collimation during helical line scanning unavoidably induces the longitudinal truncation a geometric dependent truncation window function TWF will be used to handle this case.

Composite reconstruction framework is probably the most preferable algorithm for the CBCTBI. The reconstructed object is f and can be mathematically described by the following equation 

The reconstruction term for the helical line scan cab be formatted as a type of filtered backprojection FBP 

w l is the window function used to block out the radon data acquired through helical line scan but have already been accessed by circular scan. Based on the scanning design the helical line scan will unavoidably encounter the longitudinal truncation during the scanning. Some radon points it acquires do not reflect the actual radon data and should be eradicated during the back projection. Window W l is used to accomplish this purpose.

While preferred embodiments and variations thereon have been disclosed above those skilled in the art who have reviewed the present disclosure will readily appreciate that other embodiments can be realized within the scope of the invention. For example numerical values are illustrative rather than limiting. Also the invention can be implemented on any suitable scanning device including any suitable combination of a beam emitter a flat panel or other two dimensional detector or other suitable detector and a gantry for relative movement of the two as well as a computer for processing the image data to produce images and a suitable output e.g. display or printer or storage medium for the images. Software to perform the invention may be supplied in any suitable format over any medium e.g. a physical medium such as a CD ROM or a connection over the Internet or an intranet. Therefore the present invention should be construed as limited only by the appended claims.

