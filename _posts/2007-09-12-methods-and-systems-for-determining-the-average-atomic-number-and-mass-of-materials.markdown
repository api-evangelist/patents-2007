---

title: Methods and systems for determining the average atomic number and mass of materials
abstract: Disclosed herein are methods and systems of scanning a target for potential threats using the energy spectra of photons scattered from the target to determine the spatial distributions of average atomic number and/or mass in the target. An exemplary method comprises: illuminating each of a plurality of voxels of the target with a photon beam; determining an incident flux upon each voxel; measuring the energy spectrum of photons scattered from the voxel; determining, using the energy spectrum, the average atomic number in the voxel; and determining the mass in the voxel using the incident flux, the average atomic number of the material in the voxel, the energy spectrum, and a scattering kernel corresponding to the voxel. An exemplary system may use threat detection heuristics to determine whether to trigger further action based upon the average atomic number and/or mass of the voxels.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07634058&OS=07634058&RS=07634058
owner: Passport Systems, Inc.
number: 07634058
owner_city: Billerica
owner_country: US
publication_date: 20070912
---
This application is a continuation of U.S. Ser. No. 11 177 758 filed on Jul. 8 2005 which claims priority to U.S. Ser. No. 60 586 351 filed on Jul. 8 2004 and is hereby incorporated by reference.

Portions of the disclosed subject matter were developed with support from . . . certain rights in those portions of the disclosed subject matter.

This invention relates to the field of non intrusive scanning and more particularly to systems and methods of determining the average atomic number and mass of a target or one or more portions of a target as well as to systems and methods of obtaining limits on the mass of certain elements present in a target or in one or more portions of a target.

A desirable characteristic of a non intrusive inspection technique for inspecting a target is the ability to rapidly determine atomic number Z and density of the target material as well as the spatial distribution of atomic number and density. In particular a rapid determination preferably with low radiation dose of the distribution in three dimensions of average atomic number and or mass is a powerful and useful means to determine the contents of a target container. This information may be used to determine a probability that a target container such as a piece of luggage a shipping container a storage container or other container for land sea or air transport contains a certain material such as for example a high Z and or a high density material. Knowledge that a target container contains such a material may be used to identify a threat. For example the presence of lead in a container may indicate shielding for a dirty bomb or other radioactive material. The presence of high Z materials such as uranium may signal the presence of a nuclear weapon in the container. Moreover measurement of mass distribution average atomic number or both may form part of a sequence of inspection techniques. For example regions of the target that are determined to match specified Z and density categories can be used as input into other inspection techniques that will further probe these regions. Such a system may offer the advantage of providing threat determinations in a convenient time scale.

Techniques for the non intrusive inspection of cargo include the detection of transmitted radiation as in x ray imaging to obtain a two dimensional representation of the distribution of density in a target cargo container. Two dimensional imaging using scattered radiation such as Compton scattered radiation has also been demonstrated. Because of the limitations of two dimensional imaging it is often desirable to obtain the density distribution in three dimensions. Non intrusive scanning to obtain both two and three dimensional images of a target using nuclear resonance fluorescence techniques has been described for example in U.S. Pat. No. 5 115 459 Explosives Detection Using Resonance Fluorescence of Bremsstrahlung Radiation and U.S. Pat. No. 5 420 905 Detection of Explosives and Other Materials Using Resonance Fluorescence Resonance Absorption and Other Electromagnetic Processes with Bremsstrahlung Radiation the contents of both of which are hereby incorporated by reference.

Methods and systems for achieving non intrusive inspection of cargo shipping containers luggage and other targets via measurements of scattered photon energy spectra resulting from the scattering of photon beams are presented here. The methods and systems presented here take advantage of processes that contribute to the 511 keV annihilation peak and higher order processes some occurring at higher energies which exhibit stronger Z dependence than such processes as Compton or Rutherford scattering. The methods and systems disclosed also benefit from the greater penetration of radiation that occurs at energies above the K edge for most materials allowing fewer losses in the target of photons that would otherwise contribute to signal from deep in the target. This allows the inspection of larger and or denser targets than may be practicable with systems operating at lower photon energy. Additionally the methods presented here may be employed to obtain a two dimensional and three dimensional average atomic number and or density as well as mass limits on the presence of high Z material data more rapidly and with lower radiation dose than NRF imaging.

In one aspect a method for analyzing the material in a voxel of a target comprises illuminating the voxel with a photon beam measuring a first number of photons scattered from the voxel in a first energy range and in a first measurement direction measuring a second number of photons scattered from the voxel in a second energy range and in a second measurement direction determining a ratio of the first number of photons to the second number of photons and determining an average atomic number of the material in the voxel using the ratio. In further embodiments the first energy range includes 511 keV. In further embodiments the second energy range excludes 511 keV. In other embodiments the first direction is the same as the second direction.

In another aspect a method for analyzing the material in a voxel of a target comprises illuminating the voxel with a photon beam measuring an energy spectrum of photons scattered from the voxel in a measurement direction determining a first number of photons contributing to the energy spectrum in a first energy range determining a second number of photons contributing to the energy spectrum in a second energy range computing a ratio of the first number of photons to the second number of photons and determining an average atomic number of the material in the voxel using the ratio. In further embodiments the first energy range includes 511 keV. In further embodiments the second energy range excludes 511 keV.

In another aspect a system for analyzing the material in a voxel of a target comprises a device for generating a photon beam a first detector configured to detect a first energy spectrum of photons scattered from the voxel in a first measurement direction and a processor wherein the processor is configured to determine a ratio of a first number of scattered photons having energies in a first energy range to a second number of scattered photons having energies in a second energy range and wherein the processor is further configured to determine the average atomic number in the voxel. In other embodiments a system for analyzing the material in a voxel of a target further comprises a second detector configured to detect a second energy spectrum of photons scattered from the voxel in a second measurement direction. In still further embodiments the first angle is the same as the second angle. In still further embodiments the first energy range includes 511 keV. In still further embodiments the second energy range excludes 511 keV.

In another aspect a method of analyzing material in a voxel of a target comprises illuminating the voxel with a photon beam determining an incident flux upon the voxel measuring at least one energy spectrum of photons scattered from the voxel determining using the measured energy spectrum the average atomic number in the voxel and determining the mass in the voxel using the incident flux the average atomic number of the material in the voxel the measured energy spectrum and predetermined values of a scattering kernel corresponding to the voxel. In still further embodiments determining the average atomic number in the voxel comprises determining a first number of photons contributing to at least one of the energy spectra in a first energy range determining a second number of photons contributing to at least one of the energy spectra in a second energy range computing a ratio of the first number of photons to the second number of photons and determining an average atomic number of the material in the voxel using the ratio. In still further embodiments the first energy range includes 511 keV. In still further embodiments the second energy range excludes 511 keV.

In another aspect method of analyzing material in a plurality of voxels of a target comprises a illuminating the voxels with a photon beam b measuring for each of the voxels at least one energy spectrum of photons scattered from the voxel c for each of the voxels determining the average atomic number of the material in the voxel using the measured energy spectrum and d for each voxel i determining an incident flux upon the voxel and ii determining the mass in the voxel using the incident flux the average atomic number of the material in the voxel the measured energy spectrum and predetermined values of a scattering kernel corresponding to the voxel. In further embodiments determining the average atomic number in each of the voxels comprises determining a first number of photons contributing to at least one of the energy spectra in a first energy range determining a second number of photons contributing to at least one of the energy spectra in a second energy range computing a ratio of the first number of photons to the second number of photons and determining an average atomic number of the material in the voxel using the ratio. In further embodiments the first energy range includes 511 keV. In still further embodiments the second energy range excludes 511 keV.

In another aspect a method of analyzing material in a plurality of voxels of a target comprises a illuminating the voxels with a photon beam b measuring at least one energy spectrum of photons scattered from each of the voxels c determining using the measured energy spectrum the average atomic number in each of the voxels d for each voxel i determining a flux of photons incident on the voxel and ii using the average atomic number the measured energy spectrum and predetermined values of a scattering kernel to determine the average mass in the voxel e computing using the estimated average mass and average atomic number in each voxel an estimated exit flux exiting the target measuring a measured exit flux exiting the target computing a difference between the estimated exit flux and the measured exit flux and computing a correction to the estimated average mass in each voxel based upon the computed difference between the estimated exit flux and the exit flux. In further embodiments computing a correction to the estimated average mass in each voxel further comprises assigning for each voxel a contribution to the computed difference between the estimated exit flux and the exit flux in proportion to the estimated average mass in that voxel. In further embodiments computing a correction to the estimated average mass in each voxel further comprises using a minimization procedure to adjust the estimated average mass in each voxel so that the computed difference between the estimated exit flux and the exit flux is minimized. In still further embodiments computing a correction to the estimated average mass in each voxel further comprises adjusting the computed average atomic number in each voxel so that the computed difference between the estimated exit flux and the exit flux is minimized.

In another aspect a method of analyzing material in a voxel of a target comprises a illuminating the voxel with a photon beam b determining an incident flux incident on the voxel c measuring at least one energy spectrum of photons scattered from the voxel d determining the mass in the voxel by i determining using the incident flux and the measured energy spectrum the average atomic number in the voxel and ii using the average atomic number the measured energy spectrum and predetermined values of a scattering kernel to determine the mass in the voxel and e determining an upper limit on a mass of a selected species present in the voxel using the measured energy spectrum and the mass in the voxel. In further embodiments determining an upper limit on a mass of selected species present in the voxel comprises evaluating a first scattering kernel corresponding to the selected species and evaluating a second scattering kernel corresponding to a second species. In still further embodiments determining the average atomic number in each voxel comprises determining a first number of photons contributing to at least one of the energy spectra in a first energy range determining a second number of photons contributing to at least one of the energy spectra in a second energy range computing a ratio of the first number of photons to the second number of photons and determining an average atomic number of the material in the voxel using the ratio. In still further embodiments the first energy range includes 511 keV. In still further embodiments the second energy range excludes 511 keV.

In another aspect a system for determining the average atomic number in a voxel of a target the system comprises a photon beam a means for determining an incident flux incident on the voxel a detector configured to view the target and equipped to detect an energy spectrum of photons scattered from the voxel and a processor wherein the processor is configured to determine using the energy spectrum the average atomic number in the voxel and the processor is further configured to determine the average atomic mass in the target voxel using the incident flux the average atomic number the energy spectrum and predetermined values of a scattering kernel.

In another aspect a method of analyzing material in a voxel of a target comprises illuminating the voxel with a photon beam determining an incident flux upon the voxel measuring at least one energy spectrum of photons scattered from the voxel determining a first number of photons contributing to at least one of the energy spectra in a first energy range the first energy range including 511 keV determining a second number of photons contributing to at least one of the energy spectra in a second energy range computing a ratio of the first number of photons to the second number of photons using a correlation between the ratio and the first number of photons to determine a probable average atomic number and mass in the voxel. In further embodiments the second energy range excludes 511 keV.

The present disclosure also describes methods and systems for scanning a target for potential threats. In one aspect a method of scanning a target for potential threats comprises a for each of a plurality of voxels in the target i illuminating the voxel with a photon beam ii measuring an energy spectrum of photons scattered from the voxel in a measurement direction iii determining a first number of photons contributing to the energy spectrum in a first energy range iv determining a second number of photons contributing to the energy spectrum in a second energy range v computing a ratio of the first number of photons to the second number of photons and vi determining an average atomic number of the material in the voxel using the ratio and b determining whether to trigger further action using the average atomic numbers of each of the plurality of voxels. In further embodiments the first energy range includes 511 keV. In still further embodiments the second energy range excludes 511 keV. In still further embodiments the method further comprises displaying the spatial distribution of the average atomic numbers on an output device. In still further embodiments further action comprises scanning a portion of the target by nuclear resonance fluorescence. or notifying an operator that suspicious material may be present.

In another aspect a method of scanning a target for potential threats comprises a for each of a plurality of voxels in the target i illuminating the voxel with a photon beam ii measuring a first number of photons scattered from the voxel in a first energy range and in a first measurement direction iii measuring a second number of photons scattered from the voxel in a second energy range and in a second measurement direction iv determining a ratio of the first number of photons to the second number of photons and v determining an average atomic number of the material in the voxel using the ratio and b determining whether to trigger further action using the average atomic numbers of the material in each of the plurality of voxels In further embodiments the first energy range includes 511 keV. In still further embodiments the second energy range excludes 511 keV. In still further embodiments the method further comprises displaying the spatial distribution of the average atomic numbers on an output device. In still further embodiments further action comprises scanning a portion of the target by nuclear resonance fluorescence or notifying an operator that suspicious material may be present.

In another aspect a method of scanning a target for potential threats comprises a for each of a plurality of voxels in the target i illuminating the voxel with a photon beam ii determining an incident flux upon the voxel iii measuring at least one energy spectrum of photons scattered from the voxel iv determining using the measured energy spectrum the average atomic number in the voxel and v determining the mass in the voxel using the incident flux the average atomic number of the material in the voxel the measured energy spectrum and predetermined values of a scattering kernel corresponding to the voxel determining whether to trigger further action using the masses and the average atomic numbers in each of the plurality of voxels.

In another aspect a system for scanning a target for threatening material comprising a means for generating a beam of photons a means for translating the target relative to the beam of photons at least one detector configured to detect at least one energy spectrum of photons scattered in a measurement direction from at least one voxel of the target and a processor wherein the processor is configured to determine a ratio of a first number of scattered photons having energies in a first energy range to a second number of scattered photons having energies in a second energy range the processor is further configured to determine the average atomic number in the voxel the processor is further configured to use the average atomic number in the voxel to determine whether to trigger further action.

To provide an overall understanding certain illustrative embodiments will now be described however it will be understood by one of ordinary skill in the art that the devices and methods described herein can be adapted and modified to provide devices and methods for other suitable applications and that other additions and modifications can be made without departing from the scope of the systems described herein.

Unless otherwise specified the illustrated embodiments can be understood as providing exemplary features of varying detail of certain embodiments and therefore unless otherwise specified features components modules and or aspects of the illustrations can be otherwise combined specified interchanged and or rearranged without departing from the disclosed devices or methods. Additionally the shapes and sizes of components are also exemplary and unless otherwise specified can be altered without affecting the disclosed devices or methods.

Some exemplary systems for employing continuous spectrum photon sources such as bremsstrahlung sources in resonant scattering measurements also called nuclear resonance fluorescence or NRF in non intrusive scanning applications are discussed in U.S. Pat. Nos. 5 115 459 and 5 420 905. The methods and systems described herein may employ similar apparatus for measurements using non resonant scattering processes.

The system includes a photon source producing photons having an energy spectrum over some energy range. Suitable photon sources may include a bremsstrahlung source a Compton broadened photon source using nuclear decay from a radioactive source coherent bremsstrahlung radiation free electron lasers laser backscatter from high energy electrons neutron capture photons or other photon sources known to those skilled in the field.

In the embodiment illustrated in the photon source may be a bremsstrahlung source and may include an electron source providing a beam of electrons incident on a bremsstrahlung target to generate a bremsstrahlung photon beam . The bremsstrahlung target may be followed by a beam stopper not illustrated to stop the electrons . A filter may follow the beam stopper to filter out low energy photons from the bremsstrahlung beam if desired. A collimator may be employed to collimate the bremsstrahlung beam . Shielding not illustrated may enclose the photon source . A description of an exemplary suitable bremsstrahlung photon source may be found in U.S. Pat. No. 5 115 459.

A target to be scanned such as a cargo container shipping container luggage package or other container or object may be placed in the path of the photon beam . In one embodiment the target may be moved through the path of the beam for example by a conveyor belt. In another embodiment the beam may be scanned across the target for example by moving photon source or steering the electron beam . Other ways of achieving scanning of the photon beam over the target container will be recognized by those skilled in the art. The target may contain target contents . The incident photon beam impinges upon the target container and photons may be both scattered from the contents and the target as well as transmitted through the contents and the target .

Detecting apparatuses and which may include an array of detectors may capture measure count and or record the energies of the photons scattered in a given direction or directions. A description of several exemplary suitable detecting apparatuses may be found in U.S. Pat. No. 5 115 459. The detecting apparatus or may further include a filter over the face of each detector to absorb low energy photons and shielding not illustrated . As scattering from the collimating aperture could lead to a significant amount of photons directed toward the detecting apparatus or a shadow shield not illustrated between the collimator and the detecting apparatus or may be employed. A beam dump may be provided to absorb the energy of the beam that is not absorbed as the beam passes through the target . Shielding not shown may enclose the entire device while allowing convenient means for the entry and exit of targets.

Data from the detecting apparatus or is sent to a processor which may analyze the data for example to determine an average atomic number mass or upper limits on a mass of a selected element as described below. The data may be preprocessed by preprocessing electronics which may include preamplifiers filters timing electronics and or other appropriate preprocessing electronics. Although the preprocessing electronics are connected serially in the figure they may also be connected in parallel to the processor . The processor may be further adapted to evaluate the data to determine whether the contents of the target volume meet or exceed one or more predetermined detection thresholds. For example the processor may compare the data for each irradiated target volume to profiles of normal target volumes to determine whether the irradiated target volume should be considered suspicious. In addition the processor may be programmed with other threat detection heuristics as described below. Further as described in more detail below the processor may control a variety of parameters of the photon beam scanning detection and or other aspects of the system.

The detecting apparatus and or may be configured to view the target at a measurement angle with respect to the photon beam of more than 90 degrees relative to the direction of the photon beam. In an exemplary embodiment the detecting apparatus views the target at a measurement angle of approximately 130 degrees.

The beam passes through the target contents . This beam may be absorbed in a beam dump designed to absorb substantially all of the remaining energy. For example a suitable beam dump for 10 MeV may include a layer of a hydrogenous material containing boron or lithium a layer of carbon and a layer of iron in a cavity formed in a shield of lead and or iron to shield the sides and the detectors from back streaming low energy photons. A layer of a hydrogenous material containing boron or lithium may surround the outside of this shield. The depth of this cavity the beam dimensions the directional collimation of the detectors and the exact location of the detectors are related parameters that may be made compatible so as to minimize the number of backward streaming photons from the beam dump entering the detectors. Additional shadow shields may be set up to help meet this goal.

Scanning can be achieved in a variety of ways with the technique described herein. The luggage can be scanned with the beam by moving the entire photon source the target or simply the aperture . The electron beam may also be deflected by a magnet to sweep the photon beam direction. Preferred photon beam geometries include spots cones and stripes. Other suitable scanning configurations geometries and patterns may be recognized by those skilled in the art and may be employed.

For example in one embodiment if the beam is collimated using a small circular aperture to an average angle of approximately 1 20 radians about 3 degrees the spot 1 meter from the aperture may be about 10 cm across a suitable size for imaging the contents of a piece of luggage. If higher resolution is desired a more tightly collimated beam may be used. Alternatively larger spot sizes may be preferred for rapid scanning and or for larger targets.

If the photon beam is collimated using a vertical slit aperture to produce a thin stripe of 10 cm width at the point of incidence with a piece of luggage for example a 60 cm long suitcase could be scanned in a few seconds as the suitcase moves on a conveyor belt. Alternatively the photon beam could be collimated into a spot swept vertically by an adjustable collimator or by magnetic deflection of the electron beam used to generate the photon beam . Even if the collimation is in the form of a vertical stripe the central intensity remains the highest reflecting the natural collimation and magnetic deflection of the electron beam may be useful for imaging. In other embodiments stripes with configurations other than vertical may be employed.

In addition in some embodiments a pulsed photon beam may be used to allow spatial resolution. Where the photon source is generated by an electron accelerator with suitable pulse structure the relative time between the photon pulse and the time of detection can be used to infer the spatial position of possible interaction points.

A target may be conceptualized as divided into portions or voxels. Each voxel is defined by the three dimensional intersection of the photon beam with the view of a collimated detector . One such voxel is identified in .

The processor may be adapted to analyze the data obtained by the detecting apparatus in any combination of and or . For example the processor may be programmed with statistical information about mass or atomic number distributions that fall within normal profiles. A target volume or voxel or a combination of volumes or voxels which deviates significantly from these profiles may be identified as suspicious. The processor can also be adapted to compare data to stored profiles indicative of a high likelihood of a particular type of threat. For example if a region of a target shows the explicit elemental profile of an explosive substance or of high density materials typically used as radioactive shielding the processor may signal a positive threat detection event. The system may respond to a positive threat detection event in any of a variety of ways including rescanning the region at a higher resolution performing a different type of scan such as a NRF scan for particular materials displaying an image of the target contents and or signaling a human operator.

The detection methods thus described in which scattering from the target and target contents is detected by detectors in detector array and or may be employed to obtain three dimensional imaging of the target contents . For example if the average atomic number is determined in each voxel according to the methods described herein then these data may if desired be reconstructed as a three dimensional image of the target contents displaying the spatial distribution of average atomic number. Similarly using measurements of the mass in each voxel a three dimensional distribution of mass throughout the target may be constructed as an image.

In the embodiment illustrated in the system may also include a direct transmission detector such as an X ray imager which can measure the intensity and or energy of photons transmitted through the target as a function of the position at which the photon beam strikes the target or for a bremsstrahlung source as a function of the position at which the electron beam strikes the bremsstrahlung target . Such a measurement could be used for example to obtain a map of the average density of the target projected along the axis of the photon beam . In this way a very precise image of the transmission density of the target can be constructed. Such an image will identify specific areas of high material density in the target which would be a further aid in detecting explosive or high atomic number materials. Similar density imaging could also be achieved by detecting the back scatter from the target especially at low energies . A transmission detector may also be employed to measure the total photon flux transmitted through the target with or without spatial resolution as a function of energy.

An exemplary system for achieving non intrusive inspection of a target container is further illustrated schematically in . A collimated beam of photons impinges on the target . This collimated photon beam as described above may have a continuous spectrum in an energy region of interest and can be produced by a variety of mechanisms such as bremsstrahlung radioactive decay or other means known in the art. The intensity and energy of the photon beam before impinging on the target the incident flux F is known either from design and control parameters by direct measurement or both.

In one embodiment the incident flux Fon the target may be measured and or monitored by inserting a flux measurement device at position in the photon beam. The flux measurement device may be for example an electrometer and or an ionization gauge where the photon beam passes through a material having known interaction cross section with photons at the energies of the photon beam . The flux measurement device then measures the current created as the photon beam interacts with the material and outputs the incident flux F preferably as a function of photon energy. A similar flux measurement device may be present downstream of the target for measuring the exit flux as discussed below .

Photons scattered from the target and or its contents may be detected in a photon detector or an array of photon detectors which may be collimated to view a particular portion of the target. The spatial volume viewed by a photon detector in this example is determined by the cross sectional area of the beam and the detector view along the collimation axis of the detector. As noted above the portion of the target volume viewed by a photon detector the intersection in space of the path of the photon beam with the field of view of a detector is referred to as a voxel which is a volume element of the three dimensional space of the target container. The precise shape of each voxel which may be irregular is determined by the shape and geometry of the beam and the geometry of the collimated view of each detector. In the embodiment illustrated schematically in an array of detectors may simultaneously view photons scattered from multiple voxels for example voxels along the beam . The array of collimated photon detectors can be replaced by a single photon detector or any number that can change viewing volume without any loss of generality to the method herein described. The photon detectors measure the number and energy distribution of photons scattered in the measurement direction measured with respect to the incident beam direction. The rate or integral or number of photons for fixed time counting and shape of the energy spectrum of photons scattered into each detector is dependent on i the intensity and energy distribution of the incident photon flux reaching the voxel viewed by the detector ii the density and composition of the viewed voxel iii the angle at which the detector is aimed relative to the incident photon beam iv the efficiency and energy resolution of the photon detectors and v the density and or composition of the material between the voxel and the detector.

The features illustrated in are general and may be observed in scattered photon energy spectra obtained by irradiation of a sample with for example a photon bremsstrahlung beam with end point energy greater than 1 MeV. As will be understood by those skilled in the art similar photon energy spectra would be observable for a variety of detector geometries including without limitation any detector placed with a viewing angle of greater than approximately 90 relative to the incident photon beam.

The scattered photon energy spectra such as those illustrated in have a general and important feature that forms the basis of a rapid detection scheme for identifying high Z materials The part of the photon energy spectrum scattered at angles greater than approximately 90 degrees relative to the bremsstrahlung beam and at energies well below the endpoint of the bremsstrahlung beam is very dependent on the Z of the material. As an example a sample of lead presents about an order of magnitude more intensity than a similar mass of copper. The Z dependence of features of this photon energy spectrum can be used as described below for identifying and or mapping the average atomic number of the contents of a target container.

In addition as will be fully described below the measured average Z in a voxel of the inspected target material obtained by the method described below together with the measured absolute scattered photon intensity can be used to determine the total mass of the voxel.

The following methods may be used to non intrusively inspect a target container and identify the average Z of the contents. As illustrated schematically in a photon beam is made to impinge on a target . The photon beam may be scanned perpendicular to a face of the target container. The target container may be moved through the system perpendicular to the beam direction and to the scanning direction allowing every region of the container to be examined. As shown schematically in for every position of the beam the collimated detectors interrogate a voxel where the beam and the collimated view of the detectors intersect the voxels interrogated by the detectors may be disposed adjacently the illustrated voxels and of have been spatially separated for clarity of illustration . The inspection system may include processor programmed to dynamically analyze the data from the detector array to rapidly determine the average atomic number Z mass of material and or limits on the mass of a particular material in each voxel irradiated by the beam using the methods described below.

An exemplary inspection system may include data acquisition electronics for collecting photon counts and or energy distribution from the photon detectors. In addition the processor may be further programmed with threat detection heuristics that determine whether to take further action dependent upon the result of analyzing the collected data. Such further action may include notifying a human operator of a potential threat or triggering further measurements to be initiated and or conducted either by an automated system or by human operators. For example the system may be programmed to alert an operator or conduct further measurements upon detection of the presence of materials having average Z in a specified range or above a threshold value. Such further measurements may include higher resolution scans of selected regions of the target. Further measurements may also include scanning the target with other scanning methods including NRF imaging for further analysis of the isotopic contents of the target or a portion of the target. An exemplary system for determining the average Z and or mass distribution in a target may use the same detectors for both the average Z and or mass measurements and any additional NRF imaging of the target. Alternatively an additional set of detectors may be supplied for further imaging. As illustrated in the system may include detector arrays and or that may be used for NRF imaging such as described in U.S. Pat. Nos. 5 115 459 and 5 420 905. Also as illustrated in the system may be configured for transmission NRF detection using reference scatterers and detector array also as described in U.S. Pat. Nos. 5 115 459 and 5 420 905.

In some embodiments processor may be configured to represent the average Z values and or average density for each voxel graphically on a visual display such as with color or shading to form a two or three dimensional image of the container s contents. The processor may also be configured to display regions of the container having average atomic number above some threshold value.

The average Z S of the material in a voxel is determined in the first approximation by the ratio of measured photon counts in two energy regions of the energy spectra of the scattered photons. The terms photon spectrum energy spectrum and photon energy spectrum are used interchangeably throughout the present disclosure to refer to the photon energy spectral distribution or the number of counts detected in each energy channel. For example region may include the 511 keV line produced from positron production and annihilation in the target voxel and region may include an energy band beginning at 600 keV and extending toward some higher energy limit programmed or entered into the data reduction system. The higher energy region can be quite broad in an exemplary embodiment it begins at 600 keV and extends upwards to about 2 MeV. In an alternative embodiment either or both regions may be as a narrow as a single detection channel if counting statistics are adequate. The exact energy limits will be determined by the specific requirements of a particular application and may depend upon the counting statistics detector resolution or signal to noise ratios obtained in the higher energy channels in a particular application. It will be understood that 600 keV is an arbitrary limit and any energy range may be used that excludes the 511 keV peak although as discussed above energies above 150 keV may be preferable. In practice the higher energy region may be selected by choosing a center energy and then selecting a width such that the statistical fluctuations over that region are no longer dominated by noise.

Let R Z represent the ratio of the scattered photon intensity in region to the scattered photon intensity in region . In R Z is plotted for approximately equal effective masses of material with Z 92 82 29 and 7 uranium lead copper and BOsurrounded by paper respectively . In Ewas chosen so that the numerator of R Z was the integral under the 511 keV peak Ewas approximately 600 keV 5 keV.

As can be seen from the dependence of R Z upon atomic number Z is quite pronounced. Generally the higher the average Z in the target the lower the value of R Z . The ratio is largely independent of the total mass of material contained in the voxel. Thus the average Z in a voxel may be determined by counting photons scattered in each of an appropriately selected energy region and computing the ratio R Z and comparing the result to an R Z curve such as that shown in . The known R Z curve used for this comparison may be determined empirically by placing test targets of known Z in the path of the beam and measuring R from several such test targets having a range of Z. Alternatively an R Z curve could be determined by analytic or statistical modeling of the interactions occurring in the target.

It should be noted that depending upon the size of the interval Ethat includes the annihilation peak a subtraction of the continuous portion of the photon energy spectrum in this energy interval may be desirable before computing the ratio R Z . For example if the detector has a broad energy resolution relative to the width of the 511 keV peak the interval Emay include contributions from the continuous portion of the photon energy spectrum. In order to get an accurate measure of the normalized counts in the annihilation peak these contributions may be estimated and subtracted out. In an exemplary embodiment the contributions of the continuous portion may be estimated by averaging the continuous portion of the photon energy spectrum on either side of the energy interval E.

In some embodiments the photon intensity in region may be measured in a different scattering direction from the photon intensity in region . In such an embodiment the photon intensity in one of the two regions may be corrected for the difference in measurement angle prior to computing the ratio. The correction can be determined empirically analytically or by statistical modeling to determine the angular distribution of scattered photons and or any differences in detection efficiency between the detectors.

In another exemplary embodiment the scattered photon energy spectrum from a voxel can be used in conjunction with the photons scattered from neighboring regions of the target to indicate the presence of a high Z material as follows. Presence of a signifycant quantity of high Z material in one voxel may result in strong absorption of the beam which in turn results in a reduced flux incident upon the voxels downstream in the beam path. Thus the energy spectra of photons scattered from downstream voxels may exhibit a reduction in signal strength. Similarly if a high Z material is present in between the voxel under interrogation and the detector out of the path of the photon beam then the photons scattered from the voxel under interrogation may be attenuated by absorption on their way to the detector causing a reduction in signal from the interrogated voxels. In an exemplary embodiment a threat detection system may look for such spatial correlations in the attenuation of the signal and use them to determine or verify the presence of a high Z material both along the beam and or along the path from the voxel under interrogation to the detector. For example when such a correlation is detected it may alert an operator and or trigger further investigation of the target or of a region of the target such as with NRF imaging.

The mass of the material contained in each voxel can be estimated by an iterative method using as input the number of photons measured in the continuous region of the photon energy spectrum above a given energy such as 600 keV see . The choice of energy region is arbitrary and any region may be used that provides adequate counting statistics. The optimal energy regions for a particular application will depend upon the design specifics of the scattering system. The energy regions used in a particular application may be selected empirically by adjusting parameters until the greatest sensitivity for mass determination is achieved. Alternatively energy regions may be selected using statistical modeling methods to compute estimated optimum values.

In an exemplary embodiment of this method the mass in the first voxel interrogated by the photon beam is determined using the incident flux F and then the mass is used to estimate the flux incident upon the next voxel in the beam path and so on along the beam as follows. Referring to which schematically illustrates the detection of scattered photons from several voxels along the beam path the photon count from the i th voxel S into direction with energies falling in the range E is given by Equation 1

where G E Z is a known factor dependent on the average Z value Z the energy of the measured photons and the angle of scattering from the i th voxel Fis the total photon flux entering the i th voxel and Mis the mass contained in the i th voxel. If the voxel under consideration is the very first target voxel struck by the incident beam then Fis the incident flux Fdiscussed above. As discussed above Epreferentially includes the annihilation peak at 511 keV while Eis preferably some higher energy range. Also as discussed above depending upon the size of the interval Ethat includes the annihilation peak a subtraction of the continuous portion of the photon energy spectrum in this energy interval may be desirable.

The factor G E Z may be determined either empirically or by analytical or statistical modeling. G E Z is referred to herein as the scattering kernel. It represents the flux or number of photons scattered in the measurement direction scattered from a material having atomic number Zand mass normalized to 1 gram for a unit total incident flux per cm. The kernel depends upon the parameters defining the shape of the flux incident upon the i th voxel. For example for a bremsstrahlung source the kernel depends upon the endpoint energy of the electron beam used to generate the bremsstrahlung photons. Thus the kernel must be determined for the particular photon source used in any given embodiment.

Data tables or analytic expression of the kernel G E Z may be provided to the processor in data reduction software that uses Equation 1 to determine the mass Min the i th voxel. For example the kernel G E Z could be determined in advance empirically by placing test targets of known Zand known Min voxel i and measuring Susing known incident photon flux Ffor several such test targets having a range of average Z. Where such test masses are used the calibration of the G measurement must take into account the size of the interrogated voxel. This can be achieved by for example using test targets of smaller cross sectional area than the incident photon beam. Then the product of the areal density of the test target and the cross sectional area of the test target provides the total mass of the interrogated voxels for the calibration. Alternatively instead of direct measurement the kernel Gcould be determined by Monte Carlo modeling of the interactions occurring in the target and incorporating the detector and beam geometry. Or the kernel Gcould be determined by analytic modeling either in advance or in real time. Thus exemplary values may be stored by the system in data tables or as analytic expressions. Regardless of how the factor Gis determined and stored its values will be referred to herein as predetermined values. Generally the factor G E Z incorporates the Z dependence and spatial dependence of the scattering cross section the energy distribution of the photons incident on the i th voxel which when a bremsstrahlung source is used is dependent upon the spectrum of the electron beam used to create the bremsstrahlung source as well as the detector geometry.

The average Z in each voxel Zalong the beam may be determined by for example the ratio method discussed above. Using the average atomic number Zin the first voxel to evaluate G together with the measured scattered photon count Sfrom the first voxel and the known initial photon flux F the average mass Min the first voxel may be determined from Equation 1.

The attenuation resulting from interaction of the incident photon beam with the contents of the first voxel can be estimated from the extracted values of Zand M so that the flux Fincident on the second voxel the next voxel along the beam can be estimated. Using the average atomic number Zin the second voxel determined for example using the ratio method described above to evaluate G together with the measured scattered photon count Sfrom the first voxel and the estimated photon flux Fincident on the second voxel the mass Min the second voxel may be determined from Equation 1. The processor may be programmed to repeat this calculation for all voxels along the beam estimating the flux Fincident on each voxel and using the average Z value Zto compute the mass Mfor each voxel.

In one embodiment the values Z or M or both are represented for example by colors or shading or points plotted on a visual display to create an image of the mass or Z distribution along the beam. By scanning the beam through the target and repeating this process a 3 D image of the target s contents may be constructed.

In another exemplary embodiment the exit flux from the container may be measured to provide an additional constraint on the mass determinations. The exit flux and its energy spectrum F E may be measured similarly to the measurement of the initial flux Fdescribed above by placing a flux measurement devise in the beam path downstream of the target as illustrated schematically by reference number in . Alternatively the exit flux may be determined by other types of transmission detection in the beam path as illustrated schematically in . For example transmission detector may be an X ray imaging detector that can provide spatial information about the transmitted flux as well as a measurement of the total transmitted flux. As another example the exit flux may be deduced from transmission NRF measurements using reference scatterers and detector array . The exit flux measurement can provide an additional constraint to the mass measurement as follows.

The step by step derivation of the mass in each successive voxel terminates at the end of the container with a predicted exit flux P E where the explicit energy distribution of the flux as well as the total flux may be predicted based upon the energy distribution of the incident flux and of the measured scattered photons. This flux may be compared to the measured exit flux F E to correct the predicted mass measurement. To begin an exemplary process of correcting the predicted mass distribution the energy averaged flux difference D E F E P E may be used to change the mass of each voxel along the path according to the influence on the total photon flux of the original Zand M. That is the difference D is apportioned to each voxel in proportion to the attenuation of that voxel to the transmitted flux in the process of the derivation of Zand M. Next this first order mass distribution is modified in a minimization procedure so that the incident flux energy distribution and the exit flux energy distribution match as closely as possible. In addition the energy spectrum of the exit flux may be compared to that of the predicted exit flux P E and the measured average Z of each target voxel may similarly be adjusted in the minimization process in particular to take advantage of the large variation of the energy dependence of photon absorption with Z.

In another embodiment aspects of the voxel geometry such as diameter or orientation may be varied to improve the comparison between the predicted and measured exit flux energy spectrum and or refine the measurements of mass in each voxel. For example a redefined voxel having twice the area but one half the thickness of the original voxel may contain the same mass but yield a very different photon attenuation. Mathematically this is captured in the geometry dependence of G the scattering kernel. Such voxel redefinition may be achieved by for example changing the collimation of the photon beam and or the detectors.

In an alternative embodiment improved resolution in the average atomic number and mass estimates may be obtained by computing a correlation between R Z as defined above and the normalized intensity of the annihilation peak at 511 keV. This correlation may be obtained by for example plotting R Z against the integrated counts in the 511 keV peak. Because both of these variables have strong dependence upon Z and the peak intensity depends upon the mass in the interrogated voxel this correlation may provide improved separation between species of different atomic number and or different masses. For example lighter species have relatively large R Z see but relatively small counts in the annihilation peak while heavier species have small R Z and larger numbers of counts in the annihilation peak. This correlation is illustrated in the plot in .

Each point in represents a different mass and of the species identified in the legend. The target masses used for the measurements in are provided in Table 1 below. Each mass listed in the table corresponds to a data point in . The target mass can be matched with its corresponding data point by noting that the normalized annihilation peak intensity the x axis value increases monotonically with increasing mass for a given species. Thus for example the 0.54 kg Sn target corresponds to the leftmost Sn point in lowest normalized peak intensity and the 1.61 kg Sn target corresponds to the rightmost Sn point highest normalized peak intensity . The y axis R Z of was measured and computed using the number of counts in the annihilation peak as the numerator and the number of counts in an energy interval of 5 keV around 1000 keV for the denominator. The photon source was a bremsstrahlung beam generated using a 2.8 MeV electron beam.

From the data in it can be seen that a given measured value of R Z may correspond to more than one average atomic number. This is so because of experimental uncertainty in the measured value of R Z and may be particularly problematic for lower average atomic numbers where background effects such as ambient scatter can dominate the R Z measurement. As an example from it can be seen that a measured R Z of approximately 1600 may be observed using samples of carbon BO or aluminum.

Plotting R Z against the normalized annihilation peak intensity however can provide improved separation facilitating the distinctions among different species that may yield similar measured R Z values. This is so because for a given voxel geometry and a given average atomic number there is a limit to how much mass can be present in a voxel. Thus for a given value of R Z that could correspond to more than one average atomic number a high peak intensity suggests the presence of denser material increasing the probability that the voxel has a higher average atomic number. As an example from it can be seen that while certain samples of carbon BO or aluminum all yield measured ratios of approximately 1600 plotting these ratios against the normalized annihilation peak intensity provides some separation among these species.

A threat detection system may analyze such correlations between measured R Z and measured annihilation peak intensity to distinguish among multiple possible average Z values. Alternatively the system may given the measured R Z and annihilation peak intensities compute and output probabilities that the voxel contains certain mass average Z combinations probability pthat the voxel contains a mass Mof material with average Z Z and or probability pthat the voxel contains a mass Mof material with average Z Z . For example consider the data shown in for sample of carbon and aluminum. Since certain samples of both of these species yield a measured R Z of approximately 1600 the R Z measurement alone cannot distinguish between them. However if the normalized annihilation peak intensity is relatively high for example about 450 the probability may be quite low that a sufficient amount of the light element carbon may be present in the voxel under interrogation to yield the measured peak intensity. In contrast the probability may be considerably higher that a sufficient amount of the relatively heavier element aluminum may be present. The system may in some embodiments employ threat detection heuristics that use such probabilities to determine whether to notify an operator sound an alarm and or trigger further scanning such as NRF imaging or other imaging.

It should be noted that the measured annihilation peak intensity may need to be normalized for one or more factors in constructing a correlation such as that shown in . First an overall normalization for incident flux may be required. In some embodiments this overall normalization may be based upon the brightness of the incident beam. For example in the illustration in the number of counts in the annihilation peak was normalized to the total charge on the bremsstrahlung target used to generate the beam live time electron beam current . Alternatively where the incident flux upon each voxel is estimated as described above the annihilation peak intensity may be normalized to that estimated incident flux. In addition a second more sophisticated normalization factor may be applied where necessary or desired for refinement of the correlation. This additional normalization takes into account the effects of the geometry of the voxel as described above in connection with determining the scattering kernel G.

A voxel may contain a mixture of materials with the measured values of Z and M resulting from the summation of the elemental scattered photon distributions. For the purposes of this discussion the measured values of Z and M in a given voxel will be denoted by Zand Mrespectively. For example for two materials one will have Z Z and mass M and the other Z

For each energy region of the scattered photon energy spectrum the following relationship holds Equation 4

Where flux F incident on the voxel divides out. Eq. 4 can be used to set a limit on the mass Mby setting Zto the lowest value for which G E Z has been measured. Using Equation 3 and Equation 4 Equation 5

As can be seen from the exemplary data in in the limit of Zsmall compared to Z G E Z is much less than G E Z . Also G E Z is much less than G E Z . With these approximations Equation 5 reduces to Equation 6

Defining G 0.51 MeV Z G Z G of the annihilation peak and G 0.6 MeV Z G Z G of the continuum energy chosen for the measurement where 0.6 MeV can be replaced by whatever energy is chosen and assuming an admixture of the two mass components Mand M the measured R value is given by Equation 7

Equation 9 can be used to estimate an upper limit the contribution of a high Z material that is embedded into a lower Z matrix. As an example suppose Z 29 for a voxel of mass M where Zand Mmay be measured using the methods described above . If the high Z material is assumed to be uranium an upper limit of the contribution of uranium Z 92 is obtained by extrapolating Z 1. In this example the term G Z G Z is taken to be 1 as the data in indicates and G Z G Z is or order 1 100 yielding M Z 92 1 7 M. The simplicity of this results depends on the rapid variation of the continuum flux with Z and the relative constancy of the annihilation yield for roughly equal mass targets.

