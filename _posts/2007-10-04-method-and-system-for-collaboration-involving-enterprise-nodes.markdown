---

title: Method and system for collaboration involving enterprise nodes
abstract: A method and system for a communication network containing both trusted peers and untrusted hosts within the network. Trusted peers can collaborate with each other to observe and monitor the activity of the untrusted hosts. In addition, a trusted peer instantiated with a virtual machine can have an operating system kernel collaborate with a hypervisor to determine whether threats are present. A trusted peer that needs particular functionality installed can collaborate with other trusted peers and with an administrative console to have that functionality installed. An untrusted host can have a driver directly inserted into it by an administration console, which will facilitate in the collaboration process.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08336108&OS=08336108&RS=08336108
owner: Red Hat, Inc.
number: 08336108
owner_city: Raleigh
owner_country: US
publication_date: 20071004
---
The invention relates generally to collaboration amongst peer entities within a communications network and more specifically to validation of other untrusted nodes within the communications network based on authentication of those nodes or detection of unauthorized activity facilitated by such collaboration between trusted peer entities.

Modern enterprise networks are designed and architected for client server computing as well as peer to peer communication. A host computing machine may attach itself to a modern enterprise network and establish itself on the enterprise utilizing no more than a non authenticated physical connection. Specifically an untrusted host computing machine with physical access to an enterprise network can attach and monitor for typical network behavior as well as specific authentication criteria that could allow a malicious individual s to gain access the resources of the given enterprise network. In many cases it is not possible for the physical hardware responsible for both the security and business continuity of the enterprise network to determine which host s or peers should or should not be present and accessing network resources.

A computing host that has been classified as non authentic e.g. a rogue machine unidentified machine or a machine that has some type of malicious functionality installed on it should be removed from the enterprise if possible or at a minimum provided with very limited services and access to the enterprise resources. An approach that allows for categorical denial of a non authentic peer to access impact or otherwise effect the enterprise network would be useful in such a situation.

A need therefore exists for a software arrangement and process that is capable of allowing trusted entities within a communications network to collaborate with each other to determine whether a particular activity should be permitted or not. In one case a need exists for allowing trusted nodes within a communications network to collaborate with each other to determine whether an untrusted node may be trusted. In another case a need exists for allowing trusted components of a virtual machine to collaborate in determining whether communications to or from a given node should be permitted or whether there are security vulnerabilities are being exploited or attempting to be exploited on that node. A need further exists for the ability to directly insert a driver into a virtual machine file of either a trusted or untrusted node.

In accordance with one embodiment of the invention a software based mechanism allows collaboration between various nodes within a communications network. The software could be distributed to one or more nodes from a central node via the network. According to an embodiment there is provided a method for authenticating network nodes in a communications network including observing network behavior of one or more other network nodes determining if another network node is a trusted peer or an untrusted host communicating with the administration console and collaborating amongst resources within the communications network to address the network behavior of the one or more other network nodes.

Additionally in an embodiment a network node may need a collaboration module. In such a case a method is provided including determining that a network node does not have a collaboration module distributing a collaboration module to a network node and installing the collaboration module in the network node.

According to another embodiment a system is provided that allows trusted peers to collaborate with each other in a communications network including an administrative console which further includes a display and a database a core engine and a collaboration module configured to exchange information about activity within the communications network.

Numerous opportunities may exist within an enterprise for a host computing device or simply host device to connect to an enterprise network. Often such host devices may connect to the enterprise network in a way that results in a degradation of business continuity the loss or destruction of intellectual property or some other negative impact. These negative results could occur as a result of a malicious user purposefully trying to harm the network or as a result of an inadvertent user simply unaware of the damage being caused. Examples of such negative effects include infecting the enterprise network with viruses Trojans or other malware being used as a zombie in a distributed denial of service DDOS attack or maliciously causing a DDOS on the infected host and also to other hosts on the network by flooding the network with unauthorized traffic.

One approach for handling the above situation would be to validate untrusted hosts in the enterprise before full enterprise communication and resource allocation is permitted between trusted peers. In this context a trusted peer is a host device within an enterprise network and an untrusted host comprises a host device that has not been or for some reason cannot be fully authenticated. A trusted peer is a host device that has been adequately authenticated to the enterprise. Such authentication may be facilitated by a single trusted peer in collaboration with the administration console and also by collaboration between multiple trusted peers to determine peer authenticity and remediation of non authentic enterprise nodes.

Once a distributed system of collaborating trusted i.e. authenticated peers has been established within an enterprise network those trusted peers can operate in conjunction to determine a classification for another untrusted node. This collaboration requires only that the trusted nodes observe or witness the communication behavior of the untrusted node. Similarly within a trusted node collaboration can occur between trusted components at various levels within the computing stack to determine if any security vulnerabilities are being exploited.

Various embodiments of this mechanism and an exemplary process for installing it are described in the following subsections. As indicated this mechanism could be remotely distributed from a single hardware platform to one or more nodes within an enterprise network. The mechanism could be installed in stages and each stage can be selected with the characteristics of that node in mind. The configuration at any given mode could comprise an observation functionality an analysis functionality a reporting functionality a remediation functionality or some subset of those functionalities.

In this example the AC has at least the following components user interface application server mapper JDBC SQL database and AC communication module . The AC propagates the security mechanism out to the various network nodes via the data transmission medium. It might propagate the mechanism in stages so as to first cause a receiving network node to install the core aspect or core engine of the mechanism when a user of the node logs in. The installation is designed to be transparent to the user and the core engine is hooked into the stack of the operating system of the node. This installation thus yields the disposition of the core engine and stealth kernel driver as shown in each of nodes and .

Once the core engine component is installed the AC may send a communication module component that enables data traffic pertaining to the collaboration mechanism functionality to be conveyed or communicated to and or from that network node. These components are shown as the node communication modules in each of nodes and . Collectively the core engine the node communication module and the additional modules described below comprise a set of functional modules.

Once the node communication module is installed the AC can forward one or more observation modules to the node. Examples of types of observation modules will be described below. Each such module can be designed to receive data packets intercepted between an adapter driver and a protocol layer of the node s operating system and then analyze the data packets to determine whether they are indicative of some activity or behavior of interest.

In one possible embodiment the user interface of the AC will present a security dashboard to an operator. The dashboard will facilitate operator actions intended to remotely install execute report on and manage the state of the enterprise from a single geographic location.

In addition to illustrating components of interest illustrates example packet flows that indicate those packets directed to the security mechanism packets that are target packets that is packets of interest to the security mechanism and flows where the packets are mixed that is where there are target packets and security mechanism packets. In this example the packet flow between the highlighted components with AC are directed to the security mechanism as is the traffic between the core engine and the node communication module within a node. The traffic between the core engine and the observation modules and remediation modules pertains to the target packets. The remainder of the illustrated data packet flows can be considered mixed.

In the example of the AC can include six major components a communication package an object adapter an EJB Servlet container a J2EE Application Container a data store and thick client .

In one example configuration data store can include a relational database to store all persistent data pertaining to the security mechanism. This data can include but is not limited to system configuration information system state information activity reports from node modules such as from a communication module an observation module or remediation module. The database could additionally store module activity event configuration network topology data node inventory data operator credentials and operator activity log data. Thus the AC can monitor track and act on information detected and or collected by the security mechanism at the respective nodes. As a consequence an operator or system monitor can prescribe further security related activities to the network via the various network nodes. Also because the AC can see the reports of multiple nodes it can detect security attacks that might not be detectable by a single network node operating on its own.

The modules for observation and or remediation are associated with the module component . In this example the module component includes communications capabilities inventory data stores one or more observation modules and one or more remediation modules . These observation and remediation modules are intended to handle the details of the packet processing operations. The modules also can be dynamically updated.

The above described architecture is designed to include multiple strategies for packet drivers. An appropriate packet driver for a particular customer or node will depend on customer requirements. While the specifics may vary it is beneficial if a packet driver has one or more of the following characteristics 

3. it detects whether the connection to the adapter driver is hooked intercepted tampered with in any way and

Additionally the Secure Intermediate Driver described above can be designed so that for example in a Microsoft operating system environment it will effectively look like an adapter driver to the protocols and a protocol to the adaptive driver. The SID can then forward all of the packets to the CE and it can effectively forward all packets between the protocols and the adapter driver transparently if desired.

In an intermediate driver receives packets from the network and transmits packets to the network. This could be the SID described above. The intermediate driver intercepts packets from this flow and provides them to the CE . In this illustration two aspects of the CE are referred to XML router and Packet Manager and Ripping Engine . The intermediate driver exchanges packets with Packet Manager and Ripping Engine . As will be described in connection with the Core Engine will forward packets to from the drivers to any module that is registered to receive that traffic. In this illustration however the focus is on communications particularly between this instantiation of the security mechanism and another instantiation of the mechanism at another node or with the Administrative Console.

In the arrangement of the XML Router interacts with C API a device that has a read write interface that enables the AC to communicate with elements of the security mechanism. Furthermore the XML Router and the Packet Manager and Ripping Engine interface with communication module . The Packet Manager and Ripping Engine sends an intercepted packet to the Packet of Interest Check . If the packet is of interest it is queried for processing by the Packet Handler Builder and Reassembly Engine which is responsive to XML Handler and XML Handler . The result is that the communications module will take any XML message destined for another security mechanism and package that message into an Ethernet message. The Ethernet message is sent back to the Packet Manager in the CE and is forwarded to the Intermediate Driver for transmission on the network.

In this arrangement the CE s Packet Manager and Ripping Engine exchanges packets with the intermediate driver as above and with the TCP IP device intercept . The Packet Manager and Ripping Engine further exchanges packets with various handling modules as appropriate.

Within the CE the API interface thread handles the read write interface from the CAPI as described above with respect to . The XML Router performs the same functions as in but is now shown to interface more specifically with a configuration handler that has associated CE Configuration persistent storage . The Configuration Handler is a thread that will process all CE messages and will persist the current configuration so it can be retrieved on any re start. This might even include information about any of the modules that have been installed in the system.

As illustrated in the Packet Decoder can receive packets from the secure intermediate driver and or a TCP filter. The TCP filter could be a TCP UDP Raw filter used to intercept packets data to and from the TCP IP device the UDP device and the Raw device. This will allow a module to receive traffic before it reaches the TCP IP stack from an application. As in prior descriptions the Secure Intermediate Driver will be used to intercept packets from any protocol device or any additional intermediate drivers that are installed in the stack and from the Adaptive Driver.

The PDM will get packets from each connection to the TCP IP device. In the case where there are multiple TCP IP addresses the PDM could identify each connection with a unique identifier. This connection identifier will have correlating information stored in an Inventory Module which is described below. The PDM will also get packets from each adapter driver that is currently installed in the system. The PDM will also identify each packet stream to from the adapter driver with a unique identifier.

The PDM allows modules to request packets data from each potential source. The PDM has two specific request types the first is a serial forward of the packets and the second is to forward the packet information in parallel with a smart pointer . Modules that request a serial forward of the packets data will have the potential of modifying the data before the data is forwarded onto the next module or the egress of the PDM. The PDM will allow the modules to specifically ask for traffic from a specific point in the network stack i.e. egress down from a specific TCP IP device connection or ingress up from the adapter driver or from a specific direction to from all connections in the network stack i.e. ingress up from all adapter drivers .

The PDM will perform packet decodes as much as possible on all packets data received by the PDM. The PDM will allow modules to ask for packets data based on decoded packet data information.

1. The PDM will obtain traffic flows to from the Adapter Driver with a connection that is as close to the Adapter Driver as possible.

2. The PDM will obtain traffic flows to from the TCP UDP Raw filter with a connection that is as close to the Applications as possible.

3. The PDM will allow modules to register for serial packet data forwards based on a specific location and unique device based on a specific location for all devices or based on a decoded packet filter.

4. The PDM will allow the modules to modify the serial packet data traffic and will forward the modified data.

5. The PDM will allow modules to register for parallel packet data traffic. The PDM will distribute this information using smart pointers . Modules are not allowed to modify packet data traffic received with a parallel packet registration.

6. The PDM will allow modules to register for parallel packet decodes information to be sent to the module. The PDM will distribute the packet decodes information using smart pointers.

7. The PDM will allow modules to specify the priority of the filter for serial packet forwarding parallel packet forwarding and parallel packet decode forwarding for packets data received at any specific location. The priority of the filter will determine what order packets will be forwarded to a module. A module may specify a different priority for packets received at different points. For example a module may specify a high priority for packets received on the ingress from the adapter drivers so that it sees packets before any other modules for traffic on the way in and specify a low priority for packets received on the ingress from the protocol drivers so that it sees packets last after any other modules for traffic on the way out.

8. The PDM will allow modules to kill packets data so that the data is no longer forwarded. This will allow a remediation module to block all packets to from devices as required.

As illustrated in many of the drawing figures and as discussed above the security mechanism can be deployed within a node with one or more modules such as observation modules and remediation modules.

Modules could have a variety of functionality. Some modules could gather computer inventory some modules could gather network topology some modules could perform behavior analysis on the network traffic and some modules could remediate network traffic. All modules in the system must be designed against a set of generic requirements for modules. The generic requirements are as follows 

1. Modules will be installed by the Core Engine and be coded to operate in kernel space or user space.

As indicated above the communications module will be used by all other modules to communicate with the Administration Console. The communications module may have multiple modes of communication that it can use including 

1. Ethernet Broadcast packets These broadcast packets will not use IP and therefore will not be routable. However other nodes which see these messages may route them to from the AC.

3. Spliced UDP packets This will be standard UDP packet streams sent in different splices routed via other nodes to the AC.

4. Covert communications this will use normal IP traffic streams and embed covert communications in to the stream so that communications can not be easily traced.

5. Covert spliced communications this will use normal IP traffic streams and may splice the traffic via different channels to reach the AC. The spliced traffic may be routed via other nodes to the AC.

1. Receive authenticate validate and decrypt all messages from the AC. Encrypt create a message integrity check sign and send all messages to the AC.

2. Receive all module creation messages and when a module is complete authenticate validate and decrypt the module. Send the module to the module manager for installation.

4. Handle multiple priority messages from various modules and send those messages in the order required based on priority. The CM should be able to stop sending a lower priority message that has been partially sent in order to send a higher priority message. The CM should resume sending the lower priority message when possible with out retransmitting the entire message.

Other potential modules that might be used include an Inventory Module IM a Discovery Module DM Remediation Modules RM and Observation Modules OM .

The IM could be used by all other modules to get inventory information about the computer. The IM could track information like the following 

1. What network cards are installed in the system and will generate a unique identifier for traffic to from the network card. The IM will attempt to determine the type of network card including wireless Ethernet GigE card and etc. Will determine if Microsoft VPN services are configured on the system.

2. What protocols are installed in the system and will generate a unique identifier for the traffic to from the protocol.

4. Will attempt to determine if VPN software is installed on the system. Will specifically look for an intermediate driver from DNE and PCAUSA.

5. Will attempt to determine if a packet sniffer is installed on the system i.e. Sniffer Pro Etherpeek and Ethereal. Will determine if winpcap is installed on the system.

The DM could be used by all other modules to get discovered network information. The DM could maintain information like the following 

RMs could perform remediation against network traffic flows. These may be flows detected by Observation Modules OMs that are originating from malware flows blocked by AC configuration or other network traffic flows identified by any Observation Module OM . Remediation may be blocking the traffic flow resetting the traffic flow or spoofing that the traffic flow is proceeding while blocking the flow i.e. like a honey pot .

Initially the RMs will be dormant and not have any packet filters registered. They will register their APIs to the API Manager in the CE. If an RM receives a configuration message from the AC or an OM to filter a specific network traffic stream then it will use the API manager to get the Packet Manager API and register a serial packet filter for the traffic stream. When that packet stream is delivered to the RM then it can perform remediation.

OMs could perform behavior analysis on the various network packet flows received by the security mechanism. There will be different type of OMs that will look for different network behaviors. The OMs will use the other modules in the system to perform the behavior analysis.

Determining whether an untrusted host can be acceptable to trusted peers and have access to enterprise resources can occur by allowing multiple trusted peers to collaborate with each other to identify and classify the state of the unknown or untrusted host being observed. Referring to the exemplary system shown in a trusted peer and another trusted peer can be connected to local area network via wireless access point . In an embodiment each trusted peer and in the wireless network can contain the collaboration module described above. If an untrusted host connects to access point trusted peers and can collaborate with each other the administrative console and possibly other trusted nodes connected to local area network in observing the behavior of untrusted host . Based on the observation identification and classification of the activities of untrusted host by the trusted nodes untrusted host could become trusted.

In a similar fashion untrusted host can be physically connected to local area network . Trusted peers and each containing a collaboration module as described above can collaborate on the observation identification and classification of the activities of untrusted host . This can be accomplished by trusted nodes sharing information they observe from the unknown host s communications with enterprise networks resources as well as the trusted peers themselves. Eventually that collaboration could lead to untrusted host becoming trusted. Alternatively untrusted host could exhibit questionable behavior or could violate policy. In such a case the rest of the trusted nodes on network could contribute to preventing access by untrusted host to network resources.

Any number of behaviors by or characteristics of an untrusted node could be observed by the trusted hosts. Enterprise network communications between both trusted peers and untrusted hosts could be observed or monitored for behavior that could be used to determine the risk associated with continuing a networked relationship with any given trusted peer or untrusted host regardless of it s classification. Such a list of behaviors could be provided to the trusted peers by a user developed through a self learning process or some combination of the two.

As an example trusted peers and in could observe and monitor untrusted host for attempting such things as DNS cache poisoning IP mapping modifications phishing and resource access polling and then communicate such information amongst all trusted peers including the administration module . DNS cache poisoning refers to an attack that causes a Domain Name Server DNS to appear to have received accurate DNS information. The attack exploits a flaw in the DNS software that can make it accept incorrect information that can then leads to legitimate DNS requests being directed to IP addresses of rogue servers that could potentially contain malicious content. IP mapping modifications involve an attacker attempting to divert traffic by modifying the IP address of a machine which can be handled within the system described herein via DNS name to IP mapping verification . Phishing refers to an email based attack which attempts to gain personal information by convincing the recipient to share personal information with the sender who is usually masquerading as a different entity e.g. a bank or other financial institution . Resource access polling describes the activity of an attacker trying to access information without authorized access e.g. searching for social security numbers in databases on the system .

Since each of the above attacks is network based the trusted peers could collaborate in their observation and remediation of the untrusted host. In a virtual environment if the untrusted node existed on a physical machine that was a trusted peer the attacks could be observed there as well by the collaboration between the driver in the hypervisor and the device driver in the operating system as discussed further in the context of .

Also as a result of the above described distributed approach if one or more trusted peers require a module that is temporarily unavailable from Administration Console a trusted peer may request or be pushed a module or set of modules and updated configuration from the other trusted peers. For example in the event that trusted peer did not have one or more particular remediation modules as described above in the context of those modules could be requested from trusted peers and . Alternatively if trusted peers and detected that trusted peer did not have those remediation modules without being requested by trusted host trusted peers and could push those remediation modules to trusted host .

With the observation and determination of authenticated peers that exhibit one or many of these behaviors a system according to the present invention can allow for the denial of access to network resources by the untrusted host. To do this one or more trusted peers can ignore the communication attempts by an untrusted host. This methodology can also prevent an untrusted host from introducing unauthorized traffic into an intranet or over the Internet. Further behavior by neighboring hosts and other network elements like routers switches firewalls etc can be enforced per policies supplied for example by the network administrator.

Similarly access by an untrusted host can be remediated in a virtualized environment. In such a case access by the untrusted host to the network could be restricted or completely prevented by a driver running on the associated hypervisor as illustrated in the context of . This could occur for example where an untrusted host is determined to be and thus classified as a rogue. In such an instance that rogue host s network communications can be filtered by all trusted peers. The rogue host could effectively be removed from the enterprise including for example by terminating the process on the physical machine on which it resides or in a virtualized environment by having the other trusted peers ignore the untrusted host s virtual machine. This could result from a configuration change dynamically sent to the trusted peers by administration console .

Using collaboration in the virtualized environment as illustrated further in the context of it is possible to determine if a kernel driver or other malicious code has been maliciously inserted. This could occur for example where malicious code is inserted inline between the operating system driver and the physical kernel driver i.e. in the hypervisor . Such a case could be observed and analyzed by the two drivers collaborating with each other in analyzing the differences between what was requested or inserted into the stack and what was yielded or realized at the driver placed directly above the adapter driver of the physical machine.

For cases where trusted peers determine and classify a formally untrusted host s state as safe or trusted a message can be sent to administration console to insert the core engine described above to the newly classified peer along with other modules appropriate for that trusted peer. Having been authenticated the now trusted peer will also be instantiated with a collaboration module to assist in future analysis of untrusted hosts that connect to the network. The insertion of the collaboration module in the now trusted peer could further be accomplished without needing to restart the trusted peer.

Once installed device driver in the operating system kernel and hypervisor driver can collaborate with each other and with other trusted peers to observe activity by other untrusted hosts. For example device driver and driver could determine if an untrusted host has installed a rootkit by collaborating and comparing activity that was intended by the application and what services were actually requested to the hypervisor of the physical machine.

Similarly hosted virtual machine can collaborate with hosted virtual machine . In an embodiment collaboration module within hosted virtual machine can communicate over the network with collaboration module within hosted virtual machine . As described above with respect to the two hosted virtual machines and can collaborate on the observation identification and classification of the activities of other trusted peers and untrusted hosts in the network. This can be accomplished by trusted nodes sharing information they observe from the unknown host s communications with enterprise networks resources as well as the authenticated nodes themselves.

Within hosted virtual machine collaboration module can also perform observation and analysis on activities that lie only within hosted virtual machine . For example collaboration module can observe the integrity and authenticity of the code that makes up all of hosted virtual machine by utilizing an electronic signature. In an embodiment collaboration module can generate a cryptographic digital signature across various portions of the executable code that make up hosted virtual machine . The digital signatures could then be checked at various times during the operation of hosted virtual machine to verify that no changes had been made to any of the code e.g. by a malicious or rogue entity within the network .

In an embodiment a digital signature refers to a public key digital signature or simply digital signature which can be calculated across any data object using well understood cryptographic techniques. A digital signature derives its security from the concept of a key pair consisting of a public key and private key that have a specific mathematical relationship between them. Within a public key infrastructure PKI a key pair can be provided to each entity or machine that is to generate digital signatures. In a PKI the public key can be shared publicly without jeopardizing the overall security of the system.

More specifically the mathematical relationship between the public key and the private key that comprise the key pair permits the public key to be revealed while maintaining the security of the overall system. This characteristic is particularly important in an open network system such as the Internet where entities need a reliable means of authentication. The private key on the other hand must be securely maintained in order for the security of the system to be maintained.

A public key pair used to produce a public key digital signature further has the property of computational infeasibility i.e. it would be computationally infeasible for an entity to determine the private key of a user from the public key of that user. Thus the user may share the public key of the user s key pair through a mechanism known as a digital certificate or simply a certificate . In addition to the public key a certificate may contain a number of other fields that contain information about the holder of the certificate. The well understood X.509 standard ITU recommendation ITU T X.509 defines a certificate format commonly used for Internet communications.

In the system shown in collaboration module would securely maintain the private key e.g. encrypted in nonvolatile memory . When needed collaboration module could use a private key to calculate a digital signature on the code that comprises V Driver Kernel Driver core engine remediation module A observation module A observation module B remediation module B and collaboration module . The resulting digital signature and the public key that corresponds to the private key could then be used by collaboration module to check the integrity of the code that makes up hosted virtual machine .

Administration console can identify or qualify which virtual machines in network storage contain specific software. In an embodiment a list of virtual machines that do not contain a specific software technology including for example a kernel V driver according to the present invention can be developed. Since a hypervisor contains information on the location of each at rest virtual machine i.e. the flat file of a virtual machine that is not being executed the list of virtual machines that do not contain a kernel V driver can be used to query hypervisor API or kernel V driver in hypervisor kernel to locate where physically those virtual machines reside when they are at rest. It will thus be possible to identify locate and insert a kernel level device driver into a virtual machine file that is resident on a physical machine or on a local disk storage area network or network attached storage associated with a particular hypervisor.

The insertion of a kernel driver into a flat file that when executed is considered a virtual machine may be accomplished by parsing though the at rest flat file of the virtual machine and identifying the bit location of other known drivers e.g. printer drivers communications drivers and other similar drivers Once a specific known driver is location various methods could be used to insert the kernel driver into the virtual machine flat file.

In an embodiment virtual machine flat file can be parsed for known drivers and once located a known driver can be replaced with a kernel driver such as V driver Kernel Driver shown in that mimics the same functionality as the original driver by compressing both the original driver the V driver and a compression engine into the same size memory space as the original uncompressed driver.

In an alternate embodiment virtual machine flat file can be parsed for known drivers as described above. The known driver can be replaced with V driver kernel driver that will facilitate the functions of the known driver by encapsulating the known driver with an application wrapper that can then utilize V driver kernel driver to execute the encapsulated known driver from application space while providing it a kernel interface. The V driver will assume the location and connection of the known driver and move the known driver into application space setting up a conduit to interface the known driver back into the kernel.

In yet another embodiment the virtual machine can be executed in temporary contained memory also known as a sandbox and the V driver Kernel Driver can be inserted at run time with no user interaction. The insertion is accomplished by utilizing the exposed interfaces at run time. By loading the Virtual Machine in a separate virtual player instance for the purposes running a driver insertion script against the file the virtual machine will temporarily be executed by the virtual player instance and then inserted with the driver and terminated without user interaction. This process will be performed as a batch process against virtual machines that do not contain the V driver automatically at the user s option.

A communication network can contain both trusted peers and untrusted hosts within the network. Utilizing the systems and methods described above trusted peers can collaborate with each other and with an administration console using collaboration modules. A trusted peer can observe and monitor the activity of other trusted peers untrusted hosts along with activity within the computing system of that trusted peer itself. In addition a trusted peer instantiated with a virtual machine can have an operating system kernel collaborate with a hypervisor to determine whether threats are present. A trusted peer that needs particular functionality installed can collaborate with other trusted peers and with an administrative console to have that functionality installed. Further an untrusted host can have a driver directly inserted into it by an administration console which will facilitate in the collaboration process.

The previous description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other embodiments without departing from the spirit or scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.

